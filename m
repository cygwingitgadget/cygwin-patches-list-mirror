From: "Robert Collins" <robert.collins@itdomain.com.au>
To: "Gary R. Van Sickle" <g.r.vansickle@worldnet.att.net>, <cygwin-patches@sourceware.cygnus.com>
Subject: Re: [PATCH] Update 2 - Setup.exe property sheet patch
Date: Thu, 20 Dec 2001 04:38:00 -0000
Message-ID: <023b01c18953$25d03ee0$0200a8c0@lifelesswks>
References: <NCBBIHCHBLCMLBLOBONKIEAFCIAA.g.r.vansickle@worldnet.att.net>
X-SW-Source: 2001-q4/msg00342.html
Content-type: multipart/mixed; boundary="----------=_1583532850-65438-128"
Message-ID: <20011220043800.heOZMzBlANCW4X3XU8h7YlnvjlRN2TGJ3hptrXYJTAg@z>

This is a multi-part message in MIME format...

------------=_1583532850-65438-128
Content-length: 309

Hmm, houston we have a problem. Local installs are busted.

I've attached the actual patch against CVS head (i've run indent on
everything, so even with the new files in it's only 120Kb now.

Don't worry about fixing local installs just yet - lets get the thing
committed. But As soon as it's in ... :}.

Rob

------------=_1583532850-65438-128
Content-Type: text/x-diff; charset=us-ascii; name="Property.patch"
Content-Disposition: inline; filename="Property.patch"
Content-Transfer-Encoding: base64
Content-Length: 166730

PyBhcgo/IGNvcHlhbmRzcGF3bi5jYwo/IGZvby5wYXRjaAo/IEd1aWRlbGlu
ZXMudHh0Cj8gaW9fc3RyZWFtLW5ldF9sYXRlc3QuZGlmZgo/IGlvX3N0cmVh
bS1uZXRfbGF0ZXN0X01ha2VmaWxlLmluLmRpZmYKPyBwYXZlbDIwMDExMjA2
LnBhdGNoCj8gUHJvcHJldHkucGF0Y2gKPyByZXBsYWNlc2VsZi5wYXRjaAo/
IHNldHVwZml4LnBhdGNoCj8gVVJMUGFyc2VyLmNjCj8gVVJMUGFyc2VyLmgK
SW5kZXg6IE1ha2VmaWxlLmluCj09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KUkNT
IGZpbGU6IC9jdnMvc3JjL3NyYy93aW5zdXAvY2luc3RhbGwvTWFrZWZpbGUu
aW4sdgpyZXRyaWV2aW5nIHJldmlzaW9uIDIuMzkKZGlmZiAtdSAtcCAtcjIu
MzkgTWFrZWZpbGUuaW4KLS0tIE1ha2VmaWxlLmluCTIwMDEvMTIvMjAgMTE6
NDk6NTMJMi4zOQorKysgTWFrZWZpbGUuaW4JMjAwMS8xMi8yMCAxMjozNTo1
NwpAQCAtODcsNiArODcsNyBAQCBPQkpTID0gXAogCWF1dG9sb2FkLm8gXAog
CWNhdGVnb3J5Lm8gXAogCWNob29zZS5vIFwKKwljaXN0cmluZy5vIFwKIAlj
b21wcmVzcy5vIFwKIAljb21wcmVzc19iei5vIFwKIAljb21wcmVzc19nei5v
IFwKQEAgLTEyOSw2ICsxMzAsOCBAQCBPQkpTID0gXAogCXBhY2thZ2Vfc291
cmNlLm8gXAogCXBhY2thZ2VfdmVyc2lvbi5vIFwKIAlwb3N0aW5zdGFsbC5v
IFwKKwlwcm9wcGFnZS5vIFwKKwlwcm9wc2hlZXQubyBcCiAJcmVzLm8gXAog
CXJmYzE3MzgubyBcCiAJcm9vdC5vIFwKQEAgLTEzOCw3ICsxNDEsOSBAQCBP
QkpTID0gXAogCXNvdXJjZS5vIFwKIAlzcGxhc2gubyBcCiAJc3RhdGUubyBc
CisJdGhyZWViYXIubyBcCiAJdmVyc2lvbi5vIFwKKwl3aW5kb3cubyBcCiAJ
JEUKIAogLlNVRkZJWEVTOgpJbmRleDogY2hvb3NlLmNjCj09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT0KUkNTIGZpbGU6IC9jdnMvc3JjL3NyYy93aW5zdXAvY2lu
c3RhbGwvY2hvb3NlLmNjLHYKcmV0cmlldmluZyByZXZpc2lvbiAyLjc5CmRp
ZmYgLXUgLXAgLXIyLjc5IGNob29zZS5jYwotLS0gY2hvb3NlLmNjCTIwMDEv
MTIvMjAgMTE6NDk6NTMJMi43OQorKysgY2hvb3NlLmNjCTIwMDEvMTIvMjAg
MTI6MzU6NTkKQEAgLTM2LDYgKzM2LDcgQEAgc3RhdGljIGNvbnN0IGNoYXIg
KmN2c2lkID0KICNpbmNsdWRlIDxzdGRsaWIuaD4KICNpbmNsdWRlIDxpby5o
PgogI2luY2x1ZGUgPGN0eXBlLmg+CisjaW5jbHVkZSA8cHJvY2Vzcy5oPgog
CiAjaW5jbHVkZSAiZGlhbG9nLmgiCiAjaW5jbHVkZSAicmVzb3VyY2UuaCIK
QEAgLTQ3LDYgKzQ4LDcgQEAgc3RhdGljIGNvbnN0IGNoYXIgKmN2c2lkID0K
ICNpbmNsdWRlICJmaW5kLmgiCiAjaW5jbHVkZSAiZmlsZW1hbmlwLmgiCiAj
aW5jbHVkZSAiaW9fc3RyZWFtLmgiCisjaW5jbHVkZSAicHJvcHNoZWV0Lmgi
CiAjaW5jbHVkZSAiY2hvb3NlLmgiCiAjaW5jbHVkZSAiY2F0ZWdvcnkuaCIK
IApAQCAtNTUsNiArNTcsOCBAQCBzdGF0aWMgY29uc3QgY2hhciAqY3ZzaWQg
PQogI2luY2x1ZGUgInBhY2thZ2VfdmVyc2lvbi5oIgogCiAjaW5jbHVkZSAi
cG9ydC5oIgorI2luY2x1ZGUgInRocmVlYmFyLmgiCitleHRlcm4gVGhyZWVC
YXJQcm9ncmVzc1BhZ2UgUHJvZ3Jlc3M7CiAKICNkZWZpbmUgYWxsb2NhIF9f
YnVpbHRpbl9hbGxvY2EKIApAQCAtMTA4OSw2ICsxMDkzLDcgQEAgZGlhbG9n
X3Byb2MgKEhXTkQgaCwgVUlOVCBtZXNzYWdlLCBXUEFSQQogICAgICAgci50
b3AgKz0gMjsKICAgICAgIHIuYm90dG9tIC09IDI7CiAgICAgICBjcmVhdGVf
bGlzdHZpZXcgKGgsICZyKTsKKwogI2lmIDAKICAgICAgIGxvYWRfZGlhbG9n
IChoKTsKICNlbmRpZgpAQCAtMTE5Myw3ICsxMTk4LDcgQEAgc2Nhbl9kb3du
bG9hZGVkX2ZpbGVzICgpCiB9CiAKIHZvaWQKLWRvX2Nob29zZSAoSElOU1RB
TkNFIGgpCitkb19jaG9vc2UgKEhJTlNUQU5DRSBoLCBIV05EIG93bmVyKQog
ewogICBpbnQgcnY7CiAKQEAgLTEyMTcsOSArMTIyMiw5IEBAIGRvX2Nob29z
ZSAoSElOU1RBTkNFIGgpCiAgIHNldF9leGlzdGVuY2UgKCk7CiAgIGZpbGxf
bWlzc2luZ19jYXRlZ29yeSAoKTsKIAotICBydiA9IERpYWxvZ0JveCAoaCwg
TUFLRUlOVFJFU09VUkNFIChJRERfQ0hPT1NFKSwgMCwgZGlhbG9nX3Byb2Mp
OworICBydiA9IERpYWxvZ0JveCAoaCwgTUFLRUlOVFJFU09VUkNFIChJRERf
Q0hPT1NFKSwgb3duZXIsIGRpYWxvZ19wcm9jKTsKICAgaWYgKHJ2ID09IC0x
KQotICAgIGZhdGFsIChJRFNfRElBTE9HX0ZBSUxFRCk7CisgICAgZmF0YWwg
KG93bmVyLCBJRFNfRElBTE9HX0ZBSUxFRCk7CiAKICAgbG9nIChMT0dfQkFC
QkxFLCAiQ2hvb3NlciByZXN1bHRzLi4uIik7CiAgIHBhY2thZ2VkYiBkYjsK
QEAgLTEzMDIsNCArMTMwNyw2MyBAQCBkb19jaG9vc2UgKEhJTlNUQU5DRSBo
KQogCX0KICNlbmRpZgogICAgIH0KK30KKworI2RlZmluZSBXTV9BUFBfU1RB
UlRfQ0hPT1NFICAgICAgICBXTV9BUFArMAorI2RlZmluZSBXTV9BUFBfQ0hP
T1NFX0lTX0ZJTklTSEVEICBXTV9BUFArMQorCitleHRlcm4gdm9pZAorZG9f
Y2hvb3NlIChISU5TVEFOQ0UgaCwgSFdORCBvd25lcik7CisKK3ZvaWQgZG9f
Y2hvb3NlX3RocmVhZCh2b2lkICpwKQoreworCUNob29zZXJQYWdlICpjcDsK
KworCWNwID0gc3RhdGljX2Nhc3Q8Q2hvb3NlclBhZ2UqPihwKTsKKworCWRv
X2Nob29zZShjcC0+R2V0SW5zdGFuY2UoKSwgY3AtPkdldEhXTkQoKSk7CisK
KwljcC0+UG9zdE1lc3NhZ2UoV01fQVBQX0NIT09TRV9JU19GSU5JU0hFRCk7
CisKKwlfZW5kdGhyZWFkKCk7Cit9CisKK2Jvb2wgQ2hvb3NlclBhZ2U6OkNy
ZWF0ZSgpCit7CisgIHJldHVybiBQcm9wZXJ0eVBhZ2U6OkNyZWF0ZShJRERf
Q0hPT1NFUik7Cit9CisKK3ZvaWQgQ2hvb3NlclBhZ2U6Ok9uQWN0aXZhdGUo
KQoreworICBHZXRPd25lcigpLT5TZXRCdXR0b25zKDApOworICBQb3N0TWVz
c2FnZShXTV9BUFBfU1RBUlRfQ0hPT1NFKTsKK30KKworYm9vbCBDaG9vc2Vy
UGFnZTo6T25NZXNzYWdlQXBwKFVJTlQgdU1zZywgV1BBUkFNIHdQYXJhbSwg
TFBBUkFNIGxQYXJhbSkKK3sKKwlzd2l0Y2godU1zZykKKwl7CisJY2FzZSBX
TV9BUFBfU1RBUlRfQ0hPT1NFOgorCQl7CisJCQkvLyBTdGFydCB0aGUgY2hv
b3NlciB0aHJlYWQuCisJCQlfYmVnaW50aHJlYWQoZG9fY2hvb3NlX3RocmVh
ZCwgMCwgdGhpcyk7CisJCQlicmVhazsKKwkJfQorCWNhc2UgV01fQVBQX0NI
T09TRV9JU19GSU5JU0hFRDoKKwkJeworCQkJaWYobmV4dF9kaWFsb2cgPT0g
MCkKKwkJCXsKKwkJCQkvLyBDYW5jZWwKKwkJCQlHZXRPd25lcigpLT5QcmVz
c0J1dHRvbihQU0JUTl9DQU5DRUwpOworCQkJCWJyZWFrOworCQkJfQorCQkJ
UHJvZ3Jlc3MuU2V0QWN0aXZhdGVUYXNrKFdNX0FQUF9TVEFSVF9ET1dOTE9B
RCk7CisJCQlHZXRPd25lcigpLT5TZXRBY3RpdmVQYWdlQnlJRChJRERfSU5T
VEFUVVMpOworCQkJYnJlYWs7CisJCX0KKwlkZWZhdWx0OgorCQlyZXR1cm4g
ZmFsc2U7CisJCWJyZWFrOworCX0KKwlyZXR1cm4gdHJ1ZTsKIH0KSW5kZXg6
IGNob29zZS5oCj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KUkNTIGZpbGU6IC9j
dnMvc3JjL3NyYy93aW5zdXAvY2luc3RhbGwvY2hvb3NlLmgsdgpyZXRyaWV2
aW5nIHJldmlzaW9uIDIuOQpkaWZmIC11IC1wIC1yMi45IGNob29zZS5oCi0t
LSBjaG9vc2UuaAkyMDAxLzEyLzIwIDExOjQ5OjUzCTIuOQorKysgY2hvb3Nl
LmgJMjAwMS8xMi8yMCAxMjozNTo1OQpAQCAtMTYsNiArMTYsOCBAQAogI2lm
bmRlZiBfQ0hPT1NFX0hfCiAjZGVmaW5lIF9DSE9PU0VfSF8KIAorI2luY2x1
ZGUgInByb3BwYWdlLmgiCisKIGNsYXNzIENhdGVnb3J5OwogY2xhc3MgcGFj
a2FnZW1ldGE7CiAKQEAgLTE5NSw1ICsxOTcsMTggQEAgcHJpdmF0ZToKICAg
dm9pZCBzZXRfaGVhZGVycyAoKTsKICAgdm9pZCBpbml0X2hlYWRlcnMgKEhE
QyBkYyk7CiB9OworCitjbGFzcyBDaG9vc2VyUGFnZSA6IHB1YmxpYyBQcm9w
ZXJ0eVBhZ2UKK3sKK3B1YmxpYzoKKwlDaG9vc2VyUGFnZSgpIHt9OworCXZp
cnR1YWwgfkNob29zZXJQYWdlKCkge307CisJCisJdmlydHVhbCBib29sIE9u
TWVzc2FnZUFwcChVSU5UIHVNc2csIFdQQVJBTSB3UGFyYW0sIExQQVJBTSBs
UGFyYW0pOworCQorCWJvb2wgQ3JlYXRlKCk7CisJdmlydHVhbCB2b2lkIE9u
QWN0aXZhdGUoKTsKK307CisKICNlbmRpZiAvKiBfX2NwbHVzcGx1cyAqLwog
I2VuZGlmIC8qIF9DSE9PU0VfSF8gKi8KSW5kZXg6IGNpc3RyaW5nLmNjCj09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT0KUkNTIGZpbGU6IGNpc3RyaW5nLmNjCmRp
ZmYgLU4gY2lzdHJpbmcuY2MKLS0tIC9kZXYvbnVsbAlUdWUgTWF5ICA1IDEz
OjMyOjI3IDE5OTgKKysrIGNpc3RyaW5nLmNjCVRodSBEZWMgMjAgMDQ6MzU6
NTkgMjAwMQpAQCAtMCwwICsxLDUyIEBACisvKgorICogQ29weXJpZ2h0IChj
KSAyMDAxLCBHYXJ5IFIuIFZhbiBTaWNrbGUuCisgKgorICogICAgIFRoaXMg
cHJvZ3JhbSBpcyBmcmVlIHNvZnR3YXJlOyB5b3UgY2FuIHJlZGlzdHJpYnV0
ZSBpdCBhbmQvb3IgbW9kaWZ5CisgKiAgICAgaXQgdW5kZXIgdGhlIHRlcm1z
IG9mIHRoZSBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBhcyBwdWJsaXNo
ZWQgYnkKKyAqICAgICB0aGUgRnJlZSBTb2Z0d2FyZSBGb3VuZGF0aW9uOyBl
aXRoZXIgdmVyc2lvbiAyIG9mIHRoZSBMaWNlbnNlLCBvcgorICogICAgIChh
dCB5b3VyIG9wdGlvbikgYW55IGxhdGVyIHZlcnNpb24uCisgKgorICogICAg
IEEgY29weSBvZiB0aGUgR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgY2Fu
IGJlIGZvdW5kIGF0CisgKiAgICAgaHR0cDovL3d3dy5nbnUub3JnLworICoK
KyAqIFdyaXR0ZW4gYnkgR2FyeSBSLiBWYW4gU2lja2xlIDxnLnIudmFuc2lj
a2xlQHdvcmxkbmV0LmF0dC5uZXQ+CisgKgorICovCisKKy8vIFllcCwgYW5v
dGhlciBzdHJpbmcgY2xhc3MKKworI2luY2x1ZGUgImNpc3RyaW5nLmgiCisj
aW5jbHVkZSA8c3RkbGliLmg+CisKK0RXT1JECitjaXN0cmluZzo6Rm9ybWF0
IChVSU5UIGksIC4uLikKK3sKKyAgVENIQVIgRm9ybWF0U3RyaW5nQnVmZmVy
WzI1Nl07CisgIFRDSEFSICpCdWZmOworICB2YV9saXN0IGFyZ2xpc3Q7Cisg
IERXT1JEIG51bWNoYXJzOworCisgIC8vIEdldCB0aGUgc3RyaW5nIGZyb20g
dGhlIHN0cmluZ3RhYmxlIChGb3JtYXRNZXNzYWdlKCkgY2FuIG9ubHkgd29y
ayB3aXRoCisgIC8vIGxpdGVyYWwgc3RyaW5ncyBvciAqbWVzc2FnZSp0YWJs
ZSBlbnRyaWVzLCB3aGljaCBhcmUgZGlmZmVyZW50IGZvciBzb21lCisgIC8v
IGluZXhwbGljYWJsZSByZWFzb24pLgorICBMb2FkU3RyaW5nIChHZXRNb2R1
bGVIYW5kbGUgKE5VTEwpLCBpLCBGb3JtYXRTdHJpbmdCdWZmZXIsIDI1Nik7
CisKKyAgdmFfc3RhcnQgKGFyZ2xpc3QsIGkpOworICBudW1jaGFycyA9OjoK
KyAgICBGb3JtYXRNZXNzYWdlIChGT1JNQVRfTUVTU0FHRV9BTExPQ0FURV9C
VUZGRVIgfAorCQkgICBGT1JNQVRfTUVTU0FHRV9GUk9NX1NUUklORywgRm9y
bWF0U3RyaW5nQnVmZmVyLCBpLCAwLAorCQkgICAoTFBUU1RSKSAmIEJ1ZmYs
IDAsICZhcmdsaXN0KTsKKyAgdmFfZW5kIChhcmdsaXN0KTsKKworICBpZiAo
bnVtY2hhcnMgPT0gMCkKKyAgICB7CisgICAgICAvLyBTb21ldGhpbmcgd2Vu
dCB3cm9uZy4KKyAgICAgIHJldHVybiAwOworICAgIH0KKworICBidWZmZXIg
PSBuZXcgVENIQVJbKG51bWNoYXJzICsgMSkgKiBzaXplb2YgKFRDSEFSKV07
CisgIG1lbWNweSAoYnVmZmVyLCBCdWZmLCAobnVtY2hhcnMgKyAxKSAqIHNp
emVvZiAoVENIQVIpKTsKKyAgTG9jYWxGcmVlIChCdWZmKTsKKworICByZXR1
cm4gbnVtY2hhcnM7Cit9CkluZGV4OiBjaXN0cmluZy5oCj09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT0KUkNTIGZpbGU6IGNpc3RyaW5nLmgKZGlmZiAtTiBjaXN0
cmluZy5oCi0tLSAvZGV2L251bGwJVHVlIE1heSAgNSAxMzozMjoyNyAxOTk4
CisrKyBjaXN0cmluZy5oCVRodSBEZWMgMjAgMDQ6MzU6NTkgMjAwMQpAQCAt
MCwwICsxLDQxIEBACisvKgorICogQ29weXJpZ2h0IChjKSAyMDAxLCBHYXJ5
IFIuIFZhbiBTaWNrbGUuCisgKgorICogICAgIFRoaXMgcHJvZ3JhbSBpcyBm
cmVlIHNvZnR3YXJlOyB5b3UgY2FuIHJlZGlzdHJpYnV0ZSBpdCBhbmQvb3Ig
bW9kaWZ5CisgKiAgICAgaXQgdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBHTlUg
R2VuZXJhbCBQdWJsaWMgTGljZW5zZSBhcyBwdWJsaXNoZWQgYnkKKyAqICAg
ICB0aGUgRnJlZSBTb2Z0d2FyZSBGb3VuZGF0aW9uOyBlaXRoZXIgdmVyc2lv
biAyIG9mIHRoZSBMaWNlbnNlLCBvcgorICogICAgIChhdCB5b3VyIG9wdGlv
bikgYW55IGxhdGVyIHZlcnNpb24uCisgKgorICogICAgIEEgY29weSBvZiB0
aGUgR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgY2FuIGJlIGZvdW5kIGF0
CisgKiAgICAgaHR0cDovL3d3dy5nbnUub3JnLworICoKKyAqIFdyaXR0ZW4g
YnkgR2FyeSBSLiBWYW4gU2lja2xlIDxnLnIudmFuc2lja2xlQHdvcmxkbmV0
LmF0dC5uZXQ+CisgKgorICovCisKKy8vIFllcCwgYW5vdGhlciBzdHJpbmcg
Y2xhc3MKKworI2luY2x1ZGUgPHdpbmRvd3MuaD4KKworY2xhc3MgY2lzdHJp
bmcKK3sKKyAgVENIQVIgKmJ1ZmZlcjsKK3B1YmxpYzoKKyAgICBjaXN0cmlu
ZyAoKQorICB7CisgICAgYnVmZmVyID0gTlVMTDsKKyAgfTsKKyAgY2lzdHJp
bmcgKGNvbnN0IFRDSEFSICogcyk7CisgIH5jaXN0cmluZyAoKQorICB7Cisg
ICAgaWYgKGJ1ZmZlciAhPSBOVUxMKQorICAgICAgZGVsZXRlW11idWZmZXI7
CisgIH07CisKKyAgY29uc3QgVENIQVIgKmNfc3RyICgpCisgIHsKKyAgICBy
ZXR1cm4gYnVmZmVyOworICB9OworCisgIERXT1JEIEZvcm1hdCAoVUlOVCBp
LCAuLi4pOworfTsKSW5kZXg6IGRlc2t0b3AuY2MKPT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PQpSQ1MgZmlsZTogL2N2cy9zcmMvc3JjL3dpbnN1cC9jaW5zdGFs
bC9kZXNrdG9wLmNjLHYKcmV0cmlldmluZyByZXZpc2lvbiAyLjE5CmRpZmYg
LXUgLXAgLXIyLjE5IGRlc2t0b3AuY2MKLS0tIGRlc2t0b3AuY2MJMjAwMS8x
Mi8yMCAxMTo0OTo1MwkyLjE5CisrKyBkZXNrdG9wLmNjCTIwMDEvMTIvMjAg
MTI6MzU6NTkKQEAgLTQ4LDYgKzQ4LDggQEAgc3RhdGljIGNvbnN0IGNoYXIg
KmN2c2lkID0KICNpbmNsdWRlICJwYWNrYWdlX21ldGEuaCIKICNpbmNsdWRl
ICJwYWNrYWdlX3ZlcnNpb24uaCIKIAorI2luY2x1ZGUgImRlc2t0b3AuaCIK
Kwogc3RhdGljIE9TVkVSU0lPTklORk8gdmVyaW5mbzsKIAogLyogTGluZXMg
c3RhcnRpbmcgd2l0aCAnQCcgYXJlIGNvbmRpdGlvbmFscyAtIGluY2x1ZGUg
J04nIGZvciBOVCwKQEAgLTQ0NCw1NiArNDQ2LDQ4IEBAIGRpYWxvZ19jbWQg
KEhXTkQgaCwgaW50IGlkLCBIV05EIGh3bmRjdGwKICAgICAgIHNhdmVfZGlh
bG9nIChoKTsKICAgICAgIGNoZWNrX2lmX2VuYWJsZV9uZXh0IChoKTsKICAg
ICAgIGJyZWFrOwotCi0gICAgY2FzZSBJRE9LOgotICAgICAgc2F2ZV9kaWFs
b2cgKGgpOwotICAgICAgZG9fZGVza3RvcF9zZXR1cCAoKTsKLSAgICAgIE5F
WFQgKElERF9TX1BPU1RJTlNUQUxMKTsKLSAgICAgIGJyZWFrOwotCi0gICAg
Y2FzZSBJRENfQkFDSzoKLSAgICAgIHNhdmVfZGlhbG9nIChoKTsKLSAgICAg
IE5FWFQgKElERF9DSE9PU0UpOwotICAgICAgYnJlYWs7Ci0KLSAgICBjYXNl
IElEQ0FOQ0VMOgotICAgICAgTkVYVCAoMCk7Ci0gICAgICBicmVhazsKICAg
ICB9CiAgIHJldHVybiAwOwogfQogCi1zdGF0aWMgQk9PTCBDQUxMQkFDSwot
ZGlhbG9nX3Byb2MgKEhXTkQgaCwgVUlOVCBtZXNzYWdlLCBXUEFSQU0gd1Bh
cmFtLCBMUEFSQU0gbFBhcmFtKQorYm9vbAorRGVza3RvcFNldHVwUGFnZTo6
Q3JlYXRlICgpCiB7Ci0gIHN3aXRjaCAobWVzc2FnZSkKLSAgICB7Ci0gICAg
Y2FzZSBXTV9JTklURElBTE9HOgotICAgICAgbG9hZF9kaWFsb2cgKGgpOwot
ICAgICAgcmV0dXJuIEZBTFNFOwotICAgIGNhc2UgV01fQ09NTUFORDoKLSAg
ICAgIHJldHVybiBIQU5ETEVfV01fQ09NTUFORCAoaCwgd1BhcmFtLCBsUGFy
YW0sIGRpYWxvZ19jbWQpOwotICAgIH0KLSAgcmV0dXJuIEZBTFNFOworICBy
ZXR1cm4gUHJvcGVydHlQYWdlOjpDcmVhdGUgKE5VTEwsIGRpYWxvZ19jbWQs
IElERF9ERVNLVE9QKTsKIH0KIAogdm9pZAotZG9fZGVza3RvcCAoSElOU1RB
TkNFIGgpCitEZXNrdG9wU2V0dXBQYWdlOjpPbkluaXQgKCkKIHsKKyAgLy8g
RklYTUU6IFRoaXMgQ29Jbml0aWFsaXplKCkgZmVlbHMgbGlrZSBpdCBjb3Vs
ZCBiZSBtb3ZlZCB0byBzdGFydHVwIGluIG1haW4uY2MuCiAgIENvSW5pdGlh
bGl6ZSAoTlVMTCk7Ci0KICAgdmVyaW5mby5kd09TVmVyc2lvbkluZm9TaXpl
ID0gc2l6ZW9mICh2ZXJpbmZvKTsKICAgR2V0VmVyc2lvbkV4ICgmdmVyaW5m
byk7Ci0KICAgcm9vdF9kZXNrdG9wID0KICAgICBjaGVja19kZXNrdG9wICgi
Q3lnd2luIiwgYmFja3NsYXNoIChjeWdwYXRoICgiL2N5Z3dpbi5iYXQiLCAw
KSkpOwogICByb290X21lbnUgPQogICAgIGNoZWNrX3N0YXJ0bWVudSAoIkN5
Z3dpbiBCYXNoIFNoZWxsIiwKIAkJICAgICBiYWNrc2xhc2ggKGN5Z3BhdGgg
KCIvY3lnd2luLmJhdCIsIDApKSk7CisgIGxvYWRfZGlhbG9nIChHZXRIV05E
ICgpKTsKK30KIAotICBpbnQgcnYgPSAwOworbG9uZworRGVza3RvcFNldHVw
UGFnZTo6T25CYWNrICgpCit7CisgIEhXTkQgaCA9IEdldEhXTkQgKCk7Cisg
IHNhdmVfZGlhbG9nIChoKTsKKyAgTkVYVCAoSUREX0NIT09TRSk7CisgIHJl
dHVybiBJRERfQ0hPT1NFUjsKK30KKworYm9vbAorRGVza3RvcFNldHVwUGFn
ZTo6T25GaW5pc2ggKCkKK3sKKyAgSFdORCBoID0gR2V0SFdORCAoKTsKKyAg
c2F2ZV9kaWFsb2cgKGgpOworICBkb19kZXNrdG9wX3NldHVwICgpOworICBO
RVhUIChJRERfU19QT1NUSU5TVEFMTCk7CisgIGRvX3Bvc3RpbnN0YWxsIChH
ZXRJbnN0YW5jZSAoKSwgaCk7CiAKLSAgcnYgPSBEaWFsb2dCb3ggKGgsIE1B
S0VJTlRSRVNPVVJDRSAoSUREX0RFU0tUT1ApLCAwLCBkaWFsb2dfcHJvYyk7
Ci0gIGlmIChydiA9PSAtMSkKLSAgICBmYXRhbCAoSURTX0RJQUxPR19GQUlM
RUQpOworICByZXR1cm4gdHJ1ZTsKIH0KSW5kZXg6IGRlc2t0b3AuaAo9PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09ClJDUyBmaWxlOiBkZXNrdG9wLmgKZGlmZiAt
TiBkZXNrdG9wLmgKLS0tIC9kZXYvbnVsbAlUdWUgTWF5ICA1IDEzOjMyOjI3
IDE5OTgKKysrIGRlc2t0b3AuaAlUaHUgRGVjIDIwIDA0OjM1OjU5IDIwMDEK
QEAgLTAsMCArMSw0MSBAQAorI2lmbmRlZiBDSU5TVEFMTF9ERVNLVE9QX0gK
KyNkZWZpbmUgQ0lOU1RBTExfREVTS1RPUF9ICisKKy8qCisgKiBDb3B5cmln
aHQgKGMpIDIwMDEsIEdhcnkgUi4gVmFuIFNpY2tsZS4KKyAqCisgKiAgICAg
VGhpcyBwcm9ncmFtIGlzIGZyZWUgc29mdHdhcmU7IHlvdSBjYW4gcmVkaXN0
cmlidXRlIGl0IGFuZC9vciBtb2RpZnkKKyAqICAgICBpdCB1bmRlciB0aGUg
dGVybXMgb2YgdGhlIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGFzIHB1
Ymxpc2hlZCBieQorICogICAgIHRoZSBGcmVlIFNvZnR3YXJlIEZvdW5kYXRp
b247IGVpdGhlciB2ZXJzaW9uIDIgb2YgdGhlIExpY2Vuc2UsIG9yCisgKiAg
ICAgKGF0IHlvdXIgb3B0aW9uKSBhbnkgbGF0ZXIgdmVyc2lvbi4KKyAqCisg
KiAgICAgQSBjb3B5IG9mIHRoZSBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5z
ZSBjYW4gYmUgZm91bmQgYXQKKyAqICAgICBodHRwOi8vd3d3LmdudS5vcmcv
CisgKgorICogV3JpdHRlbiBieSBHYXJ5IFIuIFZhbiBTaWNrbGUgPGcuci52
YW5zaWNrbGVAd29ybGRuZXQuYXR0Lm5ldD4KKyAqCisgKi8KKworLy8gVGhp
cyBpcyB0aGUgaGVhZGVyIGZvciB0aGUgRGVza3RvcFNldHVwUGFnZSBjbGFz
cy4gIEFsbG93cyBzZWxlY3Rpb24KKy8vIG9mICJjcmVhdGUgZGVza3RvcCBp
Y29uIiBhbmQgImFkZCB0byBzdGFydCBtZW51Ii4KKworI2luY2x1ZGUgInBy
b3BwYWdlLmgiCisKK2NsYXNzIERlc2t0b3BTZXR1cFBhZ2U6cHVibGljIFBy
b3BlcnR5UGFnZQoreworcHVibGljOgorICBEZXNrdG9wU2V0dXBQYWdlICgp
CisgIHsKKyAgfTsKKyAgdmlydHVhbCB+IERlc2t0b3BTZXR1cFBhZ2UgKCkK
KyAgeworICB9OworCisgIGJvb2wgQ3JlYXRlICgpOworCisgIHZpcnR1YWwg
dm9pZCBPbkluaXQgKCk7CisgIHZpcnR1YWwgYm9vbCBPbkZpbmlzaCAoKTsK
KyAgdmlydHVhbCBsb25nIE9uQmFjayAoKTsKK307CisKKyNlbmRpZiAvLyBD
SU5TVEFMTF9ERVNLVE9QX0gKSW5kZXg6IGRpYWxvZy5oCj09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT0KUkNTIGZpbGU6IC9jdnMvc3JjL3NyYy93aW5zdXAvY2lu
c3RhbGwvZGlhbG9nLmgsdgpyZXRyaWV2aW5nIHJldmlzaW9uIDIuNApkaWZm
IC11IC1wIC1yMi40IGRpYWxvZy5oCi0tLSBkaWFsb2cuaAkyMDAxLzExLzEz
IDAxOjQ5OjMxCTIuNAorKysgZGlhbG9nLmgJMjAwMS8xMi8yMCAxMjozNTo1
OQpAQCAtMjIsNyArMjIsNyBAQCBleHRlcm4gaW50IG5leHRfZGlhbG9nOwog
LyogZWl0aGVyICJub3RoaW5nIHRvIGRvIiBvciAic2V0dXAgY29tcGxldGUi
IG9yIHNvbWV0aGluZyBsaWtlIHRoYXQgKi8KIGV4dGVybiBpbnQgZXhpdF9t
c2c7CiAKLSNkZWZpbmUgRCh4KSB2b2lkIHgoSElOU1RBTkNFIF9oKQorI2Rl
ZmluZSBEKHgpIHZvaWQgeChISU5TVEFOQ0UgX2gsIEhXTkQgb3duZXIpCiAK
IC8qIHByb3RvdHlwZXMgZm9yIGFsbCB0aGUgZG9fKiBmdW5jdGlvbnMgKG1v
c3QgY2FsbGVkIGJ5IG1haW4uY2MpICovCiAKSW5kZXg6IGRvd25sb2FkLmNj
Cj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT0KUkNTIGZpbGU6IC9jdnMvc3JjL3Ny
Yy93aW5zdXAvY2luc3RhbGwvZG93bmxvYWQuY2MsdgpyZXRyaWV2aW5nIHJl
dmlzaW9uIDIuMTgKZGlmZiAtdSAtcCAtcjIuMTggZG93bmxvYWQuY2MKLS0t
IGRvd25sb2FkLmNjCTIwMDEvMTIvMjAgMTE6NDk6NTMJMi4xOAorKysgZG93
bmxvYWQuY2MJMjAwMS8xMi8yMCAxMjozNTo1OQpAQCAtMjUsNiArMjUsNyBA
QCBzdGF0aWMgY29uc3QgY2hhciAqY3ZzaWQgPQogCiAjaW5jbHVkZSA8c3Rk
aW8uaD4KICNpbmNsdWRlIDx1bmlzdGQuaD4KKyNpbmNsdWRlIDxwcm9jZXNz
Lmg+CiAKICNpbmNsdWRlICJyZXNvdXJjZS5oIgogI2luY2x1ZGUgIm1zZy5o
IgpAQCAtNDcsNiArNDgsOSBAQCBzdGF0aWMgY29uc3QgY2hhciAqY3ZzaWQg
PQogCiAjaW5jbHVkZSAicmZjMTczOC5oIgogCisjaW5jbHVkZSAidGhyZWVi
YXIuaCIKK2V4dGVybiBUaHJlZUJhclByb2dyZXNzUGFnZSBQcm9ncmVzczsK
KwogLyogMCBvbiBmYWlsdXJlCiAgKi8KIHN0YXRpYyBpbnQKQEAgLTk1LDcg
Kzk5LDcgQEAgY2hlY2tfZm9yX2NhY2hlZCAocGFja2FnZXNvdXJjZSAmIHBr
Z3NvdQogCiAvKiBkb3dubG9hZCBhIGZpbGUgZnJvbSBhIG1pcnJvciBzaXRl
IHRvIHRoZSBsb2NhbCBjYWNoZS4gKi8KIHN0YXRpYyBpbnQKLWRvd25sb2Fk
X29uZSAocGFja2FnZXNvdXJjZSAmIHBrZ3NvdXJjZSkKK2Rvd25sb2FkX29u
ZSAocGFja2FnZXNvdXJjZSAmIHBrZ3NvdXJjZSwgSFdORCBvd25lcikKIHsK
ICAgaWYgKGNoZWNrX2Zvcl9jYWNoZWQgKHBrZ3NvdXJjZSkgJiYgc291cmNl
ICE9IElEQ19TT1VSQ0VfRE9XTkxPQUQpCiAgICAgcmV0dXJuIDA7CkBAIC0x
MDYsMTQgKzExMCwxNSBAQCBkb3dubG9hZF9vbmUgKHBhY2thZ2Vzb3VyY2Ug
JiBwa2dzb3VyY2UpCiAgIGZvciAoc2l6ZV90IG4gPSAxOyBuIDw9IHBrZ3Nv
dXJjZS5zaXRlcy5udW1iZXIgKCkgJiYgIXN1Y2Nlc3M7IG4rKykKICAgICB7
CiAgICAgICBjb25zdCBjaGFyICpsb2NhbCA9IGNvbmNhdCAobG9jYWxfZGly
LCAiLyIsCi0JCQkJICByZmMxNzM4X2VzY2FwZV9wYXJ0IChwa2dzb3VyY2Uu
c2l0ZXNbbl0tPmtleSksICIvIiwKKwkJCQkgIHJmYzE3MzhfZXNjYXBlX3Bh
cnQgKHBrZ3NvdXJjZS5zaXRlc1tuXS0+CisJCQkJCQkgICAgICAga2V5KSwg
Ii8iLAogCQkJCSAgcGtnc291cmNlLkNhbm9uaWNhbCAoKSwgMCk7CiAgICAg
ICBpb19zdHJlYW06Om1rcGF0aF9wIChQQVRIX1RPX0ZJTEUsIGNvbmNhdCAo
ImZpbGU6Ly8iLCBsb2NhbCwgMCkpOwogCiAgICAgICBpZiAoZ2V0X3VybF90
b19maWxlCiAJICAoY29uY2F0CiAJICAgKHBrZ3NvdXJjZS5zaXRlc1tuXS0+
a2V5LCAiLyIsIHBrZ3NvdXJjZS5DYW5vbmljYWwgKCksIDApLAotCSAgIGNv
bmNhdCAobG9jYWwsICIudG1wIiwgMCksIHBrZ3NvdXJjZS5zaXplKSkKKwkg
ICBjb25jYXQgKGxvY2FsLCAiLnRtcCIsIDApLCBwa2dzb3VyY2Uuc2l6ZSwg
b3duZXIpKQogCXsKIAkgIC8qIEZJWE1FOiBub3RlIG5ldyBzb3VyY2UgPyAq
LwogCSAgY29udGludWU7CkBAIC0xNDYsOCArMTUxLDggQEAgZG93bmxvYWRf
b25lIChwYWNrYWdlc291cmNlICYgcGtnc291cmNlKQogICByZXR1cm4gMTsK
IH0KIAotdm9pZAotZG9fZG93bmxvYWQgKEhJTlNUQU5DRSBoKQorc3RhdGlj
IHZvaWQKK2RvX2Rvd25sb2FkX3RocmVhZCAoSElOU1RBTkNFIGgsIEhXTkQg
b3duZXIpCiB7CiAgIGludCBlcnJvcnMgPSAwOwogICB0b3RhbF9kb3dubG9h
ZF9ieXRlcyA9IDA7CkBAIC0xNTcsMTkgKzE2MiwxOSBAQCBkb19kb3dubG9h
ZCAoSElOU1RBTkNFIGgpCiAgIC8qIGNhbGN1bGF0ZSB0aGUgYW1vdW50IG5l
ZWRlZCAqLwogICBmb3IgKHNpemVfdCBuID0gMTsgbiA8IGRiLnBhY2thZ2Vz
Lm51bWJlciAoKTsgbisrKQogICAgIHsKLSAgICAgIHBhY2thZ2VtZXRhICZw
a2cgPSAqIGRiLnBhY2thZ2VzW25dOworICAgICAgcGFja2FnZW1ldGEgJiBw
a2cgPSAqZGIucGFja2FnZXNbbl07CiAgICAgICBpZiAocGtnLmRlc2lyZWQg
JiYgKHBrZy5kZXNpcmVkLT5zcmNwaWNrZWQgfHwgcGtnLmRlc2lyZWQtPmJp
bnBpY2tlZCkpCi0gICAgICB7Ci0JcGFja2FnZXZlcnNpb24gKnZlcnNpb24g
PSBwa2cuZGVzaXJlZDsKLQlpZiAoIQotCSAgICAoY2hlY2tfZm9yX2NhY2hl
ZCAodmVyc2lvbi0+YmluKQotCSAgICAgJiYgc291cmNlICE9IElEQ19TT1VS
Q0VfRE9XTkxPQUQpKQotCSAgdG90YWxfZG93bmxvYWRfYnl0ZXMgKz0gdmVy
c2lvbi0+YmluLnNpemU7Ci0JaWYgKCEKLQkgICAgKGNoZWNrX2Zvcl9jYWNo
ZWQgKHZlcnNpb24tPnNyYykKLQkgICAgICYmIHNvdXJjZSAhPSBJRENfU09V
UkNFX0RPV05MT0FEKSkKLQkgIHRvdGFsX2Rvd25sb2FkX2J5dGVzICs9IHZl
cnNpb24tPnNyYy5zaXplOwotICAgICAgfQorCXsKKwkgIHBhY2thZ2V2ZXJz
aW9uICp2ZXJzaW9uID0gcGtnLmRlc2lyZWQ7CisJICBpZiAoIQorCSAgICAg
IChjaGVja19mb3JfY2FjaGVkICh2ZXJzaW9uLT5iaW4pCisJICAgICAgICYm
IHNvdXJjZSAhPSBJRENfU09VUkNFX0RPV05MT0FEKSAmJiBwa2cuZGVzaXJl
ZC0+YmlucGlja2VkKQorCSAgICB0b3RhbF9kb3dubG9hZF9ieXRlcyArPSB2
ZXJzaW9uLT5iaW4uc2l6ZTsKKwkgIGlmICghCisJICAgICAgKGNoZWNrX2Zv
cl9jYWNoZWQgKHZlcnNpb24tPnNyYykKKwkgICAgICAgJiYgc291cmNlICE9
IElEQ19TT1VSQ0VfRE9XTkxPQUQpICYmIHBrZy5kZXNpcmVkLT5zcmNwaWNr
ZWQpCisJICAgIHRvdGFsX2Rvd25sb2FkX2J5dGVzICs9IHZlcnNpb24tPnNy
Yy5zaXplOworCX0KICAgICB9CiAKICAgLyogYW5kIGRvIHRoZSBkb3dubG9h
ZC4gRklYTUU6IFRoaXMgaGVyZSB3ZSBhc3NpZ24gYSBuZXcgbmFtZSBmb3Ig
dGhlIGNhY2hlZCB2ZXJzaW9uCkBAIC0xNzcsMjggKzE4MiwyOCBAQCBkb19k
b3dubG9hZCAoSElOU1RBTkNFIGgpCiAgICAqLwogICBmb3IgKHNpemVfdCBu
ID0gMTsgbiA8IGRiLnBhY2thZ2VzLm51bWJlciAoKTsgbisrKQogICAgIHsK
LSAgICAgIHBhY2thZ2VtZXRhICZwa2cgPSAqIGRiLnBhY2thZ2VzW25dOwot
ICAgIGlmIChwa2cuZGVzaXJlZCAmJiAocGtnLmRlc2lyZWQtPnNyY3BpY2tl
ZCB8fCBwa2cuZGVzaXJlZC0+YmlucGlja2VkKSkKLSAgICAgIHsKLQlpbnQg
ZSA9IDA7Ci0JcGFja2FnZXZlcnNpb24gKnZlcnNpb24gPSBwa2cuZGVzaXJl
ZDsKLQlpZiAodmVyc2lvbi0+YmlucGlja2VkKQotCSAgZSArPSBkb3dubG9h
ZF9vbmUgKHZlcnNpb24tPmJpbik7Ci0JaWYgKHZlcnNpb24tPnNyY3BpY2tl
ZCkKLQkgIGUgKz0gZG93bmxvYWRfb25lICh2ZXJzaW9uLT5zcmMpOwotCWVy
cm9ycyArPSBlOworICAgICAgcGFja2FnZW1ldGEgJiBwa2cgPSAqZGIucGFj
a2FnZXNbbl07CisgICAgICBpZiAocGtnLmRlc2lyZWQgJiYgKHBrZy5kZXNp
cmVkLT5zcmNwaWNrZWQgfHwgcGtnLmRlc2lyZWQtPmJpbnBpY2tlZCkpCisJ
eworCSAgaW50IGUgPSAwOworCSAgcGFja2FnZXZlcnNpb24gKnZlcnNpb24g
PSBwa2cuZGVzaXJlZDsKKwkgIGlmICh2ZXJzaW9uLT5iaW5waWNrZWQpCisJ
ICAgIGUgKz0gZG93bmxvYWRfb25lICh2ZXJzaW9uLT5iaW4sIG93bmVyKTsK
KwkgIGlmICh2ZXJzaW9uLT5zcmNwaWNrZWQpCisJICAgIGUgKz0gZG93bmxv
YWRfb25lICh2ZXJzaW9uLT5zcmMsIG93bmVyKTsKKwkgIGVycm9ycyArPSBl
OwogI2lmIDAKLQlpZiAoZSkKLQkgIHBrZy0+YWN0aW9uID0gQUNUSU9OX0VS
Uk9SOworCSAgaWYgKGUpCisJICAgIHBrZy0+YWN0aW9uID0gQUNUSU9OX0VS
Uk9SOwogI2VuZGlmCi0gICAgICB9CisJfQogICAgIH0KIAogICBkaXNtaXNz
X3VybF9zdGF0dXNfZGlhbG9nICgpOwogCiAgIGlmIChlcnJvcnMpCiAgICAg
ewotICAgICAgaWYgKHllc25vIChJRFNfRE9XTkxPQURfSU5DT01QTEVURSkg
PT0gSURZRVMpCisgICAgICBpZiAoeWVzbm8gKG93bmVyLCBJRFNfRE9XTkxP
QURfSU5DT01QTEVURSkgPT0gSURZRVMpCiAJewogCSAgbmV4dF9kaWFsb2cg
PSBJRERfU0lURTsKIAkgIHJldHVybjsKQEAgLTIxNSw0ICsyMjAsMjkgQEAg
ZG9fZG93bmxvYWQgKEhJTlNUQU5DRSBoKQogICAgIH0KICAgZWxzZQogICAg
IG5leHRfZGlhbG9nID0gSUREX1NfSU5TVEFMTDsKK30KKworc3RhdGljIHZv
aWQKK2RvX2Rvd25sb2FkX3JlZmxlY3RvciAodm9pZCAqcCkKK3sKKyAgSEFO
RExFICpjb250ZXh0OworICBjb250ZXh0ID0gKEhBTkRMRSAqKSBwOworCisg
IGRvX2Rvd25sb2FkX3RocmVhZCAoKEhJTlNUQU5DRSkgY29udGV4dFswXSwg
KEhXTkQpIGNvbnRleHRbMV0pOworCisgIC8vIFRlbGwgdGhlIHByb2dyZXNz
IHBhZ2UgdGhhdCB3ZSdyZSBkb25lIGRvd25sb2FkaW5nCisgIFByb2dyZXNz
LlBvc3RNZXNzYWdlIChXTV9BUFBfRE9XTkxPQURfVEhSRUFEX0NPTVBMRVRF
LCAwLCBuZXh0X2RpYWxvZyk7CisKKyAgX2VuZHRocmVhZCAoKTsKK30KKwor
c3RhdGljIEhBTkRMRSBjb250ZXh0WzJdOworCit2b2lkCitkb19kb3dubG9h
ZCAoSElOU1RBTkNFIGgsIEhXTkQgb3duZXIpCit7CisgIGNvbnRleHRbMF0g
PSBoOworICBjb250ZXh0WzFdID0gb3duZXI7CisKKyAgX2JlZ2ludGhyZWFk
IChkb19kb3dubG9hZF9yZWZsZWN0b3IsIDAsIGNvbnRleHQpOwogfQpJbmRl
eDogZnJvbWN3ZC5jYwo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09ClJDUyBmaWxl
OiAvY3ZzL3NyYy9zcmMvd2luc3VwL2NpbnN0YWxsL2Zyb21jd2QuY2Msdgpy
ZXRyaWV2aW5nIHJldmlzaW9uIDIuMTYKZGlmZiAtdSAtcCAtcjIuMTYgZnJv
bWN3ZC5jYwotLS0gZnJvbWN3ZC5jYwkyMDAxLzEyLzIwIDExOjQ5OjUzCTIu
MTYKKysrIGZyb21jd2QuY2MJMjAwMS8xMi8yMCAxMjozNjowMApAQCAtMTE4
LDcgKzExOCw3IEBAIGNoZWNrX2luaSAoY2hhciAqcGF0aCwgdW5zaWduZWQg
aW50IGZzaXoKIH0KIAogdm9pZAotZG9fZnJvbWN3ZCAoSElOU1RBTkNFIGgp
Citkb19mcm9tY3dkIChISU5TVEFOQ0UgaCwgSFdORCBvd25lcikKIHsKICAg
Zm91bmRfaW5pID0gdHJ1ZTsKICAgZmluZCAoIi4iLCBjaGVja19pbmkpOwpJ
bmRleDogZ2V0dXJsLmNjCj09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KUkNTIGZp
bGU6IC9jdnMvc3JjL3NyYy93aW5zdXAvY2luc3RhbGwvZ2V0dXJsLmNjLHYK
cmV0cmlldmluZyByZXZpc2lvbiAyLjE1CmRpZmYgLXUgLXAgLXIyLjE1IGdl
dHVybC5jYwotLS0gZ2V0dXJsLmNjCTIwMDEvMTIvMDIgMDM6MjU6MTEJMi4x
NQorKysgZ2V0dXJsLmNjCTIwMDEvMTIvMjAgMTI6MzY6MDAKQEAgLTQzLDEx
OSArNDMsMzMgQEAgc3RhdGljIGNvbnN0IGNoYXIgKmN2c2lkID0KICNpbmNs
dWRlICJkaXNrZnVsbC5oIgogI2luY2x1ZGUgIm1vdW50LmgiCiAKLXN0YXRp
YyBIV05EIGd3X2RpYWxvZyA9IDA7Ci1zdGF0aWMgSFdORCBnd191cmwgPSAw
Owotc3RhdGljIEhXTkQgZ3dfcmF0ZSA9IDA7Ci1zdGF0aWMgSFdORCBnd19w
cm9ncmVzcyA9IDA7Ci1zdGF0aWMgSFdORCBnd19wcHJvZ3Jlc3MgPSAwOwot
c3RhdGljIEhXTkQgZ3dfaXByb2dyZXNzID0gMDsKLXN0YXRpYyBIV05EIGd3
X3Byb2dyZXNzX3RleHQgPSAwOwotc3RhdGljIEhXTkQgZ3dfcHByb2dyZXNz
X3RleHQgPSAwOwotc3RhdGljIEhXTkQgZ3dfaXByb2dyZXNzX3RleHQgPSAw
Owotc3RhdGljIEhBTkRMRSBpbml0X2V2ZW50OworI2luY2x1ZGUgInRocmVl
YmFyLmgiCitleHRlcm4gVGhyZWVCYXJQcm9ncmVzc1BhZ2UgUHJvZ3Jlc3M7
CisKIHN0YXRpYyBpbnQgbWF4X2J5dGVzID0gMDsKIHN0YXRpYyBpbnQgaXNf
bG9jYWxfaW5zdGFsbCA9IDA7CiAKIGludCB0b3RhbF9kb3dubG9hZF9ieXRl
cyA9IDA7CiBpbnQgdG90YWxfZG93bmxvYWRfYnl0ZXNfc29mYXIgPSAwOwog
Ci1zdGF0aWMgQk9PTAotZGlhbG9nX2NtZCAoSFdORCBoLCBpbnQgaWQsIEhX
TkQgaHduZGN0bCwgVUlOVCBjb2RlKQotewotICBzd2l0Y2ggKGlkKQotICAg
IHsKLSAgICBjYXNlIElEQ0FOQ0VMOgotICAgICAgZXhpdF9zZXR1cCAoMCk7
Ci0gICAgfQotICByZXR1cm4gMDsKLX0KLQotc3RhdGljIEJPT0wgQ0FMTEJB
Q0sKLWRpYWxvZ19wcm9jIChIV05EIGgsIFVJTlQgbWVzc2FnZSwgV1BBUkFN
IHdQYXJhbSwgTFBBUkFNIGxQYXJhbSkKLXsKLSAgc3dpdGNoIChtZXNzYWdl
KQotICAgIHsKLSAgICBjYXNlIFdNX0lOSVRESUFMT0c6Ci0gICAgICBnd19k
aWFsb2cgPSBoOwotICAgICAgZ3dfdXJsID0gR2V0RGxnSXRlbSAoaCwgSURD
X0RMU19VUkwpOwotICAgICAgZ3dfcmF0ZSA9IEdldERsZ0l0ZW0gKGgsIElE
Q19ETFNfUkFURSk7Ci0gICAgICBnd19wcm9ncmVzcyA9IEdldERsZ0l0ZW0g
KGgsIElEQ19ETFNfUFJPR1JFU1MpOwotICAgICAgZ3dfcHByb2dyZXNzID0g
R2V0RGxnSXRlbSAoaCwgSURDX0RMU19QUFJPR1JFU1MpOwotICAgICAgZ3df
aXByb2dyZXNzID0gR2V0RGxnSXRlbSAoaCwgSURDX0RMU19JUFJPR1JFU1Mp
OwotICAgICAgZ3dfcHJvZ3Jlc3NfdGV4dCA9IEdldERsZ0l0ZW0gKGgsIElE
Q19ETFNfUFJPR1JFU1NfVEVYVCk7Ci0gICAgICBnd19wcHJvZ3Jlc3NfdGV4
dCA9IEdldERsZ0l0ZW0gKGgsIElEQ19ETFNfUFBST0dSRVNTX1RFWFQpOwot
ICAgICAgZ3dfaXByb2dyZXNzX3RleHQgPSBHZXREbGdJdGVtIChoLCBJRENf
RExTX0lQUk9HUkVTU19URVhUKTsKLSAgICAgIFNldEV2ZW50IChpbml0X2V2
ZW50KTsKLSAgICAgIHJldHVybiBUUlVFOwotICAgIGNhc2UgV01fQ09NTUFO
RDoKLSAgICAgIHJldHVybiBIQU5ETEVfV01fQ09NTUFORCAoaCwgd1BhcmFt
LCBsUGFyYW0sIGRpYWxvZ19jbWQpOwotICAgIH0KLSAgcmV0dXJuIEZBTFNF
OwotfQotCi1zdGF0aWMgV0lOQVBJIERXT1JECi1kaWFsb2cgKHZvaWQgKikK
LXsKLSAgTVNHIG07Ci0gIEhXTkQgbG9jYWxfZ3dfZGlhbG9nID0KLSAgICBD
cmVhdGVEaWFsb2cgKGhpbnN0YW5jZSwgTUFLRUlOVFJFU09VUkNFIChJRERf
RExTVEFUVVMpLAotCQkgIDAsIGRpYWxvZ19wcm9jKTsKLSAgU2hvd1dpbmRv
dyAobG9jYWxfZ3dfZGlhbG9nLCBTV19TSE9XTk9STUFMKTsKLSAgVXBkYXRl
V2luZG93IChsb2NhbF9nd19kaWFsb2cpOwotICB3aGlsZSAoR2V0TWVzc2Fn
ZSAoJm0sIDAsIDAsIDApID4gMCkKLSAgICB7Ci0gICAgICBUcmFuc2xhdGVN
ZXNzYWdlICgmbSk7Ci0gICAgICBEaXNwYXRjaE1lc3NhZ2UgKCZtKTsKLSAg
ICB9Ci0gIHJldHVybiAwOwotfQotCiBzdGF0aWMgRFdPUkQgc3RhcnRfdGlj
czsKIAogc3RhdGljIHZvaWQKLWluaXRfZGlhbG9nIChjaGFyIGNvbnN0ICp1
cmwsIGludCBsZW5ndGgpCitpbml0X2RpYWxvZyAoY2hhciBjb25zdCAqdXJs
LCBpbnQgbGVuZ3RoLCBIV05EIG93bmVyKQogewogICBpZiAoaXNfbG9jYWxf
aW5zdGFsbCkKICAgICByZXR1cm47Ci0gIGlmIChnd19kaWFsb2cgPT0gMCkK
LSAgICB7Ci0gICAgICBEV09SRCB0aWQ7Ci0gICAgICBIQU5ETEUgdGhyZWFk
OwotICAgICAgaW5pdF9ldmVudCA9IENyZWF0ZUV2ZW50ICgwLCAwLCAwLCAw
KTsKLSAgICAgIHRocmVhZCA9IENyZWF0ZVRocmVhZCAoMCwgMCwgZGlhbG9n
LCAwLCAwLCAmdGlkKTsKLSAgICAgIFdhaXRGb3JTaW5nbGVPYmplY3QgKGlu
aXRfZXZlbnQsIDEwMDApOwotICAgICAgQ2xvc2VIYW5kbGUgKGluaXRfZXZl
bnQpOwotICAgICAgU2VuZE1lc3NhZ2UgKGd3X3Byb2dyZXNzLCBQQk1fU0VU
UkFOR0UsIDAsIE1BS0VMUEFSQU0gKDAsIDEwMCkpOwotICAgICAgU2VuZE1l
c3NhZ2UgKGd3X3Bwcm9ncmVzcywgUEJNX1NFVFJBTkdFLCAwLCBNQUtFTFBB
UkFNICgwLCAxMDApKTsKLSAgICAgIFNlbmRNZXNzYWdlIChnd19pcHJvZ3Jl
c3MsIFBCTV9TRVRSQU5HRSwgMCwgTUFLRUxQQVJBTSAoMCwgMTAwKSk7Ci0g
ICAgfQorCiAgIGNoYXIgY29uc3QgKnNsID0gdXJsOwogICBjaGFyIGNvbnN0
ICpjcDsKICAgZm9yIChjcCA9IHVybDsgKmNwOyBjcCsrKQogICAgIGlmICgq
Y3AgPT0gJy8nIHx8ICpjcCA9PSAnXFwnIHx8ICpjcCA9PSAnOicpCiAgICAg
ICBzbCA9IGNwICsgMTsKICAgbWF4X2J5dGVzID0gbGVuZ3RoOwotICBTZXRX
aW5kb3dUZXh0IChnd191cmwsIHNsKTsKLSAgU2V0V2luZG93VGV4dCAoZ3df
cmF0ZSwgIkNvbm5lY3RpbmcuLi4iKTsKLSAgU2VuZE1lc3NhZ2UgKGd3X3By
b2dyZXNzLCBQQk1fU0VUUE9TLCAoV1BBUkFNKSAwLCAwKTsKLSAgU2hvd1dp
bmRvdyAoZ3dfcHJvZ3Jlc3MsIChsZW5ndGggPiAwKSA/IFNXX1NIT1cgOiBT
V19ISURFKTsKLSAgaWYgKGxlbmd0aCA+IDApCi0gICAgU2V0V2luZG93VGV4
dCAoZ3dfcHJvZ3Jlc3NfdGV4dCwgIlBhY2thZ2UiKTsKLSAgZWxzZQotICAg
IFNldFdpbmRvd1RleHQgKGd3X3Byb2dyZXNzX3RleHQsICIgICAgICAgIik7
Ci0gIFNob3dXaW5kb3cgKGd3X3Bwcm9ncmVzcywgKHRvdGFsX2Rvd25sb2Fk
X2J5dGVzID4gMCkgPyBTV19TSE9XIDogU1dfSElERSk7Ci0gIGlmICh0b3Rh
bF9kb3dubG9hZF9ieXRlcyA+IDApCi0gICAgewotICAgICAgU2V0V2luZG93
VGV4dCAoZ3dfcHByb2dyZXNzX3RleHQsICJUb3RhbCIpOwotICAgICAgU2V0
V2luZG93VGV4dCAoZ3dfaXByb2dyZXNzX3RleHQsICJEaXNrIik7Ci0gICAg
fQotICBlbHNlCi0gICAgewotICAgICAgU2V0V2luZG93VGV4dCAoZ3dfcHBy
b2dyZXNzX3RleHQsICIgICAgICIpOwotICAgICAgU2V0V2luZG93VGV4dCAo
Z3dfaXByb2dyZXNzX3RleHQsICIgICAgIik7Ci0gICAgfQotICBTaG93V2lu
ZG93IChnd19pcHJvZ3Jlc3MsICh0b3RhbF9kb3dubG9hZF9ieXRlcyA+IDAp
ID8gU1dfU0hPVyA6IFNXX0hJREUpOwotICBTaG93V2luZG93IChnd19kaWFs
b2csIFNXX1NIT1dOT1JNQUwpOworICBQcm9ncmVzcy5TZXRUZXh0MSAoIkRv
d25sb2FkaW5nLi4uIik7CisgIFByb2dyZXNzLlNldFRleHQyIChzbCk7Cisg
IFByb2dyZXNzLlNldFRleHQzICgiQ29ubmVjdGluZy4uLiIpOworICBQcm9n
cmVzcy5TZXRCYXIxICgwKTsKICAgc3RhcnRfdGljcyA9IEdldFRpY2tDb3Vu
dCAoKTsKIH0KIApAQCAtMTY2LDcgKzgwLDcgQEAgcHJvZ3Jlc3MgKGludCBi
eXRlcykKICAgaWYgKGlzX2xvY2FsX2luc3RhbGwpCiAgICAgcmV0dXJuOwog
ICBzdGF0aWMgY2hhciBidWZbMTAwXTsKLSAgaW50IGticHM7CisgIGRvdWJs
ZSBrYnBzOwogICBzdGF0aWMgdW5zaWduZWQgaW50IGxhc3RfdGljcyA9IDA7
CiAgIERXT1JEIHRpY3MgPSBHZXRUaWNrQ291bnQgKCk7CiAgIGlmICh0aWNz
ID09IHN0YXJ0X3RpY3MpCS8vIHRvIHByZXZlbnQgZGl2aXNpb24gYnkgemVy
bwpAQCAtMTc1LDM2ICs4OSwzMSBAQCBwcm9ncmVzcyAoaW50IGJ5dGVzKQog
ICAgIHJldHVybjsKICAgbGFzdF90aWNzID0gdGljczsKIAotICBrYnBzID0g
Ynl0ZXMgLyAodGljcyAtIHN0YXJ0X3RpY3MpOwotICBTaG93V2luZG93IChn
d19wcm9ncmVzcywgKG1heF9ieXRlcyA+IDApID8gU1dfU0hPVyA6IFNXX0hJ
REUpOwotICBTaG93V2luZG93IChnd19wcHJvZ3Jlc3MsICh0b3RhbF9kb3du
bG9hZF9ieXRlcyA+IDApID8gU1dfU0hPVyA6IFNXX0hJREUpOwotICBTaG93
V2luZG93IChnd19pcHJvZ3Jlc3MsICh0b3RhbF9kb3dubG9hZF9ieXRlcyA+
IDApID8gU1dfU0hPVyA6IFNXX0hJREUpOwotICBpZiAobWF4X2J5dGVzID4g
MTAwKQotICAgIHsKLSAgICAgIGludCBwZXJjID0gYnl0ZXMgLyAobWF4X2J5
dGVzIC8gMTAwKTsKLSAgICAgIFNlbmRNZXNzYWdlIChnd19wcm9ncmVzcywg
UEJNX1NFVFBPUywgKFdQQVJBTSkgcGVyYywgMCk7Ci0gICAgICBzcHJpbnRm
IChidWYsICIlM2QgJSUgICglZGsvJWRrKSAgJWQga2Ivc1xuIiwKKyAga2Jw
cyA9ICgoZG91YmxlKSBieXRlcykgLyAoZG91YmxlKSAodGljcyAtIHN0YXJ0
X3RpY3MpOworICBpZiAobWF4X2J5dGVzID4gMCkKKyAgICB7CisgICAgICBp
bnQgcGVyYyA9IChpbnQpICgxMDAuMCAqICgoZG91YmxlKSBieXRlcykgLyAo
ZG91YmxlKSBtYXhfYnl0ZXMpOworICAgICAgUHJvZ3Jlc3MuU2V0QmFyMSAo
Ynl0ZXMsIG1heF9ieXRlcyk7CisgICAgICBzcHJpbnRmIChidWYsICIlM2Qg
JSUgICglZGsvJWRrKSAgJTIuMWYga2Ivc1xuIiwKIAkgICAgICAgcGVyYywg
Ynl0ZXMgLyAxMDAwLCBtYXhfYnl0ZXMgLyAxMDAwLCBrYnBzKTsKICAgICAg
IGlmICh0b3RhbF9kb3dubG9hZF9ieXRlcyA+IDApCiAJewotCSAgaW50IHRv
dGFscGVyYyA9Ci0JICAgICh0b3RhbF9kb3dubG9hZF9ieXRlc19zb2ZhciAr
Ci0JICAgICBieXRlcykgLyAodG90YWxfZG93bmxvYWRfYnl0ZXMgLyAxMDAp
OwotCSAgU2VuZE1lc3NhZ2UgKGd3X3Bwcm9ncmVzcywgUEJNX1NFVFBPUywg
KFdQQVJBTSkgdG90YWxwZXJjLCAwKTsKKwkgIFByb2dyZXNzLlNldEJhcjIg
KHRvdGFsX2Rvd25sb2FkX2J5dGVzX3NvZmFyICsgYnl0ZXMsCisJCQkgICAg
dG90YWxfZG93bmxvYWRfYnl0ZXMpOwogCX0KICAgICB9CiAgIGVsc2UKLSAg
ICBzcHJpbnRmIChidWYsICIlZCAgJWQga2Ivc1xuIiwgYnl0ZXMsIGticHMp
OworICAgIHNwcmludGYgKGJ1ZiwgIiVkICAlMi4xZiBrYi9zXG4iLCBieXRl
cywga2Jwcyk7CiAKLSAgU2V0V2luZG93VGV4dCAoZ3dfcmF0ZSwgYnVmKTsK
KyAgUHJvZ3Jlc3MuU2V0VGV4dDMgKGJ1Zik7CiB9CiAKIGlvX3N0cmVhbSAq
Ci1nZXRfdXJsX3RvX21lbWJ1ZiAoY2hhciBjb25zdCAqX3VybCkKK2dldF91
cmxfdG9fbWVtYnVmIChjaGFyIGNvbnN0ICpfdXJsLCBIV05EIG93bmVyKQog
ewogICBsb2cgKExPR19CQUJCTEUsICJnZXRfdXJsX3RvX21lbWJ1ZiAlcyIs
IF91cmwpOwogICBpc19sb2NhbF9pbnN0YWxsID0gKHNvdXJjZSA9PSBJRENf
U09VUkNFX0NXRCk7Ci0gIGluaXRfZGlhbG9nIChfdXJsLCAwKTsKKyAgaW5p
dF9kaWFsb2cgKF91cmwsIDAsIG93bmVyKTsKICAgTmV0SU8gKm4gPSBOZXRJ
Tzo6b3BlbiAoX3VybCk7CiAgIGlmICghbiB8fCAhbi0+b2sgKCkpCiAgICAg
ewpAQCAtMjU0LDkgKzE2Myw5IEBAIGdldF91cmxfdG9fbWVtYnVmIChjaGFy
IGNvbnN0ICpfdXJsKQogfQogCiBjaGFyICoKLWdldF91cmxfdG9fc3RyaW5n
IChjaGFyIGNvbnN0ICpfdXJsKQorZ2V0X3VybF90b19zdHJpbmcgKGNoYXIg
Y29uc3QgKl91cmwsIEhXTkQgb3duZXIpCiB7Ci0gIGlvX3N0cmVhbSAqc3Ry
ZWFtID0gZ2V0X3VybF90b19tZW1idWYgKF91cmwpOworICBpb19zdHJlYW0g
KnN0cmVhbSA9IGdldF91cmxfdG9fbWVtYnVmIChfdXJsLCBvd25lcik7CiAg
IGlmICghc3RyZWFtKQogICAgIHJldHVybiAwOwogICBzaXplX3QgYnl0ZXMg
PSBzdHJlYW0tPmdldF9zaXplICgpOwpAQCAtMjY0LDEwICsxNzMsMTEgQEAg
Z2V0X3VybF90b19zdHJpbmcgKGNoYXIgY29uc3QgKl91cmwpCiAgICAgewog
ICAgICAgLyogemVybyBsZW5ndGgsIG9yIGVycm9yIHJldHJpZXZpbmcgbGVu
Z3RoICovCiAgICAgICBkZWxldGUgc3RyZWFtOwotICAgICAgbG9nIChMT0df
QkFCQkxFLCAiZ2V0X3VybF90b19zdHJpbmcoKTogY291bGRuJ3QgcmV0cmll
dmUgYnVmZmVyIHNpemUsIG9yIHplcm8gbGVuZ3RoIGJ1ZmZlciIpOworICAg
ICAgbG9nIChMT0dfQkFCQkxFLAorCSAgICJnZXRfdXJsX3RvX3N0cmluZygp
OiBjb3VsZG4ndCByZXRyaWV2ZSBidWZmZXIgc2l6ZSwgb3IgemVybyBsZW5n
dGggYnVmZmVyIik7CiAgICAgICByZXR1cm4gMDsKICAgICB9Ci0gIGNoYXIg
KnJ2ID0gbmV3IGNoYXIgW2J5dGVzICsgMV07CisgIGNoYXIgKnJ2ID0gbmV3
IGNoYXJbYnl0ZXMgKyAxXTsKICAgaWYgKCFydikKICAgICB7CiAgICAgICBk
ZWxldGUgc3RyZWFtOwpAQCAtMjc2LDIyICsxODYsMjIgQEAgZ2V0X3VybF90
b19zdHJpbmcgKGNoYXIgY29uc3QgKl91cmwpCiAgICAgfQogICAvKiBtZW1i
dWZzIGFyZSBxdWl0ZSBzYWZlICovCiAgIHN0cmVhbS0+cmVhZCAocnYsIGJ5
dGVzKTsKLSAgcnYgW2J5dGVzXSA9ICdcMCc7CisgIHJ2W2J5dGVzXSA9ICdc
MCc7CiAgIGRlbGV0ZSBzdHJlYW07CiAgIHJldHVybiBydjsKIH0KIAogaW50
CiBnZXRfdXJsX3RvX2ZpbGUgKGNoYXIgKl91cmwsIGNoYXIgKl9maWxlbmFt
ZSwgaW50IGV4cGVjdGVkX2xlbmd0aCwKLQkJIEJPT0wgYWxsb3dfZnRwX2F1
dGgpCisJCSBIV05EIG93bmVyLCBCT09MIGFsbG93X2Z0cF9hdXRoKQogewog
ICBsb2cgKExPR19CQUJCTEUsICJnZXRfdXJsX3RvX2ZpbGUgJXMgJXMiLCBf
dXJsLCBfZmlsZW5hbWUpOwogICBpZiAodG90YWxfZG93bmxvYWRfYnl0ZXMg
PiAwKQogICAgIHsKICAgICAgIGludCBkZiA9IGRpc2tmdWxsIChnZXRfcm9v
dF9kaXIgKCkpOwotICAgICAgU2VuZE1lc3NhZ2UgKGd3X2lwcm9ncmVzcywg
UEJNX1NFVFBPUywgKFdQQVJBTSkgZGYsIDApOworICAgICAgUHJvZ3Jlc3Mu
U2V0QmFyMyAoZGYpOwogICAgIH0KLSAgaW5pdF9kaWFsb2cgKF91cmwsIGV4
cGVjdGVkX2xlbmd0aCk7CisgIGluaXRfZGlhbG9nIChfdXJsLCBleHBlY3Rl
ZF9sZW5ndGgsIG93bmVyKTsKIAogICByZW1vdmUgKF9maWxlbmFtZSk7CQkv
KiBidXQgaWdub3JlIGVycm9ycyAqLwogCkBAIC0zMDksNyArMjE5LDcgQEAg
Z2V0X3VybF90b19maWxlIChjaGFyICpfdXJsLCBjaGFyICpfZmlsZQogICAg
ICAgY29uc3QgY2hhciAqZXJyID0gc3RyZXJyb3IgKGVycm5vKTsKICAgICAg
IGlmICghZXJyKQogCWVyciA9ICIodW5rbm93biBlcnJvcikiOwotICAgICAg
ZmF0YWwgKElEU19FUlJfT1BFTl9XUklURSwgX2ZpbGVuYW1lLCBlcnIpOwor
ICAgICAgZmF0YWwgKG93bmVyLCBJRFNfRVJSX09QRU5fV1JJVEUsIF9maWxl
bmFtZSwgZXJyKTsKICAgICB9CiAKICAgaWYgKG4tPmZpbGVfc2l6ZSkKQEAg
LTMzOCwxNSArMjQ4LDE2IEBAIGdldF91cmxfdG9fZmlsZSAoY2hhciAqX3Vy
bCwgY2hhciAqX2ZpbGUKICAgaWYgKHRvdGFsX2Rvd25sb2FkX2J5dGVzID4g
MCkKICAgICB7CiAgICAgICBpbnQgZGYgPSBkaXNrZnVsbCAoZ2V0X3Jvb3Rf
ZGlyICgpKTsKLSAgICAgIFNlbmRNZXNzYWdlIChnd19pcHJvZ3Jlc3MsIFBC
TV9TRVRQT1MsIChXUEFSQU0pIGRmLCAwKTsKKyAgICAgIFByb2dyZXNzLlNl
dEJhcjMgKGRmKTsKICAgICB9CiAKICAgcmV0dXJuIDA7CiB9CiAKKy8vIEZJ
WE1FOiBJIHRoaW5rIHRoaXMgY2FuIGdvIG5vdywgSSBkb24ndCB0aGluayBh
bnl0aGluZyBjYWxscyBpdC4KIHZvaWQKIGRpc21pc3NfdXJsX3N0YXR1c19k
aWFsb2cgKCkKIHsKLSAgaWYgKCFpc19sb2NhbF9pbnN0YWxsKQotICAgIFNo
b3dXaW5kb3cgKGd3X2RpYWxvZywgU1dfSElERSk7CisgIC8vaWYgKCFpc19s
b2NhbF9pbnN0YWxsKQorICAvL1Nob3dXaW5kb3cgKGd3X2RpYWxvZywgU1df
SElERSk7CiB9CkluZGV4OiBnZXR1cmwuaAo9PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09ClJDUyBmaWxlOiAvY3ZzL3NyYy9zcmMvd2luc3VwL2NpbnN0YWxsL2dl
dHVybC5oLHYKcmV0cmlldmluZyByZXZpc2lvbiAyLjQKZGlmZiAtdSAtcCAt
cjIuNCBnZXR1cmwuaAotLS0gZ2V0dXJsLmgJMjAwMS8xMi8wMiAwMzoyNTox
MQkyLjQKKysrIGdldHVybC5oCTIwMDEvMTIvMjAgMTI6MzY6MDAKQEAgLTIx
LDggKzIxLDggQEAgZXh0ZXJuIGludCB0b3RhbF9kb3dubG9hZF9ieXRlc19z
b2ZhcjsKIAogY2xhc3MgaW9fc3RyZWFtOwogCi1pb19zdHJlYW0gKmdldF91
cmxfdG9fbWVtYnVmIChjaGFyIGNvbnN0ICopOwotY2hhciAqZ2V0X3VybF90
b19zdHJpbmcgKGNoYXIgY29uc3QgKik7Citpb19zdHJlYW0gKmdldF91cmxf
dG9fbWVtYnVmIChjaGFyIGNvbnN0ICosIEhXTkQgb3duZXIpOworY2hhciAq
Z2V0X3VybF90b19zdHJpbmcgKGNoYXIgY29uc3QgKiwgSFdORCBvd25lcik7
CiBpbnQgZ2V0X3VybF90b19maWxlIChjaGFyICpfdXJsLCBjaGFyICpfZmls
ZW5hbWUsIGludCBleHBlY3RlZF9zaXplLAotCQkgICAgIEJPT0wgYWxsb3df
ZnRwX2F1dGggPSBGQUxTRSk7CisJCSAgICAgSFdORCBvd25lciwgQk9PTCBh
bGxvd19mdHBfYXV0aCA9IEZBTFNFKTsKIHZvaWQgZGlzbWlzc191cmxfc3Rh
dHVzX2RpYWxvZyAoKTsKSW5kZXg6IGluaS5jYwo9PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09ClJDUyBmaWxlOiAvY3ZzL3NyYy9zcmMvd2luc3VwL2NpbnN0YWxs
L2luaS5jYyx2CnJldHJpZXZpbmcgcmV2aXNpb24gMi4xNQpkaWZmIC11IC1w
IC1yMi4xNSBpbmkuY2MKLS0tIGluaS5jYwkyMDAxLzEyLzAzIDIyOjIyOjA5
CTIuMTUKKysrIGluaS5jYwkyMDAxLzEyLzIwIDEyOjM2OjAwCkBAIC0yOCw2
ICsyOCw3IEBAIHN0YXRpYyBjb25zdCBjaGFyICpjdnNpZCA9CiAjaW5jbHVk
ZSA8c3RkaW8uaD4KICNpbmNsdWRlIDxzdGRsaWIuaD4KICNpbmNsdWRlIDxz
dGRhcmcuaD4KKyNpbmNsdWRlIDxwcm9jZXNzLmg+CiAKICNpbmNsdWRlICJp
bmkuaCIKICNpbmNsdWRlICJyZXNvdXJjZS5oIgpAQCAtNDUsNiArNDYsOSBA
QCBzdGF0aWMgY29uc3QgY2hhciAqY3ZzaWQgPQogCiAjaW5jbHVkZSAiaW9f
c3RyZWFtLmgiCiAKKyNpbmNsdWRlICJ0aHJlZWJhci5oIgorZXh0ZXJuIFRo
cmVlQmFyUHJvZ3Jlc3NQYWdlIFByb2dyZXNzOworCiB1bnNpZ25lZCBpbnQg
c2V0dXBfdGltZXN0YW1wID0gMDsKIGNoYXIgKnNldHVwX3ZlcnNpb24gPSAw
OwogCkBAIC01OSw1MCArNjMsNTQgQEAgc3RhdGljIGludCBsb2NhbF9pbmk7
CiBzdGF0aWMgdm9pZAogZmluZF9yb3V0aW5lIChjaGFyICpwYXRoLCB1bnNp
Z25lZCBpbnQgZnNpemUpCiB7Ci0gIGlmICghc3Ryc3RyIChwYXRoLCAiL3Nl
dHVwLmluaSIpICkKKyAgaWYgKCFzdHJzdHIgKHBhdGgsICIvc2V0dXAuaW5p
IikpCiAgICAgcmV0dXJuOwotICBpb19zdHJlYW0gKmluaV9maWxlID0gaW9f
c3RyZWFtOjpvcGVuIChjb25jYXQgKCJmaWxlOi8vIiwgbG9jYWxfZGlyLCIv
IiwgcGF0aCwgMCksICJyYiIpOworICBpb19zdHJlYW0gKmluaV9maWxlID0K
KyAgICBpb19zdHJlYW06Om9wZW4gKGNvbmNhdCAoImZpbGU6Ly8iLCBsb2Nh
bF9kaXIsICIvIiwgcGF0aCwgMCksICJyYiIpOwogICBpZiAoIWluaV9maWxl
KQogICAgIHsKLSAgICBub3RlIChJRFNfU0VUVVBJTklfTUlTU0lORywgcGF0
aCk7Ci0gICAgcmV0dXJuOworICAgICAgbm90ZSAoTlVMTCwgSURTX1NFVFVQ
SU5JX01JU1NJTkcsIHBhdGgpOworICAgICAgcmV0dXJuOwogICAgIH0KIAog
ICAvKiBGSVhNRTogb25seSB1c2UgbW9zdCByZWNlbnQgY29weSAqLwogICBz
ZXR1cF90aW1lc3RhbXAgPSAwOwogICBzZXR1cF92ZXJzaW9uID0gMDsKIAot
ICBpbmlfaW5pdCAoaW5pX2ZpbGUsIGNvbmNhdCAoImZpbGU6Ly8iLCBsb2Nh
bF9kaXIsIi8iLCBwYXRoLCAwKSk7CisgIGluaV9pbml0IChpbmlfZmlsZSwg
Y29uY2F0ICgiZmlsZTovLyIsIGxvY2FsX2RpciwgIi8iLCBwYXRoLCAwKSk7
CiAKICAgLyp5eWRlYnVnID0gMTsgKi8KIAogICBpZiAoeXlwYXJzZSAoKSB8
fCBlcnJvcl9jb3VudCA+IDApCi0gICAgTWVzc2FnZUJveCAoMCwgZXJyb3Jf
YnVmLCBlcnJvcl9jb3VudCA9PSAxID8gIlBhcnNlIEVycm9yIiA6ICJQYXJz
ZSBFcnJvcnMiLCAwKTsKKyAgICBNZXNzYWdlQm94ICgwLCBlcnJvcl9idWYs
CisJCWVycm9yX2NvdW50ID09IDEgPyAiUGFyc2UgRXJyb3IiIDogIlBhcnNl
IEVycm9ycyIsIDApOwogICBlbHNlCiAgICAgbG9jYWxfaW5pKys7CiB9CiAK
IHN0YXRpYyBpbnQKLWRvX2xvY2FsX2luaSAoKQorZG9fbG9jYWxfaW5pIChI
V05EIG93bmVyKQogewogICBsb2NhbF9pbmkgPSAwOwogICBmaW5kIChsb2Nh
bF9kaXIsIGZpbmRfcm91dGluZSk7Ci0gIHJldHVybiBsb2NhbF9pbmk7IAor
ICByZXR1cm4gbG9jYWxfaW5pOwogfQogCiBzdGF0aWMgaW50Ci1kb19yZW1v
dGVfaW5pICgpCitkb19yZW1vdGVfaW5pIChIV05EIG93bmVyKQogewogICBz
aXplX3QgaW5pX2NvdW50ID0gMDsKKwogICBmb3IgKHNpemVfdCBuID0gMTsg
biA8PSBzaXRlX2xpc3QubnVtYmVyICgpOyBuKyspCiAgICAgewogICAgICAg
aW9fc3RyZWFtICppbmlfZmlsZSA9Ci0JZ2V0X3VybF90b19tZW1idWYgKGNv
bmNhdCAoc2l0ZV9saXN0W25dLT51cmwsICIvc2V0dXAuaW5pIiwgMCkpOwor
CWdldF91cmxfdG9fbWVtYnVmIChjb25jYXQgKHNpdGVfbGlzdFtuXS0+dXJs
LCAiL3NldHVwLmluaSIsIDApLAorCQkJICAgb3duZXIpOwogICAgICAgZGlz
bWlzc191cmxfc3RhdHVzX2RpYWxvZyAoKTsKIAogICAgICAgaWYgKCFpbmlf
ZmlsZSkKIAl7Ci0JICBub3RlIChJRFNfU0VUVVBJTklfTUlTU0lORywgc2l0
ZV9saXN0W25dLT51cmwpOworCSAgbm90ZSAob3duZXIsIElEU19TRVRVUElO
SV9NSVNTSU5HLCBzaXRlX2xpc3Rbbl0tPnVybCk7CiAJICBjb250aW51ZTsK
IAl9CiAKQEAgLTEzOSwxNCArMTQ3LDE0IEBAIGRvX3JlbW90ZV9pbmkgKCkK
ICAgcmV0dXJuIGluaV9jb3VudDsKIH0KIAotdm9pZAotZG9faW5pIChISU5T
VEFOQ0UgaCkKK3N0YXRpYyB2b2lkCitkb19pbmlfdGhyZWFkIChISU5TVEFO
Q0UgaCwgSFdORCBvd25lcikKIHsKICAgc2l6ZV90IGluaV9jb3VudCA9IDA7
CiAgIGlmIChzb3VyY2UgPT0gSURDX1NPVVJDRV9DV0QpCi0gICAgaW5pX2Nv
dW50ID0gZG9fbG9jYWxfaW5pICgpOworICAgIGluaV9jb3VudCA9IGRvX2xv
Y2FsX2luaSAob3duZXIpOwogICBlbHNlCi0gICAgaW5pX2NvdW50ID0gZG9f
cmVtb3RlX2luaSAoKTsKKyAgICBpbmlfY291bnQgPSBkb19yZW1vdGVfaW5p
IChvd25lcik7CiAKICAgaWYgKGluaV9jb3VudCA9PSAwKQogICAgIHsKQEAg
LTE3MSw3ICsxNzksNyBAQCBkb19pbmkgKEhJTlNUQU5DRSBoKQogCSAgaWYg
KG9sZF90aW1lc3RhbXAgJiYgc2V0dXBfdGltZXN0YW1wCiAJICAgICAgJiYg
KG9sZF90aW1lc3RhbXAgPiBzZXR1cF90aW1lc3RhbXApKQogCSAgICB7Ci0J
ICAgICAgaW50IHluID0geWVzbm8gKElEU19PTERfU0VUVVBJTkkpOworCSAg
ICAgIGludCB5biA9IHllc25vIChvd25lciwgSURTX09MRF9TRVRVUElOSSk7
CiAJICAgICAgaWYgKHluID09IElETk8pCiAJCWV4aXRfc2V0dXAgKDEpOwog
CSAgICB9CkBAIC0xOTcsMTEgKzIwNSwzNyBAQCBkb19pbmkgKEhJTlNUQU5D
RSBoKQogICAgICAgY2hhciAqaW5pX3ZlcnNpb24gPSBjYW5vbmljYWxpemVf
dmVyc2lvbiAoc2V0dXBfdmVyc2lvbik7CiAgICAgICBjaGFyICpvdXJfdmVy
c2lvbiA9IGNhbm9uaWNhbGl6ZV92ZXJzaW9uICh2ZXJzaW9uKTsKICAgICAg
IGlmIChzdHJjbXAgKG91cl92ZXJzaW9uLCBpbmlfdmVyc2lvbikgPCAwKQot
CW5vdGUgKElEU19PTERfU0VUVVBfVkVSU0lPTiwgdmVyc2lvbiwgc2V0dXBf
dmVyc2lvbik7CisJbm90ZSAob3duZXIsIElEU19PTERfU0VUVVBfVkVSU0lP
TiwgdmVyc2lvbiwgc2V0dXBfdmVyc2lvbik7CiAgICAgfQorCisgIG5leHRf
ZGlhbG9nID0gSUREX0NIT09TRVI7Cit9CisKK3N0YXRpYyB2b2lkCitkb19p
bmlfdGhyZWFkX3JlZmxlY3RvciAodm9pZCAqcCkKK3sKKyAgSEFORExFICpj
b250ZXh0OworICBjb250ZXh0ID0gKEhBTkRMRSAqKSBwOworCisgIGRvX2lu
aV90aHJlYWQgKChISU5TVEFOQ0UpIGNvbnRleHRbMF0sIChIV05EKSBjb250
ZXh0WzFdKTsKKworICAvLyBUZWxsIHRoZSBwcm9ncmVzcyBwYWdlIHRoYXQg
d2UncmUgZG9uZSBkb3dubG9hZGluZworICBQcm9ncmVzcy5Qb3N0TWVzc2Fn
ZSAoV01fQVBQX1NFVFVQX0lOSV9ET1dOTE9BRF9DT01QTEVURSwgMCwgbmV4
dF9kaWFsb2cpOworCisgIF9lbmR0aHJlYWQgKCk7Cit9CiAKLSAgbmV4dF9k
aWFsb2cgPSBJRERfQ0hPT1NFOworc3RhdGljIEhBTkRMRSBjb250ZXh0WzJd
OworCit2b2lkCitkb19pbmkgKEhJTlNUQU5DRSBoLCBIV05EIG93bmVyKQor
eworICBjb250ZXh0WzBdID0gaDsKKyAgY29udGV4dFsxXSA9IG93bmVyOwor
CisgIF9iZWdpbnRocmVhZCAoZG9faW5pX3RocmVhZF9yZWZsZWN0b3IsIDAs
IGNvbnRleHQpOwogfQorCiAKIGV4dGVybiBpbnQgeXlsaW5lbm87CiAKSW5k
ZXg6IGluc3RhbGwuY2MKPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQpSQ1MgZmls
ZTogL2N2cy9zcmMvc3JjL3dpbnN1cC9jaW5zdGFsbC9pbnN0YWxsLmNjLHYK
cmV0cmlldmluZyByZXZpc2lvbiAyLjMxCmRpZmYgLXUgLXAgLXIyLjMxIGlu
c3RhbGwuY2MKLS0tIGluc3RhbGwuY2MJMjAwMS8xMi8yMCAxMTo0OTo1Mwky
LjMxCisrKyBpbnN0YWxsLmNjCTIwMDEvMTIvMjAgMTI6MzY6MDAKQEAgLTMz
LDYgKzMzLDggQEAgc3RhdGljIGNvbnN0IGNoYXIgKmN2c2lkID0KICNpbmNs
dWRlIDxzeXMvdHlwZXMuaD4KICNpbmNsdWRlIDxzeXMvc3RhdC5oPgogI2lu
Y2x1ZGUgPGVycm5vLmg+CisjaW5jbHVkZSA8cHJvY2Vzcy5oPgorCiAjaW5j
bHVkZSAiemxpYi96bGliLmgiCiAKICNpbmNsdWRlICJyZXNvdXJjZS5oIgpA
QCAtNjEsMTA5ICs2MywzMSBAQCBzdGF0aWMgY29uc3QgY2hhciAqY3ZzaWQg
PQogCiAjaW5jbHVkZSAicG9ydC5oIgogCi1zdGF0aWMgSFdORCBpbnNfZGlh
bG9nID0gMDsKLXN0YXRpYyBIV05EIGluc19hY3Rpb24gPSAwOwotc3RhdGlj
IEhXTkQgaW5zX3BrZ25hbWUgPSAwOwotc3RhdGljIEhXTkQgaW5zX2ZpbGVu
YW1lID0gMDsKLXN0YXRpYyBIV05EIGluc19wcHJvZ3Jlc3MgPSAwOwotc3Rh
dGljIEhXTkQgaW5zX2lwcm9ncmVzcyA9IDA7Ci1zdGF0aWMgSFdORCBpbnNf
ZGlza2Z1bGwgPSAwOwotc3RhdGljIEhBTkRMRSBpbml0X2V2ZW50OworI2lu
Y2x1ZGUgInRocmVlYmFyLmgiCitleHRlcm4gVGhyZWVCYXJQcm9ncmVzc1Bh
Z2UgUHJvZ3Jlc3M7CiAKIHN0YXRpYyBpbnQgdG90YWxfYnl0ZXMgPSAwOwog
c3RhdGljIGludCB0b3RhbF9ieXRlc19zb2ZhciA9IDA7CiBzdGF0aWMgaW50
IHBhY2thZ2VfYnl0ZXMgPSAwOwogCi1zdGF0aWMgYm9vbAotZGlhbG9nX2Nt
ZCAoSFdORCBoLCBpbnQgaWQsIEhXTkQgaHduZGN0bCwgVUlOVCBjb2RlKQot
ewotICBzd2l0Y2ggKGlkKQotICAgIHsKLSAgICBjYXNlIElEQ0FOQ0VMOgot
ICAgICAgZXhpdF9zZXR1cCAoMSk7Ci0gICAgfQotICByZXR1cm4gMDsKLX0K
LQotc3RhdGljIEJPT0wgQ0FMTEJBQ0sKLWRpYWxvZ19wcm9jIChIV05EIGgs
IFVJTlQgbWVzc2FnZSwgV1BBUkFNIHdQYXJhbSwgTFBBUkFNIGxQYXJhbSkK
LXsKLSAgc3dpdGNoIChtZXNzYWdlKQotICAgIHsKLSAgICBjYXNlIFdNX0lO
SVRESUFMT0c6Ci0gICAgICBpbnNfZGlhbG9nID0gaDsKLSAgICAgIGluc19h
Y3Rpb24gPSBHZXREbGdJdGVtIChoLCBJRENfSU5TX0FDVElPTik7Ci0gICAg
ICBpbnNfcGtnbmFtZSA9IEdldERsZ0l0ZW0gKGgsIElEQ19JTlNfUEtHKTsK
LSAgICAgIGluc19maWxlbmFtZSA9IEdldERsZ0l0ZW0gKGgsIElEQ19JTlNf
RklMRSk7Ci0gICAgICBpbnNfcHByb2dyZXNzID0gR2V0RGxnSXRlbSAoaCwg
SURDX0lOU19QUFJPR1JFU1MpOwotICAgICAgaW5zX2lwcm9ncmVzcyA9IEdl
dERsZ0l0ZW0gKGgsIElEQ19JTlNfSVBST0dSRVNTKTsKLSAgICAgIGluc19k
aXNrZnVsbCA9IEdldERsZ0l0ZW0gKGgsIElEQ19JTlNfRElTS0ZVTEwpOwot
ICAgICAgU2V0RXZlbnQgKGluaXRfZXZlbnQpOwotICAgICAgcmV0dXJuIFRS
VUU7Ci0gICAgY2FzZSBXTV9DT01NQU5EOgotICAgICAgcmV0dXJuIEhBTkRM
RV9XTV9DT01NQU5EIChoLCB3UGFyYW0sIGxQYXJhbSwgZGlhbG9nX2NtZCk7
Ci0gICAgfQotICByZXR1cm4gRkFMU0U7Ci19Ci0KLXN0YXRpYyBXSU5BUEkg
RFdPUkQKLWRpYWxvZyAodm9pZCAqKQotewotICBpbnQgcnYgPSAwOwotICBN
U0cgbTsKLSAgSFdORCBpbnNfZGlhbG9nID0gQ3JlYXRlRGlhbG9nIChoaW5z
dGFuY2UsIE1BS0VJTlRSRVNPVVJDRSAoSUREX0lOU1RBVFVTKSwKLQkJCQkg
IDAsIGRpYWxvZ19wcm9jKTsKLSAgaWYgKGluc19kaWFsb2cgPT0gMCkKLSAg
ICBmYXRhbCAoImNyZWF0ZSBkaWFsb2ciKTsKLSAgU2hvd1dpbmRvdyAoaW5z
X2RpYWxvZywgU1dfU0hPV05PUk1BTCk7Ci0gIFVwZGF0ZVdpbmRvdyAoaW5z
X2RpYWxvZyk7Ci0gIHdoaWxlIChHZXRNZXNzYWdlICgmbSwgMCwgMCwgMCkg
PiAwKQotICAgIHsKLSAgICAgIFRyYW5zbGF0ZU1lc3NhZ2UgKCZtKTsKLSAg
ICAgIERpc3BhdGNoTWVzc2FnZSAoJm0pOwotICAgIH0KLSAgcmV0dXJuIHJ2
OwotfQotCiBzdGF0aWMgdm9pZAogaW5pdF9kaWFsb2cgKCkKIHsKLSAgaWYg
KGluc19kaWFsb2cgPT0gMCkKLSAgICB7Ci0gICAgICBEV09SRCB0aWQ7Ci0g
ICAgICBIQU5ETEUgdGhyZWFkOwotICAgICAgaW5pdF9ldmVudCA9IENyZWF0
ZUV2ZW50ICgwLCAwLCAwLCAwKTsKLSAgICAgIHRocmVhZCA9IENyZWF0ZVRo
cmVhZCAoMCwgMCwgZGlhbG9nLCAwLCAwLCAmdGlkKTsKLSAgICAgIFdhaXRG
b3JTaW5nbGVPYmplY3QgKGluaXRfZXZlbnQsIDEwMDAwKTsKLSAgICAgIENs
b3NlSGFuZGxlIChpbml0X2V2ZW50KTsKLSAgICAgIFNlbmRNZXNzYWdlIChp
bnNfcHByb2dyZXNzLCBQQk1fU0VUUkFOR0UsIDAsIE1BS0VMUEFSQU0gKDAs
IDEwMCkpOwotICAgICAgU2VuZE1lc3NhZ2UgKGluc19pcHJvZ3Jlc3MsIFBC
TV9TRVRSQU5HRSwgMCwgTUFLRUxQQVJBTSAoMCwgMTAwKSk7Ci0gICAgICBT
ZW5kTWVzc2FnZSAoaW5zX2Rpc2tmdWxsLCBQQk1fU0VUUkFOR0UsIDAsIE1B
S0VMUEFSQU0gKDAsIDEwMCkpOwotICAgIH0KLQotICBTZXRXaW5kb3dUZXh0
IChpbnNfcGtnbmFtZSwgIiIpOwotICBTZXRXaW5kb3dUZXh0IChpbnNfZmls
ZW5hbWUsICIiKTsKLSAgU2VuZE1lc3NhZ2UgKGluc19wcHJvZ3Jlc3MsIFBC
TV9TRVRQT1MsIChXUEFSQU0pIDAsIDApOwotICBTZW5kTWVzc2FnZSAoaW5z
X2lwcm9ncmVzcywgUEJNX1NFVFBPUywgKFdQQVJBTSkgMCwgMCk7Ci0gIFNl
bmRNZXNzYWdlIChpbnNfZGlza2Z1bGwsIFBCTV9TRVRQT1MsIChXUEFSQU0p
IDAsIDApOwotICBTaG93V2luZG93IChpbnNfZGlhbG9nLCBTV19TSE9XTk9S
TUFMKTsKKyAgUHJvZ3Jlc3MuU2V0VGV4dDIgKCIiKTsKKyAgUHJvZ3Jlc3Mu
U2V0VGV4dDMgKCIiKTsKIH0KIAogc3RhdGljIHZvaWQKIHByb2dyZXNzIChp
bnQgYnl0ZXMpCiB7Ci0gIGludCBwZXJjOwotCi0gIGlmIChwYWNrYWdlX2J5
dGVzID4gMTAwKQorICBpZiAocGFja2FnZV9ieXRlcyA+IDApCiAgICAgewot
ICAgICAgcGVyYyA9IGJ5dGVzIC8gKHBhY2thZ2VfYnl0ZXMgLyAxMDApOwot
ICAgICAgU2VuZE1lc3NhZ2UgKGluc19wcHJvZ3Jlc3MsIFBCTV9TRVRQT1Ms
IChXUEFSQU0pIHBlcmMsIDApOworICAgICAgUHJvZ3Jlc3MuU2V0QmFyMSAo
Ynl0ZXMsIHBhY2thZ2VfYnl0ZXMpOwogICAgIH0KIAotICBpZiAodG90YWxf
Ynl0ZXMgPiAxMDApCisgIGlmICh0b3RhbF9ieXRlcyA+IDApCiAgICAgewot
ICAgICAgcGVyYyA9ICh0b3RhbF9ieXRlc19zb2ZhciArIGJ5dGVzKSAvICh0
b3RhbF9ieXRlcyAvIDEwMCk7Ci0gICAgICBTZW5kTWVzc2FnZSAoaW5zX2lw
cm9ncmVzcywgUEJNX1NFVFBPUywgKFdQQVJBTSkgcGVyYywgMCk7CisgICAg
ICBQcm9ncmVzcy5TZXRCYXIyICh0b3RhbF9ieXRlc19zb2ZhciArIGJ5dGVz
LCB0b3RhbF9ieXRlcyk7CiAgICAgfQogfQogCkBAIC0xOTIsMTEgKzExNiwx
MSBAQCBzdGF0aWMgaW50IG51bV9pbnN0YWxscywgbnVtX3VuaW5zdGFsbHM7
CiBzdGF0aWMgdm9pZAogdW5pbnN0YWxsX29uZSAocGFja2FnZW1ldGEgJiBw
a2dtKQogewotICAgICAgU2V0V2luZG93VGV4dCAoaW5zX3BrZ25hbWUsIHBr
Z20ubmFtZSk7Ci0gICAgICBTZXRXaW5kb3dUZXh0IChpbnNfYWN0aW9uLCAi
VW5pbnN0YWxsaW5nLi4uIik7Ci0gICAgICBsb2cgKDAsICJVbmluc3RhbGxp
bmcgJXMiLCBwa2dtLm5hbWUpOwotICAgICAgcGtnbS51bmluc3RhbGwgKCk7
Ci0gICAgICBudW1fdW5pbnN0YWxscysrOworICBQcm9ncmVzcy5TZXRUZXh0
MSAoIlVuaW5zdGFsbGluZy4uLiIpOworICBQcm9ncmVzcy5TZXRUZXh0MiAo
cGtnbS5uYW1lKTsKKyAgbG9nICgwLCAiVW5pbnN0YWxsaW5nICVzIiwgcGtn
bS5uYW1lKTsKKyAgcGtnbS51bmluc3RhbGwgKCk7CisgIG51bV91bmluc3Rh
bGxzKys7CiB9CiAKIApAQCAtMjA3LDEwICsxMzEsMTAgQEAgaW5zdGFsbF9v
bmVfc291cmNlIChwYWNrYWdlbWV0YSAmIHBrZ20sIAogCQkgICAgY2hhciBj
b25zdCAqcHJlZml4LCBwYWNrYWdlX3R5cGVfdCB0eXBlKQogewogICBpbnQg
ZXJyb3JzID0gMDsKLSAgU2V0V2luZG93VGV4dCAoaW5zX3BrZ25hbWUsIHNv
dXJjZS5CYXNlICgpKTsKKyAgUHJvZ3Jlc3MuU2V0VGV4dDIgKHNvdXJjZS5C
YXNlICgpKTsKICAgaWYgKCFpb19zdHJlYW06OmV4aXN0cyAoc291cmNlLkNh
Y2hlZCAoKSkpCiAgICAgewotICAgICAgbm90ZSAoSURTX0VSUl9PUEVOX1JF
QUQsIHNvdXJjZS5DYWNoZWQgKCksICJObyBzdWNoIGZpbGUiKTsKKyAgICAg
IG5vdGUgKE5VTEwsIElEU19FUlJfT1BFTl9SRUFELCBzb3VyY2UuQ2FjaGVk
ICgpLCAiTm8gc3VjaCBmaWxlIik7CiAgICAgICByZXR1cm4gMTsKICAgICB9
CiAgIGlvX3N0cmVhbSAqbHN0ID0gMDsKQEAgLTIzMiw3ICsxNTYsNyBAQCBp
bnN0YWxsX29uZV9zb3VyY2UgKHBhY2thZ2VtZXRhICYgcGtnbSwgCiAKICAg
Y2hhciBtc2dbNjRdOwogICBzdHJjcHkgKG1zZywgIkluc3RhbGxpbmciKTsK
LSAgU2V0V2luZG93VGV4dCAoaW5zX2FjdGlvbiwgbXNnKTsKKyAgUHJvZ3Jl
c3MuU2V0VGV4dDEgKG1zZyk7CiAgIGxvZyAoMCwgIiVzJXMiLCBtc2csIHNv
dXJjZS5DYWNoZWQgKCkpOwogICBpb19zdHJlYW0gKnRtcCA9IGlvX3N0cmVh
bTo6b3BlbiAoc291cmNlLkNhY2hlZCAoKSwgInJiIik7CiAgIGFyY2hpdmUg
KnRoZWZpbGUgPSAwOwpAQCAtMjU0LDcgKzE3OCw3IEBAIGluc3RhbGxfb25l
X3NvdXJjZSAocGFja2FnZW1ldGEgJiBwa2dtLCAKIAkgICAgbHN0LT53cml0
ZSAoY29uY2F0IChmbiwgIlxuIiwgMCksIHN0cmxlbiAoZm4pICsgMSk7CiAK
IAkgIC8qIEZJWE1FOiBjb25jYXQgbGVha3MgbWVtb3J5ICovCi0JICBTZXRX
aW5kb3dUZXh0IChpbnNfZmlsZW5hbWUsIGNvbmNhdCAocHJlZml4LCBmbiwg
MCkpOworCSAgUHJvZ3Jlc3MuU2V0VGV4dDMgKGNvbmNhdCAocHJlZml4LCBm
biwgMCkpOwogCSAgbG9nIChMT0dfQkFCQkxFLCAiSW5zdGFsbGluZyBmaWxl
ICVzJXMiLCBwcmVmaXgsIGZuKTsKIAkgIGlmIChhcmNoaXZlOjpleHRyYWN0
X2ZpbGUgKHRoZWZpbGUsIHByZWZpeCkgIT0gMCkKIAkgICAgewpAQCAtMjc0
LDcgKzE5OCw3IEBAIGluc3RhbGxfb25lX3NvdXJjZSAocGFja2FnZW1ldGEg
JiBwa2dtLCAKICAgcHJvZ3Jlc3MgKDApOwogCiAgIGludCBkZiA9IGRpc2tm
dWxsIChnZXRfcm9vdF9kaXIgKCkpOwotICBTZW5kTWVzc2FnZSAoaW5zX2Rp
c2tmdWxsLCBQQk1fU0VUUE9TLCAoV1BBUkFNKSBkZiwgMCk7CisgIFByb2dy
ZXNzLlNldEJhcjMgKGRmKTsKIAogICBpZiAobHN0KQogICAgIGRlbGV0ZSBs
c3Q7CkBAIC0yODksMTcgKzIxMywxNyBAQCBpbnN0YWxsX29uZSAocGFja2Fn
ZW1ldGEgJiBwa2cpCiAgIGludCBlcnJvcnMgPSAwOwogCiAgIGlmIChwa2cu
ZGVzaXJlZC0+YmlucGlja2VkKQotICB7Ci0gICAgZXJyb3JzICs9Ci0gICAg
ICBpbnN0YWxsX29uZV9zb3VyY2UgKHBrZywgcGtnLmRlc2lyZWQtPmJpbiwg
ImN5Z2ZpbGU6Ly8vIiwKLQkJCSAgcGFja2FnZV9iaW5hcnkpOwotICAgIGlm
ICghZXJyb3JzKQotICAgICAgcGtnLmluc3RhbGxlZCA9IHBrZy5kZXNpcmVk
OwotICB9Ci0gIGlmIChwa2cuZGVzaXJlZC0+c3JjcGlja2VkKQorICAgIHsK
ICAgICAgIGVycm9ycyArPQotCSAgICBpbnN0YWxsX29uZV9zb3VyY2UgKHBr
ZywgcGtnLmRlc2lyZWQtPnNyYywgImN5Z2ZpbGU6Ly8vdXNyL3NyYyIsCi0J
CSAgICAgICAgICAgICAgICAgICAgICAgIHBhY2thZ2Vfc291cmNlKTsKKwlp
bnN0YWxsX29uZV9zb3VyY2UgKHBrZywgcGtnLmRlc2lyZWQtPmJpbiwgImN5
Z2ZpbGU6Ly8vIiwKKwkJCSAgICBwYWNrYWdlX2JpbmFyeSk7CisgICAgICBp
ZiAoIWVycm9ycykKKwlwa2cuaW5zdGFsbGVkID0gcGtnLmRlc2lyZWQ7Cisg
ICAgfQorICBpZiAocGtnLmRlc2lyZWQtPnNyY3BpY2tlZCkKKyAgICBlcnJv
cnMgKz0KKyAgICAgIGluc3RhbGxfb25lX3NvdXJjZSAocGtnLCBwa2cuZGVz
aXJlZC0+c3JjLCAiY3lnZmlsZTovLy91c3Ivc3JjIiwKKwkJCSAgcGFja2Fn
ZV9zb3VyY2UpOwogCiAgIC8qIEZJWE1FOiBtYWtlIGEgdXBncmFkZSBtZXRo
b2QgYW5kIHJlaW5zdGF0ZSB0aGlzICovCiAjaWYgMApAQCAtMzc1LDggKzI5
OSw4IEBAIGNoZWNrX2Zvcl9vbGRfY3lnd2luICgpCiAgIHJldHVybjsKIH0K
IAotdm9pZAotZG9faW5zdGFsbCAoSElOU1RBTkNFIGgpCitzdGF0aWMgdm9p
ZAorZG9faW5zdGFsbF90aHJlYWQgKEhJTlNUQU5DRSBoLCBIV05EIG93bmVy
KQogewogICBpbnQgaTsKICAgaW50IGVycm9ycyA9IDA7CkBAIC0zOTgsMTUg
KzMyMiwxMyBAQCBkb19pbnN0YWxsIChISU5TVEFOQ0UgaCkKICAgaW9fc3Ry
ZWFtICp1dG1wID0gaW9fc3RyZWFtOjpvcGVuICgiY3lnZmlsZTovLy92YXIv
cnVuL3V0bXAiLCAid2IiKTsKICAgZGVsZXRlIHV0bXA7CiAKLSAgZGlzbWlz
c191cmxfc3RhdHVzX2RpYWxvZyAoKTsKLQogICBpbml0X2RpYWxvZyAoKTsK
IAogICB0b3RhbF9ieXRlcyA9IDA7CiAgIHRvdGFsX2J5dGVzX3NvZmFyID0g
MDsKIAogICBpbnQgZGYgPSBkaXNrZnVsbCAoZ2V0X3Jvb3RfZGlyICgpKTsK
LSAgU2VuZE1lc3NhZ2UgKGluc19kaXNrZnVsbCwgUEJNX1NFVFBPUywgKFdQ
QVJBTSkgZGYsIDApOworICBQcm9ncmVzcy5TZXRCYXIzIChkZik7CiAKICAg
aW50IGlzdGV4dCA9IChyb290X3RleHQgPT0gSURDX1JPT1RfVEVYVCkgPyAx
IDogMDsKICAgaW50IGlzc3lzdGVtID0gKHJvb3Rfc2NvcGUgPT0gSURDX1JP
T1RfU1lTVEVNKSA/IDEgOiAwOwpAQCAtNDE5LDI3ICszNDEsMjYgQEAgZG9f
aW5zdGFsbCAoSElOU1RBTkNFIGgpCiAgIHBhY2thZ2VkYiBkYjsKICAgZm9y
IChzaXplX3QgbiA9IDE7IG4gPCBkYi5wYWNrYWdlcy5udW1iZXIgKCk7IG4r
KykKICAgICB7Ci0gICAgICBwYWNrYWdlbWV0YSAmcGtnID0gKiBkYi5wYWNr
YWdlc1tuXTsKKyAgICAgIHBhY2thZ2VtZXRhICYgcGtnID0gKmRiLnBhY2th
Z2VzW25dOwogCi0gICAgaWYgKHBrZy5kZXNpcmVkICYmIChwa2cuZGVzaXJl
ZC0+c3JjcGlja2VkIHx8IHBrZy5kZXNpcmVkLT5iaW5waWNrZWQpKQotICAg
ICAgewotCWlmIChwa2cuZGVzaXJlZC0+c3JjcGlja2VkKQotCSAgdG90YWxf
Ynl0ZXMgKz0gcGtnLmRlc2lyZWQtPnNyYy5zaXplOwotCWlmIChwa2cuZGVz
aXJlZC0+YmlucGlja2VkKQotCSAgdG90YWxfYnl0ZXMgKz0gcGtnLmRlc2ly
ZWQtPmJpbi5zaXplOwotICAgICAgfQorICAgICAgaWYgKHBrZy5kZXNpcmVk
ICYmIChwa2cuZGVzaXJlZC0+c3JjcGlja2VkIHx8IHBrZy5kZXNpcmVkLT5i
aW5waWNrZWQpKQorCXsKKwkgIGlmIChwa2cuZGVzaXJlZC0+c3JjcGlja2Vk
KQorCSAgICB0b3RhbF9ieXRlcyArPSBwa2cuZGVzaXJlZC0+c3JjLnNpemU7
CisJICBpZiAocGtnLmRlc2lyZWQtPmJpbnBpY2tlZCkKKwkgICAgdG90YWxf
Ynl0ZXMgKz0gcGtnLmRlc2lyZWQtPmJpbi5zaXplOworCX0KICAgICB9CiAK
ICAgZm9yIChzaXplX3QgbiA9IDE7IG4gPCBkYi5wYWNrYWdlcy5udW1iZXIg
KCk7IG4rKykKICAgICB7Ci0gICAgICBwYWNrYWdlbWV0YSAmcGtnID0gKiBk
Yi5wYWNrYWdlc1tuXTsKKyAgICAgIHBhY2thZ2VtZXRhICYgcGtnID0gKmRi
LnBhY2thZ2VzW25dOwogICAgICAgaWYgKHBrZy5pbnN0YWxsZWQgJiYgKCFw
a2cuZGVzaXJlZCB8fCBwa2cuZGVzaXJlZCAhPSBwa2cuaW5zdGFsbGVkKSkK
IAl7CiAJICB1bmluc3RhbGxfb25lIChwa2cpOwogCX0KIAotICAgICAgaWYg
KHBrZy5kZXNpcmVkCi0JICAmJiAocGtnLmRlc2lyZWQtPnNyY3BpY2tlZCB8
fCBwa2cuZGVzaXJlZC0+YmlucGlja2VkKSkKKyAgICAgIGlmIChwa2cuZGVz
aXJlZCAmJiAocGtnLmRlc2lyZWQtPnNyY3BpY2tlZCB8fCBwa2cuZGVzaXJl
ZC0+YmlucGlja2VkKSkKIAl7CiAJICBpbnQgZSA9IDA7CiAJICBlICs9IGlu
c3RhbGxfb25lIChwa2cpOwpAQCAtNDUwLDE1ICszNzEsMTMgQEAgZG9faW5z
dGFsbCAoSElOU1RBTkNFIGgpCiAJfQogICAgIH0JCQkJLy8gZW5kIG9mIGJp
ZyBwYWNrYWdlIGxvb3AKIAotICBTaG93V2luZG93IChpbnNfZGlhbG9nLCBT
V19ISURFKTsKLQogICBpbnQgdGVtcGVycjsKICAgaWYgKCh0ZW1wZXJyID0g
ZGIuZmx1c2ggKCkpKQogICAgIHsKICAgICAgIGNvbnN0IGNoYXIgKmVyciA9
IHN0cmVycm9yICh0ZW1wZXJyKTsKICAgICAgIGlmICghZXJyKQogCWVyciA9
ICIodW5rbm93biBlcnJvcikiOwotICAgICAgZmF0YWwgKElEU19FUlJfT1BF
Tl9XUklURSwgZXJyKTsKKyAgICAgIGZhdGFsIChvd25lciwgSURTX0VSUl9P
UEVOX1dSSVRFLCBlcnIpOwogICAgIH0KIAogICBpZiAoIWVycm9ycykKQEAg
LTQ3OCw0ICszOTcsMjkgQEAgZG9faW5zdGFsbCAoSElOU1RBTkNFIGgpCiAg
ICAgZXhpdF9tc2cgPSBJRFNfSU5TVEFMTF9JTkNPTVBMRVRFOwogICBlbHNl
CiAgICAgZXhpdF9tc2cgPSBJRFNfSU5TVEFMTF9DT01QTEVURTsKK30KKwor
c3RhdGljIHZvaWQKK2RvX2luc3RhbGxfcmVmbGVjdG9yICh2b2lkICpwKQor
eworICBIQU5ETEUgKmNvbnRleHQ7CisgIGNvbnRleHQgPSAoSEFORExFICop
IHA7CisKKyAgZG9faW5zdGFsbF90aHJlYWQgKChISU5TVEFOQ0UpIGNvbnRl
eHRbMF0sIChIV05EKSBjb250ZXh0WzFdKTsKKworICAvLyBUZWxsIHRoZSBw
cm9ncmVzcyBwYWdlIHRoYXQgd2UncmUgZG9uZSBkb3dubG9hZGluZworICBQ
cm9ncmVzcy5Qb3N0TWVzc2FnZSAoV01fQVBQX0lOU1RBTExfVEhSRUFEX0NP
TVBMRVRFLCBuZXh0X2RpYWxvZyk7CisKKyAgX2VuZHRocmVhZCAoKTsKK30K
Kworc3RhdGljIEhBTkRMRSBjb250ZXh0WzJdOworCit2b2lkCitkb19pbnN0
YWxsIChISU5TVEFOQ0UgaCwgSFdORCBvd25lcikKK3sKKyAgY29udGV4dFsw
XSA9IGg7CisgIGNvbnRleHRbMV0gPSBvd25lcjsKKworICBfYmVnaW50aHJl
YWQgKGRvX2luc3RhbGxfcmVmbGVjdG9yLCAwLCBjb250ZXh0KTsKIH0KSW5k
ZXg6IGxvY2FsZGlyLmNjCj09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KUkNTIGZp
bGU6IC9jdnMvc3JjL3NyYy93aW5zdXAvY2luc3RhbGwvbG9jYWxkaXIuY2Ms
dgpyZXRyaWV2aW5nIHJldmlzaW9uIDIuNQpkaWZmIC11IC1wIC1yMi41IGxv
Y2FsZGlyLmNjCi0tLSBsb2NhbGRpci5jYwkyMDAxLzExLzE0IDAwOjExOjM1
CTIuNQorKysgbG9jYWxkaXIuY2MJMjAwMS8xMi8yMCAxMjozNjowMApAQCAt
MzksNiArMzksOCBAQCBzdGF0aWMgY29uc3QgY2hhciAqY3ZzaWQgPQogI2lu
Y2x1ZGUgIm1rZGlyLmgiCiAjaW5jbHVkZSAiaW9fc3RyZWFtLmgiCiAKKyNp
bmNsdWRlICJsb2NhbGRpci5oIgorCiB2b2lkCiBzYXZlX2xvY2FsX2RpciAo
KQogewpAQCAtMTI4LDc0ICsxMzAsMjAgQEAgZGlhbG9nX2NtZCAoSFdORCBo
LCBpbnQgaWQsIEhXTkQgaHduZGN0bAogICAgIGNhc2UgSURDX0xPQ0FMX0RJ
Ul9CUk9XU0U6CiAgICAgICBicm93c2UgKGgpOwogICAgICAgYnJlYWs7Ci0K
LSAgICBjYXNlIElET0s6Ci0gICAgICBzYXZlX2RpYWxvZyAoaCk7Ci0gICAg
ICBzYXZlX2xvY2FsX2RpciAoKTsKLSAgICAgIGlmIChTZXRDdXJyZW50RGly
ZWN0b3J5QSAobG9jYWxfZGlyKSkKLQl7Ci0JICBzd2l0Y2ggKHNvdXJjZSkK
LQkgICAgewotCSAgICBjYXNlIElEQ19TT1VSQ0VfRE9XTkxPQUQ6Ci0JICAg
IGNhc2UgSURDX1NPVVJDRV9ORVRJTlNUOgotCSAgICAgIE5FWFQgKElERF9O
RVQpOwotCSAgICAgIGJyZWFrOwotCSAgICBjYXNlIElEQ19TT1VSQ0VfQ1dE
OgotCSAgICAgIE5FWFQgKElERF9TX0ZST01fQ1dEKTsKLQkgICAgICBicmVh
azsKLQkgICAgZGVmYXVsdDoKLQkgICAgICBtc2cgKCJzb3VyY2UgaXMgZGVm
YXVsdD8gJWRcbiIsIHNvdXJjZSk7Ci0JICAgICAgTkVYVCAoMCk7Ci0JICAg
ICAgYnJlYWs7Ci0JICAgIH0KLQl9Ci0gICAgICBlbHNlCi0Jbm90ZSAoSURT
X0VSUl9DSERJUiwgbG9jYWxfZGlyKTsKLQotICAgICAgYnJlYWs7Ci0KLSAg
ICBjYXNlIElEQ19CQUNLOgotICAgICAgc2F2ZV9kaWFsb2cgKGgpOwotICAg
ICAgc3dpdGNoIChzb3VyY2UpCi0JewotCWNhc2UgSURDX1NPVVJDRV9ET1dO
TE9BRDoKLQkgIE5FWFQgKElERF9TT1VSQ0UpOwotCSAgYnJlYWs7Ci0JY2Fz
ZSBJRENfU09VUkNFX05FVElOU1Q6Ci0JY2FzZSBJRENfU09VUkNFX0NXRDoK
LQkgIE5FWFQgKElERF9ST09UKTsKLQkgIGJyZWFrOwotCWRlZmF1bHQ6Ci0J
ICBtc2cgKCJzb3VyY2UgaXMgZGVmYXVsdD8gJWRcbiIsIHNvdXJjZSk7Ci0J
ICBORVhUICgwKTsKLQl9Ci0gICAgICBicmVhazsKLQotICAgIGNhc2UgSURD
QU5DRUw6Ci0gICAgICBORVhUICgwKTsKLSAgICAgIGJyZWFrOwogICAgIH0K
ICAgcmV0dXJuIDA7CiB9CisKKy8vZXh0ZXJuIGNoYXIgY3dkW19NQVhfUEFU
SF07CiAKLXN0YXRpYyBCT09MIENBTExCQUNLCi1kaWFsb2dfcHJvYyAoSFdO
RCBoLCBVSU5UIG1lc3NhZ2UsIFdQQVJBTSB3UGFyYW0sIExQQVJBTSBsUGFy
YW0pCitib29sCitMb2NhbERpclBhZ2U6OkNyZWF0ZSAoKQogewotICBzd2l0
Y2ggKG1lc3NhZ2UpCi0gICAgewotICAgIGNhc2UgV01fSU5JVERJQUxPRzoK
LSAgICAgIGxvYWRfZGlhbG9nIChoKTsKLSAgICAgIHJldHVybiBGQUxTRTsK
LSAgICBjYXNlIFdNX0NPTU1BTkQ6Ci0gICAgICByZXR1cm4gSEFORExFX1dN
X0NPTU1BTkQgKGgsIHdQYXJhbSwgbFBhcmFtLCBkaWFsb2dfY21kKTsKLSAg
ICB9Ci0gIHJldHVybiBGQUxTRTsKKyAgcmV0dXJuIFByb3BlcnR5UGFnZTo6
Q3JlYXRlIChOVUxMLCBkaWFsb2dfY21kLCBJRERfTE9DQUxfRElSKTsKIH0K
IAotZXh0ZXJuIGNoYXIgY3dkW19NQVhfUEFUSF07Ci0KIHZvaWQKLWRvX2xv
Y2FsX2RpciAoSElOU1RBTkNFIGgpCitMb2NhbERpclBhZ2U6Ok9uSW5pdCAo
KQogewogICBzdGF0aWMgaW50IGluaXRlZCA9IDA7CiAgIGlmICghaW5pdGVk
KQpAQCAtMjE3LDExICsxNjUsNDMgQEAgZG9fbG9jYWxfZGlyIChISU5TVEFO
Q0UgaCkKIAl9CiAgICAgICBpbml0ZWQgPSAxOwogICAgIH0KK30KKwordm9p
ZAorTG9jYWxEaXJQYWdlOjpPbkFjdGl2YXRlICgpCit7CisgIGxvYWRfZGlh
bG9nIChHZXRIV05EICgpKTsKK30KIAotICBpbnQgcnYgPSAwOwotICBydiA9
IERpYWxvZ0JveCAoaCwgTUFLRUlOVFJFU09VUkNFIChJRERfTE9DQUxfRElS
KSwgMCwgZGlhbG9nX3Byb2MpOwotICBpZiAocnYgPT0gLTEpCi0gICAgZmF0
YWwgKElEU19ESUFMT0dfRkFJTEVEKTsKK2xvbmcKK0xvY2FsRGlyUGFnZTo6
T25OZXh0ICgpCit7CisgIEhXTkQgaCA9IEdldEhXTkQgKCk7CiAKKyAgc2F2
ZV9kaWFsb2cgKGgpOworICBzYXZlX2xvY2FsX2RpciAoKTsKICAgbG9nICgw
LCAiU2VsZWN0ZWQgbG9jYWwgZGlyZWN0b3J5OiAlcyIsIGxvY2FsX2Rpcik7
CisgIGlmIChTZXRDdXJyZW50RGlyZWN0b3J5QSAobG9jYWxfZGlyKSkKKyAg
ICB7CisgICAgICBpZiAoc291cmNlID09IElEQ19TT1VSQ0VfQ1dEKQorCXsK
KwkgIHJldHVybiBJRERfU19GUk9NX0NXRDsKKwl9CisgICAgfQorICBlbHNl
CisgICAgbm90ZSAoaCwgSURTX0VSUl9DSERJUiwgbG9jYWxfZGlyKTsKKwor
ICByZXR1cm4gMDsKK30KKworbG9uZworTG9jYWxEaXJQYWdlOjpPbkJhY2sg
KCkKK3sKKyAgc2F2ZV9kaWFsb2cgKEdldEhXTkQgKCkpOworICBpZiAoc291
cmNlID09IElEQ19TT1VSQ0VfRE9XTkxPQUQpCisgICAgeworICAgICAgLy8g
RG93bmxvYWRpbmcgb25seSwgc2tpcCB0aGUgdW5peCByb290IHBhZ2UKKyAg
ICAgIHJldHVybiBJRERfU09VUkNFOworICAgIH0KKyAgcmV0dXJuIDA7CiB9
CkluZGV4OiBsb2NhbGRpci5oCj09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KUkNT
IGZpbGU6IGxvY2FsZGlyLmgKZGlmZiAtTiBsb2NhbGRpci5oCi0tLSAvZGV2
L251bGwJVHVlIE1heSAgNSAxMzozMjoyNyAxOTk4CisrKyBsb2NhbGRpci5o
CVRodSBEZWMgMjAgMDQ6MzY6MDAgMjAwMQpAQCAtMCwwICsxLDQ0IEBACisj
aWZuZGVmIENJTlNUQUxMX0xPQ0FMRElSX0gKKyNkZWZpbmUgQ0lOU1RBTExf
TE9DQUxESVJfSAorCisvKgorICogQ29weXJpZ2h0IChjKSAyMDAxLCBHYXJ5
IFIuIFZhbiBTaWNrbGUuCisgKgorICogICAgIFRoaXMgcHJvZ3JhbSBpcyBm
cmVlIHNvZnR3YXJlOyB5b3UgY2FuIHJlZGlzdHJpYnV0ZSBpdCBhbmQvb3Ig
bW9kaWZ5CisgKiAgICAgaXQgdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBHTlUg
R2VuZXJhbCBQdWJsaWMgTGljZW5zZSBhcyBwdWJsaXNoZWQgYnkKKyAqICAg
ICB0aGUgRnJlZSBTb2Z0d2FyZSBGb3VuZGF0aW9uOyBlaXRoZXIgdmVyc2lv
biAyIG9mIHRoZSBMaWNlbnNlLCBvcgorICogICAgIChhdCB5b3VyIG9wdGlv
bikgYW55IGxhdGVyIHZlcnNpb24uCisgKgorICogICAgIEEgY29weSBvZiB0
aGUgR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgY2FuIGJlIGZvdW5kIGF0
CisgKiAgICAgaHR0cDovL3d3dy5nbnUub3JnLworICoKKyAqIFdyaXR0ZW4g
YnkgR2FyeSBSLiBWYW4gU2lja2xlIDxnLnIudmFuc2lja2xlQHdvcmxkbmV0
LmF0dC5uZXQ+CisgKgorICovCisKKy8vIFRoaXMgaXMgdGhlIGhlYWRlciBm
b3IgdGhlIExvY2FsRGlyUGFnZSBjbGFzcy4gIEFsbG93cyB0aGUgdXNlciB0
byBzZWxlY3QKKy8vIHRoZSBsb2NhbCBwYWNrYWdlIGRpcmVjdG9yeSAoaS5l
LiB3aGVyZSBkb3dubG9hZGVkIHBhY2thZ2VzIGFyZSBzdG9yZWQpLgorCisK
KyNpbmNsdWRlICJwcm9wcGFnZS5oIgorCitjbGFzcyBMb2NhbERpclBhZ2U6
cHVibGljIFByb3BlcnR5UGFnZQoreworcHVibGljOgorICBMb2NhbERpclBh
Z2UgKCkKKyAgeworICB9OworICB2aXJ0dWFsIH4gTG9jYWxEaXJQYWdlICgp
CisgIHsKKyAgfTsKKworICBib29sIENyZWF0ZSAoKTsKKworICB2b2lkIE9u
QWN0aXZhdGUgKCk7CisgIHZvaWQgT25Jbml0ICgpOworICBsb25nIE9uTmV4
dCAoKTsKKyAgbG9uZyBPbkJhY2sgKCk7Cit9OworCisKKyNlbmRpZgpJbmRl
eDogbG9nLmNjCj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KUkNTIGZpbGU6IC9j
dnMvc3JjL3NyYy93aW5zdXAvY2luc3RhbGwvbG9nLmNjLHYKcmV0cmlldmlu
ZyByZXZpc2lvbiAyLjUKZGlmZiAtdSAtcCAtcjIuNSBsb2cuY2MKLS0tIGxv
Zy5jYwkyMDAxLzExLzEzIDAxOjQ5OjMyCTIuNQorKysgbG9nLmNjCTIwMDEv
MTIvMjAgMTI6MzY6MDAKQEAgLTg2LDcgKzg2LDcgQEAgbG9nX3NhdmUgKGlu
dCBiYWJibGUsIGNvbnN0IGNoYXIgKmZpbGVuYQogICBGSUxFICpmID0gZm9w
ZW4gKGZpbGVuYW1lLCBhcHBlbmQgPyAiYXQiIDogInd0Iik7CiAgIGlmICgh
ZikKICAgICB7Ci0gICAgICBmYXRhbCAoSURTX05PTE9HRklMRSwgZmlsZW5h
bWUpOworICAgICAgZmF0YWwgKE5VTEwsIElEU19OT0xPR0ZJTEUsIGZpbGVu
YW1lKTsKICAgICAgIHJldHVybjsKICAgICB9CiAKQEAgLTExNSw3ICsxMTUs
NyBAQCBleGl0X3NldHVwIChpbnQgZXhpdF9jb2RlKQogICBiZWVuX2hlcmUg
PSAxOwogCiAgIGlmIChleGl0X21zZykKLSAgICBub3RlIChleGl0X21zZyk7
CisgICAgbm90ZSAoTlVMTCwgZXhpdF9tc2cpOwogCiAgIGxvZyAoTE9HX1RJ
TUVTVEFNUCwgIkVuZGluZyBjeWd3aW4gaW5zdGFsbCIpOwogCkluZGV4OiBt
YWluLmNjCj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KUkNTIGZpbGU6IC9jdnMv
c3JjL3NyYy93aW5zdXAvY2luc3RhbGwvbWFpbi5jYyx2CnJldHJpZXZpbmcg
cmV2aXNpb24gMi45CmRpZmYgLXUgLXAgLXIyLjkgbWFpbi5jYwotLS0gbWFp
bi5jYwkyMDAxLzExLzEzIDAxOjQ5OjMyCTIuOQorKysgbWFpbi5jYwkyMDAx
LzEyLzIwIDEyOjM2OjAwCkBAIC0yOSw2ICsyOSw3IEBAIHN0YXRpYyBjb25z
dCBjaGFyICpjdnNpZCA9CiAjZW5kaWYKIAogI2luY2x1ZGUgIndpbjMyLmgi
CisjaW5jbHVkZSA8Y29tbWN0cmwuaD4KIAogI2luY2x1ZGUgPHN0ZGlvLmg+
CiAjaW5jbHVkZSA8c3RkbGliLmg+CkBAIC00Miw3ICs0MywyMCBAQCBzdGF0
aWMgY29uc3QgY2hhciAqY3ZzaWQgPQogI2luY2x1ZGUgInZlcnNpb24uaCIK
IAogI2luY2x1ZGUgInBvcnQuaCIKKyNpbmNsdWRlICJwcm9wcGFnZS5oIgor
I2luY2x1ZGUgInByb3BzaGVldC5oIgogCisvLyBQYWdlIGNsYXNzIGhlYWRl
cnMKKyNpbmNsdWRlICJzcGxhc2guaCIKKyNpbmNsdWRlICJzb3VyY2UuaCIK
KyNpbmNsdWRlICJyb290LmgiCisjaW5jbHVkZSAibG9jYWxkaXIuaCIKKyNp
bmNsdWRlICJuZXQuaCIKKyNpbmNsdWRlICJzaXRlLmgiCisjaW5jbHVkZSAi
Y2hvb3NlLmgiCisjaW5jbHVkZSAidGhyZWViYXIuaCIKKyNpbmNsdWRlICJk
ZXNrdG9wLmgiCisKIGludCBuZXh0X2RpYWxvZzsKIGludCBleGl0X21zZyA9
IDA7CiAKQEAgLTEyMyw2ICsxMzcsMTIgQEAgb3V0OgogICBGcmVlU2lkIChz
aWQpOwogfQogCitleHRlcm4gQk9PTCBDQUxMQkFDSworcm9vdF9kaWFsb2df
cHJvYyAoSFdORCBoLCBVSU5UIG1lc3NhZ2UsIFdQQVJBTSB3UGFyYW0sIExQ
QVJBTSBsUGFyYW0pOworCisvLyBPdGhlciB0aHJlYWRzIHRhbGsgdG8gdGhp
cyBwYWdlLCBzbyB3ZSBuZWVkIHRvIGhhdmUgaXQgZXh0ZXJuYWJsZS4KK1Ro
cmVlQmFyUHJvZ3Jlc3NQYWdlIFByb2dyZXNzOworCiBpbnQgV0lOQVBJCiBX
aW5NYWluIChISU5TVEFOQ0UgaCwKIAkgSElOU1RBTkNFIGhQcmV2SW5zdGFu
Y2UsIExQU1RSIGNvbW1hbmRfbGluZSwgaW50IGNtZF9zaG93KQpAQCAtMTMz
LDYgKzE1MywxNiBAQCBXaW5NYWluIChISU5TVEFOQ0UgaCwKIAogICBsb2cg
KExPR19USU1FU1RBTVAsICJTdGFydGluZyBjeWd3aW4gaW5zdGFsbCwgdmVy
c2lvbiAlcyIsIHZlcnNpb24pOwogCisgIFNwbGFzaFBhZ2UgU3BsYXNoOwor
ICBTb3VyY2VQYWdlIFNvdXJjZTsKKyAgUm9vdFBhZ2UgUm9vdDsKKyAgTG9j
YWxEaXJQYWdlIExvY2FsRGlyOworICBOZXRQYWdlIE5ldDsKKyAgU2l0ZVBh
Z2UgU2l0ZTsKKyAgQ2hvb3NlclBhZ2UgQ2hvb3NlcjsKKyAgRGVza3RvcFNl
dHVwUGFnZSBEZXNrdG9wOworICBQcm9wU2hlZXQgTWFpbldpbmRvdzsKKwog
ICBjaGFyIGN3ZFtfTUFYX1BBVEhdOwogICBHZXRDdXJyZW50RGlyZWN0b3J5
IChzaXplb2YgKGN3ZCksIGN3ZCk7CiAgIGxvY2FsX2RpciA9IHN0cmR1cCAo
Y3dkKTsKQEAgLTE1MCw1OCArMTgwLDM2IEBAIFdpbk1haW4gKEhJTlNUQU5D
RSBoLAogICBpZiAoaXN3aW5udCkKICAgICBzZXRfZGVmYXVsdF9kYWNsICgp
OwogCi0gIHdoaWxlIChuZXh0X2RpYWxvZykKLSAgICB7Ci0gICAgICBzd2l0
Y2ggKG5leHRfZGlhbG9nKQotCXsKLQljYXNlIElERF9TUExBU0g6Ci0JICBk
b19zcGxhc2ggKGgpOwotCSAgYnJlYWs7Ci0JY2FzZSBJRERfU09VUkNFOgot
CSAgZG9fc291cmNlIChoKTsKLQkgIGJyZWFrOwotCWNhc2UgSUREX0xPQ0FM
X0RJUjoKLQkgIGRvX2xvY2FsX2RpciAoaCk7Ci0JICBicmVhazsKLQljYXNl
IElERF9ST09UOgotCSAgZG9fcm9vdCAoaCk7Ci0JICBicmVhazsKLQljYXNl
IElERF9ORVQ6Ci0JICBkb19uZXQgKGgpOwotCSAgYnJlYWs7Ci0JY2FzZSBJ
RERfU0lURToKLQkgIGRvX3NpdGUgKGgpOwotCSAgYnJlYWs7Ci0JY2FzZSBJ
RERfT1RIRVJfVVJMOgotCSAgZG9fb3RoZXIgKGgpOwotCSAgYnJlYWs7Ci0J
Y2FzZSBJRERfU19MT0FEX0lOSToKLQkgIGRvX2luaSAoaCk7Ci0JICBicmVh
azsKLQljYXNlIElERF9TX0ZST01fQ1dEOgotCSAgZG9fZnJvbWN3ZCAoaCk7
Ci0JICBicmVhazsKLQljYXNlIElERF9DSE9PU0U6Ci0JICBkb19jaG9vc2Ug
KGgpOwotCSAgYnJlYWs7Ci0JY2FzZSBJRERfU19ET1dOTE9BRDoKLQkgIGRv
X2Rvd25sb2FkIChoKTsKLQkgIGJyZWFrOwotCWNhc2UgSUREX1NfSU5TVEFM
TDoKLQkgIGRvX2luc3RhbGwgKGgpOwotCSAgYnJlYWs7Ci0JY2FzZSBJRERf
REVTS1RPUDoKLQkgIGRvX2Rlc2t0b3AgKGgpOwotCSAgYnJlYWs7Ci0JY2Fz
ZSBJRERfU19QT1NUSU5TVEFMTDoKLQkgIGRvX3Bvc3RpbnN0YWxsIChoKTsK
LQkgIGJyZWFrOwotCi0JZGVmYXVsdDoKLQkgIG5leHRfZGlhbG9nID0gMDsK
LQkgIGJyZWFrOwotCX0KLSAgICB9CisgIC8vIEluaXRpYWxpemUgY29tbW9u
IGNvbnRyb2xzCisgIEluaXRDb21tb25Db250cm9scyAoKTsKKworICAvLyBJ
bml0IHdpbmRvdyBjbGFzcyBsaWIKKyAgV2luZG93OjpTZXRBcHBJbnN0YW5j
ZSAoaCk7CisKKyAgLy8gQ3JlYXRlIHBhZ2VzCisgIFNwbGFzaC5DcmVhdGUg
KCk7CisgIFNvdXJjZS5DcmVhdGUgKCk7CisgIFJvb3QuQ3JlYXRlICgpOwor
ICBMb2NhbERpci5DcmVhdGUgKCk7CisgIE5ldC5DcmVhdGUgKCk7CisgIFNp
dGUuQ3JlYXRlICgpOworICBDaG9vc2VyLkNyZWF0ZSAoKTsKKyAgUHJvZ3Jl
c3MuQ3JlYXRlICgpOworICBEZXNrdG9wLkNyZWF0ZSAoKTsKKworICAvLyBB
ZGQgcGFnZXMgdG8gc2hlZXQKKyAgTWFpbldpbmRvdy5BZGRQYWdlICgmU3Bs
YXNoKTsKKyAgTWFpbldpbmRvdy5BZGRQYWdlICgmU291cmNlKTsKKyAgTWFp
bldpbmRvdy5BZGRQYWdlICgmUm9vdCk7CisgIE1haW5XaW5kb3cuQWRkUGFn
ZSAoJkxvY2FsRGlyKTsKKyAgTWFpbldpbmRvdy5BZGRQYWdlICgmTmV0KTsK
KyAgTWFpbldpbmRvdy5BZGRQYWdlICgmU2l0ZSk7CisgIE1haW5XaW5kb3cu
QWRkUGFnZSAoJkNob29zZXIpOworICBNYWluV2luZG93LkFkZFBhZ2UgKCZQ
cm9ncmVzcyk7CisgIE1haW5XaW5kb3cuQWRkUGFnZSAoJkRlc2t0b3ApOwor
CisgIC8vIENyZWF0ZSB0aGUgUHJvcFNoZWV0IG1haW4gd2luZG93CisgIE1h
aW5XaW5kb3cuQ3JlYXRlICgpOwogCiAgIGV4aXRfc2V0dXAgKDApOwogICAv
KiBLZWVwIGdjYyBoYXBweSA6fSAqLwpJbmRleDogbXNnLmNjCj09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT0KUkNTIGZpbGU6IC9jdnMvc3JjL3NyYy93aW5zdXAv
Y2luc3RhbGwvbXNnLmNjLHYKcmV0cmlldmluZyByZXZpc2lvbiAyLjIKZGlm
ZiAtdSAtcCAtcjIuMiBtc2cuY2MKLS0tIG1zZy5jYwkyMDAxLzExLzEzIDAx
OjQ5OjMyCTIuMgorKysgbXNnLmNjCTIwMDEvMTIvMjAgMTI6MzY6MDAKQEAg
LTM4LDcgKzM4LDcgQEAgbXNnIChjb25zdCBjaGFyICpmbXQsIC4uLikKIH0K
IAogc3RhdGljIGludAotbWJveCAoY29uc3QgY2hhciAqbmFtZSwgaW50IHR5
cGUsIGludCBpZCwgdmFfbGlzdCBhcmdzKQorbWJveCAoSFdORCBvd25lciwg
Y29uc3QgY2hhciAqbmFtZSwgaW50IHR5cGUsIGludCBpZCwgdmFfbGlzdCBh
cmdzKQogewogICBjaGFyIGJ1ZlsxMDAwXSwgZm10WzEwMDBdOwogCkBAIC00
NywzMCArNDcsMzAgQEAgbWJveCAoY29uc3QgY2hhciAqbmFtZSwgaW50IHR5
cGUsIGludCBpZAogCiAgIHZzcHJpbnRmIChidWYsIGZtdCwgYXJncyk7CiAg
IGxvZyAoMCwgIm1ib3ggJXM6ICVzIiwgbmFtZSwgYnVmKTsKLSAgcmV0dXJu
IE1lc3NhZ2VCb3ggKDAsIGJ1ZiwgIkN5Z3dpbiBTZXR1cCIsIHR5cGUgfCBN
Ql9UT1BNT1NUKTsKKyAgcmV0dXJuIE1lc3NhZ2VCb3ggKG93bmVyLCBidWYs
ICJDeWd3aW4gU2V0dXAiLCB0eXBlIC8qfCBNQl9UT1BNT1NUICovICk7CiB9
CiAKIHZvaWQKLW5vdGUgKGludCBpZCwgLi4uKQorbm90ZSAoSFdORCBvd25l
ciwgaW50IGlkLCAuLi4pCiB7CiAgIHZhX2xpc3QgYXJnczsKICAgdmFfc3Rh
cnQgKGFyZ3MsIGlkKTsKLSAgbWJveCAoIm5vdGUiLCAwLCBpZCwgYXJncyk7
CisgIG1ib3ggKG93bmVyLCAibm90ZSIsIDAsIGlkLCBhcmdzKTsKIH0KIAog
dm9pZAotZmF0YWwgKGludCBpZCwgLi4uKQorZmF0YWwgKEhXTkQgb3duZXIs
IGludCBpZCwgLi4uKQogewogICB2YV9saXN0IGFyZ3M7CiAgIHZhX3N0YXJ0
IChhcmdzLCBpZCk7Ci0gIG1ib3ggKCJmYXRhbCIsIDAsIGlkLCBhcmdzKTsK
KyAgbWJveCAob3duZXIsICJmYXRhbCIsIDAsIGlkLCBhcmdzKTsKICAgZXhp
dF9zZXR1cCAoMSk7CiB9CiAKIGludAoteWVzbm8gKGludCBpZCwgLi4uKQor
eWVzbm8gKEhXTkQgb3duZXIsIGludCBpZCwgLi4uKQogewogICB2YV9saXN0
IGFyZ3M7CiAgIHZhX3N0YXJ0IChhcmdzLCBpZCk7Ci0gIHJldHVybiBtYm94
ICgieWVzbm8iLCBNQl9ZRVNOTywgaWQsIGFyZ3MpOworICByZXR1cm4gbWJv
eCAob3duZXIsICJ5ZXNubyIsIE1CX1lFU05PLCBpZCwgYXJncyk7CiB9Cklu
ZGV4OiBtc2cuaAo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09ClJDUyBmaWxlOiAv
Y3ZzL3NyYy9zcmMvd2luc3VwL2NpbnN0YWxsL21zZy5oLHYKcmV0cmlldmlu
ZyByZXZpc2lvbiAyLjEKZGlmZiAtdSAtcCAtcjIuMSBtc2cuaAotLS0gbXNn
LmgJMjAwMS8xMS8xMyAwMTo0OTozMgkyLjEKKysrIG1zZy5oCTIwMDEvMTIv
MjAgMTI6MzY6MDAKQEAgLTIzLDExICsyMywxMSBAQCB2b2lkIG1zZyAoY29u
c3QgY2hhciAqZm10LCAuLi4pOwogICAgaXMgaW50ZXJwcmV0ZWQgbGlrZSBw
cmludGYuICBUaGUgcHJvZ3JhbSBleGl0cyB3aGVuIHRoZSB1c2VyCiAgICBw
cmVzc2VzIE9LLiAqLwogCi12b2lkIGZhdGFsIChpbnQgaWQsIC4uLik7Cit2
b2lkIGZhdGFsIChIV05EIG93bmVyLCBpbnQgaWQsIC4uLik7CiAKIC8qIFNp
bWlsYXIsIGJ1dCB0aGUgcHJvZ3JhbSBjb250aW51ZXMgd2hlbiB0aGUgdXNl
ciBwcmVzc2VzIE9LICovCiAKLXZvaWQgbm90ZSAoaW50IGlkLCAuLi4pOwor
dm9pZCBub3RlIChIV05EIG93bmVyLCBpbnQgaWQsIC4uLik7CiAKIC8qIHJl
dHVybnMgSURZRVMgb3IgSUROTywgb3RoZXJ3aXNlIHNhbWUgYXMgbm90ZSgp
ICovCi1pbnQgeWVzbm8gKGludCBpZCwgLi4uKTsKK2ludCB5ZXNubyAoSFdO
RCBvd25lciwgaW50IGlkLCAuLi4pOwpJbmRleDogbmV0LmNjCj09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT0KUkNTIGZpbGU6IC9jdnMvc3JjL3NyYy93aW5zdXAv
Y2luc3RhbGwvbmV0LmNjLHYKcmV0cmlldmluZyByZXZpc2lvbiAyLjcKZGlm
ZiAtdSAtcCAtcjIuNyBuZXQuY2MKLS0tIG5ldC5jYwkyMDAxLzExLzEzIDAx
OjQ5OjMyCTIuNworKysgbmV0LmNjCTIwMDEvMTIvMjAgMTI6MzY6MDAKQEAg
LTMwLDYgKzMwLDExIEBAIHN0YXRpYyBjb25zdCBjaGFyICpjdnNpZCA9CiAj
aW5jbHVkZSAibXNnLmgiCiAjaW5jbHVkZSAibG9nLmgiCiAKKyNpbmNsdWRl
ICJuZXQuaCIKKworI2luY2x1ZGUgInRocmVlYmFyLmgiCitleHRlcm4gVGhy
ZWVCYXJQcm9ncmVzc1BhZ2UgUHJvZ3Jlc3M7CisKIHN0YXRpYyBpbnQgcmJb
XSA9IHsgSURDX05FVF9JRTUsIElEQ19ORVRfRElSRUNULCBJRENfTkVUX1BS
T1hZLCAwIH07CiAKIHN0YXRpYyB2b2lkCkBAIC04NCw3MSArODksNTAgQEAg
ZGlhbG9nX2NtZCAoSFdORCBoLCBpbnQgaWQsIEhXTkQgaHduZGN0bAogICAg
ICAgc2F2ZV9kaWFsb2cgKGgpOwogICAgICAgY2hlY2tfaWZfZW5hYmxlX25l
eHQgKGgpOwogICAgICAgYnJlYWs7Ci0KLSAgICBjYXNlIElET0s6Ci0gICAg
ICBzYXZlX2RpYWxvZyAoaCk7Ci0gICAgICBzd2l0Y2ggKHNvdXJjZSkKLQl7
Ci0JY2FzZSBJRENfU09VUkNFX05FVElOU1Q6Ci0JY2FzZSBJRENfU09VUkNF
X0RPV05MT0FEOgotCSAgTkVYVCAoSUREX1NJVEUpOwotCSAgYnJlYWs7Ci0J
Y2FzZSBJRENfU09VUkNFX0NXRDoKLQkgIE5FWFQgKDApOwotCSAgYnJlYWs7
Ci0JZGVmYXVsdDoKLQkgIG1zZyAoInNvdXJjZSBpcyBkZWZhdWx0PyAlZFxu
Iiwgc291cmNlKTsKLQkgIE5FWFQgKDApOwotCX0KLSAgICAgIGJyZWFrOwot
Ci0gICAgY2FzZSBJRENfQkFDSzoKLSAgICAgIHNhdmVfZGlhbG9nIChoKTsK
LSAgICAgIE5FWFQgKElERF9MT0NBTF9ESVIpOwotICAgICAgYnJlYWs7Ci0K
LSAgICBjYXNlIElEQ0FOQ0VMOgotICAgICAgTkVYVCAoMCk7Ci0gICAgICBi
cmVhazsKICAgICB9CiAgIHJldHVybiAwOwogfQogCi1zdGF0aWMgQk9PTCBD
QUxMQkFDSwotZGlhbG9nX3Byb2MgKEhXTkQgaCwgVUlOVCBtZXNzYWdlLCBX
UEFSQU0gd1BhcmFtLCBMUEFSQU0gbFBhcmFtKQorYm9vbAorTmV0UGFnZTo6
Q3JlYXRlICgpCiB7Ci0gIHN3aXRjaCAobWVzc2FnZSkKLSAgICB7Ci0gICAg
Y2FzZSBXTV9JTklURElBTE9HOgotICAgICAgbG9hZF9kaWFsb2cgKGgpOwot
Ci0gICAgICAvLyBDaGVjayB0byBzZWUgaWYgYW55IHJhZGlvIGJ1dHRvbnMg
YXJlIHNlbGVjdGVkLiBJZiBub3QsIHNlbGVjdCBhIGRlZmF1bHQuCi0gICAg
ICBpZiAoCi0JICAoIVNlbmRNZXNzYWdlIChHZXREbGdJdGVtIChoLCBJRENf
TkVUX0lFNSksIEJNX0dFVENIRUNLLCAwLCAwKSA9PQotCSAgIEJTVF9DSEVD
S0VEKQotCSAgJiYgKCFTZW5kTWVzc2FnZSAoR2V0RGxnSXRlbSAoaCwgSURD
X05FVF9QUk9YWSksIEJNX0dFVENIRUNLLCAwLCAwKQotCSAgICAgID09IEJT
VF9DSEVDS0VEKSkKLQl7Ci0JICBTZW5kTWVzc2FnZSAoR2V0RGxnSXRlbSAo
aCwgSURDX05FVF9ESVJFQ1QpLCBCTV9DTElDSywgMCwgMCk7Ci0JfQotICAg
ICAgcmV0dXJuIEZBTFNFOwotICAgIGNhc2UgV01fQ09NTUFORDoKLSAgICAg
IHJldHVybiBIQU5ETEVfV01fQ09NTUFORCAoaCwgd1BhcmFtLCBsUGFyYW0s
IGRpYWxvZ19jbWQpOwotICAgIH0KLSAgcmV0dXJuIEZBTFNFOworICByZXR1
cm4gUHJvcGVydHlQYWdlOjpDcmVhdGUgKE5VTEwsIGRpYWxvZ19jbWQsIElE
RF9ORVQpOwogfQogCiB2b2lkCi1kb19uZXQgKEhJTlNUQU5DRSBoKQorTmV0
UGFnZTo6T25Jbml0ICgpCiB7Ci0gIGludCBydiA9IDA7CisgIEhXTkQgaCA9
IEdldEhXTkQgKCk7CiAKICAgbmV0X21ldGhvZCA9IElEQ19ORVRfRElSRUNU
OwotICBydiA9IERpYWxvZ0JveCAoaCwgTUFLRUlOVFJFU09VUkNFIChJRERf
TkVUKSwgMCwgZGlhbG9nX3Byb2MpOwotICBpZiAocnYgPT0gLTEpCi0gICAg
ZmF0YWwgKElEU19ESUFMT0dfRkFJTEVEKTsKKyAgbG9hZF9kaWFsb2cgKGgp
OworCisgIC8vIENoZWNrIHRvIHNlZSBpZiBhbnkgcmFkaW8gYnV0dG9ucyBh
cmUgc2VsZWN0ZWQuIElmIG5vdCwgc2VsZWN0IGEgZGVmYXVsdC4KKyAgaWYg
KCghU2VuZE1lc3NhZ2UgKEdldERsZ0l0ZW0gKElEQ19ORVRfSUU1KSwgQk1f
R0VUQ0hFQ0ssIDAsIDApID09CisgICAgICAgQlNUX0NIRUNLRUQpCisgICAg
ICAmJiAoIVNlbmRNZXNzYWdlIChHZXREbGdJdGVtIChJRENfTkVUX1BST1hZ
KSwgQk1fR0VUQ0hFQ0ssIDAsIDApCisJICA9PSBCU1RfQ0hFQ0tFRCkpCisg
ICAgeworICAgICAgU2VuZE1lc3NhZ2UgKEdldERsZ0l0ZW0gKElEQ19ORVRf
RElSRUNUKSwgQk1fQ0xJQ0ssIDAsIDApOworICAgIH0KK30KKworbG9uZwor
TmV0UGFnZTo6T25OZXh0ICgpCit7CisgIHNhdmVfZGlhbG9nIChHZXRIV05E
ICgpKTsKIAogICBsb2cgKDAsICJuZXQ6ICVzIiwKICAgICAgICAobmV0X21l
dGhvZCA9PSBJRENfTkVUX0lFNSkgPyAiSUU1IiA6CiAgICAgICAgKG5ldF9t
ZXRob2QgPT0gSURDX05FVF9ESVJFQ1QpID8gIkRpcmVjdCIgOiAiUHJveHki
KTsKKworICBQcm9ncmVzcy5TZXRBY3RpdmF0ZVRhc2sgKFdNX0FQUF9TVEFS
VF9TSVRFX0lORk9fRE9XTkxPQUQpOworICByZXR1cm4gSUREX0lOU1RBVFVT
OworfQorCitsb25nCitOZXRQYWdlOjpPbkJhY2sgKCkKK3sKKyAgc2F2ZV9k
aWFsb2cgKEdldEhXTkQgKCkpOworICByZXR1cm4gMDsKIH0KSW5kZXg6IG5l
dC5oCj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT0KUkNTIGZpbGU6IG5ldC5oCmRp
ZmYgLU4gbmV0LmgKLS0tIC9kZXYvbnVsbAlUdWUgTWF5ICA1IDEzOjMyOjI3
IDE5OTgKKysrIG5ldC5oCVRodSBEZWMgMjAgMDQ6MzY6MDAgMjAwMQpAQCAt
MCwwICsxLDQyIEBACisjaWZuZGVmIENJTlNUQUxMX05FVF9ICisjZGVmaW5l
IENJTlNUQUxMX05FVF9ICisKKy8qCisgKiBDb3B5cmlnaHQgKGMpIDIwMDEs
IEdhcnkgUi4gVmFuIFNpY2tsZS4KKyAqCisgKiAgICAgVGhpcyBwcm9ncmFt
IGlzIGZyZWUgc29mdHdhcmU7IHlvdSBjYW4gcmVkaXN0cmlidXRlIGl0IGFu
ZC9vciBtb2RpZnkKKyAqICAgICBpdCB1bmRlciB0aGUgdGVybXMgb2YgdGhl
IEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGFzIHB1Ymxpc2hlZCBieQor
ICogICAgIHRoZSBGcmVlIFNvZnR3YXJlIEZvdW5kYXRpb247IGVpdGhlciB2
ZXJzaW9uIDIgb2YgdGhlIExpY2Vuc2UsIG9yCisgKiAgICAgKGF0IHlvdXIg
b3B0aW9uKSBhbnkgbGF0ZXIgdmVyc2lvbi4KKyAqCisgKiAgICAgQSBjb3B5
IG9mIHRoZSBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBjYW4gYmUgZm91
bmQgYXQKKyAqICAgICBodHRwOi8vd3d3LmdudS5vcmcvCisgKgorICogV3Jp
dHRlbiBieSBHYXJ5IFIuIFZhbiBTaWNrbGUgPGcuci52YW5zaWNrbGVAd29y
bGRuZXQuYXR0Lm5ldD4KKyAqCisgKi8KKworLy8gVGhpcyBpcyB0aGUgaGVh
ZGVyIGZvciB0aGUgTmV0UGFnZSBjbGFzcy4gIEl0IGFsbG93cyB0aGUgdXNl
ciB0byBzZWxlY3QKKy8vIGEgcHJveHkgZXRjLgorCisKKyNpbmNsdWRlICJw
cm9wcGFnZS5oIgorCitjbGFzcyBOZXRQYWdlOnB1YmxpYyBQcm9wZXJ0eVBh
Z2UKK3sKK3B1YmxpYzoKKyAgTmV0UGFnZSAoKQorICB7CisgIH07CisgIHZp
cnR1YWwgfiBOZXRQYWdlICgpCisgIHsKKyAgfTsKKworICBib29sIENyZWF0
ZSAoKTsKKworICB2aXJ0dWFsIHZvaWQgT25Jbml0ICgpOworICB2aXJ0dWFs
IGxvbmcgT25OZXh0ICgpOworICB2aXJ0dWFsIGxvbmcgT25CYWNrICgpOwor
fTsKKworI2VuZGlmIC8vIENJTlNUQUxMX05FVF9ICkluZGV4OiBuZXRpby5j
Ywo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09ClJDUyBmaWxlOiAvY3ZzL3NyYy9z
cmMvd2luc3VwL2NpbnN0YWxsL25ldGlvLmNjLHYKcmV0cmlldmluZyByZXZp
c2lvbiAyLjUKZGlmZiAtdSAtcCAtcjIuNSBuZXRpby5jYwotLS0gbmV0aW8u
Y2MJMjAwMS8xMi8wMiAwMzoyNToxMQkyLjUKKysrIG5ldGlvLmNjCTIwMDEv
MTIvMjAgMTI6MzY6MDAKQEAgLTIyOSwyOSArMjI5LDI5IEBAIGF1dGhfcHJv
YyAoSFdORCBoLCBVSU5UIG1lc3NhZ2UsIFdQQVJBTSAKIH0KIAogc3RhdGlj
IGludAotYXV0aF9jb21tb24gKEhJTlNUQU5DRSBoLCBpbnQgaWQpCithdXRo
X2NvbW1vbiAoSElOU1RBTkNFIGgsIGludCBpZCwgSFdORCBvd25lcikKIHsK
LSAgcmV0dXJuIERpYWxvZ0JveCAoaCwgTUFLRUlOVFJFU09VUkNFIChpZCks
IDAsIGF1dGhfcHJvYyk7CisgIHJldHVybiBEaWFsb2dCb3ggKGgsIE1BS0VJ
TlRSRVNPVVJDRSAoaWQpLCBvd25lciwgYXV0aF9wcm9jKTsKIH0KIAogaW50
Ci1OZXRJTzo6Z2V0X2F1dGggKCkKK05ldElPOjpnZXRfYXV0aCAoSFdORCBv
d25lcikKIHsKICAgdXNlciA9ICZuZXRfdXNlcjsKICAgcGFzc3dkID0gJm5l
dF9wYXNzd2Q7Ci0gIHJldHVybiBhdXRoX2NvbW1vbiAoaGluc3RhbmNlLCBJ
RERfTkVUX0FVVEgpOworICByZXR1cm4gYXV0aF9jb21tb24gKGhpbnN0YW5j
ZSwgSUREX05FVF9BVVRILCBvd25lcik7CiB9CiAKIGludAotTmV0SU86Omdl
dF9wcm94eV9hdXRoICgpCitOZXRJTzo6Z2V0X3Byb3h5X2F1dGggKEhXTkQg
b3duZXIpCiB7CiAgIHVzZXIgPSAmbmV0X3Byb3h5X3VzZXI7CiAgIHBhc3N3
ZCA9ICZuZXRfcHJveHlfcGFzc3dkOwotICByZXR1cm4gYXV0aF9jb21tb24g
KGhpbnN0YW5jZSwgSUREX1BST1hZX0FVVEgpOworICByZXR1cm4gYXV0aF9j
b21tb24gKGhpbnN0YW5jZSwgSUREX1BST1hZX0FVVEgsIG93bmVyKTsKIH0K
IAogaW50Ci1OZXRJTzo6Z2V0X2Z0cF9hdXRoICgpCitOZXRJTzo6Z2V0X2Z0
cF9hdXRoIChIV05EIG93bmVyKQogewogICBpZiAobmV0X2Z0cF91c2VyKQog
ICAgIHsKQEAgLTI2Nyw1ICsyNjcsNSBAQCBOZXRJTzo6Z2V0X2Z0cF9hdXRo
ICgpCiAgICAgcmV0dXJuIElEQ0FOQ0VMOwogICB1c2VyID0gJm5ldF9mdHBf
dXNlcjsKICAgcGFzc3dkID0gJm5ldF9mdHBfcGFzc3dkOwotICByZXR1cm4g
YXV0aF9jb21tb24gKGhpbnN0YW5jZSwgSUREX0ZUUF9BVVRIKTsKKyAgcmV0
dXJuIGF1dGhfY29tbW9uIChoaW5zdGFuY2UsIElERF9GVFBfQVVUSCwgb3du
ZXIpOwogfQpJbmRleDogbmV0aW8uaAo9PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
ClJDUyBmaWxlOiAvY3ZzL3NyYy9zcmMvd2luc3VwL2NpbnN0YWxsL25ldGlv
LmgsdgpyZXRyaWV2aW5nIHJldmlzaW9uIDIuNApkaWZmIC11IC1wIC1yMi40
IG5ldGlvLmgKLS0tIG5ldGlvLmgJMjAwMS8xMi8wMiAwMzoyNToxMQkyLjQK
KysrIG5ldGlvLmgJMjAwMS8xMi8yMCAxMjozNjowMApAQCAtNTAsNyArNTAs
NyBAQCBwdWJsaWM6CiAgIC8qIEhlbHBlciBmdW5jdGlvbnMgZm9yIGh0dHAv
ZnRwIHByb3RvY29scy4gIEJvdGggcmV0dXJuIG5vbnplcm8gZm9yCiAgICAg
ICJjYW5jZWwiLCB6ZXJvIGZvciAib2siLiAgVGhleSBzZXQgbmV0X3Byb3h5
X3VzZXIsIGV0YywgaW4KICAgICAgc3RhdGUuaCAqLwotICBpbnQgZ2V0X2F1
dGggKCk7Ci0gIGludCBnZXRfcHJveHlfYXV0aCAoKTsKLSAgaW50IGdldF9m
dHBfYXV0aCAoKTsKKyAgaW50IGdldF9hdXRoIChIV05EIG93bmVyKTsKKyAg
aW50IGdldF9wcm94eV9hdXRoIChIV05EIG93bmVyKTsKKyAgaW50IGdldF9m
dHBfYXV0aCAoSFdORCBvd25lcik7CiB9OwpJbmRleDogbmlvLWZpbGUuY2MK
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PQpSQ1MgZmlsZTogL2N2cy9zcmMvc3Jj
L3dpbnN1cC9jaW5zdGFsbC9uaW8tZmlsZS5jYyx2CnJldHJpZXZpbmcgcmV2
aXNpb24gMi40CmRpZmYgLXUgLXAgLXIyLjQgbmlvLWZpbGUuY2MKLS0tIG5p
by1maWxlLmNjCTIwMDEvMTIvMDIgMDM6MjU6MTEJMi40CisrKyBuaW8tZmls
ZS5jYwkyMDAxLzEyLzIwIDEyOjM2OjAwCkBAIC00NSw3ICs0NSw3IEBAIE5l
dElPIChQdXJsKQogICAgICAgY29uc3QgY2hhciAqZXJyID0gc3RyZXJyb3Ig
KGVycm5vKTsKICAgICAgIGlmICghZXJyKQogCWVyciA9ICIodW5rbm93biBl
cnJvcikiOwotICAgICAgbm90ZSAoSURTX0VSUl9PUEVOX1JFQUQsIHBhdGgs
IGVycik7CisgICAgICBub3RlIChOVUxMLCBJRFNfRVJSX09QRU5fUkVBRCwg
cGF0aCwgZXJyKTsKICAgICB9CiB9CiAKSW5kZXg6IG5pby1mdHAuY2MKPT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PQpSQ1MgZmlsZTogL2N2cy9zcmMvc3JjL3dp
bnN1cC9jaW5zdGFsbC9uaW8tZnRwLmNjLHYKcmV0cmlldmluZyByZXZpc2lv
biAyLjgKZGlmZiAtdSAtcCAtcjIuOCBuaW8tZnRwLmNjCi0tLSBuaW8tZnRw
LmNjCTIwMDEvMTIvMDIgMDM6MjU6MTEJMi44CisrKyBuaW8tZnRwLmNjCTIw
MDEvMTIvMjAgMTI6MzY6MDIKQEAgLTk1LDcgKzk1LDcgQEAgTmV0SU9fRlRQ
OjpOZXRJT19GVFAgKGNoYXIgY29uc3QgKlB1cmwsIAogCX0KICAgICAgIGlm
IChjb2RlID09IDUzMCkJCS8qIEF1dGhlbnRpY2F0aW9uIGZhaWxlZCwgcmV0
cnkgKi8KIAl7Ci0JICBnZXRfZnRwX2F1dGggKCk7CisJICBnZXRfZnRwX2F1
dGggKE5VTEwpOwogCSAgaWYgKG5ldF9mdHBfdXNlciAmJiBuZXRfZnRwX3Bh
c3N3ZCkKIAkgICAgZ290byBhdXRoX3JldHJ5OwogCX0KSW5kZXg6IG5pby1o
dHRwLmNjCj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KUkNTIGZpbGU6IC9jdnMv
c3JjL3NyYy93aW5zdXAvY2luc3RhbGwvbmlvLWh0dHAuY2MsdgpyZXRyaWV2
aW5nIHJldmlzaW9uIDIuOQpkaWZmIC11IC1wIC1yMi45IG5pby1odHRwLmNj
Ci0tLSBuaW8taHR0cC5jYwkyMDAxLzEyLzAyIDAzOjI1OjExCTIuOQorKysg
bmlvLWh0dHAuY2MJMjAwMS8xMi8yMCAxMjozNjowMgpAQCAtMTQ4LDE0ICsx
NDgsMTQgQEAgcmV0cnlfZ2V0OgogICAgIH0KICAgaWYgKGNvZGUgPT0gNDAx
KQkJLyogYXV0aG9yaXphdGlvbiByZXF1aXJlZCAqLwogICAgIHsKLSAgICAg
IGdldF9hdXRoICgpOworICAgICAgZ2V0X2F1dGggKE5VTEwpOwogICAgICAg
ZGVsZXRlCiAJczsKICAgICAgIGdvdG8gcmV0cnlfZ2V0OwogICAgIH0KICAg
aWYgKGNvZGUgPT0gNDA3KQkJLyogcHJveHkgYXV0aG9yaXphdGlvbiByZXF1
aXJlZCAqLwogICAgIHsKLSAgICAgIGdldF9wcm94eV9hdXRoICgpOworICAg
ICAgZ2V0X3Byb3h5X2F1dGggKE5VTEwpOwogICAgICAgZGVsZXRlCiAJczsK
ICAgICAgIGdvdG8gcmV0cnlfZ2V0OwpAQCAtMTYzLDcgKzE2Myw3IEBAIHJl
dHJ5X2dldDoKICAgaWYgKGNvZGUgPT0gNTAwCQkvKiBmdHAgYXV0aGVudGlj
YXRpb24gdGhyb3VnaCBwcm94eSByZXF1aXJlZCAqLwogICAgICAgJiYgbmV0
X21ldGhvZCA9PSBJRENfTkVUX1BST1hZICYmICFzdHJuY21wICh1cmwsICJm
dHA6Ly8iLCA2KSkKICAgICB7Ci0gICAgICBnZXRfZnRwX2F1dGggKCk7Cisg
ICAgICBnZXRfZnRwX2F1dGggKE5VTEwpOwogICAgICAgaWYgKG5ldF9mdHBf
dXNlciAmJiBuZXRfZnRwX3Bhc3N3ZCkKIAl7CiAJICBkZWxldGUKSW5kZXg6
IG5pby1pZTUuY2MKPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQpSQ1MgZmlsZTog
L2N2cy9zcmMvc3JjL3dpbnN1cC9jaW5zdGFsbC9uaW8taWU1LmNjLHYKcmV0
cmlldmluZyByZXZpc2lvbiAyLjQKZGlmZiAtdSAtcCAtcjIuNCBuaW8taWU1
LmNjCi0tLSBuaW8taWU1LmNjCTIwMDEvMTIvMDIgMDM6MjU6MTEJMi40Cisr
KyBuaW8taWU1LmNjCTIwMDEvMTIvMjAgMTI6MzY6MDIKQEAgLTQ0LDcgKzQ0
LDcgQEAgTmV0SU8gKF91cmwpCiAgICAgICBISU5TVEFOQ0UgaCA9IExvYWRM
aWJyYXJ5ICgid2luaW5ldC5kbGwiKTsKICAgICAgIGlmICghaCkKIAl7Ci0J
ICBub3RlIChJRFNfV0lOSU5FVCk7CisJICBub3RlIChOVUxMLCBJRFNfV0lO
SU5FVCk7CiAJICBjb25uZWN0aW9uID0gMDsKIAkgIHJldHVybjsKIAl9CkBA
IC0xMTIsMTQgKzExMiwxNCBAQCB0cnlfYWdhaW46CiAJICBpZiAodHlwZSA9
PSA0MDEpCS8qIGF1dGhvcml6YXRpb24gcmVxdWlyZWQgKi8KIAkgICAgewog
CSAgICAgIGZsdXNoX2lvICgpOwotCSAgICAgIGdldF9hdXRoICgpOworCSAg
ICAgIGdldF9hdXRoIChOVUxMKTsKIAkgICAgICByZXNlbmQgPSAxOwogCSAg
ICAgIGdvdG8gdHJ5X2FnYWluOwogCSAgICB9CiAJICBlbHNlIGlmICh0eXBl
ID09IDQwNykJLyogcHJveHkgYXV0aG9yaXphdGlvbiByZXF1aXJlZCAqLwog
CSAgICB7CiAJICAgICAgZmx1c2hfaW8gKCk7Ci0JICAgICAgZ2V0X3Byb3h5
X2F1dGggKCk7CisJICAgICAgZ2V0X3Byb3h5X2F1dGggKE5VTEwpOwogCSAg
ICAgIHJlc2VuZCA9IDE7CiAJICAgICAgZ290byB0cnlfYWdhaW47CiAJICAg
IH0KSW5kZXg6IG90aGVyLmNjCj09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KUkNT
IGZpbGU6IC9jdnMvc3JjL3NyYy93aW5zdXAvY2luc3RhbGwvb3RoZXIuY2Ms
dgpyZXRyaWV2aW5nIHJldmlzaW9uIDIuMwpkaWZmIC11IC1wIC1yMi4zIG90
aGVyLmNjCi0tLSBvdGhlci5jYwkyMDAxLzEyLzAzIDIyOjIyOjA5CTIuMwor
Kysgb3RoZXIuY2MJMjAwMS8xMi8yMCAxMjozNjowMgpAQCAtMTAzLDEyICsx
MDMsMTIgQEAgZGlhbG9nX3Byb2MgKEhXTkQgaCwgVUlOVCBtZXNzYWdlLCBX
UEFSQQogfQogCiB2b2lkCi1kb19vdGhlciAoSElOU1RBTkNFIGgpCitkb19v
dGhlciAoSElOU1RBTkNFIGgsIEhXTkQgb3duZXIpCiB7CiAgIGludCBydiA9
IDA7Ci0gIHJ2ID0gRGlhbG9nQm94IChoLCBNQUtFSU5UUkVTT1VSQ0UgKElE
RF9PVEhFUl9VUkwpLCAwLCBkaWFsb2dfcHJvYyk7CisgIHJ2ID0gRGlhbG9n
Qm94IChoLCBNQUtFSU5UUkVTT1VSQ0UgKElERF9PVEhFUl9VUkwpLCBvd25l
ciwgZGlhbG9nX3Byb2MpOwogICBpZiAocnYgPT0gLTEpCi0gICAgZmF0YWwg
KElEU19ESUFMT0dfRkFJTEVEKTsKKyAgICBmYXRhbCAob3duZXIsIElEU19E
SUFMT0dfRkFJTEVEKTsKIAogICBsb2cgKDAsICJzaXRlOiAlcyIsIG90aGVy
X3VybCk7CiB9CkluZGV4OiBwb3N0aW5zdGFsbC5jYwo9PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09ClJDUyBmaWxlOiAvY3ZzL3NyYy9zcmMvd2luc3VwL2NpbnN0
YWxsL3Bvc3RpbnN0YWxsLmNjLHYKcmV0cmlldmluZyByZXZpc2lvbiAyLjQK
ZGlmZiAtdSAtcCAtcjIuNCBwb3N0aW5zdGFsbC5jYwotLS0gcG9zdGluc3Rh
bGwuY2MJMjAwMS8xMS8xMyAwMTo0OTozMgkyLjQKKysrIHBvc3RpbnN0YWxs
LmNjCTIwMDEvMTIvMjAgMTI6MzY6MDIKQEAgLTk4LDcgKzk4LDcgQEAgc3Rh
dGljIGNvbnN0IGNoYXIgKnNoZWxsc1tdID0gewogfTsKIAogdm9pZAotZG9f
cG9zdGluc3RhbGwgKEhJTlNUQU5DRSBoKQorZG9fcG9zdGluc3RhbGwgKEhJ
TlNUQU5DRSBoLCBIV05EIG93bmVyKQogewogICBuZXh0X2RpYWxvZyA9IDA7
CiAgIGludCBpOwpJbmRleDogcHJvcHBhZ2UuY2MKPT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PQpSQ1MgZmlsZTogcHJvcHBhZ2UuY2MKZGlmZiAtTiBwcm9wcGFn
ZS5jYwotLS0gL2Rldi9udWxsCVR1ZSBNYXkgIDUgMTM6MzI6MjcgMTk5OAor
KysgcHJvcHBhZ2UuY2MJVGh1IERlYyAyMCAwNDozNjowMiAyMDAxCkBAIC0w
LDAgKzEsMjI2IEBACisvKgorICogQ29weXJpZ2h0IChjKSAyMDAxLCBHYXJ5
IFIuIFZhbiBTaWNrbGUuCisgKgorICogICAgIFRoaXMgcHJvZ3JhbSBpcyBm
cmVlIHNvZnR3YXJlOyB5b3UgY2FuIHJlZGlzdHJpYnV0ZSBpdCBhbmQvb3Ig
bW9kaWZ5CisgKiAgICAgaXQgdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBHTlUg
R2VuZXJhbCBQdWJsaWMgTGljZW5zZSBhcyBwdWJsaXNoZWQgYnkKKyAqICAg
ICB0aGUgRnJlZSBTb2Z0d2FyZSBGb3VuZGF0aW9uOyBlaXRoZXIgdmVyc2lv
biAyIG9mIHRoZSBMaWNlbnNlLCBvcgorICogICAgIChhdCB5b3VyIG9wdGlv
bikgYW55IGxhdGVyIHZlcnNpb24uCisgKgorICogICAgIEEgY29weSBvZiB0
aGUgR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgY2FuIGJlIGZvdW5kIGF0
CisgKiAgICAgaHR0cDovL3d3dy5nbnUub3JnLworICoKKyAqIFdyaXR0ZW4g
YnkgR2FyeSBSLiBWYW4gU2lja2xlIDxnLnIudmFuc2lja2xlQHdvcmxkbmV0
LmF0dC5uZXQ+CisgKgorICovCisKKy8vIFRoaXMgaXMgdGhlIGltcGxlbWVu
dGF0aW9uIG9mIHRoZSBQcm9wZXJ0eVBhZ2UgY2xhc3MuICBJdCB3b3JrcyBj
bG9zZWx5IHdpdGggdGhlCisvLyBQcm9wU2hlZXQgY2xhc3MgdG8gaW1wbGVt
ZW50IGEgc2luZ2xlIHBhZ2Ugb2YgdGhlIHByb3BlcnR5IHNoZWV0LgorCisj
aW5jbHVkZSAicHJvcHBhZ2UuaCIKKyNpbmNsdWRlICJwcm9wc2hlZXQuaCIK
KyNpbmNsdWRlICJ3aW4zMi5oIgorCitib29sCisgIFByb3BlcnR5UGFnZTo6
RG9PbmNlRm9yU2hlZXQgPQorICB0cnVlOworCitQcm9wZXJ0eVBhZ2U6OlBy
b3BlcnR5UGFnZSAoKQoreworICBwcm9jID0gTlVMTDsKKyAgY21kcHJvYyA9
IE5VTEw7CisgIElzRmlyc3QgPSBmYWxzZTsKKyAgSXNMYXN0ID0gZmFsc2U7
Cit9CisKK1Byb3BlcnR5UGFnZTo6flByb3BlcnR5UGFnZSAoKQoreworfQor
Citib29sCitQcm9wZXJ0eVBhZ2U6OkNyZWF0ZSAoaW50IFRlbXBsYXRlSUQp
Cit7CisgIHJldHVybiBDcmVhdGUgKE5VTEwsIE5VTEwsIFRlbXBsYXRlSUQp
OworfQorCitib29sCitQcm9wZXJ0eVBhZ2U6OkNyZWF0ZSAoRExHUFJPQyBk
bGdwcm9jLCBpbnQgVGVtcGxhdGVJRCkKK3sKKyAgcmV0dXJuIENyZWF0ZSAo
ZGxncHJvYywgTlVMTCwgVGVtcGxhdGVJRCk7Cit9CisKK2Jvb2wKK1Byb3Bl
cnR5UGFnZTo6Q3JlYXRlIChETEdQUk9DIGRsZ3Byb2MsCisJCSAgICAgIEJP
T0wgKCpjcHJvYykgKEhXTkQgaCwgaW50IGlkLCBIV05EIGh3bmRjdGwsIFVJ
TlQgY29kZSksCisJCSAgICAgIGludCBUZW1wbGF0ZUlEKQoreworICBwc3Au
ZHdTaXplID0gc2l6ZW9mIChQUk9QU0hFRVRQQUdFKTsKKyAgcHNwLmR3Rmxh
Z3MgPSAwOworICBwc3AuaEluc3RhbmNlID0gR2V0SW5zdGFuY2UgKCk7Cisg
IHBzcC5wZm5EbGdQcm9jID0gRmlyc3REaWFsb2dQcm9jUmVmbGVjdG9yOwor
ICBwc3AucHN6VGVtcGxhdGUgPSAoTFBDU1RSKSBUZW1wbGF0ZUlEOworICBw
c3AubFBhcmFtID0gKExQQVJBTSkgdGhpczsKKyAgcHNwLnBmbkNhbGxiYWNr
ID0gTlVMTDsKKworICBwcm9jID0gZGxncHJvYzsKKyAgY21kcHJvYyA9IGNw
cm9jOworCisgIHJldHVybiB0cnVlOworfQorCitCT09MIENBTExCQUNLCitQ
cm9wZXJ0eVBhZ2U6OkZpcnN0RGlhbG9nUHJvY1JlZmxlY3RvciAoSFdORCBo
d25kLCBVSU5UIG1lc3NhZ2UsCisJCQkJCVdQQVJBTSB3UGFyYW0sIExQQVJB
TSBsUGFyYW0pCit7CisgIFByb3BlcnR5UGFnZSAqVGhpczsKKworICBpZiAo
bWVzc2FnZSAhPSBXTV9JTklURElBTE9HKQorICAgIHsKKyAgICAgIC8vIERv
bid0IGhhbmRsZSBhbnl0aGluZyB1bnRpbCB3ZSBnZXQgYSBXTV9JTklURElB
TE9HIG1lc3NhZ2UsIHdoaWNoCisgICAgICAvLyB3aWxsIGhhdmUgb3VyIHRo
aXMgcG9pbnRlciB3aXRoIGl0LgorICAgICAgcmV0dXJuIEZBTFNFOworICAg
IH0KKworICBUaGlzID0gKFByb3BlcnR5UGFnZSAqKSAoKChQUk9QU0hFRVRQ
QUdFICopIGxQYXJhbSktPmxQYXJhbSk7CisKKyAgU2V0V2luZG93TG9uZyAo
aHduZCwgRFdMX1VTRVIsIChEV09SRCkgVGhpcyk7CisgIFNldFdpbmRvd0xv
bmcgKGh3bmQsIERXTF9ETEdQUk9DLCAoRFdPUkQpIERpYWxvZ1Byb2NSZWZs
ZWN0b3IpOworCisgIFRoaXMtPlNldEhXTkQgKGh3bmQpOworICByZXR1cm4g
VGhpcy0+RGlhbG9nUHJvYyAobWVzc2FnZSwgd1BhcmFtLCBsUGFyYW0pOwor
fQorCitCT09MIENBTExCQUNLCitQcm9wZXJ0eVBhZ2U6OkRpYWxvZ1Byb2NS
ZWZsZWN0b3IgKEhXTkQgaHduZCwgVUlOVCBtZXNzYWdlLCBXUEFSQU0gd1Bh
cmFtLAorCQkJCSAgIExQQVJBTSBsUGFyYW0pCit7CisgIFByb3BlcnR5UGFn
ZSAqVGhpczsKKworICBUaGlzID0gKFByb3BlcnR5UGFnZSAqKSBHZXRXaW5k
b3dMb25nIChod25kLCBEV0xfVVNFUik7CisKKyAgcmV0dXJuIFRoaXMtPkRp
YWxvZ1Byb2MgKG1lc3NhZ2UsIHdQYXJhbSwgbFBhcmFtKTsKK30KKworQk9P
TCBDQUxMQkFDSworUHJvcGVydHlQYWdlOjpEaWFsb2dQcm9jIChVSU5UIG1l
c3NhZ2UsIFdQQVJBTSB3UGFyYW0sIExQQVJBTSBsUGFyYW0pCit7CisgIGlm
IChwcm9jICE9IE5VTEwpCisgICAgeworICAgICAgcHJvYyAoR2V0SFdORCAo
KSwgbWVzc2FnZSwgd1BhcmFtLCBsUGFyYW0pOworICAgIH0KKworICBib29s
IHJldHZhbDsKKworICBzd2l0Y2ggKG1lc3NhZ2UpCisgICAgeworICAgIGNh
c2UgV01fSU5JVERJQUxPRzoKKyAgICAgIHsKKwlPbkluaXQgKCk7CisJLy8g
VFJVRSA9IFNldCBmb2N1cyB0byBkZWZhdWx0IGNvbnRyb2wgKGluIHdQYXJh
bSkuCisJcmV0dXJuIFRSVUU7CisJYnJlYWs7CisgICAgICB9CisgICAgY2Fz
ZSBXTV9OT1RJRlk6CisgICAgICBzd2l0Y2ggKCgoTk1IRFIgRkFSICopIGxQ
YXJhbSktPmNvZGUpCisJeworCWNhc2UgUFNOX0FQUExZOgorCSAgU2V0V2lu
ZG93TG9uZyAoR2V0SFdORCAoKSwgRFdMX01TR1JFU1VMVCwgUFNOUkVUX05P
RVJST1IpOworCSAgcmV0dXJuIFRSVUU7CisJICBicmVhazsKKwljYXNlIFBT
Tl9TRVRBQ1RJVkU6CisJICB7CisJICAgIGlmIChEb09uY2VGb3JTaGVldCkK
KwkgICAgICB7CisJCS8vIFRlbGwgb3VyIHBhcmVudCBQcm9wU2hlZXQgd2hh
dCBpdHMgb3duIEhXTkQgaXMuCisJCUdldE93bmVyICgpLT5TZXRIV05ERnJv
bVBhZ2UgKCgoTk1IRFIgRkFSICopIGxQYXJhbSktPgorCQkJCQkgICAgICBo
d25kRnJvbSk7CisJCUdldE93bmVyICgpLT5DZW50ZXJXaW5kb3cgKCk7CisJ
CS8vIEFkZCBhIG1pbmltaXplIGJveCB0byB0aGUgcGFyZW50IHByb3BlcnR5
IHNoZWV0LiAgV2UgZG8gdGhpcyBoZXJlCisJCS8vIGluc3RlYWQgb2YgaW4g
dGhlIHNoZWV0IGNsYXNzIG1haW5seSBiZWNhdXNlIGl0IHdpbGwgd29yayB3
aXRoIGVpdGhlcgorCQkvLyBtb2RhbCBvciBtb2RlbGVzcyBzaGVldHMuCisJ
CUxPTkcgc3R5bGUgPTo6R2V0V2luZG93TG9uZyAoKChOTUhEUiBGQVIgKikg
bFBhcmFtKS0+aHduZEZyb20sCisJCQkJCSAgICAgR1dMX1NUWUxFKTsKKwkJ
OjpTZXRXaW5kb3dMb25nICgoKE5NSERSIEZBUiAqKSBsUGFyYW0pLT5od25k
RnJvbSwgR1dMX1NUWUxFLAorCQkJCSBzdHlsZSB8IFdTX01JTklNSVpFQk9Y
KTsKKwkJRG9PbmNlRm9yU2hlZXQgPSBmYWxzZTsKKwkgICAgICB9CisKKwkg
ICAgLy8gU2V0IHRoZSB3aXphcmQgYnV0dG9ucyBhcHJvcHJpYXRlbHkKKwkg
ICAgaWYgKElzRmlyc3QpCisJICAgICAgeworCQkvLyBEaXNhYmxlICJCYWNr
IiBvbiBmaXJzdCBwYWdlLgorCQlHZXRPd25lciAoKS0+U2V0QnV0dG9ucyAo
UFNXSVpCX05FWFQpOworCQkvLzo6UHJvcFNoZWV0X1NldFdpekJ1dHRvbnMo
KChOTUhEUiBGQVIgKikgbFBhcmFtKS0+aHduZEZyb20sIFBTV0laQl9ORVhU
KTsKKwkgICAgICB9CisJICAgIGVsc2UgaWYgKElzTGFzdCkKKwkgICAgICB7
CisJCS8vIERpc2FibGUgIk5leHQiLCBlbmFibGUgIkZpbmlzaCIgb24gbGFz
dCBwYWdlCisJCUdldE93bmVyICgpLT5TZXRCdXR0b25zIChQU1dJWkJfQkFD
SyB8IFBTV0laQl9GSU5JU0gpOworCQkvLzo6UHJvcFNoZWV0X1NldFdpekJ1
dHRvbnMoKChOTUhEUiBGQVIgKikgbFBhcmFtKS0+aHduZEZyb20sIFBTV0la
Ql9CQUNLIHwgUFNXSVpCX0ZJTklTSCk7CisJICAgICAgfQorCSAgICBlbHNl
CisJICAgICAgeworCQkvLyBNaWRkbGUgcGFnZSwgZW5hYmxlIGJvdGggIk5l
eHQiIGFuZCAiQmFjayIgYnV0dG9ucworCQlHZXRPd25lciAoKS0+U2V0QnV0
dG9ucyAoUFNXSVpCX0JBQ0sgfCBQU1dJWkJfTkVYVCk7CisJCS8vOjpQcm9w
U2hlZXRfU2V0V2l6QnV0dG9ucygoKE5NSERSIEZBUiAqKSBsUGFyYW0pLT5o
d25kRnJvbSwgUFNXSVpCX0JBQ0sgfCBQU1dJWkJfTkVYVCk7CisJICAgICAg
fQorCisJICAgIE9uQWN0aXZhdGUgKCk7CisKKwkgICAgLy8gMCA9PSBBY2Nl
cHQgYWN0aXZhdGlvbiwgLTEgPSBEb24ndCBhY2NlcHQKKwkgICAgOjpTZXRX
aW5kb3dMb25nIChHZXRIV05EICgpLCBEV0xfTVNHUkVTVUxULCAwKTsKKwkg
ICAgcmV0dXJuIFRSVUU7CisJICB9CisJICBicmVhazsKKwljYXNlIFBTTl9L
SUxMQUNUSVZFOgorCSAgT25EZWFjdGl2YXRlICgpOworCSAgLy8gRkFMU0Ug
PSBBbGxvdyBkZWFjdGl2YXRpb24KKwkgIFNldFdpbmRvd0xvbmcgKEdldEhX
TkQgKCksIERXTF9NU0dSRVNVTFQsIEZBTFNFKTsKKwkgIHJldHVybiBUUlVF
OworCSAgYnJlYWs7CisJY2FzZSBQU05fV0laTkVYVDoKKwkgIHsKKwkgICAg
TE9ORyByZXR2YWw7CisJICAgIHJldHZhbCA9IE9uTmV4dCAoKTsKKwkgICAg
U2V0V2luZG93TG9uZyAoR2V0SFdORCAoKSwgRFdMX01TR1JFU1VMVCwgcmV0
dmFsKTsKKwkgICAgcmV0dXJuIFRSVUU7CisJICB9CisJICBicmVhazsKKwlj
YXNlIFBTTl9XSVpCQUNLOgorCSAgeworCSAgICBMT05HIHJldHZhbDsKKwkg
ICAgcmV0dmFsID0gT25CYWNrICgpOworCSAgICBTZXRXaW5kb3dMb25nIChH
ZXRIV05EICgpLCBEV0xfTVNHUkVTVUxULCByZXR2YWwpOworCSAgICByZXR1
cm4gVFJVRTsKKwkgIH0KKwkgIGJyZWFrOworCWNhc2UgUFNOX1dJWkZJTklT
SDoKKwkgIHJldHZhbCA9IE9uRmluaXNoICgpOworCSAgLy8gRmFsc2UgPSBB
bGxvdyB0aGUgd2l6YXJkIHRvIGZpbmlzaAorCSAgU2V0V2luZG93TG9uZyAo
R2V0SFdORCAoKSwgRFdMX01TR1JFU1VMVCwgRkFMU0UpOworCSAgcmV0dXJu
IFRSVUU7CisJICBicmVhazsKKwlkZWZhdWx0OgorCSAgLy8gVW5yZWNvZ25p
emVkIG5vdGlmaWNhdGlvbgorCSAgcmV0dXJuIEZBTFNFOworCSAgYnJlYWs7
CisJfQorICAgICAgYnJlYWs7CisgICAgY2FzZSBXTV9DT01NQU5EOgorICAg
ICAgaWYgKGNtZHByb2MgIT0gTlVMTCkKKwl7CisJICByZXR1cm4gSEFORExF
X1dNX0NPTU1BTkQgKEdldEhXTkQgKCksIHdQYXJhbSwgbFBhcmFtLCBjbWRw
cm9jKTsKKwl9CisgICAgICBicmVhazsKKyAgICBkZWZhdWx0OgorICAgICAg
YnJlYWs7CisgICAgfQorCisgIGlmICgobWVzc2FnZSA+PSBXTV9BUFApICYm
IChtZXNzYWdlIDwgMHhDMDAwKSkKKyAgICB7CisgICAgICAvLyBJdCdzIGEg
cHJpdmF0ZSBhcHAgbWVzc2FnZQorICAgICAgcmV0dXJuIE9uTWVzc2FnZUFw
cCAobWVzc2FnZSwgd1BhcmFtLCBsUGFyYW0pOworICAgIH0KKworICAvLyBX
YXNuJ3QgaGFuZGxlZAorICByZXR1cm4gRkFMU0U7Cit9CkluZGV4OiBwcm9w
cGFnZS5oCj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KUkNTIGZpbGU6IHByb3Bw
YWdlLmgKZGlmZiAtTiBwcm9wcGFnZS5oCi0tLSAvZGV2L251bGwJVHVlIE1h
eSAgNSAxMzozMjoyNyAxOTk4CisrKyBwcm9wcGFnZS5oCVRodSBEZWMgMjAg
MDQ6MzY6MDIgMjAwMQpAQCAtMCwwICsxLDExNyBAQAorI2lmbmRlZiBDSU5T
VEFMTF9QUk9QUEFHRV9ICisjZGVmaW5lIENJTlNUQUxMX1BST1BQQUdFX0gK
KworLyoKKyAqIENvcHlyaWdodCAoYykgMjAwMSwgR2FyeSBSLiBWYW4gU2lj
a2xlLgorICoKKyAqICAgICBUaGlzIHByb2dyYW0gaXMgZnJlZSBzb2Z0d2Fy
ZTsgeW91IGNhbiByZWRpc3RyaWJ1dGUgaXQgYW5kL29yIG1vZGlmeQorICog
ICAgIGl0IHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUgR05VIEdlbmVyYWwgUHVi
bGljIExpY2Vuc2UgYXMgcHVibGlzaGVkIGJ5CisgKiAgICAgdGhlIEZyZWUg
U29mdHdhcmUgRm91bmRhdGlvbjsgZWl0aGVyIHZlcnNpb24gMiBvZiB0aGUg
TGljZW5zZSwgb3IKKyAqICAgICAoYXQgeW91ciBvcHRpb24pIGFueSBsYXRl
ciB2ZXJzaW9uLgorICoKKyAqICAgICBBIGNvcHkgb2YgdGhlIEdOVSBHZW5l
cmFsIFB1YmxpYyBMaWNlbnNlIGNhbiBiZSBmb3VuZCBhdAorICogICAgIGh0
dHA6Ly93d3cuZ251Lm9yZy8KKyAqCisgKiBXcml0dGVuIGJ5IEdhcnkgUi4g
VmFuIFNpY2tsZSA8Zy5yLnZhbnNpY2tsZUB3b3JsZG5ldC5hdHQubmV0Pgor
ICoKKyAqLworCisvLyBUaGlzIGlzIHRoZSBoZWFkZXIgZm9yIHRoZSBQcm9w
ZXJ0eVBhZ2UgY2xhc3MuICBJdCB3b3JrcyBjbG9zZWx5IHdpdGggdGhlCisv
LyBQcm9wU2hlZXQgY2xhc3MgdG8gaW1wbGVtZW50IGEgc2luZ2xlIHBhZ2Ug
b2YgdGhlIHByb3BlcnR5IHNoZWV0LgorCisKKyNpbmNsdWRlIDx3aW5kb3dz
Lmg+CisjaW5jbHVkZSA8cHJzaHQuaD4KKworI2luY2x1ZGUgIndpbmRvdy5o
IgorCitjbGFzcyBQcm9wU2hlZXQ7CisKK2NsYXNzIFByb3BlcnR5UGFnZTpw
dWJsaWMgV2luZG93Cit7CisgIHN0YXRpYyBib29sIERvT25jZUZvclNoZWV0
OworICBQUk9QU0hFRVRQQUdFIHBzcDsKKyAgRExHUFJPQyBwcm9jOworICAg
IEJPT0wgKCpjbWRwcm9jKSAoSFdORCBoLCBpbnQgaWQsIEhXTkQgaHduZGN0
bCwgVUlOVCBjb2RlKTsKKworICAvLyBUaGUgc2hlZXQgdGhhdCBvd25zIHRo
aXMgcGFnZS4KKyAgUHJvcFNoZWV0ICpPdXJTaGVldDsKKworICAvLyBGb3Ig
c2V0dGluZyB0aGUgYmFjay9maW5pc2ggYnV0dG9ucyBwcm9wZXJseS4KKyAg
Ym9vbCBJc0ZpcnN0LCBJc0xhc3Q7CisKKyAgc3RhdGljIEJPT0wgQ0FMTEJB
Q0sgRmlyc3REaWFsb2dQcm9jUmVmbGVjdG9yIChIV05EIGh3bmQsIFVJTlQg
bWVzc2FnZSwKKwkJCQkJCSBXUEFSQU0gd1BhcmFtLAorCQkJCQkJIExQQVJB
TSBsUGFyYW0pOworICBzdGF0aWMgQk9PTCBDQUxMQkFDSyBEaWFsb2dQcm9j
UmVmbGVjdG9yIChIV05EIGh3bmQsIFVJTlQgbWVzc2FnZSwKKwkJCQkJICAg
IFdQQVJBTSB3UGFyYW0sIExQQVJBTSBsUGFyYW0pOworCitwcm90ZWN0ZWQ6
CisgICAgdmlydHVhbCBCT09MIENBTExCQUNLIERpYWxvZ1Byb2MgKFVJTlQg
bWVzc2FnZSwgV1BBUkFNIHdQYXJhbSwKKwkJCQkgICAgICBMUEFSQU0gbFBh
cmFtKTsKKworcHVibGljOgorICAgIFByb3BlcnR5UGFnZSAoKTsKKyAgICB2
aXJ0dWFsIH4gUHJvcGVydHlQYWdlICgpOworCisgIFBST1BTSEVFVFBBR0Ug
KkdldFBST1BTSEVFVFBBR0VQdHIgKCkKKyAgeworICAgIHJldHVybiAmcHNw
OworICB9OworCisgIC8vIEZJWE1FOiBUaGVzZSBzaG91bGQgYmUgcHJpdmF0
ZSBhbmQgZnJpZW5kZWQgdG8gUHJvcFNoZWV0LgorICB2b2lkIFlvdUFyZUJl
aW5nQWRkZWRUb0FTaGVldCAoUHJvcFNoZWV0ICogcHMpCisgIHsKKyAgICBP
dXJTaGVldCA9IHBzOworICB9OworICB2b2lkIFlvdUFyZUZpcnN0ICgpCisg
IHsKKyAgICBJc0ZpcnN0ID0gdHJ1ZTsKKyAgICBJc0xhc3QgPSBmYWxzZTsK
KyAgfTsKKyAgdm9pZCBZb3VBcmVMYXN0ICgpCisgIHsKKyAgICBJc0ZpcnN0
ID0gZmFsc2U7CisgICAgSXNMYXN0ID0gdHJ1ZTsKKyAgfTsKKyAgdm9pZCBZ
b3VBcmVNaWRkbGUgKCkKKyAgeworICAgIElzRmlyc3QgPSBmYWxzZTsKKyAg
ICBJc0xhc3QgPSBmYWxzZTsKKyAgfTsKKworICB2aXJ0dWFsIGJvb2wgQ3Jl
YXRlIChpbnQgVGVtcGxhdGVJRCk7CisgIHZpcnR1YWwgYm9vbCBDcmVhdGUg
KERMR1BST0MgZGxncHJvYywgaW50IFRlbXBsYXRlSUQpOworICB2aXJ0dWFs
IGJvb2wgQ3JlYXRlIChETEdQUk9DIGRsZ3Byb2MsCisJCSAgICAgICBCT09M
ICgqY21kcHJvYykgKEhXTkQgaCwgaW50IGlkLCBIV05EIGh3bmRjdGwsCisJ
CQkJCVVJTlQgY29kZSksIGludCBUZW1wbGF0ZUlEKTsKKworICB2aXJ0dWFs
IHZvaWQgT25Jbml0ICgpCisgIHsKKyAgfTsKKyAgdmlydHVhbCB2b2lkIE9u
QWN0aXZhdGUgKCkKKyAgeworICB9OworICB2aXJ0dWFsIHZvaWQgT25EZWFj
dGl2YXRlICgpCisgIHsKKyAgfTsKKyAgdmlydHVhbCBsb25nIE9uTmV4dCAo
KQorICB7CisgICAgcmV0dXJuIDA7CisgIH07CisgIHZpcnR1YWwgbG9uZyBP
bkJhY2sgKCkKKyAgeworICAgIHJldHVybiAwOworICB9OworICB2aXJ0dWFs
IGJvb2wgT25GaW5pc2ggKCkKKyAgeworICAgIHJldHVybiB0cnVlOworICB9
OworCisgIFByb3BTaGVldCAqR2V0T3duZXIgKCkgY29uc3QKKyAgeworICAg
IHJldHVybiBPdXJTaGVldDsKKyAgfTsKK307CisKKyNlbmRpZiAvLyBDSU5T
VEFMTF9QUk9QUEFHRV9ICkluZGV4OiBwcm9wc2hlZXQuY2MKPT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PQpSQ1MgZmlsZTogcHJvcHNoZWV0LmNjCmRpZmYgLU4g
cHJvcHNoZWV0LmNjCi0tLSAvZGV2L251bGwJVHVlIE1heSAgNSAxMzozMjoy
NyAxOTk4CisrKyBwcm9wc2hlZXQuY2MJVGh1IERlYyAyMCAwNDozNjowMyAy
MDAxCkBAIC0wLDAgKzEsMjE3IEBACisvKgorICogQ29weXJpZ2h0IChjKSAy
MDAxLCBHYXJ5IFIuIFZhbiBTaWNrbGUuCisgKgorICogICAgIFRoaXMgcHJv
Z3JhbSBpcyBmcmVlIHNvZnR3YXJlOyB5b3UgY2FuIHJlZGlzdHJpYnV0ZSBp
dCBhbmQvb3IgbW9kaWZ5CisgKiAgICAgaXQgdW5kZXIgdGhlIHRlcm1zIG9m
IHRoZSBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBhcyBwdWJsaXNoZWQg
YnkKKyAqICAgICB0aGUgRnJlZSBTb2Z0d2FyZSBGb3VuZGF0aW9uOyBlaXRo
ZXIgdmVyc2lvbiAyIG9mIHRoZSBMaWNlbnNlLCBvcgorICogICAgIChhdCB5
b3VyIG9wdGlvbikgYW55IGxhdGVyIHZlcnNpb24uCisgKgorICogICAgIEEg
Y29weSBvZiB0aGUgR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgY2FuIGJl
IGZvdW5kIGF0CisgKiAgICAgaHR0cDovL3d3dy5nbnUub3JnLworICoKKyAq
IFdyaXR0ZW4gYnkgR2FyeSBSLiBWYW4gU2lja2xlIDxnLnIudmFuc2lja2xl
QHdvcmxkbmV0LmF0dC5uZXQ+CisgKgorICovCisKKy8vIFRoaXMgaXMgdGhl
IGltcGxlbWVudGF0aW9uIG9mIHRoZSBQcm9wU2hlZXQgY2xhc3MuICBUaGlz
IGNsYXNzIGVuY2Fwc3VsYXRlcworLy8gYSBXaW5kb3dzIHByb3BlcnR5IHNo
ZWV0IC8gd2l6YXJkIGFuZCBpbnRlcmZhY2VzIHdpdGggdGhlIFByb3BlcnR5
UGFnZSBjbGFzcy4KKy8vIEl0J3MgbmFtZWQgUHJvcFNoZWV0IGluc3RlYWQg
b2YgUHJvcGVydHlTaGVldCBiZWNhdXNlIHRoZSBsYXR0ZXIgY29uZmxpY3Rz
IHdpdGgKKy8vIHRoZSBXaW5kb3dzIGZ1bmN0aW9uIG9mIHRoZSBzYW1lIG5h
bWUuCisKKyNpbmNsdWRlICJwcm9wc2hlZXQuaCIKKyNpbmNsdWRlICJwcm9w
cGFnZS5oIgorCisvLyNpbmNsdWRlIDxzaGx3YXBpLmg+CisvLyAuLi5idXQg
c2luY2UgdGhlcmUgaXMgbm8gc2hsd2FwaS5oIGluIG1pbmd3IHlldDoKK3R5
cGVkZWYgc3RydWN0IF9EbGxWZXJzaW9uSW5mbworeworICBEV09SRCBjYlNp
emU7CisgIERXT1JEIGR3TWFqb3JWZXJzaW9uOworICBEV09SRCBkd01pbm9y
VmVyc2lvbjsKKyAgRFdPUkQgZHdCdWlsZE51bWJlcjsKKyAgRFdPUkQgZHdQ
bGF0Zm9ybUlEOworfQorRExMVkVSU0lPTklORk87Cit0eXBlZGVmIEhSRVNV
TFQgQ0FMTEJBQ0sgKCpETExHRVRWRVJTSU9OUFJPQykgKERMTFZFUlNJT05J
TkZPICogcGR2aSk7CisjZGVmaW5lIFBST1BTSEVFVEhFQURFUl9WMV9TSVpF
IDQwCisKKworCitQcm9wU2hlZXQ6OlByb3BTaGVldCAoKQoreworICBOdW1Q
cm9wUGFnZXMgPSAwOworfQorCitQcm9wU2hlZXQ6On5Qcm9wU2hlZXQgKCkK
K3sKK30KKworSFBST1BTSEVFVFBBR0UgKgorUHJvcFNoZWV0OjpDcmVhdGVQ
YWdlcyAoKQoreworICBIUFJPUFNIRUVUUEFHRSAqcmV0YXJyYXk7CisKKyAg
Ly8gQ3JlYXRlIHRoZSByZXR1cm4gYXJyYXkKKyAgcmV0YXJyYXkgPSBuZXcg
SFBST1BTSEVFVFBBR0VbTnVtUHJvcFBhZ2VzXTsKKworICAvLyBDcmVhdGUg
dGhlIHBhZ2VzIHdpdGggQ3JlYXRlUHJvcGVydHlTaGVldFBhZ2UoKS4KKyAg
Ly8gV2UgZG8gaXQgaGVyZSByYXRoZXIgdGhhbiBpbiB0aGUgUHJvcGVydHlQ
YWdlcyB0aGVtc2VsdmVzCisgIC8vIGJlY2F1c2UsIGZvciByZWFzb25zIGtu
b3duIG9ubHkgdG8gTWljcm9zb2Z0LCB0aGVzZSBoYW5kbGVzIHdpbGwgYmUK
KyAgLy8gZGVzdHJveWVkIGJ5IHRoZSBwcm9wZXJ0eSBzaGVldCBiZWZvcmUg
dGhlIFByb3BlcnR5U2hlZXQoKSBjYWxsIHJldHVybnMsCisgIC8vIGF0IGxl
YXN0IGlmIGl0J3MgbW9kYWwgKGRvbid0IGtub3cgYWJvdXQgbW9kZWxlc3Mp
LgorICBpbnQgaTsKKyAgZm9yIChpID0gMDsgaSA8IE51bVByb3BQYWdlczsg
aSsrKQorICAgIHsKKyAgICAgIHJldGFycmF5W2ldID0KKwlDcmVhdGVQcm9w
ZXJ0eVNoZWV0UGFnZSAoUHJvcGVydHlQYWdlc1tpXS0+R2V0UFJPUFNIRUVU
UEFHRVB0ciAoKSk7CisKKyAgICAgIC8vIFNldCBwb3NpdGlvbiBpbmZvCisg
ICAgICBpZiAoaSA9PSAwKQorCXsKKwkgIFByb3BlcnR5UGFnZXNbaV0tPllv
dUFyZUZpcnN0ICgpOworCX0KKyAgICAgIGVsc2UgaWYgKGkgPT0gTnVtUHJv
cFBhZ2VzIC0gMSkKKwl7CisJICBQcm9wZXJ0eVBhZ2VzW2ldLT5Zb3VBcmVM
YXN0ICgpOworCX0KKyAgICAgIGVsc2UKKwl7CisJICBQcm9wZXJ0eVBhZ2Vz
W2ldLT5Zb3VBcmVNaWRkbGUgKCk7CisJfQorICAgIH0KKworICByZXR1cm4g
cmV0YXJyYXk7Cit9CisKK3N0YXRpYyBEV09SRAorR2V0UFJPUFNIRUVUSEVB
REVSU2l6ZSAoKQoreworICAvLyBGb3IgY29tcGF0aWJpbGl0eSB3aXRoIGFs
bCB2ZXJzaW9ucyBvZiBjb21jdGwzMi5kbGwsIHdlIGhhdmUgdG8gZG8gdGhp
cy4KKworICBETExWRVJTSU9OSU5GTyB2aTsKKyAgSE1PRFVMRSBtb2Q7Cisg
IERMTEdFVFZFUlNJT05QUk9DIERsbEdldFZlcnNpb247CisgIERXT1JEIHJl
dHZhbCA9IDA7CisKKworICAvLyBUaGlzICdpc24ndCBzYWZlJyBpbiBhIERM
TCwgYWNjb3JkaW5nIHRvIE1TRE4KKyAgbW9kID0gTG9hZExpYnJhcnkgKCJj
b21jdGwzMi5kbGwiKTsKKworICBEbGxHZXRWZXJzaW9uID0gKERMTEdFVFZF
UlNJT05QUk9DKSBHZXRQcm9jQWRkcmVzcyAobW9kLCAiRGxsR2V0VmVyc2lv
biIpOworICBpZiAoRGxsR2V0VmVyc2lvbiA9PSBOVUxMKQorICAgIHsKKyAg
ICAgIC8vIFNvbWV0aGluZydzIHdpbGRseSBicm9rZW4sIHB1bnQuCisgICAg
ICByZXR2YWwgPSBQUk9QU0hFRVRIRUFERVJfVjFfU0laRTsKKyAgICB9Cisg
IGVsc2UKKyAgICB7CisgICAgICB2aS5jYlNpemUgPSBzaXplb2YgKERMTFZF
UlNJT05JTkZPKTsKKyAgICAgIERsbEdldFZlcnNpb24gKCZ2aSk7CisKKyAg
ICAgIGlmICgodmkuZHdNYWpvclZlcnNpb24gPCA0KSB8fAorCSAgKCh2aS5k
d01ham9yVmVyc2lvbiA9PSA0KSAmJiAodmkuZHdNaW5vclZlcnNpb24gPCA3
MSkpKQorCXsKKwkgIC8vIFJlY2VudC4KKwkgIHJldHZhbCA9IHNpemVvZiAo
UFJPUFNIRUVUSEVBREVSKTsKKwl9CisgICAgICBlbHNlCisJeworCSAgLy8g
T2xkICg9PSBXaW45NS9OVDQgdy9vIElFIDQgb3IgYmV0dGVyKQorCSAgcmV0
dmFsID0gUFJPUFNIRUVUSEVBREVSX1YxX1NJWkU7CisJfQorICAgIH0KKwor
ICBGcmVlTGlicmFyeSAobW9kKTsKKworICByZXR1cm4gcmV0dmFsOworfQor
Citib29sCitQcm9wU2hlZXQ6OkNyZWF0ZSAoY29uc3QgV2luZG93ICogUGFy
ZW50LCBEV09SRCBTdHlsZSkKK3sKKyAgUFJPUFNIRUVUSEVBREVSIHA7CisK
KyAgUGFnZUhhbmRsZXMgPSBDcmVhdGVQYWdlcyAoKTsKKworICBwLmR3U2l6
ZSA9IEdldFBST1BTSEVFVEhFQURFUlNpemUgKCk7CisgIHAuZHdGbGFncyA9
IFBTSF9OT0FQUExZTk9XIHwgUFNIX1dJWkFSRCAvKnwgUFNIX01PREVMRVNT
ICovIDsKKyAgaWYgKFBhcmVudCAhPSBOVUxMKQorICAgIHsKKyAgICAgIHAu
aHduZFBhcmVudCA9IFBhcmVudC0+R2V0SFdORCAoKTsKKyAgICB9CisgIGVs
c2UKKyAgICB7CisgICAgICBwLmh3bmRQYXJlbnQgPSBOVUxMOworICAgIH0K
KyAgcC5oSW5zdGFuY2UgPSBHZXRJbnN0YW5jZSAoKTsKKyAgcC5uUGFnZXMg
PSBOdW1Qcm9wUGFnZXM7CisgIHAublN0YXJ0UGFnZSA9IDA7CisgIHAucGhw
YWdlID0gUGFnZUhhbmRsZXM7CisgIHAucGZuQ2FsbGJhY2sgPSBOVUxMOwor
CisKKyAgUHJvcGVydHlTaGVldCAoJnApOworCisgIC8vIERvIGEgbW9kZWxl
c3MgcHJvcGVydHkgc2hlZXQuLi4KKyAgLy9TZXRIV05EKChIV05EKVByb3Bl
cnR5U2hlZXQoJnApKTsKKyAgLypTaG93KFNXX1NIT1dOT1JNQUwpOworCisg
ICAgIC8vIC4uLmJ1dCBwcmV0ZW5kIGl0J3MgbW9kYWwKKyAgICAgTWVzc2Fn
ZUxvb3AoKTsKKyAgICAgTWVzc2FnZUJveChOVUxMLCAiRE9ORSIsIE5VTEws
IE1CX09LKTsKKworICAgICAvLyBGSVhNRTogRW5hYmxlIHRoZSBwYXJlbnQg
YmVmb3JlIGRlc3Ryb3lpbmcgdGhpcyB3aW5kb3cgdG8gcHJldmVudCBhbm90
aGVyIHdpbmRvdworICAgICAvLyBmcm9tIGJlY29taW5nIHRoZSBmb3JlZ3Jv
dW5kIHdpbmRvdworICAgICAvLyBhbGE6IEVuYWJsZVdpbmRvdyg8cGFyZW50
X2h3bmQ+LCBUUlVFKTsKKyAgICAgLy9EZXN0cm95V2luZG93KFdpbmRvd0hh
bmRsZSk7CisgICAqLworICBTZXRIV05EIChOVUxMKTsKKworCisgIHJldHVy
biB0cnVlOworfQorCit2b2lkCitQcm9wU2hlZXQ6OlNldEhXTkRGcm9tUGFn
ZSAoSFdORCBoKQoreworICAvLyBJZiB3ZSdyZSBhIG1vZGFsIGRpYWxvZywg
dGhlcmUncyBubyB3YXkgZm9yIHVzIHRvIGtub3cgb3VyIHdpbmRvdyBoYW5k
bGUgdW5sZXNzCisgIC8vIG9uZSBvZiBvdXIgcGFnZXMgdGVsbHMgdXMgdGhy
b3VnaCB0aGlzIGZ1bmN0aW9uLgorICBTZXRIV05EIChoKTsKK30KKwordm9p
ZAorUHJvcFNoZWV0OjpBZGRQYWdlIChQcm9wZXJ0eVBhZ2UgKiBwKQorewor
ICAvLyBBZGQgYSBwYWdlIHRvIHRoZSBwcm9wZXJ0eSBzaGVldC4KKyAgcC0+
WW91QXJlQmVpbmdBZGRlZFRvQVNoZWV0ICh0aGlzKTsKKyAgUHJvcGVydHlQ
YWdlc1tOdW1Qcm9wUGFnZXNdID0gcDsKKyAgTnVtUHJvcFBhZ2VzKys7Cit9
CisKK2Jvb2wKK1Byb3BTaGVldDo6U2V0QWN0aXZlUGFnZSAoaW50IGkpCit7
CisgIC8vIFBvc3RzIGEgbWVzc2FnZSB0byB0aGUgbWVzc2FnZSBxdWV1ZSwg
c28gdGhpcyB3b24ndCBibG9jaworICByZXR1cm4gc3RhdGljX2Nhc3QgPCBi
b29sID4gKDo6UHJvcFNoZWV0X1NldEN1clNlbCAoR2V0SFdORCAoKSwgTlVM
TCwgaSkpOworfQorCitib29sCitQcm9wU2hlZXQ6OlNldEFjdGl2ZVBhZ2VC
eUlEIChpbnQgcmVzb3VyY2VfaWQpCit7CisgIC8vIFBvc3RzIGEgbWVzc2Fn
ZSB0byB0aGUgbWVzc2FnZSBxdWV1ZSwgc28gdGhpcyB3b24ndCBibG9jawor
ICByZXR1cm4gc3RhdGljX2Nhc3QgPCBib29sID4KKyAgICAoOjpQcm9wU2hl
ZXRfU2V0Q3VyU2VsQnlJRCAoR2V0SFdORCAoKSwgcmVzb3VyY2VfaWQpKTsK
K30KKwordm9pZAorUHJvcFNoZWV0OjpTZXRCdXR0b25zIChEV09SRCBmbGFn
cykKK3sKKyAgLy8gUG9zdHMgYSBtZXNzYWdlIHRvIHRoZSBtZXNzYWdlIHF1
ZXVlLCBzbyB0aGlzIHdvbid0IGJsb2NrCisgIDo6UHJvcFNoZWV0X1NldFdp
ekJ1dHRvbnMgKEdldEhXTkQgKCksIGZsYWdzKTsKK30KKwordm9pZAorUHJv
cFNoZWV0OjpQcmVzc0J1dHRvbiAoaW50IGJ1dHRvbikKK3sKKyAgOjpQcm9w
U2hlZXRfUHJlc3NCdXR0b24gKEdldEhXTkQgKCksIGJ1dHRvbik7Cit9Cklu
ZGV4OiBwcm9wc2hlZXQuaAo9PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09ClJDUyBm
aWxlOiBwcm9wc2hlZXQuaApkaWZmIC1OIHByb3BzaGVldC5oCi0tLSAvZGV2
L251bGwJVHVlIE1heSAgNSAxMzozMjoyNyAxOTk4CisrKyBwcm9wc2hlZXQu
aAlUaHUgRGVjIDIwIDA0OjM2OjAzIDIwMDEKQEAgLTAsMCArMSw1OSBAQAor
I2lmbmRlZiBDSU5TVEFMTF9QUk9QU0hFRVRfSAorI2RlZmluZSBDSU5TVEFM
TF9QUk9QU0hFRVRfSAorCisvKgorICogQ29weXJpZ2h0IChjKSAyMDAxLCBH
YXJ5IFIuIFZhbiBTaWNrbGUuCisgKgorICogICAgIFRoaXMgcHJvZ3JhbSBp
cyBmcmVlIHNvZnR3YXJlOyB5b3UgY2FuIHJlZGlzdHJpYnV0ZSBpdCBhbmQv
b3IgbW9kaWZ5CisgKiAgICAgaXQgdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBH
TlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBhcyBwdWJsaXNoZWQgYnkKKyAq
ICAgICB0aGUgRnJlZSBTb2Z0d2FyZSBGb3VuZGF0aW9uOyBlaXRoZXIgdmVy
c2lvbiAyIG9mIHRoZSBMaWNlbnNlLCBvcgorICogICAgIChhdCB5b3VyIG9w
dGlvbikgYW55IGxhdGVyIHZlcnNpb24uCisgKgorICogICAgIEEgY29weSBv
ZiB0aGUgR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgY2FuIGJlIGZvdW5k
IGF0CisgKiAgICAgaHR0cDovL3d3dy5nbnUub3JnLworICoKKyAqIFdyaXR0
ZW4gYnkgR2FyeSBSLiBWYW4gU2lja2xlIDxnLnIudmFuc2lja2xlQHdvcmxk
bmV0LmF0dC5uZXQ+CisgKgorICovCisKKy8vIFRoaXMgaXMgdGhlIGhlYWRl
ciBmb3IgdGhlIFByb3BTaGVldCBjbGFzcy4gIFRoaXMgY2xhc3MgZW5jYXBz
dWxhdGVzCisvLyBhIFdpbmRvd3MgcHJvcGVydHkgc2hlZXQgLyB3aXphcmQg
YW5kIGludGVyZmFjZXMgd2l0aCB0aGUgUHJvcGVydHlQYWdlIGNsYXNzLgor
Ly8gSXQncyBuYW1lZCBQcm9wU2hlZXQgaW5zdGVhZCBvZiBQcm9wZXJ0eVNo
ZWV0IGJlY2F1c2UgdGhlIGxhdHRlciBjb25mbGljdHMgd2l0aAorLy8gdGhl
IFdpbmRvd3MgZnVuY3Rpb24gb2YgdGhlIHNhbWUgbmFtZS4KKworCisjaW5j
bHVkZSA8d2luZG93cy5oPgorI2luY2x1ZGUgPHByc2h0Lmg+CisKKyNpbmNs
dWRlICJ3aW5kb3cuaCIKKworY2xhc3MgUHJvcGVydHlQYWdlOworCitjbGFz
cyBQcm9wU2hlZXQ6cHVibGljIFdpbmRvdworeworICBQcm9wZXJ0eVBhZ2Ug
KlByb3BlcnR5UGFnZXNbTUFYUFJPUFBBR0VTXTsKKyAgaW50IE51bVByb3BQ
YWdlczsKKworICBIUFJPUFNIRUVUUEFHRSAqUGFnZUhhbmRsZXM7CisgIEhQ
Uk9QU0hFRVRQQUdFICpDcmVhdGVQYWdlcyAoKTsKKworcHVibGljOgorICAg
IFByb3BTaGVldCAoKTsKKyAgICB2aXJ0dWFsIH4gUHJvcFNoZWV0ICgpOwor
CisgIC8vIFNob3VsZCBiZSBwcml2YXRlIGFuZCBmcmllbmRlZCB0byBQcm9w
ZXJ0eVBhZ2UKKyAgdm9pZCBTZXRIV05ERnJvbVBhZ2UgKEhXTkQgaCk7CisK
KyAgdmlydHVhbCBib29sIENyZWF0ZSAoY29uc3QgV2luZG93ICogUGFyZW50
ID0gTlVMTCwKKwkJICAgICAgIERXT1JEIFN0eWxlID0KKwkJICAgICAgIFdT
X09WRVJMQVBQRURXSU5ET1cgfCBXU19WSVNJQkxFIHwgV1NfQ0xJUENISUxE
UkVOKTsKKworICB2b2lkIEFkZFBhZ2UgKFByb3BlcnR5UGFnZSAqIHApOwor
CisgIGJvb2wgU2V0QWN0aXZlUGFnZSAoaW50IGkpOworICBib29sIFNldEFj
dGl2ZVBhZ2VCeUlEIChpbnQgcmVzb3VyY2VfaWQpOworICB2b2lkIFNldEJ1
dHRvbnMgKERXT1JEIGZsYWdzKTsKKyAgdm9pZCBQcmVzc0J1dHRvbiAoaW50
IGJ1dHRvbik7Cit9OworCisjZW5kaWYgLy8gQ0lOU1RBTExfUFJPUFNIRUVU
X0gKSW5kZXg6IHJlcy5yYwo9PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09ClJDUyBm
aWxlOiAvY3ZzL3NyYy9zcmMvd2luc3VwL2NpbnN0YWxsL3Jlcy5yYyx2CnJl
dHJpZXZpbmcgcmV2aXNpb24gMi4zMQpkaWZmIC11IC1wIC1yMi4zMSByZXMu
cmMKLS0tIHJlcy5yYwkyMDAxLzEyLzAzIDIyOjIyOjA5CTIuMzEKKysrIHJl
cy5yYwkyMDAxLzEyLzIwIDEyOjM2OjAzCkBAIC0yOSw3ICsyOSw3IEBAIExB
TkdVQUdFIExBTkdfRU5HTElTSCwgU1VCTEFOR19FTkdMSVNIX1UKIC8vCiAK
IElERF9TT1VSQ0UgRElBTE9HIERJU0NBUkRBQkxFICAwLCAwLCAyMTUsIDk1
Ci1TVFlMRSBEU19NT0RBTEZSQU1FIHwgRFNfQ0VOVEVSIHwgV1NfUE9QVVAg
fCBXU19DQVBUSU9OIHwgV1NfU1lTTUVOVQorU1RZTEUgRFNfTU9EQUxGUkFN
RSB8IERTX0NFTlRFUiB8IFdTX0NISUxEIHwgV1NfQ0FQVElPTiB8IFdTX1NZ
U01FTlUKIENBUFRJT04gIkN5Z3dpbiBTZXR1cCIKIEZPTlQgOCwgIk1TIFNh
bnMgU2VyaWYiCiBCRUdJTgpAQCAtNDAsMjYgKzQwLDIxIEBAIEJFR0lOCiAg
ICAgICAgICAgICAgICAgICAgIEJTX0FVVE9SQURJT0JVVFRPTiw1NSwzMCw4
OSwxMAogICAgIENPTlRST0wgICAgICAgICAiSW5zdGFsbCBmcm9tICZMb2Nh
bCBEaXJlY3RvcnkiLElEQ19TT1VSQ0VfQ1dELCJCdXR0b24iLAogICAgICAg
ICAgICAgICAgICAgICBCU19BVVRPUkFESU9CVVRUT04sNTUsNDUsOTksMTAK
LSAgICBERUZQVVNIQlVUVE9OICAgIiZOZXh0IC0tPiIsSURPSywxMDAsNzUs
NDUsMTUKLSAgICBQVVNIQlVUVE9OICAgICAgIkNhbmNlbCIsSURDQU5DRUws
MTY1LDc1LDQ1LDE1CiBFTkQKIAotSUREX0xPQ0FMX0RJUiBESUFMT0cgRElT
Q0FSREFCTEUgIDAsIDAsIDIxNSwgOTUKLVNUWUxFIERTX01PREFMRlJBTUUg
fCBEU19DRU5URVIgfCBXU19QT1BVUCB8IFdTX0NBUFRJT04gfCBXU19TWVNN
RU5VCitJRERfTE9DQUxfRElSIERJQUxPRyBESVNDQVJEQUJMRSAgMCwgMCwg
MjI3LCA5NAorU1RZTEUgRFNfTU9EQUxGUkFNRSB8IERTX0NFTlRFUiB8IFdT
X0NISUxEIHwgV1NfQ0FQVElPTiB8IFdTX1NZU01FTlUKIENBUFRJT04gIkN5
Z3dpbiBTZXR1cCIKIEZPTlQgOCwgIk1TIFNhbnMgU2VyaWYiCiBCRUdJTgog
ICAgIElDT04gICAgICAgICAgICBJRElfQ1lHV0lOLElEQ19TVEFUSUMsNSw1
LDIwLDIwCi0gICAgUFVTSEJVVFRPTiAgICAgICJCJnJvd3NlLi4uIixJRENf
TE9DQUxfRElSX0JST1dTRSwxNTAsMTAsMzQsMTQKKyAgICBQVVNIQlVUVE9O
ICAgICAgIkImcm93c2UuLi4iLElEQ19MT0NBTF9ESVJfQlJPV1NFLDE4NSwz
MCwzNCwxNAogICAgIExURVhUICAgICAgICAgICAiTG9jYWwgUGFja2FnZSAm
RGlyZWN0b3J5IixJRENfU1RBVElDLDU1LDE1LDg1LDExCi0gICAgRURJVFRF
WFQgICAgICAgIElEQ19MT0NBTF9ESVIsNTUsMjUsMTI3LDEyLEVTX0FVVE9I
U0NST0xMCi0gICAgREVGUFVTSEJVVFRPTiAgICImTmV4dCAtLT4iLElET0ss
MTAwLDc1LDQ1LDE1Ci0gICAgUFVTSEJVVFRPTiAgICAgICJDYW5jZWwiLElE
Q0FOQ0VMLDE2NSw3NSw0NSwxNQotICAgIFBVU0hCVVRUT04gICAgICAiPC0t
ICZCYWNrIixJRENfQkFDSyw1NSw3NSw0NSwxNQorICAgIEVESVRURVhUICAg
ICAgICBJRENfTE9DQUxfRElSLDU1LDMwLDEyNywxNSxFU19BVVRPSFNDUk9M
TAogRU5ECiAKIElERF9ST09UIERJQUxPRyBESVNDQVJEQUJMRSAgMCwgMCwg
MjE1LCA5NQotU1RZTEUgRFNfTU9EQUxGUkFNRSB8IERTX0NFTlRFUiB8IFdT
X1BPUFVQIHwgV1NfQ0FQVElPTiB8IFdTX1NZU01FTlUKK1NUWUxFIERTX01P
REFMRlJBTUUgfCBEU19DRU5URVIgfCBXU19DSElMRCB8IFdTX0NBUFRJT04g
fCBXU19TWVNNRU5VCiBDQVBUSU9OICJDeWd3aW4gU2V0dXAiCiBGT05UIDgs
ICJNUyBTYW5zIFNlcmlmIgogQkVHSU4KQEAgLTc3LDIzICs3MiwxNyBAQCBC
RUdJTgogICAgICAgICAgICAgICAgICAgICBXU19HUk9VUCwxMjUsNjAsMjUs
OAogICAgIENPTlRST0wgICAgICAgICAiSnVzdCAmTWUiLElEQ19ST09UX1VT
RVIsIkJ1dHRvbiIsQlNfQVVUT1JBRElPQlVUVE9OLDE2MCwKICAgICAgICAg
ICAgICAgICAgICAgNjAsNTAsOAotICAgIERFRlBVU0hCVVRUT04gICAiJk5l
eHQgLS0+IixJRE9LLDEwMCw3NSw0NSwxNQotICAgIFBVU0hCVVRUT04gICAg
ICAiQ2FuY2VsIixJRENBTkNFTCwxNjUsNzUsNDUsMTUKLSAgICBQVVNIQlVU
VE9OICAgICAgIjwtLSAmQmFjayIsSURDX0JBQ0ssNTUsNzUsNDUsMTUKIEVO
RAogCi1JRERfU0lURSBESUFMT0cgRElTQ0FSREFCTEUgIDAsIDAsIDIyMiwg
MjA2Ci1TVFlMRSBEU19NT0RBTEZSQU1FIHwgRFNfQ0VOVEVSIHwgV1NfUE9Q
VVAgfCBXU19DQVBUSU9OIHwgV1NfU1lTTUVOVQorSUREX1NJVEUgRElBTE9H
IERJU0NBUkRBQkxFICAwLCAwLCAyNDcsIDk0CitTVFlMRSBEU19NT0RBTEZS
QU1FIHwgRFNfQ0VOVEVSIHwgV1NfQ0hJTEQgfCBXU19DQVBUSU9OIHwgV1Nf
U1lTTUVOVQogQ0FQVElPTiAiQ3lnd2luIFNldHVwIgogRk9OVCA4LCAiTVMg
U2FucyBTZXJpZiIKIEJFR0lOCiAgICAgSUNPTiAgICAgICAgICAgIElESV9D
WUdXSU4sSURDX1NUQVRJQyw1LDUsMjAsMjAKLSAgICBMVEVYVCAgICAgICAg
ICAgIlNlbGVjdCBEb3dubG9hZCAmU2l0ZXMiLElEQ19TVEFUSUMsNTUsNSwx
MzUsMTEKLSAgICBMSVNUQk9YICAgICAgICAgSURDX1VSTF9MSVNULDU1LDIw
LDE2MCwxNTUsTEJTX05PSU5URUdSQUxIRUlHSFQgfCAKLSAgICAJCSAgICBM
QlNfRVhURU5ERURTRUwgfCBXU19WU0NST0xMIHwgV1NfSFNDUk9MTCB8IFdT
X1RBQlNUT1AKLSAgICBERUZQVVNIQlVUVE9OICAgIiZOZXh0IC0tPiIsSURP
SywxMDUsMTg1LDQ1LDE1Ci0gICAgUFVTSEJVVFRPTiAgICAgICJDYW5jZWwi
LElEQ0FOQ0VMLDE3MCwxODUsNDUsMTUKLSAgICBQVVNIQlVUVE9OICAgICAg
IjwtLSAmQmFjayIsSURDX0JBQ0ssNjAsMTg1LDQ1LDE1CisgICAgTFRFWFQg
ICAgICAgICAgICJTZWxlY3QgRG93bmxvYWQgJlNpdGUiLElEQ19TVEFUSUMs
NTUsNSwxMzUsMTEKKyAgICBMSVNUQk9YICAgICAgICAgSURDX1VSTF9MSVNU
LDU1LDIwLDE4NSw2NSxMQlNfTk9JTlRFR1JBTEhFSUdIVCB8IAorICAgICAg
ICAgICAgICAgICAgICBMQlNfRVhURU5ERURTRUwgfCBXU19WU0NST0xMIHwg
V1NfSFNDUk9MTCB8IFdTX1RBQlNUT1AKIEVORAogCiBJRERfT1RIRVJfVVJM
IERJQUxPRyBESVNDQVJEQUJMRSAgMCwgMCwgMjE1LCA5NQpAQCAtMTA5LDMy
ICs5OCwzMSBAQCBCRUdJTgogICAgIFBVU0hCVVRUT04gICAgICAiPC0tICZC
YWNrIixJRENfQkFDSyw1NSw3NSw0NSwxNQogRU5ECiAKLUlERF9ORVQgRElB
TE9HRVggMCwgMCwgMjE1LCA5NQotU1RZTEUgRFNfTU9EQUxGUkFNRSB8IERT
X0NFTlRFUiB8IFdTX1BPUFVQIHwgV1NfQ0FQVElPTiB8IFdTX1NZU01FTlUK
K0lERF9ORVQgRElBTE9HIERJU0NBUkRBQkxFICAwLCAwLCAyNDcsIDEwNgor
U1RZTEUgRFNfTU9EQUxGUkFNRSB8IERTX0NFTlRFUiB8IFdTX0NISUxEIHwg
V1NfQ0FQVElPTiB8IFdTX1NZU01FTlUKIENBUFRJT04gIkN5Z3dpbiBTZXR1
cCIKIEZPTlQgOCwgIk1TIFNhbnMgU2VyaWYiCiBCRUdJTgotICAgIElDT04g
ICAgICAgICAgICBJRElfQ1lHV0lOLElEQ19TVEFUSUMsNSw1LDIwLDIwCiAg
ICAgQ09OVFJPTCAgICAgICAgICImRGlyZWN0IENvbm5lY3Rpb24iLElEQ19O
RVRfRElSRUNULCJCdXR0b24iLAotICAgICAgICAgICAgICAgICAgICBCU19B
VVRPUkFESU9CVVRUT04sNTUsMTAsNzMsMTAKKyAgICAgICAgICAgICAgICAg
ICAgQlNfQVVUT1JBRElPQlVUVE9OIHwgV1NfR1JPVVAgfCBXU19UQUJTVE9Q
LDU1LDEwLDczLDEwCiAgICAgQ09OVFJPTCAgICAgICAgICJVc2UgJklFNSBT
ZXR0aW5ncyIsSURDX05FVF9JRTUsIkJ1dHRvbiIsCi0gICAgICAgICAgICAg
ICAgICAgIEJTX0FVVE9SQURJT0JVVFRPTiw1NSwyNSw2OSwxMAorICAgICAg
ICAgICAgICAgICAgICBCU19BVVRPUkFESU9CVVRUT04gfCBXU19UQUJTVE9Q
LDU1LDI1LDY5LDEwCiAgICAgQ09OVFJPTCAgICAgICAgICJVc2UgSFRUUC9G
VFAgJlByb3h5OiIsSURDX05FVF9QUk9YWSwiQnV0dG9uIiwKLSAgICAgICAg
ICAgICAgICAgICAgQlNfQVVUT1JBRElPQlVUVE9OLDU1LDQwLDg4LDEwCi0g
ICAgTFRFWFQgICAgICAgICAgICJQcm94eSAmSG9zdCIsSURDX1NUQVRJQywx
MCw1NSw1MCwxNSxTU19DRU5URVJJTUFHRSwKLSAgICAgICAgICAgICAgICAg
ICAgV1NfRVhfUklHSFQKLSAgICBFRElUVEVYVCAgICAgICAgSURDX1BST1hZ
X0hPU1QsNjUsNTUsODAsMTIsRVNfQVVUT0hTQ1JPTEwgfCBXU19ESVNBQkxF
RAotICAgIExURVhUICAgICAgICAgICAiUG9yJnQiLElEQ19TVEFUSUMsMTU1
LDU1LDIwLDE1LFNTX0NFTlRFUklNQUdFLAotICAgICAgICAgICAgICAgICAg
ICBXU19FWF9SSUdIVAotICAgIEVESVRURVhUICAgICAgICBJRENfUFJPWFlf
UE9SVCwxODAsNTUsMzAsMTIsRVNfQVVUT0hTQ1JPTEwgfCBXU19ESVNBQkxF
RAotICAgIERFRlBVU0hCVVRUT04gICAiJk5leHQgLS0+IixJRE9LLDEwMCw3
NSw0NSwxNQotICAgIFBVU0hCVVRUT04gICAgICAiQ2FuY2VsIixJRENBTkNF
TCwxNjUsNzUsNDUsMTUKLSAgICBQVVNIQlVUVE9OICAgICAgIjwtLSAmQmFj
ayIsSURDX0JBQ0ssNTUsNzUsNDUsMTUKKyAgICAgICAgICAgICAgICAgICAg
QlNfQVVUT1JBRElPQlVUVE9OIHwgV1NfVEFCU1RPUCw1NSw0MCw4OCwxMAor
ICAgIEVESVRURVhUICAgICAgICBJRENfUFJPWFlfSE9TVCwxMTUsNjAsMTIw
LDEyLEVTX0FVVE9IU0NST0xMIHwgCisgICAgICAgICAgICAgICAgICAgIFdT
X0RJU0FCTEVEIHwgV1NfR1JPVVAKKyAgICBFRElUVEVYVCAgICAgICAgSURD
X1BST1hZX1BPUlQsMTE1LDgwLDMwLDEyLEVTX0FVVE9IU0NST0xMIHwgV1Nf
RElTQUJMRUQKKyAgICBHUk9VUEJPWCAgICAgICAgIiIsSURDX1NUQVRJQyw1
NSw1MCwxODUsNTAKKyAgICBJQ09OICAgICAgICAgICAgSURJX0NZR1dJTixJ
RENfU1RBVElDLDUsNSwyMSwyMAorICAgIFJURVhUICAgICAgICAgICAiUHJv
eHkgJkhvc3QiLElEQ19TVEFUSUMsNjAsNjAsNTAsMTIsU1NfQ0VOVEVSSU1B
R0UgfCAKKyAgICAgICAgICAgICAgICAgICAgTk9UIFdTX0dST1VQCisgICAg
UlRFWFQgICAgICAgICAgICJQb3ImdCIsSURDX1NUQVRJQyw4MCw4MCwzMCwx
MixTU19DRU5URVJJTUFHRSB8IE5PVCAKKyAgICAgICAgICAgICAgICAgICAg
V1NfR1JPVVAKIEVORAogCiBJRERfRExTVEFUVVMgRElBTE9HIERJU0NBUkRB
QkxFICAwLCAwLCAyMTUsIDk1Ci1TVFlMRSBEU19NT0RBTEZSQU1FIHwgRFNf
U0VURk9SRUdST1VORCB8IERTX0NFTlRFUiB8IFdTX1BPUFVQIHwgV1NfVklT
SUJMRSB8IAotICAgIFdTX0NBUFRJT04gfCBXU19TWVNNRU5VCitTVFlMRSBE
U19NT0RBTEZSQU1FIHwgRFNfQ0VOVEVSIHwgV1NfQ0hJTEQgfCBXU19WSVNJ
QkxFIHwgV1NfQ0FQVElPTiB8IAorICAgIFdTX1NZU01FTlUKIENBUFRJT04g
IkN5Z3dpbiBTZXR1cCIKIEZPTlQgOCwgIk1TIFNhbnMgU2VyaWYiCiBCRUdJ
TgpAQCAtMTU0LDI2ICsxNDIsMjUgQEAgQkVHSU4KICAgICBSVEVYVCAgICAg
ICAgICAgIkRpc2siLElEQ19ETFNfSVBST0dSRVNTX1RFWFQsNSw2MCw0NSw4
CiBFTkQKIAotSUREX0lOU1RBVFVTIERJQUxPRyBESVNDQVJEQUJMRSAgMCwg
MCwgMjE1LCA5NQotU1RZTEUgRFNfTU9EQUxGUkFNRSB8IERTX1NFVEZPUkVH
Uk9VTkQgfCBEU19DRU5URVIgfCBXU19QT1BVUCB8IFdTX1ZJU0lCTEUgfCAK
LSAgICBXU19DQVBUSU9OIHwgV1NfU1lTTUVOVQorSUREX0lOU1RBVFVTIERJ
QUxPRyBESVNDQVJEQUJMRSAgMCwgMCwgMjUyLCA5NAorU1RZTEUgRFNfTU9E
QUxGUkFNRSB8IERTX0NFTlRFUiB8IFdTX0NISUxEIHwgV1NfVklTSUJMRSB8
IFdTX0NBUFRJT04gfCAKKyAgICBXU19TWVNNRU5VCiBDQVBUSU9OICJDeWd3
aW4gU2V0dXAiCiBGT05UIDgsICJNUyBTYW5zIFNlcmlmIgogQkVHSU4KLSAg
ICBJQ09OICAgICAgICAgICAgSURJX0NZR1dJTixJRENfU1RBVElDLDUsNSwy
MCwyMAotICAgIFBVU0hCVVRUT04gICAgICAiQ2FuY2VsIixJRENBTkNFTCwx
NjUsNzUsNDUsMTUKKyAgICBJQ09OICAgICAgICAgICAgSURJX0NZR1dJTixJ
RENfU1RBVElDLDUsNSwyMSwyMAogICAgIExURVhUICAgICAgICAgICAiSW5z
dGFsbGluZy4uLiIsSURDX0lOU19BQ1RJT04sNTUsNSwxMzUsOAogICAgIExU
RVhUICAgICAgICAgICAiKFBLRykiLElEQ19JTlNfUEtHLDU1LDE1LDE1MCw4
CiAgICAgTFRFWFQgICAgICAgICAgICIoRklMRSkiLElEQ19JTlNfRklMRSw1
NSwyNSwxNTUsOAogICAgIENPTlRST0wgICAgICAgICAiUHJvZ3Jlc3MxIixJ
RENfSU5TX0RJU0tGVUxMLCJtc2N0bHNfcHJvZ3Jlc3MzMiIsCi0gICAgICAg
ICAgICAgICAgICAgIFBCU19TTU9PVEggfCBXU19CT1JERVIsNTUsNjAsMTU1
LDEwCisgICAgICAgICAgICAgICAgICAgIFBCU19TTU9PVEggfCBXU19CT1JE
RVIsOTAsNjAsMTU1LDEwCiAgICAgQ09OVFJPTCAgICAgICAgICJQcm9ncmVz
czEiLElEQ19JTlNfSVBST0dSRVNTLCJtc2N0bHNfcHJvZ3Jlc3MzMiIsCi0g
ICAgICAgICAgICAgICAgICAgIFBCU19TTU9PVEggfCBXU19CT1JERVIsNTUs
NTAsMTU1LDEwCisgICAgICAgICAgICAgICAgICAgIFBCU19TTU9PVEggfCBX
U19CT1JERVIsOTAsNTAsMTU1LDEwCiAgICAgQ09OVFJPTCAgICAgICAgICJQ
cm9ncmVzczEiLElEQ19JTlNfUFBST0dSRVNTLCJtc2N0bHNfcHJvZ3Jlc3Mz
MiIsCi0gICAgICAgICAgICAgICAgICAgIFBCU19TTU9PVEggfCBXU19CT1JE
RVIsNTUsNDAsMTU1LDEwCi0gICAgUlRFWFQgICAgICAgICAgICJQYWNrYWdl
IixJRENfU1RBVElDLDUsNDAsNDUsOAotICAgIFJURVhUICAgICAgICAgICAi
VG90YWwiLElEQ19TVEFUSUMsMTAsNTAsNDAsOAotICAgIFJURVhUICAgICAg
ICAgICAiRGlzayIsSURDX1NUQVRJQyw1LDYwLDQ1LDgKKyAgICAgICAgICAg
ICAgICAgICAgUEJTX1NNT09USCB8IFdTX0JPUkRFUiw5MCw0MCwxNTUsMTAK
KyAgICBSVEVYVCAgICAgICAgICAgIlBhY2thZ2UiLElEQ19JTlNfQkxfUEFD
S0FHRSw0MCw0MCw0NSw4CisgICAgUlRFWFQgICAgICAgICAgICJUb3RhbCIs
SURDX0lOU19CTF9UT1RBTCw0NSw1MCw0MCw4CisgICAgUlRFWFQgICAgICAg
ICAgICJEaXNrIixJRENfSU5TX0JMX0RJU0ssNDAsNjAsNDUsOAogRU5ECiAK
IElERF9QUk9YWV9BVVRIIERJQUxPRyBESVNDQVJEQUJMRSAgMCwgMCwgMjE1
LCA5NQpAQCAtMjEwLDggKzE5Nyw5IEBAIEJFR0lOCiAgICAgUFVTSEJVVFRP
TiAgICAgICJDYW5jZWwiLElEQ0FOQ0VMLDE2NSw3NSw0NSwxNQogRU5ECiAK
LUlERF9TUExBU0ggRElBTE9HIERJU0NBUkRBQkxFICAwLCAwLCAyMTUsIDk1
Ci1TVFlMRSBEU19NT0RBTEZSQU1FIHwgRFNfQ0VOVEVSIHwgV1NfUE9QVVAg
fCBXU19DQVBUSU9OIHwgV1NfU1lTTUVOVQorSUREX1NQTEFTSCBESUFMT0cg
RElTQ0FSREFCTEUgIDAsIDAsIDIxNiwgOTQKK1NUWUxFIERTX01PREFMRlJB
TUUgfCBEU18zRExPT0sgfCBEU19DRU5URVIgfCBXU19DSElMRCB8IFdTX1ZJ
U0lCTEUgfCAKKyAgICBXU19DQVBUSU9OIHwgV1NfU1lTTUVOVQogQ0FQVElP
TiAiQ3lnd2luIFNldHVwIgogRk9OVCA4LCAiTVMgU2FucyBTZXJpZiIKIEJF
R0lOCkBAIC0yMjMsMTcgKzIxMSwyNiBAQCBCRUdJTgogICAgICAgICAgICAg
ICAgICAgICA4CiAgICAgTFRFWFQgICAgICAgICAgICJodHRwOi8vc291cmNl
cy5yZWRoYXQuY29tL2N5Z3dpbi8iLElEQ19TVEFUSUMsNTUsNTAsMTEyLAog
ICAgICAgICAgICAgICAgICAgICA4Ci0gICAgREVGUFVTSEJVVFRPTiAgICIm
TmV4dCAtLT4iLElET0ssMTAwLDc1LDQ1LDE1Ci0gICAgUFVTSEJVVFRPTiAg
ICAgICJDYW5jZWwiLElEQ0FOQ0VMLDE2NSw3NSw0NSwxNQogRU5ECiAKLUlE
RF9DSE9PU0UgRElBTE9HIERJU0NBUkRBQkxFICAwLCAwLCA0MjksIDI2Ngot
U1RZTEUgRFNfTU9EQUxGUkFNRSB8IERTXzNETE9PSyB8IERTX0NFTlRFUiB8
IFdTX1BPUFVQIHwgV1NfQ0FQVElPTiB8IAotICAgIFdTX1NZU01FTlUKK0lE
RF9DSE9PU0UgRElBTE9HRVggMCwgMCwgNDMwLCAyNjYKK1NUWUxFIERTX01P
REFMRlJBTUUgfCBEU18zRExPT0sgfCBEU19DRU5URVIgfCBXU19DSElMRCB8
IFdTX1ZJU0lCTEUgfCAKKyAgICBXU19DQVBUSU9OIHwgV1NfU1lTTUVOVQor
RVhTVFlMRSBXU19FWF9DT05UUk9MUEFSRU5UCiBDQVBUSU9OICJDeWd3aW4g
U2V0dXAiCiBGT05UIDgsICJNUyBTYW5zIFNlcmlmIgogQkVHSU4KLSAgICBJ
Q09OICAgICAgICAgICAgSURJX0NZR1dJTixJRENfU1RBVElDLDAsMiwyMSwy
MAorICAgIERFRlBVU0hCVVRUT04gICAiJk5leHQgLS0+IixJRE9LLDMxMSwy
NDIsNDUsMTUsV1NfR1JPVVAKKyAgICBQVVNIQlVUVE9OICAgICAgIkNhbmNl
bCIsSURDQU5DRUwsMzc1LDI0Miw0NSwxNQorICAgIFBVU0hCVVRUT04gICAg
ICAiPC0tICZCYWNrIixJRENfQkFDSywyNjYsMjQyLDQ1LDE1CisgICAgQ09O
VFJPTCAgICAgICAgICImUHJldiIsSURDX0NIT09TRV9QUkVWLCJCdXR0b24i
LEJTX0FVVE9SQURJT0JVVFRPTiB8IAorICAgICAgICAgICAgICAgICAgICBX
U19HUk9VUCB8IFdTX1RBQlNUT1AsMjY1LDUsMjcsMTAKKyAgICBDT05UUk9M
ICAgICAgICAgIiZDdXJyIixJRENfQ0hPT1NFX0NVUlIsIkJ1dHRvbiIsQlNf
QVVUT1JBRElPQlVUVE9OLDI5NywKKyAgICAgICAgICAgICAgICAgICAgNSwy
NSwxMAorICAgIENPTlRST0wgICAgICAgICAiRSZ4cCIsSURDX0NIT09TRV9F
WFAsIkJ1dHRvbiIsQlNfQVVUT1JBRElPQlVUVE9OLDMyMyw1LAorICAgICAg
ICAgICAgICAgICAgICAyNSwxMAorICAgIFBVU0hCVVRUT04gICAgICAiJlZp
ZXciLElEQ19DSE9PU0VfVklFVywzNTMsNSwyMCwxMCxXU19HUk9VUAorICAg
IElDT04gICAgICAgICAgICBJRElfQ1lHV0lOLElEQ19TVEFUSUMsMCwyLDIw
LDIwCiAgICAgTFRFWFQgICAgICAgICAgICJTZWxlY3QgcGFja2FnZXMgdG8g
aW5zdGFsbCIsSURDX0NIT09TRV9JTlNUX1RFWFQsMTI1LDUsCiAgICAgICAg
ICAgICAgICAgICAgIDk5LDgKICAgICBDT05UUk9MICAgICAgICAgIiIsSURD
X0xJU1RWSUVXX1BPUywiU3RhdGljIixTU19CTEFDS0ZSQU1FIHwgTk9UIApA
QCAtMjQxLDIxICsyMzgsMTIgQEAgQkVHSU4KICAgICBDT05UUk9MICAgICAg
ICAgIlNQSU4iLElEQ19TVEFUSUMsIlN0YXRpYyIsU1NfQklUTUFQLDIyLDIz
NSwxNSwxMwogICAgIExURVhUICAgICAgICAgICAiPSBjbGljayB0byBjaG9v
c2UgYWN0aW9uLCAocCkgPSBwcmV2aW91cyB2ZXJzaW9uLCAoeCkgPSBleHBl
cmltZW50YWwiLAogICAgICAgICAgICAgICAgICAgICBJRENfU1RBVElDLDM1
LDIzNCwyMjAsOAotICAgIFBVU0hCVVRUT04gICAgICAiJlZpZXciLElEQ19D
SE9PU0VfVklFVywzNTMsNSwyMCwxMAogICAgIExURVhUICAgICAgICAgICAi
IixJRENfQ0hPT1NFX1ZJRVdDQVBUSU9OLDM5MCw1LDMwLDEwCi0gICAgQ09O
VFJPTCAgICAgICAgICJFJnhwIixJRENfQ0hPT1NFX0VYUCwiQnV0dG9uIixC
U19BVVRPUkFESU9CVVRUT04gfCAKLSAgICAgICAgICAgICAgICAgICAgV1Nf
R1JPVVAsMzIzLDUsMjUsMTAKLSAgICBDT05UUk9MICAgICAgICAgIiZQcmV2
IixJRENfQ0hPT1NFX1BSRVYsIkJ1dHRvbiIsQlNfQVVUT1JBRElPQlVUVE9O
LDI2NSwKLSAgICAgICAgICAgICAgICAgICAgNSwyNywxMAotICAgIENPTlRS
T0wgICAgICAgICAiJkN1cnIiLElEQ19DSE9PU0VfQ1VSUiwiQnV0dG9uIixC
U19BVVRPUkFESU9CVVRUT04sMjk3LAotICAgICAgICAgICAgICAgICAgICA1
LDI1LDEwCi0gICAgREVGUFVTSEJVVFRPTiAgICImTmV4dCAtLT4iLElET0ss
MzExLDI0Miw0NSwxNQotICAgIFBVU0hCVVRUT04gICAgICAiQ2FuY2VsIixJ
RENBTkNFTCwzNzUsMjQyLDQ1LDE1Ci0gICAgUFVTSEJVVFRPTiAgICAgICI8
LS0gJkJhY2siLElEQ19CQUNLLDI2NiwyNDIsNDUsMTUKIEVORAogCiBJRERf
REVTS1RPUCBESUFMT0cgRElTQ0FSREFCTEUgIDAsIDAsIDIxNSwgOTUKLVNU
WUxFIERTX01PREFMRlJBTUUgfCBEU19DRU5URVIgfCBXU19QT1BVUCB8IFdT
X0NBUFRJT04gfCBXU19TWVNNRU5VCitTVFlMRSBEU19NT0RBTEZSQU1FIHwg
RFNfM0RMT09LIHwgRFNfQ0VOVEVSIHwgV1NfQ0hJTEQgfCBXU19WSVNJQkxF
IHwgCisgICAgV1NfQ0FQVElPTiB8IFdTX1NZU01FTlUKIENBUFRJT04gIkN5
Z3dpbiBTZXR1cCIKIEZPTlQgOCwgIk1TIFNhbnMgU2VyaWYiCiBCRUdJTgpA
QCAtMjY0LDEyICsyNTIsOSBAQCBCRUdJTgogICAgICAgICAgICAgICAgICAg
ICBCU19BVVRPQ0hFQ0tCT1gsNTUsMjUsMTAwLDgKICAgICBDT05UUk9MICAg
ICAgICAgIkFkZCB0byAmU3RhcnQgTWVudSIsSURDX1JPT1RfTUVOVSwiQnV0
dG9uIiwKICAgICAgICAgICAgICAgICAgICAgQlNfQVVUT0NIRUNLQk9YLDU1
LDQwLDEwMCw4Ci0gICAgREVGUFVTSEJVVFRPTiAgICImTmV4dCAtLT4iLElE
T0ssMTAwLDc1LDQ1LDE1Ci0gICAgUFVTSEJVVFRPTiAgICAgICJDYW5jZWwi
LElEQ0FOQ0VMLDE2NSw3NSw0NSwxNQotICAgIFBVU0hCVVRUT04gICAgICAi
PC0tICZCYWNrIixJRENfQkFDSyw1NSw3NSw0NSwxNQogRU5ECiAKLUlERF9G
VFBfQVVUSCBESUFMT0dFWCAwLCAwLCAyMTUsIDk1CitJRERfRlRQX0FVVEgg
RElBTE9HIERJU0NBUkRBQkxFICAwLCAwLCAyMTUsIDk1CiBTVFlMRSBEU19N
T0RBTEZSQU1FIHwgRFNfQ0VOVEVSIHwgV1NfUE9QVVAgfCBXU19DQVBUSU9O
IHwgV1NfU1lTTUVOVQogQ0FQVElPTiAiQ3lnd2luIFNldHVwIgogRk9OVCA4
LCAiTVMgU2FucyBTZXJpZiIKQEAgLTI4Niw3ICsyNzEsMTYgQEAgQkVHSU4K
ICAgICBQVVNIQlVUVE9OICAgICAgIkNhbmNlbCIsSURDQU5DRUwsMTY1LDc1
LDQ1LDE1CiBFTkQKIAorSUREX0NIT09TRVIgRElBTE9HIERJU0NBUkRBQkxF
ICAwLCAwLCAxODYsIDkwCitTVFlMRSBEU19NT0RBTEZSQU1FIHwgRFNfM0RM
T09LIHwgV1NfQ0hJTEQgfCBXU19WSVNJQkxFIHwgV1NfQ0FQVElPTiB8IAor
ICAgIFdTX1NZU01FTlUKK0NBUFRJT04gIkN5Z3dpbiBTZXR1cCIKK0ZPTlQg
OCwgIk1TIFNhbnMgU2VyaWYiCitCRUdJTgorICAgIExURVhUICAgICAgICAg
ICAiRG9uJ3QgbG9vayBoZXJlIixJRENfU1RBVElDLDI1LDM4LDEzNCw4CitF
TkQKIAorCiAjaWZkZWYgQVBTVFVESU9fSU5WT0tFRAogLy8vLy8vLy8vLy8v
Ly8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8v
Ly8vLy8vLy8vLy8vLy8vLy8vLy8KIC8vCkBAIC0zMzksOSArMzMzLDIxIEBA
IENZR1dJTi5JQ09OICAgICAgICAgICAgIEZJTEUgICAgRElTQ0FSREEKICNp
ZmRlZiBBUFNUVURJT19JTlZPS0VECiBHVUlERUxJTkVTIERFU0lHTklORk8g
RElTQ0FSREFCTEUgCiBCRUdJTgorICAgIElERF9MT0NBTF9ESVIsIERJQUxP
RworICAgIEJFR0lOCisgICAgICAgIFJJR0hUTUFSR0lOLCAyMTUKKyAgICBF
TkQKKworICAgIElERF9TSVRFLCBESUFMT0cKKyAgICBCRUdJTgorICAgICAg
ICBSSUdIVE1BUkdJTiwgMjE1CisgICAgICAgIEJPVFRPTU1BUkdJTiwgOTMK
KyAgICBFTkQKKwogICAgIElERF9ORVQsIERJQUxPRwogICAgIEJFR0lOCi0g
ICAgICAgIEJPVFRPTU1BUkdJTiwgNDkKKyAgICAgICAgUklHSFRNQVJHSU4s
IDIxNQorICAgICAgICBCT1RUT01NQVJHSU4sIDYwCiAgICAgRU5ECiAKICAg
ICBJRERfUFJPWFlfQVVUSCwgRElBTE9HCkBAIC0zNTQsMTAgKzM2MCwyMyBA
QCBCRUdJTgogICAgICAgICBCT1RUT01NQVJHSU4sIDQ5CiAgICAgRU5ECiAK
KyAgICBJRERfQ0hPT1NFLCBESUFMT0cKKyAgICBCRUdJTgorICAgICAgICBS
SUdIVE1BUkdJTiwgNDI5CisgICAgRU5ECisKICAgICBJRERfRlRQX0FVVEgs
IERJQUxPRwogICAgIEJFR0lOCiAgICAgICAgIEJPVFRPTU1BUkdJTiwgNDkK
ICAgICBFTkQKKworICAgIElERF9DSE9PU0VSLCBESUFMT0cKKyAgICBCRUdJ
TgorICAgICAgICBMRUZUTUFSR0lOLCA3CisgICAgICAgIFJJR0hUTUFSR0lO
LCAxNzkKKyAgICAgICAgVE9QTUFSR0lOLCA3CisgICAgICAgIEJPVFRPTU1B
UkdJTiwgODMKKyAgICBFTkQKIEVORAogI2VuZGlmICAgIC8vIEFQU1RVRElP
X0lOVk9LRUQKIApAQCAtNDA5LDYgKzQyOCw3IEBAIEJFR0lOCiAgICAgSURT
X0RPV05MT0FEX0ZBSUxFRCAgICAgIlVuYWJsZSB0byBkb3dubG9hZCAlcyIK
ICAgICBJRFNfRE9XTkxPQURfSU5DT01QTEVURSAiRG93bmxvYWQgSW5jb21w
bGV0ZS4gIFRyeSBhZ2Fpbj8iCiAgICAgSURTX0lOU1RBTExfSU5DT01QTEVU
RSAgIkluc3RhbGxhdGlvbiBpbmNvbXBsZXRlLiAgQ2hlY2sgL3NldHVwLmxv
Zy5mdWxsIGZvciBkZXRhaWxzIgorICAgIElEU19WRVJTSU9OX0lORk8gICAg
ICAgICJTZXR1cC5leGUgdmVyc2lvbiAlMSIKIEVORAogCiAjZW5kaWYgICAg
Ly8gRW5nbGlzaCAoVS5TLikgcmVzb3VyY2VzCkluZGV4OiByZXNvdXJjZS5o
Cj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT0KUkNTIGZpbGU6IC9jdnMvc3JjL3Ny
Yy93aW5zdXAvY2luc3RhbGwvcmVzb3VyY2UuaCx2CnJldHJpZXZpbmcgcmV2
aXNpb24gMi4xMwpkaWZmIC11IC1wIC1yMi4xMyByZXNvdXJjZS5oCi0tLSBy
ZXNvdXJjZS5oCTIwMDEvMTIvMjAgMTE6NDk6NTQJMi4xMworKysgcmVzb3Vy
Y2UuaAkyMDAxLzEyLzIwIDEyOjM2OjAzCkBAIC0yNyw2ICsyNyw3IEBACiAj
ZGVmaW5lIElEU19ET1dOTE9BRF9GQUlMRUQgICAgICAgICAgICAgMjUKICNk
ZWZpbmUgSURTX0RPV05MT0FEX0lOQ09NUExFVEUgICAgICAgICAyNgogI2Rl
ZmluZSBJRFNfSU5TVEFMTF9JTkNPTVBMRVRFICAgICAgICAgIDI3CisjZGVm
aW5lIElEU19WRVJTSU9OX0lORk8gICAgICAgICAgICAgICAgMjgKICNkZWZp
bmUgSUREX1JPT1QgICAgICAgICAgICAgICAgICAgICAgICAxMDEKICNkZWZp
bmUgSUREX1NPVVJDRSAgICAgICAgICAgICAgICAgICAgICAxMDIKICNkZWZp
bmUgSUREX09USEVSX1VSTCAgICAgICAgICAgICAgICAgICAxMDMKQEAgLTUz
LDYgKzU0LDcgQEAKICNkZWZpbmUgSURCX0NIRUNLX05PICAgICAgICAgICAg
ICAgICAgICAxMjQKICNkZWZpbmUgSURCX0NIRUNLX05BICAgICAgICAgICAg
ICAgICAgICAxMjUKICNkZWZpbmUgSUREX0ZUUF9BVVRIICAgICAgICAgICAg
ICAgICAgICAxMjYKKyNkZWZpbmUgSUREX0NIT09TRVIgICAgICAgICAgICAg
ICAgICAgICAxMjcKICNkZWZpbmUgSURDX1NPVVJDRV9ET1dOTE9BRCAgICAg
ICAgICAgICAxMDAwCiAjZGVmaW5lIElEQ19TT1VSQ0VfTkVUSU5TVCAgICAg
ICAgICAgICAgMTAwMQogI2RlZmluZSBJRENfU09VUkNFX0NXRCAgICAgICAg
ICAgICAgICAgIDEwMDIKQEAgLTk5LDkgKzEwMSwxMiBAQAogI2RlZmluZSBJ
RENfRExTX1BST0dSRVNTX1RFWFQgICAgICAgICAgIDEwNDcKICNkZWZpbmUg
SURDX0RMU19QUFJPR1JFU1NfVEVYVCAgICAgICAgICAxMDQ4CiAjZGVmaW5l
IElEQ19ETFNfSVBST0dSRVNTX1RFWFQgICAgICAgICAgMTA0OQotI2RlZmlu
ZSBJRENfQ0hPT1NFX0lOU1RfVEVYVCAgICAgIDEwNTAKKyNkZWZpbmUgSURD
X0NIT09TRV9JTlNUX1RFWFQgICAgICAgICAgICAxMDUwCiAjZGVmaW5lIElE
Q19DSE9PU0VfVklFV0NBUFRJT04gICAgICAgICAgMTA1MQogI2RlZmluZSBJ
RENfQ0hPT1NFX0xJU1RIRUFERVIJCTEwNTIKKyNkZWZpbmUgSURDX0lOU19C
TF9QQUNLQUdFICAgICAgICAgICAgICAxMDUzCisjZGVmaW5lIElEQ19JTlNf
QkxfVE9UQUwgICAgICAgICAgICAgICAgMTA1NAorI2RlZmluZSBJRENfSU5T
X0JMX0RJU0sgICAgICAgICAgICAgICAgIDEwNTUKICNkZWZpbmUgSURDX1NU
QVRJQyAgICAgICAgICAgICAgICAgICAgICAtMQogCiAvLyBOZXh0IGRlZmF1
bHQgdmFsdWVzIGZvciBuZXcgb2JqZWN0cwpAQCAtMTEwLDkgKzExNSw5IEBA
CiAjaWZuZGVmIEFQU1RVRElPX1JFQURPTkxZX1NZTUJPTFMKICNkZWZpbmUg
X0FQU19OT19NRkMgICAgICAgICAgICAgICAgICAgICAxCiAjZGVmaW5lIF9B
UFNfM0RfQ09OVFJPTFMgICAgICAgICAgICAgICAgICAgICAxCi0jZGVmaW5l
IF9BUFNfTkVYVF9SRVNPVVJDRV9WQUxVRSAgICAgICAgMTI3CisjZGVmaW5l
IF9BUFNfTkVYVF9SRVNPVVJDRV9WQUxVRSAgICAgICAgMTI4CiAjZGVmaW5l
IF9BUFNfTkVYVF9DT01NQU5EX1ZBTFVFICAgICAgICAgNDAwMDMKLSNkZWZp
bmUgX0FQU19ORVhUX0NPTlRST0xfVkFMVUUgICAgICAgICAxMDUzCisjZGVm
aW5lIF9BUFNfTkVYVF9DT05UUk9MX1ZBTFVFICAgICAgICAgMTA1NgogI2Rl
ZmluZSBfQVBTX05FWFRfU1lNRURfVkFMVUUgICAgICAgICAgIDEwMQogI2Vu
ZGlmCiAjZW5kaWYKSW5kZXg6IHJvb3QuY2MKPT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PQpSQ1MgZmlsZTogL2N2cy9zcmMvc3JjL3dpbnN1cC9jaW5zdGFsbC9y
b290LmNjLHYKcmV0cmlldmluZyByZXZpc2lvbiAyLjcKZGlmZiAtdSAtcCAt
cjIuNyByb290LmNjCi0tLSByb290LmNjCTIwMDEvMTEvMTMgMDE6NDk6MzIJ
Mi43CisrKyByb290LmNjCTIwMDEvMTIvMjAgMTI6MzY6MDMKQEAgLTM1LDYg
KzM1LDcgQEAgc3RhdGljIGNvbnN0IGNoYXIgKmN2c2lkID0KICNpbmNsdWRl
ICJtb3VudC5oIgogI2luY2x1ZGUgImNvbmNhdC5oIgogI2luY2x1ZGUgImxv
Zy5oIgorI2luY2x1ZGUgInJvb3QuaCIKIAogc3RhdGljIGludCByYltdID0g
eyBJRENfUk9PVF9URVhULCBJRENfUk9PVF9CSU5BUlksIDAgfTsKIHN0YXRp
YyBpbnQgc3VbXSA9IHsgSURDX1JPT1RfU1lTVEVNLCBJRENfUk9PVF9VU0VS
LCAwIH07CkBAIC0xNDMsNjQgKzE0NCw1NiBAQCBkaWFsb2dfY21kIChIV05E
IGgsIGludCBpZCwgSFdORCBod25kY3RsCiAgICAgY2FzZSBJRENfUk9PVF9C
Uk9XU0U6CiAgICAgICBicm93c2UgKGgpOwogICAgICAgYnJlYWs7Ci0KLSAg
ICBjYXNlIElET0s6Ci0gICAgICBzYXZlX2RpYWxvZyAoaCk7Ci0KLSAgICAg
IGlmICghZGlyZWN0b3J5X2lzX2Fic29sdXRlICgpKQotCXsKLQkgIG5vdGUg
KElEU19ST09UX0FCU09MVVRFKTsKLQkgIGJyZWFrOwotCX0KLQotICAgICAg
aWYgKGRpcmVjdG9yeV9pc19yb290ZGlyICgpKQotCWlmIChJRE5PID09IHll
c25vIChJRFNfUk9PVF9TTEFTSCkpCi0JICBicmVhazsKLQotICAgICAgaWYg
KGRpcmVjdG9yeV9oYXNfc3BhY2VzICgpKQotCWlmIChJRE5PID09IHllc25v
IChJRFNfUk9PVF9TUEFDRSkpCi0JICBicmVhazsKLQotICAgICAgTkVYVCAo
SUREX0xPQ0FMX0RJUik7Ci0gICAgICBicmVhazsKLQotICAgIGNhc2UgSURD
X0JBQ0s6Ci0gICAgICBzYXZlX2RpYWxvZyAoaCk7Ci0gICAgICBORVhUIChJ
RERfU09VUkNFKTsKLSAgICAgIGJyZWFrOwotCi0gICAgY2FzZSBJRENBTkNF
TDoKLSAgICAgIE5FWFQgKDApOwotICAgICAgYnJlYWs7CiAgICAgfQogICBy
ZXR1cm4gMDsKIH0KIAotc3RhdGljIEJPT0wgQ0FMTEJBQ0sKLWRpYWxvZ19w
cm9jIChIV05EIGgsIFVJTlQgbWVzc2FnZSwgV1BBUkFNIHdQYXJhbSwgTFBB
UkFNIGxQYXJhbSkKK2Jvb2wKK1Jvb3RQYWdlOjpDcmVhdGUgKCkKIHsKLSAg
c3dpdGNoIChtZXNzYWdlKQotICAgIHsKLSAgICBjYXNlIFdNX0lOSVRESUFM
T0c6Ci0gICAgICBsb2FkX2RpYWxvZyAoaCk7Ci0gICAgICByZXR1cm4gRkFM
U0U7Ci0gICAgY2FzZSBXTV9DT01NQU5EOgotICAgICAgcmV0dXJuIEhBTkRM
RV9XTV9DT01NQU5EIChoLCB3UGFyYW0sIGxQYXJhbSwgZGlhbG9nX2NtZCk7
Ci0gICAgfQotICByZXR1cm4gRkFMU0U7CisgIHJldHVybiBQcm9wZXJ0eVBh
Z2U6OkNyZWF0ZSAoTlVMTCwgZGlhbG9nX2NtZCwgSUREX1JPT1QpOwogfQog
CiB2b2lkCi1kb19yb290IChISU5TVEFOQ0UgaCkKK1Jvb3RQYWdlOjpPbklu
aXQgKCkKIHsKLSAgaW50IHJ2ID0gMDsKICAgaWYgKCFnZXRfcm9vdF9kaXIg
KCkpCiAgICAgcmVhZF9tb3VudHMgKCk7Ci0gIHJ2ID0gRGlhbG9nQm94ICho
LCBNQUtFSU5UUkVTT1VSQ0UgKElERF9ST09UKSwgMCwgZGlhbG9nX3Byb2Mp
OwotICBpZiAocnYgPT0gLTEpCi0gICAgZmF0YWwgKElEU19ESUFMT0dfRkFJ
TEVEKTsKKyAgbG9hZF9kaWFsb2cgKEdldEhXTkQgKCkpOworfQogCitsb25n
CitSb290UGFnZTo6T25OZXh0ICgpCit7CisgIEhXTkQgaCA9IEdldEhXTkQg
KCk7CisKKyAgc2F2ZV9kaWFsb2cgKGgpOworCisgIGlmICghZGlyZWN0b3J5
X2lzX2Fic29sdXRlICgpKQorICAgIHsKKyAgICAgIG5vdGUgKGgsIElEU19S
T09UX0FCU09MVVRFKTsKKyAgICAgIHJldHVybiAtMTsKKyAgICB9CisgIGVs
c2UgaWYgKGRpcmVjdG9yeV9pc19yb290ZGlyICgpICYmIChJRE5PID09IHll
c25vIChoLCBJRFNfUk9PVF9TTEFTSCkpKQorICAgIHJldHVybiAtMTsKKyAg
ZWxzZSBpZiAoZGlyZWN0b3J5X2hhc19zcGFjZXMgKCkgJiYgKElETk8gPT0g
eWVzbm8gKGgsIElEU19ST09UX1NQQUNFKSkpCisgICAgcmV0dXJuIC0xOwor
CisgIE5FWFQgKElERF9MT0NBTF9ESVIpOworCiAgIGxvZyAoMCwgInJvb3Q6
ICVzICVzICVzIiwgZ2V0X3Jvb3RfZGlyICgpLAogICAgICAgIChyb290X3Rl
eHQgPT0gSURDX1JPT1RfVEVYVCkgPyAidGV4dCIgOiAiYmluYXJ5IiwKICAg
ICAgICAocm9vdF9zY29wZSA9PSBJRENfUk9PVF9VU0VSKSA/ICJ1c2VyIiA6
ICJzeXN0ZW0iKTsKKworICByZXR1cm4gMDsKK30KKworbG9uZworUm9vdFBh
Z2U6Ok9uQmFjayAoKQoreworICBIV05EIGggPSBHZXRIV05EICgpOworCisg
IHNhdmVfZGlhbG9nIChoKTsKKyAgTkVYVCAoSUREX1NPVVJDRSk7CisgIHJl
dHVybiAwOwogfQpJbmRleDogcm9vdC5oCj09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT0KUkNTIGZpbGU6IHJvb3QuaApkaWZmIC1OIHJvb3QuaAotLS0gL2Rldi9u
dWxsCVR1ZSBNYXkgIDUgMTM6MzI6MjcgMTk5OAorKysgcm9vdC5oCVRodSBE
ZWMgMjAgMDQ6MzY6MDMgMjAwMQpAQCAtMCwwICsxLDIzIEBACisjaWZuZGVm
IENJTlNUQUxMX1JPT1RfSAorI2RlZmluZSBDSU5TVEFMTF9ST09UX0gKKwor
I2luY2x1ZGUgInByb3BwYWdlLmgiCisKK2NsYXNzIFJvb3RQYWdlOnB1Ymxp
YyBQcm9wZXJ0eVBhZ2UKK3sKK3B1YmxpYzoKKyAgUm9vdFBhZ2UgKCkKKyAg
eworICB9OworICB2aXJ0dWFsIH4gUm9vdFBhZ2UgKCkKKyAgeworICB9Owor
CisgIGJvb2wgQ3JlYXRlICgpOworCisgIHZvaWQgT25Jbml0ICgpOworICB2
aXJ0dWFsIGxvbmcgT25OZXh0ICgpOworICB2aXJ0dWFsIGxvbmcgT25CYWNr
ICgpOworfTsKKworI2VuZGlmIC8vIENJTlNUQUxMX1JPT1RfSApJbmRleDog
c2l0ZS5jYwo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09ClJDUyBmaWxlOiAvY3Zz
L3NyYy9zcmMvd2luc3VwL2NpbnN0YWxsL3NpdGUuY2MsdgpyZXRyaWV2aW5n
IHJldmlzaW9uIDIuMTAKZGlmZiAtdSAtcCAtcjIuMTAgc2l0ZS5jYwotLS0g
c2l0ZS5jYwkyMDAxLzEyLzAzIDIyOjIyOjA5CTIuMTAKKysrIHNpdGUuY2MJ
MjAwMS8xMi8yMCAxMjozNjowMwpAQCAtMjUsNiArMjUsNyBAQCBzdGF0aWMg
Y29uc3QgY2hhciAqY3ZzaWQgPQogI2luY2x1ZGUgPHN0ZGlvLmg+CiAjaW5j
bHVkZSA8c3RkbGliLmg+CiAjaW5jbHVkZSA8c3RyaW5nLmg+CisjaW5jbHVk
ZSA8cHJvY2Vzcy5oPgogCiAjaW5jbHVkZSAiZGlhbG9nLmgiCiAjaW5jbHVk
ZSAicmVzb3VyY2UuaCIKQEAgLTM4LDYgKzM5LDEyIEBAIHN0YXRpYyBjb25z
dCBjaGFyICpjdnNpZCA9CiAKICNpbmNsdWRlICJwb3J0LmgiCiAKKyNpbmNs
dWRlICJzaXRlLmgiCisjaW5jbHVkZSAicHJvcHNoZWV0LmgiCisKKyNpbmNs
dWRlICJ0aHJlZWJhci5oIgorZXh0ZXJuIFRocmVlQmFyUHJvZ3Jlc3NQYWdl
IFByb2dyZXNzOworCiAjZGVmaW5lIE5PX0lEWCAoLTEpCiAjZGVmaW5lIE9U
SEVSX0lEWCAoLTIpCiAKQEAgLTEwMSw3ICsxMDgsMTIgQEAgbG9hZF9kaWFs
b2cgKEhXTkQgaCkKICAgICAgIGludCBpbmRleCA9IFNlbmRNZXNzYWdlIChs
aXN0Ym94LCBMQl9GSU5EU1RSSU5HLCAoV1BBUkFNKSAtIDEsCiAJCQkgICAg
ICAgKExQQVJBTSkgc2l0ZV9saXN0W25dLT5kaXNwbGF5ZWRfdXJsKTsKICAg
ICAgIGlmIChpbmRleCAhPSBMQl9FUlIpCi0JU2VuZE1lc3NhZ2UgKGxpc3Ri
b3gsIExCX1NFTElURU1SQU5HRSwgVFJVRSwgKGluZGV4IDw8IDE2KSB8IGlu
ZGV4KTsKKwl7CisJICAvLyBIaWdobGlnaHQgdGhlIHNlbGVjdGVkIGl0ZW0K
KwkgIFNlbmRNZXNzYWdlIChsaXN0Ym94LCBMQl9TRUxJVEVNUkFOR0UsIFRS
VUUsIChpbmRleCA8PCAxNikgfCBpbmRleCk7CisJICAvLyBNYWtlIHN1cmUg
aXQncyBmdWxseSB2aXNpYmxlCisJICBTZW5kTWVzc2FnZSAobGlzdGJveCwg
TEJfU0VUQ0FSRVRJTkRFWCwgaW5kZXgsIEZBTFNFKTsKKwl9CiAgICAgfQog
ICBjaGVja19pZl9lbmFibGVfbmV4dCAoaCk7CiB9CkBAIC0xNjcsNjMgKzE3
OSwxOCBAQCBkaWFsb2dfY21kIChIV05EIGgsIGludCBpZCwgSFdORCBod25k
Y3RsCiAgICAgY2FzZSBJRENfVVJMX0xJU1Q6CiAgICAgICBjaGVja19pZl9l
bmFibGVfbmV4dCAoaCk7CiAgICAgICBicmVhazsKLQotICAgIGNhc2UgSURP
SzoKLSAgICAgIHNhdmVfZGlhbG9nIChoKTsKLSAgICAgIGlmIChtaXJyb3Jf
aWR4ID09IE9USEVSX0lEWCkKLQlORVhUIChJRERfT1RIRVJfVVJMKTsKLSAg
ICAgIGVsc2UKLQl7Ci0JICBzYXZlX3NpdGVfdXJsICgpOwotCSAgTkVYVCAo
SUREX1NfTE9BRF9JTkkpOwotCX0KLSAgICAgIGJyZWFrOwotCi0gICAgY2Fz
ZSBJRENfQkFDSzoKLSAgICAgIHNhdmVfZGlhbG9nIChoKTsKLSAgICAgIE5F
WFQgKElERF9ORVQpOwotICAgICAgYnJlYWs7Ci0KLSAgICBjYXNlIElEQ0FO
Q0VMOgotICAgICAgTkVYVCAoMCk7Ci0gICAgICBicmVhazsKICAgICB9CiAg
IHJldHVybiAwOwogfQogCi1zdGF0aWMgQk9PTCBDQUxMQkFDSwotZGlhbG9n
X3Byb2MgKEhXTkQgaCwgVUlOVCBtZXNzYWdlLCBXUEFSQU0gd1BhcmFtLCBM
UEFSQU0gbFBhcmFtKQotewotICBpbnQgajsKLSAgSFdORCBsaXN0Ym94Owot
ICBzd2l0Y2ggKG1lc3NhZ2UpCi0gICAgewotICAgIGNhc2UgV01fSU5JVERJ
QUxPRzoKLSAgICAgIGxpc3Rib3ggPSBHZXREbGdJdGVtIChoLCBJRENfVVJM
X0xJU1QpOwotICAgICAgZm9yIChzaXplX3QgaSA9IDE7IGkgPD0gYWxsX3Np
dGVfbGlzdC5udW1iZXIgKCk7IGkrKykKLQl7Ci0JICBqID0KLQkgICAgU2Vu
ZE1lc3NhZ2UgKGxpc3Rib3gsIExCX0FERFNUUklORywgMCwKLQkJCSAoTFBB
UkFNKSBhbGxfc2l0ZV9saXN0W2ldLT5kaXNwbGF5ZWRfdXJsKTsKLQkgIFNl
bmRNZXNzYWdlIChsaXN0Ym94LCBMQl9TRVRJVEVNREFUQSwgaiwgaSk7Ci0J
fQotICAgICAgaiA9IFNlbmRNZXNzYWdlIChsaXN0Ym94LCBMQl9BRERTVFJJ
TkcsIDAsIChMUEFSQU0pICJPdGhlciBVUkwiKTsKLSAgICAgIFNlbmRNZXNz
YWdlIChsaXN0Ym94LCBMQl9TRVRJVEVNREFUQSwgaiwgT1RIRVJfSURYKTsK
LSAgICAgIGxvYWRfZGlhbG9nIChoKTsKLSAgICAgIHJldHVybiBGQUxTRTsK
LSAgICBjYXNlIFdNX0NPTU1BTkQ6Ci0gICAgICByZXR1cm4gSEFORExFX1dN
X0NPTU1BTkQgKGgsIHdQYXJhbSwgbFBhcmFtLCBkaWFsb2dfY21kKTsKLSAg
ICB9Ci0gIHJldHVybiBGQUxTRTsKLX0KLQogc3RhdGljIGludAotZ2V0X3Np
dGVfbGlzdCAoSElOU1RBTkNFIGgpCitnZXRfc2l0ZV9saXN0IChISU5TVEFO
Q0UgaCwgSFdORCBvd25lcikKIHsKICAgY2hhciBtaXJyb3JfdXJsWzEwMDBd
OworCiAgIGlmIChMb2FkU3RyaW5nIChoLCBJRFNfTUlSUk9SX0xTVCwgbWly
cm9yX3VybCwgc2l6ZW9mIChtaXJyb3JfdXJsKSkgPD0gMCkKICAgICByZXR1
cm4gMTsKLSAgY2hhciAqbWlycm9ycyA9IGdldF91cmxfdG9fc3RyaW5nICht
aXJyb3JfdXJsKTsKKyAgY2hhciAqbWlycm9ycyA9IGdldF91cmxfdG9fc3Ry
aW5nIChtaXJyb3JfdXJsLCBvd25lcik7CiAgIGRpc21pc3NfdXJsX3N0YXR1
c19kaWFsb2cgKCk7CiAgIGlmICghbWlycm9ycykKICAgICByZXR1cm4gMTsK
QEAgLTMyMCwyNCArMjg3LDEwNiBAQCBnZXRfc2F2ZWRfc2l0ZXMgKCkKIAog
fQogCi12b2lkCi1kb19zaXRlIChISU5TVEFOQ0UgaCkKK3N0YXRpYyB2b2lk
Citkb19kb3dubG9hZF9zaXRlX2luZm9fdGhyZWFkICh2b2lkICpwKQogewot
ICBpbnQgcnYgPSAwOworICBIQU5ETEUgKmNvbnRleHQ7CisgIEhJTlNUQU5D
RSBoaW5zdDsKKyAgSFdORCBoOworICBjb250ZXh0ID0gKEhBTkRMRSAqKSBw
OworCisgIGhpbnN0ID0gKEhJTlNUQU5DRSkgKGNvbnRleHRbMF0pOworICBo
ID0gKEhXTkQpIChjb250ZXh0WzFdKTsKIAogICBpZiAoYWxsX3NpdGVfbGlz
dC5udW1iZXIgKCkgPT0gMCkKLSAgICBpZiAoZ2V0X3NpdGVfbGlzdCAoaCkp
Ci0gICAgICB7Ci0JTkVYVCAoSUREX05FVCk7Ci0JcmV0dXJuOwotICAgICAg
fQorICAgIHsKKyAgICAgIGlmIChnZXRfc2l0ZV9saXN0IChoaW5zdCwgaCkp
CisJeworCSAgLy8gRXJyb3I6IENvdWxkbid0IGRvd25sb2FkIHRoZSBzaXRl
IGluZm8uICBHbyBiYWNrIHRvIHRoZSBOZXQgc2V0dXAgcGFnZS4KKwkgIE5F
WFQgKElERF9ORVQpOworCSAgcmV0dXJuOworCX0KKyAgICB9CisKKyAgLy8g
RXZlcnl0aGluZyB3b3JrZWQsIGdvIHRvIHRoZSBzaXRlIHNlbGVjdCBwYWdl
CisgIE5FWFQgKElERF9TSVRFKTsKKworICAvLyBUZWxsIHRoZSBwcm9ncmVz
cyBwYWdlIHRoYXQgd2UncmUgZG9uZSBkb3dubG9hZGluZworICBQcm9ncmVz
cy5Qb3N0TWVzc2FnZSAoV01fQVBQX1NJVEVfSU5GT19ET1dOTE9BRF9DT01Q
TEVURSwgMCwgbmV4dF9kaWFsb2cpOworCisgIF9lbmR0aHJlYWQgKCk7Cit9
CiAKK3N0YXRpYyBIQU5ETEUgY29udGV4dFsyXTsKKwordm9pZAorZG9fZG93
bmxvYWRfc2l0ZV9pbmZvIChISU5TVEFOQ0UgaGluc3QsIEhXTkQgb3duZXIp
Cit7CisKKyAgY29udGV4dFswXSA9IGhpbnN0OworICBjb250ZXh0WzFdID0g
b3duZXI7CisKKyAgX2JlZ2ludGhyZWFkIChkb19kb3dubG9hZF9zaXRlX2lu
Zm9fdGhyZWFkLCAwLCBjb250ZXh0KTsKKworfQorCitib29sCitTaXRlUGFn
ZTo6Q3JlYXRlICgpCit7CisgIHJldHVybiBQcm9wZXJ0eVBhZ2U6OkNyZWF0
ZSAoTlVMTCwgZGlhbG9nX2NtZCwgSUREX1NJVEUpOworfQorCit2b2lkCitT
aXRlUGFnZTo6T25Jbml0ICgpCit7CisgIEhXTkQgaCA9IEdldEhXTkQgKCk7
CisgIGludCBqOworICBIV05EIGxpc3Rib3g7CisKICAgZ2V0X3NhdmVkX3Np
dGVzICgpOworCisgIGxpc3Rib3ggPSBHZXREbGdJdGVtIChJRENfVVJMX0xJ
U1QpOworICBmb3IgKHNpemVfdCBpID0gMTsgaSA8PSBhbGxfc2l0ZV9saXN0
Lm51bWJlciAoKTsgaSsrKQorICAgIHsKKyAgICAgIGogPQorCVNlbmRNZXNz
YWdlIChsaXN0Ym94LCBMQl9BRERTVFJJTkcsIDAsCisJCSAgICAgKExQQVJB
TSkgYWxsX3NpdGVfbGlzdFtpXS0+ZGlzcGxheWVkX3VybCk7CisgICAgICBT
ZW5kTWVzc2FnZSAobGlzdGJveCwgTEJfU0VUSVRFTURBVEEsIGosIGkpOwor
ICAgIH0KKyAgaiA9IFNlbmRNZXNzYWdlIChsaXN0Ym94LCBMQl9BRERTVFJJ
TkcsIDAsIChMUEFSQU0pICJPdGhlciBVUkwiKTsKKyAgU2VuZE1lc3NhZ2Ug
KGxpc3Rib3gsIExCX1NFVElURU1EQVRBLCBqLCBPVEhFUl9JRFgpOworICBs
b2FkX2RpYWxvZyAoaCk7Cit9CiAKLSAgcnYgPSBEaWFsb2dCb3ggKGgsIE1B
S0VJTlRSRVNPVVJDRSAoSUREX1NJVEUpLCAwLCBkaWFsb2dfcHJvYyk7Ci0g
IGlmIChydiA9PSAtMSkKLSAgICBmYXRhbCAoSURTX0RJQUxPR19GQUlMRUQp
OworbG9uZworU2l0ZVBhZ2U6Ok9uTmV4dCAoKQoreworICBIV05EIGggPSBH
ZXRIV05EICgpOwogCi0gIGZvciAoc2l6ZV90IG4gPSAxOyBuIDw9IHNpdGVf
bGlzdC5udW1iZXIgKCk7IG4rKykKLSAgICBsb2cgKDAsICJzaXRlOiAlcyIs
IHNpdGVfbGlzdFtuXS0+dXJsKTsKKyAgc2F2ZV9kaWFsb2cgKGgpOworICBp
ZiAobWlycm9yX2lkeCA9PSBPVEhFUl9JRFgpCisgICAgTkVYVCAoSUREX09U
SEVSX1VSTCk7CisgIGVsc2UKKyAgICB7CisgICAgICBzYXZlX3NpdGVfdXJs
ICgpOworICAgICAgTkVYVCAoSUREX1NfTE9BRF9JTkkpOworCisgICAgICBm
b3IgKHNpemVfdCBuID0gMTsgbiA8PSBzaXRlX2xpc3QubnVtYmVyICgpOyBu
KyspCisJbG9nICgwLCAic2l0ZTogJXMiLCBzaXRlX2xpc3Rbbl0tPnVybCk7
CisKKyAgICAgIFByb2dyZXNzLlNldEFjdGl2YXRlVGFzayAoV01fQVBQX1NU
QVJUX1NFVFVQX0lOSV9ET1dOTE9BRCk7CisgICAgICByZXR1cm4gSUREX0lO
U1RBVFVTOworICAgIH0KKworICByZXR1cm4gMDsKK30KKworbG9uZworU2l0
ZVBhZ2U6Ok9uQmFjayAoKQoreworICBIV05EIGggPSBHZXRIV05EICgpOwor
CisgIHNhdmVfZGlhbG9nIChoKTsKKyAgTkVYVCAoSUREX05FVCk7CisgIHJl
dHVybiAwOwogfQpJbmRleDogc2l0ZS5oCj09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT0KUkNTIGZpbGU6IC9jdnMvc3JjL3NyYy93aW5zdXAvY2luc3RhbGwvc2l0
ZS5oLHYKcmV0cmlldmluZyByZXZpc2lvbiAyLjEKZGlmZiAtdSAtcCAtcjIu
MSBzaXRlLmgKLS0tIHNpdGUuaAkyMDAxLzEyLzAzIDIyOjIyOjA5CTIuMQor
Kysgc2l0ZS5oCTIwMDEvMTIvMjAgMTI6MzY6MDMKQEAgLTE3LDE3ICsxNyw0
MSBAQAogI2RlZmluZSBfU0lURV9IXwogCiAvKiByZXF1aXJlZCB0byBwYXJz
ZSB0aGlzIGZpbGUgKi8KLSNpbmNsdWRlIDxzdHJpbmdzLmg+CisjaW5jbHVk
ZSA8c3RyaW5nLmg+CisjaW5jbHVkZSA8c3RkbGliLmg+CiAjaW5jbHVkZSAi
bGlzdC5oIgogCisjaW5jbHVkZSAicHJvcHBhZ2UuaCIKKworY2xhc3MgU2l0
ZVBhZ2U6cHVibGljIFByb3BlcnR5UGFnZQoreworcHVibGljOgorICBTaXRl
UGFnZSAoKQorICB7CisgIH07CisgIHZpcnR1YWwgfiBTaXRlUGFnZSAoKQor
ICB7CisgIH07CisKKyAgYm9vbCBDcmVhdGUgKCk7CisKKyAgdm9pZCBPbklu
aXQgKCk7CisgIGxvbmcgT25OZXh0ICgpOworICBsb25nIE9uQmFjayAoKTsK
K307CisKK3ZvaWQgZG9fZG93bmxvYWRfc2l0ZV9pbmZvIChISU5TVEFOQ0Ug
aCwgSFdORCBvd25lcik7CisKIGNsYXNzIHNpdGVfbGlzdF90eXBlCiB7CiBw
dWJsaWM6Ci0gIHNpdGVfbGlzdF90eXBlICgpIDogdXJsKDApLCBkaXNwbGF5
ZWRfdXJsICgwKSwga2V5ICgwKSB7fTsKKyAgc2l0ZV9saXN0X3R5cGUgKCk6
dXJsICgwKSwgZGlzcGxheWVkX3VybCAoMCksIGtleSAoMCkKKyAgeworICB9
OwogICBzaXRlX2xpc3RfdHlwZSAoY2hhciBjb25zdCAqKTsKICAgLyogd29y
a2Fyb3VuZCBmb3IgbWlzc2luZyBwbGFjZW1lbnQgbmV3IGluIGdjYyAyLjk1
ICovCiAgIHZvaWQgaW5pdCAoY2hhciBjb25zdCAqKTsKLSAgfnNpdGVfbGlz
dF90eXBlICgpIAorICB+c2l0ZV9saXN0X3R5cGUgKCkKICAgewogICAgIGlm
ICh1cmwpCiAgICAgICBmcmVlICh1cmwpOwpAQCAtNDIsOSArNjYsOSBAQCBw
dWJsaWM6CiB9OwogCiAvKiB1c2VyIGNob3NlbiBzaXRlcyAqLwotZXh0ZXJu
IGxpc3QgPHNpdGVfbGlzdF90eXBlLCBjb25zdCBjaGFyICosIHN0cmNhc2Vj
bXA+IHNpdGVfbGlzdDsKK2V4dGVybiBsaXN0IDwgc2l0ZV9saXN0X3R5cGUs
IGNvbnN0IGNoYXIgKiwgc3RyY2FzZWNtcCA+IHNpdGVfbGlzdDsKIC8qIHBv
dGVudGlhbCBzaXRlcyAqLwotZXh0ZXJuIGxpc3QgPHNpdGVfbGlzdF90eXBl
LCBjb25zdCBjaGFyICosIHN0cmNhc2VjbXA+IGFsbF9zaXRlX2xpc3Q7Citl
eHRlcm4gbGlzdCA8IHNpdGVfbGlzdF90eXBlLCBjb25zdCBjaGFyICosIHN0
cmNhc2VjbXAgPiBhbGxfc2l0ZV9saXN0OwogCiB2b2lkIHNhdmVfc2l0ZV91
cmwgKCk7CiAKSW5kZXg6IHNvdXJjZS5jYwo9PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09ClJDUyBmaWxlOiAvY3ZzL3NyYy9zcmMvd2luc3VwL2NpbnN0YWxsL3Nv
dXJjZS5jYyx2CnJldHJpZXZpbmcgcmV2aXNpb24gMi45CmRpZmYgLXUgLXAg
LXIyLjkgc291cmNlLmNjCi0tLSBzb3VyY2UuY2MJMjAwMS8xMi8yMCAxMTo0
OTo1NAkyLjkKKysrIHNvdXJjZS5jYwkyMDAxLzEyLzIwIDEyOjM2OjAzCkBA
IC0zMSw2ICszMSw4IEBAIHN0YXRpYyBjb25zdCBjaGFyICpjdnNpZCA9CiAj
aW5jbHVkZSAibG9nLmgiCiAjaW5jbHVkZSAicGFja2FnZV9kYi5oIgogCisj
aW5jbHVkZSAic291cmNlLmgiCisKIHN0YXRpYyBpbnQgcmJbXSA9CiAgIHsg
SURDX1NPVVJDRV9ORVRJTlNULCBJRENfU09VUkNFX0RPV05MT0FELCBJRENf
U09VUkNFX0NXRCwgMCB9OwogCkBAIC00NSw3ICs0Nyw4IEBAIHNhdmVfZGlh
bG9nIChIV05EIGgpCiB7CiAgIHNvdXJjZSA9IHJiZ2V0IChoLCByYik7CiAg
IHBhY2thZ2VkYiBkYjsKLSAgZGIudGFzayA9IHNvdXJjZSA9PSBJRENfU09V
UkNFX0RPV05MT0FEID8gUGFja2FnZURCX0Rvd25sb2FkIDogUGFja2FnZURC
X0luc3RhbGw7CisgIGRiLnRhc2sgPQorICAgIHNvdXJjZSA9PSBJRENfU09V
UkNFX0RPV05MT0FEID8gUGFja2FnZURCX0Rvd25sb2FkIDogUGFja2FnZURC
X0luc3RhbGw7CiB9CiAKIHN0YXRpYyBCT09MCkBAIC02MCw2NSArNjMsNjEg
QEAgZGlhbG9nX2NtZCAoSFdORCBoLCBpbnQgaWQsIEhXTkQgaHduZGN0bAog
ICAgICAgc2F2ZV9kaWFsb2cgKGgpOwogICAgICAgYnJlYWs7CiAKLSAgICBj
YXNlIElET0s6Ci0gICAgICBzYXZlX2RpYWxvZyAoaCk7Ci0gICAgICBpZiAo
c291cmNlID09IElEQ19TT1VSQ0VfRE9XTkxPQUQpCi0JTkVYVCAoSUREX0xP
Q0FMX0RJUik7Ci0gICAgICBlbHNlCi0JTkVYVCAoSUREX1JPT1QpOwotICAg
ICAgYnJlYWs7Ci0KLSAgICBjYXNlIElEQ19CQUNLOgotICAgICAgc2F2ZV9k
aWFsb2cgKGgpOwotICAgICAgTkVYVCAoMCk7Ci0gICAgICBicmVhazsKLQot
ICAgIGNhc2UgSURDQU5DRUw6Ci0gICAgICBORVhUICgwKTsKLSAgICAgIGJy
ZWFrOwotCiAgICAgZGVmYXVsdDoKICAgICAgIGJyZWFrOwogICAgIH0KICAg
cmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBCT09MIENBTExCQUNLCi1kaWFsb2df
cHJvYyAoSFdORCBoLCBVSU5UIG1lc3NhZ2UsIFdQQVJBTSB3UGFyYW0sIExQ
QVJBTSBsUGFyYW0pCitib29sCitTb3VyY2VQYWdlOjpDcmVhdGUgKCkKIHsK
LSAgc3dpdGNoIChtZXNzYWdlKQotICAgIHsKLSAgICBjYXNlIFdNX0lOSVRE
SUFMT0c6Ci0gICAgICBsb2FkX2RpYWxvZyAoaCk7Ci0gICAgICAvLyBDaGVj
ayB0byBzZWUgaWYgYW55IHJhZGlvIGJ1dHRvbnMgYXJlIHNlbGVjdGVkLiBJ
ZiBub3QsIHNlbGVjdCBhIGRlZmF1bHQuCi0gICAgICBpZiAoCi0JICAoIVNl
bmRNZXNzYWdlCi0JICAgKEdldERsZ0l0ZW0gKGgsIElEQ19TT1VSQ0VfRE9X
TkxPQUQpLCBCTV9HRVRDSEVDSywgMCwKLQkgICAgMCkgPT0gQlNUX0NIRUNL
RUQpCi0JICAmJiAoIVNlbmRNZXNzYWdlIChHZXREbGdJdGVtIChoLCBJRENf
U09VUkNFX0NXRCksIEJNX0dFVENIRUNLLCAwLCAwKQotCSAgICAgID09IEJT
VF9DSEVDS0VEKSkKLQl7Ci0JICBTZW5kTWVzc2FnZSAoR2V0RGxnSXRlbSAo
aCwgSURDX1NPVVJDRV9ORVRJTlNUKSwgQk1fU0VUQ0hFQ0ssCi0JCSAgICAg
ICBCU1RfQ0hFQ0tFRCwgMCk7Ci0JfQotICAgICAgcmV0dXJuIEZBTFNFOwot
ICAgIGNhc2UgV01fQ09NTUFORDoKLSAgICAgIHJldHVybiBIQU5ETEVfV01f
Q09NTUFORCAoaCwgd1BhcmFtLCBsUGFyYW0sIGRpYWxvZ19jbWQpOwotICAg
IH0KLSAgcmV0dXJuIEZBTFNFOworICByZXR1cm4gUHJvcGVydHlQYWdlOjpD
cmVhdGUgKE5VTEwsIGRpYWxvZ19jbWQsIElERF9TT1VSQ0UpOwogfQogCiB2
b2lkCi1kb19zb3VyY2UgKEhJTlNUQU5DRSBoKQorU291cmNlUGFnZTo6T25B
Y3RpdmF0ZSAoKQogewotICBpbnQgcnYgPSAwOwotICAvKiBzb3VyY2UgPSBJ
RENfU09VUkNFX0NXRDsgKi8KICAgaWYgKCFzb3VyY2UpCiAgICAgc291cmNl
ID0gSURDX1NPVVJDRV9ORVRJTlNUOwotICBydiA9IERpYWxvZ0JveCAoaCwg
TUFLRUlOVFJFU09VUkNFIChJRERfU09VUkNFKSwgMCwgZGlhbG9nX3Byb2Mp
OwotICBpZiAocnYgPT0gLTEpCi0gICAgZmF0YWwgKElEU19ESUFMT0dfRkFJ
TEVEKTsKKyAgbG9hZF9kaWFsb2cgKEdldEhXTkQgKCkpOworICAvLyBDaGVj
ayB0byBzZWUgaWYgYW55IHJhZGlvIGJ1dHRvbnMgYXJlIHNlbGVjdGVkLiBJ
ZiBub3QsIHNlbGVjdCBhIGRlZmF1bHQuCisgIGlmICgoIVNlbmRNZXNzYWdl
CisgICAgICAgKEdldERsZ0l0ZW0gKElEQ19TT1VSQ0VfRE9XTkxPQUQpLCBC
TV9HRVRDSEVDSywgMCwKKwkwKSA9PSBCU1RfQ0hFQ0tFRCkKKyAgICAgICYm
ICghU2VuZE1lc3NhZ2UgKEdldERsZ0l0ZW0gKElEQ19TT1VSQ0VfQ1dEKSwg
Qk1fR0VUQ0hFQ0ssIDAsIDApCisJICA9PSBCU1RfQ0hFQ0tFRCkpCisgICAg
eworICAgICAgU2VuZE1lc3NhZ2UgKEdldERsZ0l0ZW0gKElEQ19TT1VSQ0Vf
TkVUSU5TVCksIEJNX1NFVENIRUNLLAorCQkgICBCU1RfQ0hFQ0tFRCwgMCk7
CisgICAgfQorfQogCitsb25nCitTb3VyY2VQYWdlOjpPbk5leHQgKCkKK3sK
KyAgSFdORCBoID0gR2V0SFdORCAoKTsKKworICBzYXZlX2RpYWxvZyAoaCk7
CisgIGlmIChzb3VyY2UgPT0gSURDX1NPVVJDRV9ET1dOTE9BRCkKKyAgICB7
CisgICAgICAvLyBJZiBhbGwgd2UncmUgZG9pbmcgaXMgZG93bmxvYWRpbmcs
c2tpcCB0aGUgcm9vdCBkaXJlY3RvcnkgcGFnZQorICAgICAgcmV0dXJuIElE
RF9MT0NBTF9ESVI7CisgICAgfQorCisgIHJldHVybiAwOworfQorCitsb25n
CitTb3VyY2VQYWdlOjpPbkJhY2sgKCkKK3sKKyAgc2F2ZV9kaWFsb2cgKEdl
dEhXTkQgKCkpOworICByZXR1cm4gMDsKK30KKwordm9pZAorU291cmNlUGFn
ZTo6T25EZWFjdGl2YXRlICgpCit7CiAgIGxvZyAoMCwgInNvdXJjZTogJXMi
LAogICAgICAgIChzb3VyY2UgPT0gSURDX1NPVVJDRV9ET1dOTE9BRCkgPyAi
ZG93bmxvYWQiIDoKICAgICAgICAoc291cmNlID09IElEQ19TT1VSQ0VfTkVU
SU5TVCkgPyAibmV0d29yayBpbnN0YWxsIiA6ICJmcm9tIGN3ZCIpOwpJbmRl
eDogc291cmNlLmgKPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQpSQ1MgZmlsZTog
c291cmNlLmgKZGlmZiAtTiBzb3VyY2UuaAotLS0gL2Rldi9udWxsCVR1ZSBN
YXkgIDUgMTM6MzI6MjcgMTk5OAorKysgc291cmNlLmgJVGh1IERlYyAyMCAw
NDozNjowMyAyMDAxCkBAIC0wLDAgKzEsNDMgQEAKKyNpZm5kZWYgQ0lOU1RB
TExfU09VUkNFX0gKKyNkZWZpbmUgQ0lOU1RBTExfU09VUkNFX0gKKworLyoK
KyAqIENvcHlyaWdodCAoYykgMjAwMSwgR2FyeSBSLiBWYW4gU2lja2xlLgor
ICoKKyAqICAgICBUaGlzIHByb2dyYW0gaXMgZnJlZSBzb2Z0d2FyZTsgeW91
IGNhbiByZWRpc3RyaWJ1dGUgaXQgYW5kL29yIG1vZGlmeQorICogICAgIGl0
IHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUgR05VIEdlbmVyYWwgUHVibGljIExp
Y2Vuc2UgYXMgcHVibGlzaGVkIGJ5CisgKiAgICAgdGhlIEZyZWUgU29mdHdh
cmUgRm91bmRhdGlvbjsgZWl0aGVyIHZlcnNpb24gMiBvZiB0aGUgTGljZW5z
ZSwgb3IKKyAqICAgICAoYXQgeW91ciBvcHRpb24pIGFueSBsYXRlciB2ZXJz
aW9uLgorICoKKyAqICAgICBBIGNvcHkgb2YgdGhlIEdOVSBHZW5lcmFsIFB1
YmxpYyBMaWNlbnNlIGNhbiBiZSBmb3VuZCBhdAorICogICAgIGh0dHA6Ly93
d3cuZ251Lm9yZy8KKyAqCisgKiBXcml0dGVuIGJ5IEdhcnkgUi4gVmFuIFNp
Y2tsZSA8Zy5yLnZhbnNpY2tsZUB3b3JsZG5ldC5hdHQubmV0PgorICoKKyAq
LworCisvLyBUaGlzIGlzIHRoZSBoZWFkZXIgZm9yIHRoZSBTb3VyY2VQYWdl
IGNsYXNzLCB3aGljaCBsZXRzIHRoZSB1c2VyCisvLyBzZWxlY3QgRG93bmxv
YWQrSW5zdGFsbCwgRG93bmxvYWQsIG9yIEluc3RhbGwgRnJvbSBMb2NhbCBE
aXJlY3RvcnkuCisKKworI2luY2x1ZGUgInByb3BwYWdlLmgiCisKK2NsYXNz
IFNvdXJjZVBhZ2U6cHVibGljIFByb3BlcnR5UGFnZQoreworcHVibGljOgor
ICBTb3VyY2VQYWdlICgpCisgIHsKKyAgfTsKKyAgdmlydHVhbCB+IFNvdXJj
ZVBhZ2UgKCkKKyAgeworICB9OworCisgIGJvb2wgQ3JlYXRlICgpOworCisg
IHZvaWQgT25BY3RpdmF0ZSAoKTsKKyAgdm9pZCBPbkRlYWN0aXZhdGUgKCk7
CisgIGxvbmcgT25OZXh0ICgpOworICBsb25nIE9uQmFjayAoKTsKK307CisK
KyNlbmRpZgpJbmRleDogc3BsYXNoLmNjCj09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT0KUkNTIGZpbGU6IC9jdnMvc3JjL3NyYy93aW5zdXAvY2luc3RhbGwvc3Bs
YXNoLmNjLHYKcmV0cmlldmluZyByZXZpc2lvbiAyLjYKZGlmZiAtdSAtcCAt
cjIuNiBzcGxhc2guY2MKLS0tIHNwbGFzaC5jYwkyMDAxLzExLzEzIDAxOjQ5
OjMyCTIuNgorKysgc3BsYXNoLmNjCTIwMDEvMTIvMjAgMTI6MzY6MDMKQEAg
LTEsNSArMSw1IEBACiAvKgotICogQ29weXJpZ2h0IChjKSAyMDAwLCBSZWQg
SGF0LCBJbmMuCisgKiBDb3B5cmlnaHQgKGMpIDIwMDEsIEdhcnkgUi4gVmFu
IFNpY2tsZS4KICAqCiAgKiAgICAgVGhpcyBwcm9ncmFtIGlzIGZyZWUgc29m
dHdhcmU7IHlvdSBjYW4gcmVkaXN0cmlidXRlIGl0IGFuZC9vciBtb2RpZnkK
ICAqICAgICBpdCB1bmRlciB0aGUgdGVybXMgb2YgdGhlIEdOVSBHZW5lcmFs
IFB1YmxpYyBMaWNlbnNlIGFzIHB1Ymxpc2hlZCBieQpAQCAtOSw3MSArOSwz
MSBAQAogICogICAgIEEgY29weSBvZiB0aGUgR05VIEdlbmVyYWwgUHVibGlj
IExpY2Vuc2UgY2FuIGJlIGZvdW5kIGF0CiAgKiAgICAgaHR0cDovL3d3dy5n
bnUub3JnLwogICoKLSAqIFdyaXR0ZW4gYnkgREogRGVsb3JpZSA8ZGpAY3ln
bnVzLmNvbT4KKyAqIFdyaXR0ZW4gYnkgR2FyeSBSLiBWYW4gU2lja2xlIDxn
LnIudmFuc2lja2xlQHdvcmxkbmV0LmF0dC5uZXQ+CiAgKgogICovCiAKLS8q
IFRoZSBwdXJwb3NlIG9mIHRoaXMgZmlsZSBpcyB0byBkaXNwbGF5IHRoZSBw
cm9ncmFtIG5hbWUsIHZlcnNpb24sCi0gICBjb3B5cmlnaHQgbm90aWNlLCBh
bmQgcHJvamVjdCBVUkwuICovCisvLyBUaGlzIGlzIHRoZSBpbXBsZW1lbnRh
dGlvbiBvZiB0aGUgU3BsYXNoUGFnZSBjbGFzcy4gIFNpbmNlIHRoZSBzcGxh
c2ggcGFnZQorLy8gaGFzIGxpdHRsZSB0byBkbywgdGhlcmUncyBub3QgbXVj
aCBoZXJlLgogCi0jaWYgMAotc3RhdGljIGNvbnN0IGNoYXIgKmN2c2lkID0K
LSAgIlxuJSUlICRJZDogc3BsYXNoLmNjLHYgMi42IDIwMDEvMTEvMTMgMDE6
NDk6MzIgcmJjb2xsaW5zIEV4cCAkXG4iOwotI2VuZGlmCi0KLSNpbmNsdWRl
ICJ3aW4zMi5oIgogI2luY2x1ZGUgPHN0ZGlvLmg+Ci0jaW5jbHVkZSAiZGlh
bG9nLmgiCi0jaW5jbHVkZSAicmVzb3VyY2UuaCIKLSNpbmNsdWRlICJtc2cu
aCIKICNpbmNsdWRlICJ2ZXJzaW9uLmgiCisjaW5jbHVkZSAicmVzb3VyY2Uu
aCIKKyNpbmNsdWRlICJjaXN0cmluZy5oIgorI2luY2x1ZGUgInNwbGFzaC5o
IgogCi1zdGF0aWMgdm9pZAotbG9hZF9kaWFsb2cgKEhXTkQgaCkKK2Jvb2wK
K1NwbGFzaFBhZ2U6OkNyZWF0ZSAoKQogewotICBjaGFyIGJ1ZmZlclsxMDBd
OwotICBIV05EIHYgPSBHZXREbGdJdGVtIChoLCBJRENfVkVSU0lPTik7Ci0g
IHNwcmludGYgKGJ1ZmZlciwgIlNldHVwLmV4ZSB2ZXJzaW9uICVzIiwKLQkg
ICB2ZXJzaW9uWzBdID8gdmVyc2lvbiA6ICJbdW5rbm93bl0iKTsKLSAgU2V0
V2luZG93VGV4dCAodiwgYnVmZmVyKTsKKyAgcmV0dXJuIFByb3BlcnR5UGFn
ZTo6Q3JlYXRlIChJRERfU1BMQVNIKTsKIH0KIAotc3RhdGljIEJPT0wKLWRp
YWxvZ19jbWQgKEhXTkQgaCwgaW50IGlkLCBIV05EIGh3bmRjdGwsIFVJTlQg
Y29kZSkKK3ZvaWQKK1NwbGFzaFBhZ2U6Ok9uSW5pdCAoKQogewotICBzd2l0
Y2ggKGlkKQotICAgIHsKLQotICAgIGNhc2UgSURPSzoKLSAgICAgIE5FWFQg
KElERF9TT1VSQ0UpOwotICAgICAgYnJlYWs7Ci0KLSAgICBjYXNlIElEQ0FO
Q0VMOgotICAgICAgTkVYVCAoMCk7Ci0gICAgICBicmVhazsKLSAgICB9Ci0g
IHJldHVybiAwOwotfQorICBjaXN0cmluZyB2ZXI7CiAKLXN0YXRpYyBCT09M
IENBTExCQUNLCi1kaWFsb2dfcHJvYyAoSFdORCBoLCBVSU5UIG1lc3NhZ2Us
IFdQQVJBTSB3UGFyYW0sIExQQVJBTSBsUGFyYW0pCi17Ci0gIHN3aXRjaCAo
bWVzc2FnZSkKLSAgICB7Ci0gICAgY2FzZSBXTV9JTklURElBTE9HOgotICAg
ICAgbG9hZF9kaWFsb2cgKGgpOwotICAgICAgcmV0dXJuIFRSVUU7Ci0gICAg
Y2FzZSBXTV9DT01NQU5EOgotICAgICAgcmV0dXJuIEhBTkRMRV9XTV9DT01N
QU5EIChoLCB3UGFyYW0sIGxQYXJhbSwgZGlhbG9nX2NtZCk7Ci0gICAgfQot
ICByZXR1cm4gRkFMU0U7Ci19CisgIHZlci5Gb3JtYXQgKElEU19WRVJTSU9O
X0lORk8sIHZlcnNpb25bMF0gPyB2ZXJzaW9uIDogIlt1bmtub3duXSIpOwog
Ci12b2lkCi1kb19zcGxhc2ggKEhJTlNUQU5DRSBoKQotewotICBpbnQgcnYg
PSAwOwotICBydiA9IERpYWxvZ0JveCAoaCwgTUFLRUlOVFJFU09VUkNFIChJ
RERfU1BMQVNIKSwgMCwgZGlhbG9nX3Byb2MpOwotICBpZiAocnYgPT0gLTEp
Ci0gICAgZmF0YWwgKElEU19ESUFMT0dfRkFJTEVEKTsKKyAgU2V0V2luZG93
VGV4dCAoR2V0RGxnSXRlbSAoSURDX1ZFUlNJT04pLCB2ZXIuY19zdHIgKCkp
OwogfQpJbmRleDogc3BsYXNoLmgKPT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQpS
Q1MgZmlsZTogc3BsYXNoLmgKZGlmZiAtTiBzcGxhc2guaAotLS0gL2Rldi9u
dWxsCVR1ZSBNYXkgIDUgMTM6MzI6MjcgMTk5OAorKysgc3BsYXNoLmgJVGh1
IERlYyAyMCAwNDozNjowMyAyMDAxCkBAIC0wLDAgKzEsMzggQEAKKyNpZm5k
ZWYgQ0lOU1RBTExfU1BMQVNIX0gKKyNkZWZpbmUgQ0lOU1RBTExfU1BMQVNI
X0gKKworLyoKKyAqIENvcHlyaWdodCAoYykgMjAwMSwgR2FyeSBSLiBWYW4g
U2lja2xlLgorICoKKyAqICAgICBUaGlzIHByb2dyYW0gaXMgZnJlZSBzb2Z0
d2FyZTsgeW91IGNhbiByZWRpc3RyaWJ1dGUgaXQgYW5kL29yIG1vZGlmeQor
ICogICAgIGl0IHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUgR05VIEdlbmVyYWwg
UHVibGljIExpY2Vuc2UgYXMgcHVibGlzaGVkIGJ5CisgKiAgICAgdGhlIEZy
ZWUgU29mdHdhcmUgRm91bmRhdGlvbjsgZWl0aGVyIHZlcnNpb24gMiBvZiB0
aGUgTGljZW5zZSwgb3IKKyAqICAgICAoYXQgeW91ciBvcHRpb24pIGFueSBs
YXRlciB2ZXJzaW9uLgorICoKKyAqICAgICBBIGNvcHkgb2YgdGhlIEdOVSBH
ZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGNhbiBiZSBmb3VuZCBhdAorICogICAg
IGh0dHA6Ly93d3cuZ251Lm9yZy8KKyAqCisgKiBXcml0dGVuIGJ5IEdhcnkg
Ui4gVmFuIFNpY2tsZSA8Zy5yLnZhbnNpY2tsZUB3b3JsZG5ldC5hdHQubmV0
PgorICoKKyAqLworCisvLyBUaGlzIGlzIHRoZSBoZWFkZXIgZm9yIHRoZSBT
cGxhc2hQYWdlIGNsYXNzLiAgU2luY2UgdGhlIHNwbGFzaCBwYWdlCisvLyBo
YXMgbGl0dGxlIHRvIGRvLCB0aGVyZSdzIG5vdCBtdWNoIGhlcmUuCisKKyNp
bmNsdWRlICJwcm9wcGFnZS5oIgorCitjbGFzcyBTcGxhc2hQYWdlOnB1Ymxp
YyBQcm9wZXJ0eVBhZ2UKK3sKK3B1YmxpYzoKKyAgU3BsYXNoUGFnZSAoKQor
ICB7CisgIH07CisgIHZpcnR1YWwgfiBTcGxhc2hQYWdlICgpCisgIHsKKyAg
fTsKKworICBib29sIENyZWF0ZSAoKTsKKyAgdm9pZCBPbkluaXQgKCk7Cit9
OworCisjZW5kaWYgLy8gQ0lOU1RBTExfU1BMQVNIX0gKSW5kZXg6IHRocmVl
YmFyLmNjCj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KUkNTIGZpbGU6IHRocmVl
YmFyLmNjCmRpZmYgLU4gdGhyZWViYXIuY2MKLS0tIC9kZXYvbnVsbAlUdWUg
TWF5ICA1IDEzOjMyOjI3IDE5OTgKKysrIHRocmVlYmFyLmNjCVRodSBEZWMg
MjAgMDQ6MzY6MDMgMjAwMQpAQCAtMCwwICsxLDE5OSBAQAorLyoKKyAqIENv
cHlyaWdodCAoYykgMjAwMSwgR2FyeSBSLiBWYW4gU2lja2xlLgorICoKKyAq
ICAgICBUaGlzIHByb2dyYW0gaXMgZnJlZSBzb2Z0d2FyZTsgeW91IGNhbiBy
ZWRpc3RyaWJ1dGUgaXQgYW5kL29yIG1vZGlmeQorICogICAgIGl0IHVuZGVy
IHRoZSB0ZXJtcyBvZiB0aGUgR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2Ug
YXMgcHVibGlzaGVkIGJ5CisgKiAgICAgdGhlIEZyZWUgU29mdHdhcmUgRm91
bmRhdGlvbjsgZWl0aGVyIHZlcnNpb24gMiBvZiB0aGUgTGljZW5zZSwgb3IK
KyAqICAgICAoYXQgeW91ciBvcHRpb24pIGFueSBsYXRlciB2ZXJzaW9uLgor
ICoKKyAqICAgICBBIGNvcHkgb2YgdGhlIEdOVSBHZW5lcmFsIFB1YmxpYyBM
aWNlbnNlIGNhbiBiZSBmb3VuZCBhdAorICogICAgIGh0dHA6Ly93d3cuZ251
Lm9yZy8KKyAqCisgKiBXcml0dGVuIGJ5IEdhcnkgUi4gVmFuIFNpY2tsZSA8
Zy5yLnZhbnNpY2tsZUB3b3JsZG5ldC5hdHQubmV0PgorICoKKyAqLworCisv
LyBUaGlzIGlzIHRoZSBpbXBsZW1lbnRhdGlvbiBvZiB0aGUgVGhyZWVCYXJQ
cm9ncmVzc1BhZ2UgY2xhc3MuICBJdCBpcyBhIGZhaXJseSBnZW5lcmljCisv
LyBwcm9ncmVzcyBpbmRpY2F0b3IgcHJvcGVydHkgcGFnZSB3aXRoIHRocmVl
IHByb2dyZXNzIGJhcnMuCisKKyNpbmNsdWRlICJ3aW4zMi5oIgorI2luY2x1
ZGUgImNvbW1jdHJsLmgiCisjaW5jbHVkZSAicmVzb3VyY2UuaCIKKworI2lu
Y2x1ZGUgImRpYWxvZy5oIgorI2luY2x1ZGUgInNpdGUuaCIKKworI2luY2x1
ZGUgInByb3BzaGVldC5oIgorI2luY2x1ZGUgInRocmVlYmFyLmgiCisKK2Jv
b2wKK1RocmVlQmFyUHJvZ3Jlc3NQYWdlOjpDcmVhdGUgKCkKK3sKKyAgcmV0
dXJuIFByb3BlcnR5UGFnZTo6Q3JlYXRlIChJRERfSU5TVEFUVVMpOworfQor
Cit2b2lkCitUaHJlZUJhclByb2dyZXNzUGFnZTo6T25Jbml0ICgpCit7Cisg
IC8vIEdldCBIV05EcyB0byB0aGUgZGlhbG9nIGNvbnRyb2xzCisgIGluc19h
Y3Rpb24gPSBHZXREbGdJdGVtIChJRENfSU5TX0FDVElPTik7CisgIGluc19w
a2duYW1lID0gR2V0RGxnSXRlbSAoSURDX0lOU19QS0cpOworICBpbnNfZmls
ZW5hbWUgPSBHZXREbGdJdGVtIChJRENfSU5TX0ZJTEUpOworICAvLyBCYXJz
CisgIGluc19wcHJvZ3Jlc3MgPSBHZXREbGdJdGVtIChJRENfSU5TX1BQUk9H
UkVTUyk7CisgIGluc19pcHJvZ3Jlc3MgPSBHZXREbGdJdGVtIChJRENfSU5T
X0lQUk9HUkVTUyk7CisgIGluc19kaXNrZnVsbCA9IEdldERsZ0l0ZW0gKElE
Q19JTlNfRElTS0ZVTEwpOworICAvLyBCYXIgbGFiZWxzCisgIGluc19ibF9w
YWNrYWdlID0gR2V0RGxnSXRlbSAoSURDX0lOU19CTF9QQUNLQUdFKTsKKyAg
aW5zX2JsX3RvdGFsID0gR2V0RGxnSXRlbSAoSURDX0lOU19CTF9UT1RBTCk7
CisgIGluc19ibF9kaXNrID0gR2V0RGxnSXRlbSAoSURDX0lOU19CTF9ESVNL
KTsKK30KKwordm9pZAorVGhyZWVCYXJQcm9ncmVzc1BhZ2U6OlNldFRleHQx
IChjb25zdCBUQ0hBUiAqIHQpCit7CisgIFNldFdpbmRvd1RleHQgKGluc19h
Y3Rpb24sIHQpOworfQorCit2b2lkCitUaHJlZUJhclByb2dyZXNzUGFnZTo6
U2V0VGV4dDIgKGNvbnN0IFRDSEFSICogdCkKK3sKKyAgU2V0V2luZG93VGV4
dCAoaW5zX3BrZ25hbWUsIHQpOworfQorCit2b2lkCitUaHJlZUJhclByb2dy
ZXNzUGFnZTo6U2V0VGV4dDMgKGNvbnN0IFRDSEFSICogdCkKK3sKKyAgU2V0
V2luZG93VGV4dCAoaW5zX2ZpbGVuYW1lLCB0KTsKK30KKwordm9pZAorVGhy
ZWVCYXJQcm9ncmVzc1BhZ2U6OlNldEJhcjEgKGxvbmcgcHJvZ3Jlc3MsIGxv
bmcgbWF4KQoreworICBpbnQgcGVyY2VudCA9IChpbnQpICgxMDAuMCAqICgo
ZG91YmxlKSBwcm9ncmVzcykgLyAoZG91YmxlKSBtYXgpOworICBTZW5kTWVz
c2FnZSAoaW5zX3Bwcm9ncmVzcywgUEJNX1NFVFBPUywgKFdQQVJBTSkgcGVy
Y2VudCwgMCk7Cit9CisKK3ZvaWQKK1RocmVlQmFyUHJvZ3Jlc3NQYWdlOjpT
ZXRCYXIyIChsb25nIHByb2dyZXNzLCBsb25nIG1heCkKK3sKKyAgaW50IHBl
cmNlbnQgPSAoaW50KSAoMTAwLjAgKiAoKGRvdWJsZSkgcHJvZ3Jlc3MpIC8g
KGRvdWJsZSkgbWF4KTsKKyAgU2VuZE1lc3NhZ2UgKGluc19pcHJvZ3Jlc3Ms
IFBCTV9TRVRQT1MsIChXUEFSQU0pIHBlcmNlbnQsIDApOworfQorCit2b2lk
CitUaHJlZUJhclByb2dyZXNzUGFnZTo6U2V0QmFyMyAobG9uZyBwcm9ncmVz
cywgbG9uZyBtYXgpCit7CisgIGludCBwZXJjZW50ID0gKGludCkgKDEwMC4w
ICogKChkb3VibGUpIHByb2dyZXNzKSAvIChkb3VibGUpIG1heCk7CisgIFNl
bmRNZXNzYWdlIChpbnNfZGlza2Z1bGwsIFBCTV9TRVRQT1MsIChXUEFSQU0p
IHBlcmNlbnQsIDApOworfQorCit2b2lkCitUaHJlZUJhclByb2dyZXNzUGFn
ZTo6RW5hYmxlU2luZ2xlQmFyIChib29sIGVuYWJsZSkKK3sKKyAgLy8gU3dp
dGNoIHRvL2Zyb20gc2luZ2xlIGJhciBtb2RlCisgIFNob3dXaW5kb3cgKGlu
c19ibF90b3RhbCwgZW5hYmxlID8gU1dfSElERSA6IFNXX1NIT1cpOworICBT
aG93V2luZG93IChpbnNfYmxfZGlzaywgZW5hYmxlID8gU1dfSElERSA6IFNX
X1NIT1cpOworICBTaG93V2luZG93IChpbnNfaXByb2dyZXNzLCBlbmFibGUg
PyBTV19ISURFIDogU1dfU0hPVyk7CisgIFNob3dXaW5kb3cgKGluc19kaXNr
ZnVsbCwgZW5hYmxlID8gU1dfSElERSA6IFNXX1NIT1cpOworfQorCit2b2lk
CitUaHJlZUJhclByb2dyZXNzUGFnZTo6T25BY3RpdmF0ZSAoKQoreworICAv
LyBEaXNhYmxlIGJhY2sgYW5kIG5leHQgYnV0dG9ucworICBHZXRPd25lciAo
KS0+U2V0QnV0dG9ucyAoMCk7CisKKyAgLy8gU2V0IGFsbCBiYXJzIHRvIDAK
KyAgU2V0QmFyMSAoMCk7CisgIFNldEJhcjIgKDApOworICBTZXRCYXIzICgw
KTsKKworICBzd2l0Y2ggKHRhc2spCisgICAgeworICAgIGNhc2UgV01fQVBQ
X1NUQVJUX1NJVEVfSU5GT19ET1dOTE9BRDoKKyAgICBjYXNlIFdNX0FQUF9T
VEFSVF9TRVRVUF9JTklfRE9XTkxPQUQ6CisgICAgICAvLyBGb3IgdGhlc2Ug
dGFza3MsIHNob3cgb25seSBhIHNpbmdsZSBwcm9ncmVzcyBiYXIuCisgICAg
ICBFbmFibGVTaW5nbGVCYXIgKCk7CisgICAgICBicmVhazsKKyAgICBkZWZh
dWx0OgorICAgICAgLy8gU2hvdyB0aGUgbm9ybWFsIDMtYmFyIHZpZXcgYnkg
ZGVmYXVsdAorICAgICAgRW5hYmxlU2luZ2xlQmFyIChmYWxzZSk7CisgICAg
ICBicmVhazsKKyAgICB9CisKKyAgV2luZG93OjpQb3N0TWVzc2FnZSAodGFz
ayk7Cit9CisKK2Jvb2wKK1RocmVlQmFyUHJvZ3Jlc3NQYWdlOjpPbk1lc3Nh
Z2VBcHAgKFVJTlQgdU1zZywgV1BBUkFNIHdQYXJhbSwgTFBBUkFNIGxQYXJh
bSkKK3sKKyAgc3dpdGNoICh1TXNnKQorICAgIHsKKyAgICBjYXNlIFdNX0FQ
UF9TVEFSVF9ET1dOTE9BRDoKKyAgICAgIHsKKwkvLyBTdGFydCB0aGUgcGFj
a2FnZSBkb3dubG9hZCB0aHJlYWQuCisJZG9fZG93bmxvYWQgKEdldEluc3Rh
bmNlICgpLCBHZXRIV05EICgpKTsKKwlicmVhazsKKyAgICAgIH0KKyAgICBj
YXNlIFdNX0FQUF9ET1dOTE9BRF9USFJFQURfQ09NUExFVEU6CisgICAgICB7
CisJaWYgKGxQYXJhbSA9PSBJRERfU19JTlNUQUxMKQorCSAgeworCSAgICAv
LyBEb3dubG9hZCBpcyBjb21wbGV0ZSBhbmQgd2Ugd2FudCB0byBnbyBvbiB0
byB0aGUgaW5zdGFsbC4KKwkgICAgV2luZG93OjpQb3N0TWVzc2FnZSAoV01f
QVBQX1NUQVJUX0lOU1RBTEwpOworCSAgfQorCWVsc2UgaWYgKGxQYXJhbSAh
PSAwKQorCSAgeworCSAgICAvLyBEb3dubG9hZCBmYWlsZWQgZm9yIHNvbWUg
cmVhc29uLCBnbyBiYWNrIHRvIHNpdGUgc2VsZWN0aW9uIHBhZ2UKKwkgICAg
R2V0T3duZXIgKCktPlNldEFjdGl2ZVBhZ2VCeUlEIChsUGFyYW0pOworCSAg
fQorCWVsc2UKKwkgIHsKKwkgICAgLy8gV2FzIGEgZG93bmxvYWQtb25seSwg
YW5kIGlzIGNvbXBsZXRlIG9yIGZhaWxlZC4KKwkgICAgR2V0T3duZXIgKCkt
PlByZXNzQnV0dG9uIChQU0JUTl9DQU5DRUwpOworCSAgfQorCWJyZWFrOwor
ICAgICAgfQorICAgIGNhc2UgV01fQVBQX1NUQVJUX0lOU1RBTEw6CisgICAg
ICB7CisJLy8gU3RhcnQgdGhlIGluc3RhbGwgdGhyZWFkLgorCWRvX2luc3Rh
bGwgKEdldEluc3RhbmNlICgpLCBHZXRIV05EICgpKTsKKwlicmVhazsKKyAg
ICAgIH0KKyAgICBjYXNlIFdNX0FQUF9JTlNUQUxMX1RIUkVBRF9DT01QTEVU
RToKKyAgICAgIHsKKwkvLyBSZS1lbmFibGUgYW5kICJQdXNoIiB0aGUgTmV4
dCBidXR0b24KKwlHZXRPd25lciAoKS0+U2V0QnV0dG9ucyAoUFNXSVpCX05F
WFQpOworCUdldE93bmVyICgpLT5QcmVzc0J1dHRvbiAoUFNCVE5fTkVYVCk7
CisJYnJlYWs7CisgICAgICB9CisgICAgY2FzZSBXTV9BUFBfU1RBUlRfU0lU
RV9JTkZPX0RPV05MT0FEOgorICAgICAgeworCWRvX2Rvd25sb2FkX3NpdGVf
aW5mbyAoR2V0SW5zdGFuY2UgKCksIEdldEhXTkQgKCkpOworCWJyZWFrOwor
ICAgICAgfQorICAgIGNhc2UgV01fQVBQX1NJVEVfSU5GT19ET1dOTE9BRF9D
T01QTEVURToKKyAgICAgIHsKKwlHZXRPd25lciAoKS0+U2V0QWN0aXZlUGFn
ZUJ5SUQgKGxQYXJhbSk7CisJYnJlYWs7CisgICAgICB9CisgICAgY2FzZSBX
TV9BUFBfU1RBUlRfU0VUVVBfSU5JX0RPV05MT0FEOgorICAgICAgeworCWRv
X2luaSAoR2V0SW5zdGFuY2UgKCksIEdldEhXTkQgKCkpOworCWJyZWFrOwor
ICAgICAgfQorICAgIGNhc2UgV01fQVBQX1NFVFVQX0lOSV9ET1dOTE9BRF9D
T01QTEVURToKKyAgICAgIHsKKwlHZXRPd25lciAoKS0+U2V0QWN0aXZlUGFn
ZUJ5SUQgKGxQYXJhbSk7CisJYnJlYWs7CisgICAgICB9CisgICAgZGVmYXVs
dDoKKyAgICAgIHsKKwkvLyBOb3QgaGFuZGxlZAorCXJldHVybiBmYWxzZTsK
KyAgICAgIH0KKyAgICB9CisKKyAgcmV0dXJuIHRydWU7Cit9CkluZGV4OiB0
aHJlZWJhci5oCj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KUkNTIGZpbGU6IHRo
cmVlYmFyLmgKZGlmZiAtTiB0aHJlZWJhci5oCi0tLSAvZGV2L251bGwJVHVl
IE1heSAgNSAxMzozMjoyNyAxOTk4CisrKyB0aHJlZWJhci5oCVRodSBEZWMg
MjAgMDQ6MzY6MDMgMjAwMQpAQCAtMCwwICsxLDgxIEBACisjaWZuZGVmIENJ
TlNUQUxMX1RIUkVFQkFSX0gKKyNkZWZpbmUgQ0lOU1RBTExfVEhSRUVCQVJf
SAorCisvKgorICogQ29weXJpZ2h0IChjKSAyMDAxLCBHYXJ5IFIuIFZhbiBT
aWNrbGUuCisgKgorICogICAgIFRoaXMgcHJvZ3JhbSBpcyBmcmVlIHNvZnR3
YXJlOyB5b3UgY2FuIHJlZGlzdHJpYnV0ZSBpdCBhbmQvb3IgbW9kaWZ5Cisg
KiAgICAgaXQgdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBHTlUgR2VuZXJhbCBQ
dWJsaWMgTGljZW5zZSBhcyBwdWJsaXNoZWQgYnkKKyAqICAgICB0aGUgRnJl
ZSBTb2Z0d2FyZSBGb3VuZGF0aW9uOyBlaXRoZXIgdmVyc2lvbiAyIG9mIHRo
ZSBMaWNlbnNlLCBvcgorICogICAgIChhdCB5b3VyIG9wdGlvbikgYW55IGxh
dGVyIHZlcnNpb24uCisgKgorICogICAgIEEgY29weSBvZiB0aGUgR05VIEdl
bmVyYWwgUHVibGljIExpY2Vuc2UgY2FuIGJlIGZvdW5kIGF0CisgKiAgICAg
aHR0cDovL3d3dy5nbnUub3JnLworICoKKyAqIFdyaXR0ZW4gYnkgR2FyeSBS
LiBWYW4gU2lja2xlIDxnLnIudmFuc2lja2xlQHdvcmxkbmV0LmF0dC5uZXQ+
CisgKgorICovCisKKy8vIFRoaXMgaXMgdGhlIGhlYWRlciBmb3IgdGhlIFRo
cmVlQmFyUHJvZ3Jlc3NQYWdlIGNsYXNzLiAgSXQgaXMgYSBmYWlybHkgZ2Vu
ZXJpYworLy8gcHJvZ3Jlc3MgaW5kaWNhdG9yIHByb3BlcnR5IHBhZ2Ugd2l0
aCB0aHJlZSBwcm9ncmVzcyBiYXJzLgorCisKKyNpbmNsdWRlICJ3aW4zMi5o
IgorI2luY2x1ZGUgInByb3BwYWdlLmgiCisKKyNkZWZpbmUgV01fQVBQX1NU
QVJUX0RPV05MT0FEICAgICAgICAgICAgICBXTV9BUFArMAorI2RlZmluZSBX
TV9BUFBfRE9XTkxPQURfVEhSRUFEX0NPTVBMRVRFICAgIFdNX0FQUCsxCisj
ZGVmaW5lIFdNX0FQUF9TVEFSVF9JTlNUQUxMICAgICAgICAgICAgICAgV01f
QVBQKzIKKyNkZWZpbmUgV01fQVBQX0lOU1RBTExfVEhSRUFEX0NPTVBMRVRF
ICAgICBXTV9BUFArMworI2RlZmluZSBXTV9BUFBfU1RBUlRfU0lURV9JTkZP
X0RPV05MT0FEICAgIFdNX0FQUCs0CisjZGVmaW5lIFdNX0FQUF9TSVRFX0lO
Rk9fRE9XTkxPQURfQ09NUExFVEUgV01fQVBQKzUKKyNkZWZpbmUgV01fQVBQ
X1NUQVJUX1NFVFVQX0lOSV9ET1dOTE9BRCAgICBXTV9BUFArNgorI2RlZmlu
ZSBXTV9BUFBfU0VUVVBfSU5JX0RPV05MT0FEX0NPTVBMRVRFIFdNX0FQUCs3
CisKK2NsYXNzIFRocmVlQmFyUHJvZ3Jlc3NQYWdlOnB1YmxpYyBQcm9wZXJ0
eVBhZ2UKK3sKKyAgSFdORCBpbnNfZGlhbG9nOworICBIV05EIGluc19hY3Rp
b247CisgIEhXTkQgaW5zX3BrZ25hbWU7CisgIEhXTkQgaW5zX2ZpbGVuYW1l
OworICBIV05EIGluc19wcHJvZ3Jlc3M7CisgIEhXTkQgaW5zX2lwcm9ncmVz
czsKKyAgSFdORCBpbnNfZGlza2Z1bGw7CisgIEhXTkQgaW5zX2JsX3BhY2th
Z2U7CisgIEhXTkQgaW5zX2JsX3RvdGFsOworICBIV05EIGluc19ibF9kaXNr
OworCisgIGludCB0YXNrOworCisgIHZvaWQgRW5hYmxlU2luZ2xlQmFyIChi
b29sIGVuYWJsZSA9IHRydWUpOworCitwdWJsaWM6CisgICAgVGhyZWVCYXJQ
cm9ncmVzc1BhZ2UgKCkKKyAgeworICB9OworICB2aXJ0dWFsIH4gVGhyZWVC
YXJQcm9ncmVzc1BhZ2UgKCkKKyAgeworICB9OworCisgIGJvb2wgQ3JlYXRl
ICgpOworCisgIHZpcnR1YWwgdm9pZCBPbkluaXQgKCk7CisgIHZpcnR1YWwg
dm9pZCBPbkFjdGl2YXRlICgpOworICB2aXJ0dWFsIGJvb2wgT25NZXNzYWdl
QXBwIChVSU5UIHVNc2csIFdQQVJBTSB3UGFyYW0sIExQQVJBTSBsUGFyYW0p
OworCisgIHZvaWQgU2V0VGV4dDEgKGNvbnN0IFRDSEFSICogdCk7CisgIHZv
aWQgU2V0VGV4dDIgKGNvbnN0IFRDSEFSICogdCk7CisgIHZvaWQgU2V0VGV4
dDMgKGNvbnN0IFRDSEFSICogdCk7CisKKyAgdm9pZCBTZXRCYXIxIChsb25n
IHByb2dyZXNzLCBsb25nIG1heCA9IDEwMCk7CisgIHZvaWQgU2V0QmFyMiAo
bG9uZyBwcm9ncmVzcywgbG9uZyBtYXggPSAxMDApOworICB2b2lkIFNldEJh
cjMgKGxvbmcgcHJvZ3Jlc3MsIGxvbmcgbWF4ID0gMTAwKTsKKworICB2b2lk
IFNldEFjdGl2YXRlVGFzayAoaW50IHQpCisgIHsKKyAgICB0YXNrID0gdDsK
KyAgfTsKK307CisKKworI2VuZGlmIC8vIENJTlNUQUxMX1RIUkVFQkFSX0gK
SW5kZXg6IHdpbmRvdy5jYwo9PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09ClJDUyBm
aWxlOiB3aW5kb3cuY2MKZGlmZiAtTiB3aW5kb3cuY2MKLS0tIC9kZXYvbnVs
bAlUdWUgTWF5ICA1IDEzOjMyOjI3IDE5OTgKKysrIHdpbmRvdy5jYwlUaHUg
RGVjIDIwIDA0OjM2OjAzIDIwMDEKQEAgLTAsMCArMSwyNjkgQEAKKy8qCisg
KiBDb3B5cmlnaHQgKGMpIDIwMDEsIEdhcnkgUi4gVmFuIFNpY2tsZS4KKyAq
CisgKiAgICAgVGhpcyBwcm9ncmFtIGlzIGZyZWUgc29mdHdhcmU7IHlvdSBj
YW4gcmVkaXN0cmlidXRlIGl0IGFuZC9vciBtb2RpZnkKKyAqICAgICBpdCB1
bmRlciB0aGUgdGVybXMgb2YgdGhlIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNl
bnNlIGFzIHB1Ymxpc2hlZCBieQorICogICAgIHRoZSBGcmVlIFNvZnR3YXJl
IEZvdW5kYXRpb247IGVpdGhlciB2ZXJzaW9uIDIgb2YgdGhlIExpY2Vuc2Us
IG9yCisgKiAgICAgKGF0IHlvdXIgb3B0aW9uKSBhbnkgbGF0ZXIgdmVyc2lv
bi4KKyAqCisgKiAgICAgQSBjb3B5IG9mIHRoZSBHTlUgR2VuZXJhbCBQdWJs
aWMgTGljZW5zZSBjYW4gYmUgZm91bmQgYXQKKyAqICAgICBodHRwOi8vd3d3
LmdudS5vcmcvCisgKgorICogV3JpdHRlbiBieSBHYXJ5IFIuIFZhbiBTaWNr
bGUgPGcuci52YW5zaWNrbGVAd29ybGRuZXQuYXR0Lm5ldD4KKyAqCisgKi8K
KworLy8gVGhpcyBpcyB0aGUgaW1wbGVtZW50YXRpb24gb2YgdGhlIFdpbmRv
dyBjbGFzcy4gIEl0IHNlcnZlcyBib3RoIGFzIGEgd2luZG93IGNsYXNzCisv
LyBpbiBpdHMgb3duIHJpZ2h0IGFuZCBhcyBhIGJhc2UgY2xhc3MgZm9yIG90
aGVyIHdpbmRvdy1saWtlIGNsYXNzZXMgKGUuZy4gUHJvcGVydHlQYWdlLAor
Ly8gUHJvcFNoZWV0KS4KKworI2luY2x1ZGUgPHdpbmRvd3MuaD4KKyNpbmNs
dWRlICJ3aW5kb3cuaCIKKworQVRPTQorICBXaW5kb3c6OldpbmRvd0NsYXNz
QXRvbSA9CisgIDA7CitISU5TVEFOQ0UKKyAgV2luZG93OjpBcHBJbnN0YW5j
ZSA9CisgIE5VTEw7CisKKy8vIEZJWE1FOiBJIGtub3csIHRoaXMgaXMgYnJ1
dGFsLiAgTXV0ZXhpbmcgc2hvdWxkIGF0IGxlYXN0IG1ha2Ugd2luZG93IGNy
ZWF0aW9uIHRocmVhZHNhZmUsCisvLyBidXQgaWYgc29tZWJvZHkgaGFzIGFu
eSBpZGVhcyBhcyB0byBob3cgdG8gZ2V0IHJpZCBvZiBpdCBlbnRpcmVseSwg
cGxlYXNlIHRlbGwgbWUgLyBkbyBzby4KK3N0cnVjdCBSRUZMRUNUSU9OX0lO
Rk8KK3sKKyAgV2luZG93ICoKKyAgICBUaGlzOworICBib29sCisgICAgRmly
c3RDYWxsOworfTsKK1JFRkxFQ1RJT05fSU5GTworICBSZWZsZWN0aW9uSW5m
bzsKKworV2luZG93OjpXaW5kb3cgKCkKK3sKKyAgV2luZG93SGFuZGxlID0g
TlVMTDsKKyAgUGFyZW50ID0gTlVMTDsKK30KKworV2luZG93Ojp+V2luZG93
ICgpCit7CisgIC8vIEZJWE1FOiBNYXliZSBkbyBzb21lIHJlZmVyZW5jZSBj
b3VudGluZyBhbmQgZG8gdGhpcyBVbnJlZ2lzdGVyCisgIC8vIHdoZW4gdGhl
cmUgYXJlIG5vIG1vcmUgb2YgdXMgbGVmdC4gIE5vdCByZWFsIGNyaXRpY2Fs
IHVubGVzcworICAvLyB3ZSdyZSBpbiBhIERMTCB3aGljaCB3ZSdyZSBub3Qg
cmlnaHQgbm93LgorICAvL1VucmVnaXN0ZXJDbGFzcyhXaW5kb3dDbGFzc0F0
b20sIEluc3RhbmNlSGFuZGxlKTsKK30KKworTFJFU1VMVCBDQUxMQkFDSwor
V2luZG93OjpGaXJzdFdpbmRvd1Byb2NSZWZsZWN0b3IgKEhXTkQgaHduZCwg
VUlOVCB1TXNnLCBXUEFSQU0gd1BhcmFtLAorCQkJCSAgTFBBUkFNIGxQYXJh
bSkKK3sKKyAgLy8gR2V0IG91ciB0aGlzIHBvaW50ZXIKKyAgUkVGTEVDVElP
Tl9JTkZPICpyaXAgPSAmUmVmbGVjdGlvbkluZm87CisKKyAgaWYgKHJpcC0+
Rmlyc3RDYWxsKQorICAgIHsKKyAgICAgIHJpcC0+Rmlyc3RDYWxsID0gZmFs
c2U7CisKKyAgICAgIC8vIFNldCB0aGUgV2luZG93IGhhbmRsZSBzbyB0aGUg
cmVhbCBXaW5kb3dQcm9jIGhhcyBvbmUgdG8gd29yayB3aXRoLgorICAgICAg
cmlwLT5UaGlzLT5XaW5kb3dIYW5kbGUgPSBod25kOworCisgICAgICAvLyBT
ZXQgYSBiYWNrcmVmZXJlbmNlIHRvIHRoaXMgY2xhc3MgaW5zdGFuY2UgaW4g
dGhlIEhXTkQuCisgICAgICAvLyBGSVhNRTogU2hvdWxkIHJlYWxseSBiZSBT
ZXRXaW5kb3dMb25nUHRyKCksIGJ1dCBpdCBhcHBlYXJzIHRvCisgICAgICAv
LyBub3QgYmUgZGVmaW5lZCB5ZXQuCisgICAgICBTZXRXaW5kb3dMb25nICho
d25kLCBHV0xfVVNFUkRBVEEsIChMT05HKSByaXAtPlRoaXMpOworCisgICAg
ICAvLyBTZXQgYSBuZXcgV2luZG93UHJvYyBub3cgdGhhdCB3ZSBoYXZlIHRo
ZSBwZWxpbWluYXJpZXMgZG9uZS4KKyAgICAgIC8vIExpa2Ugc3ViY2xhc3Np
bmcsIG9ubHkgbm90LgorICAgICAgU2V0V2luZG93TG9uZyAoaHduZCwgR1dM
X1dORFBST0MsIChMT05HKSAmIFdpbmRvdzo6V2luZG93UHJvY1JlZmxlY3Rv
cik7CisgICAgfQorCisgIHJldHVybiByaXAtPlRoaXMtPldpbmRvd1Byb2Mg
KHVNc2csIHdQYXJhbSwgbFBhcmFtKTsKK30KKworTFJFU1VMVCBDQUxMQkFD
SworV2luZG93OjpXaW5kb3dQcm9jUmVmbGVjdG9yIChIV05EIGh3bmQsIFVJ
TlQgdU1zZywgV1BBUkFNIHdQYXJhbSwKKwkJCSAgICAgTFBBUkFNIGxQYXJh
bSkKK3sKKyAgV2luZG93ICpUaGlzOworCisgIC8vIEdldCBvdXIgdGhpcyBw
b2ludGVyCisgIC8vIEZJWE1FOiBTaG91bGQgcmVhbGx5IGJlIEdldFdpbmRv
d0xvbmdQdHIoKSwgYnV0IGl0IGFwcGVhcnMgdG8KKyAgLy8gbm90IGJlIGRl
ZmluZWQgeWV0LgorICBUaGlzID0gKFdpbmRvdyAqKSBHZXRXaW5kb3dMb25n
IChod25kLCBHV0xfVVNFUkRBVEEpOworCisgIHJldHVybiBUaGlzLT5XaW5k
b3dQcm9jICh1TXNnLCB3UGFyYW0sIGxQYXJhbSk7Cit9CisKK2Jvb2wKK1dp
bmRvdzo6Q3JlYXRlIChXaW5kb3cgKiBwYXJlbnQsIERXT1JEIFN0eWxlKQor
eworICAvLyBGaXJzdCByZWdpc3RlciB0aGUgd2luZG93IGNsYXNzLCBpZiB3
ZSBoYXZlbid0IGFscmVhZHkKKyAgaWYgKFJlZ2lzdGVyV2luZG93Q2xhc3Mg
KCkgPT0gZmFsc2UpCisgICAgeworICAgICAgLy8gUmVnaXN0cmF0aW9uIGZh
aWxlZAorICAgICAgcmV0dXJuIGZhbHNlOworICAgIH0KKworICAvLyBTZXQg
dXAgdGhlIHJlZmxlY3Rpb24gaW5mbywgc28gdGhhdCB0aGUgV2luZG93cyB3
aW5kb3cgY2FuIGZpbmQgdXMuCisgIFJlZmxlY3Rpb25JbmZvLlRoaXMgPSB0
aGlzOworICBSZWZsZWN0aW9uSW5mby5GaXJzdENhbGwgPSB0cnVlOworCisg
IFBhcmVudCA9IHBhcmVudDsKKworICAvLyBDcmVhdGUgdGhlIHdpbmRvdyBp
bnN0YW5jZQorICBXaW5kb3dIYW5kbGUgPSBDcmVhdGVXaW5kb3cgKCJNYWlu
V2luZG93Q2xhc3MiLAkvL01BS0VJTlRBVE9NKFdpbmRvd0NsYXNzQXRvbSks
ICAgICAvLyB3aW5kb3cgY2xhc3MgYXRvbSAobmFtZSkKKwkJCSAgICAgICAi
SGVsbG8iLAkvLyBubyB0aXRsZS1iYXIgc3RyaW5nIHlldAorCQkJICAgICAg
IC8vIFN0eWxlIGJpdHMKKwkJCSAgICAgICBTdHlsZSwKKwkJCSAgICAgICAv
LyBEZWZhdWx0IHBvc2l0aW9ucyBhbmQgc2l6ZQorCQkJICAgICAgIENXX1VT
RURFRkFVTFQsCisJCQkgICAgICAgQ1dfVVNFREVGQVVMVCwgQ1dfVVNFREVG
QVVMVCwgQ1dfVVNFREVGQVVMVCwKKwkJCSAgICAgICAvLyBQYXJlbnQgV2lu
ZG93IAorCQkJICAgICAgIHBhcmVudCA9PQorCQkJICAgICAgIE5VTEwgPyAo
SFdORCkgTlVMTCA6IHBhcmVudC0+R2V0SFdORCAoKSwKKwkJCSAgICAgICAv
LyB1c2UgY2xhc3MgbWVudSAKKwkJCSAgICAgICAoSE1FTlUpIE5VTEwsCisJ
CQkgICAgICAgLy8gVGhlIGFwcGxpY2F0aW9uIGluc3RhbmNlIAorCQkJICAg
ICAgIEdldEluc3RhbmNlICgpLCAoTFBWT0lEKSBOVUxMKTsKKworICBpZiAo
V2luZG93SGFuZGxlID09IE5VTEwpCisgICAgeworICAgICAgLy8gRmFpbGVk
CisgICAgICByZXR1cm4gZmFsc2U7CisgICAgfQorCisgIHJldHVybiB0cnVl
OworfQorCitib29sCitXaW5kb3c6OlJlZ2lzdGVyV2luZG93Q2xhc3MgKCkK
K3sKKyAgaWYgKFdpbmRvd0NsYXNzQXRvbSA9PSAwKQorICAgIHsKKyAgICAg
IC8vIFdlJ3JlIG5vdCByZWdpc3RlcmVkIHlldAorICAgICAgV05EQ0xBU1NF
WCB3YzsKKworICAgICAgd2MuY2JTaXplID0gc2l6ZW9mICh3Yyk7CisgICAg
ICAvLyBTb21lIHNlbnNpYmxlIHN0eWxlIGRlZmF1bHRzCisgICAgICB3Yy5z
dHlsZSA9IENTX0RCTENMS1MgfCBDU19IUkVEUkFXIHwgQ1NfVlJFRFJBVzsK
KyAgICAgIC8vIE91ciBkZWZhdWx0IHdpbmRvdyBwcm9jZWR1cmUuICBUaGlz
IHJlcGxhY2VzIGl0c2VsZgorICAgICAgLy8gb24gdGhlIGZpcnN0IGNhbGwg
d2l0aCB0aGUgc2ltcGxlciBXaW5kb3c6OldpbmRvd1Byb2NSZWZsZWN0b3Io
KS4KKyAgICAgIHdjLmxwZm5XbmRQcm9jID0gV2luZG93OjpGaXJzdFdpbmRv
d1Byb2NSZWZsZWN0b3I7CisgICAgICAvLyBObyBjbGFzcyBieXRlcworICAg
ICAgd2MuY2JDbHNFeHRyYSA9IDA7CisgICAgICAvLyBPbmUgcG9pbnRlciB0
byBSRUZMRUNUSU9OX0lORk8gaW4gdGhlIGV4dHJhIHdpbmRvdyBpbnN0YW5j
ZSBieXRlcworICAgICAgd2MuY2JXbmRFeHRyYSA9IDQ7CisgICAgICAvLyBU
aGUgYXBwIGluc3RhbmNlCisgICAgICB3Yy5oSW5zdGFuY2UgPSBHZXRJbnN0
YW5jZSAoKTsKKyAgICAgIC8vIFVzZSBhIGJ1bmNoIG9mIHN5c3RlbSBkZWZh
dWx0cyBmb3IgdGhlIEdVSSBlbGVtZW50cworICAgICAgd2MuaEljb24gPSBO
VUxMOworICAgICAgd2MuaEljb25TbSA9IE5VTEw7CisgICAgICB3Yy5oQ3Vy
c29yID0gTlVMTDsKKyAgICAgIHdjLmhickJhY2tncm91bmQgPSAoSEJSVVNI
KSAoQ09MT1JfQkFDS0dST1VORCArIDEpOworICAgICAgLy8gTm8gbWVudQor
ICAgICAgd2MubHBzek1lbnVOYW1lID0gTlVMTDsKKyAgICAgIC8vIFdlJ2xs
IGdldCBhIGxpdHRsZSBjcmF6eSBoZXJlIHdpdGggdGhlIGNsYXNzIG5hbWUK
KyAgICAgIHdjLmxwc3pDbGFzc05hbWUgPSAiTWFpbldpbmRvd0NsYXNzIjsK
KworICAgICAgLy8gQWxsIHNldCwgdHJ5IHRvIHJlZ2lzdGVyCisgICAgICBX
aW5kb3dDbGFzc0F0b20gPSBSZWdpc3RlckNsYXNzRXggKCZ3Yyk7CisKKyAg
ICAgIGlmIChXaW5kb3dDbGFzc0F0b20gPT0gMCkKKwl7CisJICAvLyBGYWls
ZWQKKwkgIHJldHVybiBmYWxzZTsKKwl9CisgICAgfQorCisgIC8vIFdlJ3Jl
IHJlZ2lzdGVyZWQsIG9yIGFscmVhZHkgd2VyZSBiZWZvcmUgdGhlIGNhbGws
CisgIC8vIHJldHVybiBzdWNjZXNzIGluIGVpdGhlciBjYXNlLgorICByZXR1
cm4gdHJ1ZTsKK30KKwordm9pZAorV2luZG93OjpTaG93IChpbnQgU3RhdGUp
Cit7CisgIDo6U2hvd1dpbmRvdyAoV2luZG93SGFuZGxlLCBTdGF0ZSk7Cit9
CisKK3ZvaWQKK1dpbmRvdzo6Q2VudGVyV2luZG93ICgpCit7CisgIFJFQ1Qg
V2luZG93UmVjdCwgUGFyZW50UmVjdDsKKyAgaW50IFdpbmRvd1dpZHRoLCBX
aW5kb3dIZWlnaHQ7CisgIFBPSU5UIHA7CisKKyAgLy8gR2V0IHRoZSB3aW5k
b3cgcmVjdGFuZ2xlCisgIEdldFdpbmRvd1JlY3QgKEdldEhXTkQgKCksICZX
aW5kb3dSZWN0KTsKKworICBpZiAoR2V0UGFyZW50ICgpID09IE5VTEwpCisg
ICAgeworICAgICAgLy8gQ2VudGVyIG9uIGRlc2t0b3Agd2luZG93CisgICAg
ICBHZXRXaW5kb3dSZWN0IChHZXREZXNrdG9wV2luZG93ICgpLCAmUGFyZW50
UmVjdCk7CisgICAgfQorICBlbHNlCisgICAgeworICAgICAgLy8gQ2VudGVy
IG9uIGNsaWVudCBhcmVhIG9mIHBhcmVudAorICAgICAgR2V0Q2xpZW50UmVj
dCAoR2V0UGFyZW50ICgpLT5HZXRIV05EICgpLCAmUGFyZW50UmVjdCk7Cisg
ICAgfQorCisgIFdpbmRvd1dpZHRoID0gV2luZG93UmVjdC5yaWdodCAtIFdp
bmRvd1JlY3QubGVmdDsKKyAgV2luZG93SGVpZ2h0ID0gV2luZG93UmVjdC5i
b3R0b20gLSBXaW5kb3dSZWN0LnRvcDsKKworICAvLyBGaW5kIGNlbnRlciBv
ZiBhcmVhIHdlJ3JlIGNlbnRlcmluZyBvbgorICBwLnggPSAoUGFyZW50UmVj
dC5yaWdodCAtIFBhcmVudFJlY3QubGVmdCkgLyAyOworICBwLnkgPSAoUGFy
ZW50UmVjdC5ib3R0b20gLSBQYXJlbnRSZWN0LnRvcCkgLyAyOworCisgIC8v
IENvbnZlcnQgdGhhdCB0byBzY3JlZW4gY29vcmRzCisgIGlmIChHZXRQYXJl
bnQgKCkgPT0gTlVMTCkKKyAgICB7CisgICAgICBDbGllbnRUb1NjcmVlbiAo
R2V0RGVza3RvcFdpbmRvdyAoKSwgJnApOworICAgIH0KKyAgZWxzZQorICAg
IHsKKyAgICAgIENsaWVudFRvU2NyZWVuIChHZXRQYXJlbnQgKCktPkdldEhX
TkQgKCksICZwKTsKKyAgICB9CisKKyAgLy8gQ2FsY3VsYXRlIG5ldyB0b3Ag
bGVmdCBjb3JuZXIgZm9yIHdpbmRvdworICBwLnggLT0gV2luZG93V2lkdGgg
LyAyOworICBwLnkgLT0gV2luZG93SGVpZ2h0IC8gMjsKKworICAvLyBBbmQg
ZmluYWxseSBtb3ZlIHRoZSB3aW5kb3cKKyAgTW92ZVdpbmRvdyAoR2V0SFdO
RCAoKSwgcC54LCBwLnksIFdpbmRvd1dpZHRoLCBXaW5kb3dIZWlnaHQsIFRS
VUUpOworfQorCitMUkVTVUxUCitXaW5kb3c6OldpbmRvd1Byb2MgKFVJTlQg
dU1zZywgV1BBUkFNIHdQYXJhbSwgTFBBUkFNIGxQYXJhbSkKK3sKKyAgc3dp
dGNoICh1TXNnKQorICAgIHsKKyAgICBkZWZhdWx0OgorICAgICAgcmV0dXJu
IERlZldpbmRvd1Byb2MgKFdpbmRvd0hhbmRsZSwgdU1zZywgd1BhcmFtLCBs
UGFyYW0pOworICAgIH0KKworICByZXR1cm4gMDsKK30KKworYm9vbAorV2lu
ZG93OjpNZXNzYWdlTG9vcCAoKQoreworICBNU0cgbXNnOworCisgIHdoaWxl
IChHZXRNZXNzYWdlICgmbXNnLCBOVUxMLCAwLCAwKSAhPSAwCisJICYmIEdl
dE1lc3NhZ2UgKCZtc2csIChIV05EKSBOVUxMLCAwLCAwKSAhPSAtMSkKKyAg
ICB7CisgICAgICBpZiAoIUlzV2luZG93IChXaW5kb3dIYW5kbGUpIHx8ICFJ
c0RpYWxvZ01lc3NhZ2UgKFdpbmRvd0hhbmRsZSwgJm1zZykpCisJeworCSAg
VHJhbnNsYXRlTWVzc2FnZSAoJm1zZyk7CisJICBEaXNwYXRjaE1lc3NhZ2Ug
KCZtc2cpOworCX0KKyAgICB9CisKKyAgcmV0dXJuIHRydWU7Cit9CisKK3Zv
aWQKK1dpbmRvdzo6UG9zdE1lc3NhZ2UgKFVJTlQgdU1zZywgV1BBUkFNIHdQ
YXJhbSwgTFBBUkFNIGxQYXJhbSkKK3sKKyAgOjpQb3N0TWVzc2FnZSAoR2V0
SFdORCAoKSwgdU1zZywgd1BhcmFtLCBsUGFyYW0pOworfQpJbmRleDogd2lu
ZG93LmgKPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PQpSQ1MgZmlsZTogd2luZG93
LmgKZGlmZiAtTiB3aW5kb3cuaAotLS0gL2Rldi9udWxsCVR1ZSBNYXkgIDUg
MTM6MzI6MjcgMTk5OAorKysgd2luZG93LmgJVGh1IERlYyAyMCAwNDozNjow
MyAyMDAxCkBAIC0wLDAgKzEsOTUgQEAKKyNpZm5kZWYgQ0lOU1RBTExfV0lO
RE9XX0gKKyNkZWZpbmUgQ0lOU1RBTExfV0lORE9XX0gKKworLyoKKyAqIENv
cHlyaWdodCAoYykgMjAwMSwgR2FyeSBSLiBWYW4gU2lja2xlLgorICoKKyAq
ICAgICBUaGlzIHByb2dyYW0gaXMgZnJlZSBzb2Z0d2FyZTsgeW91IGNhbiBy
ZWRpc3RyaWJ1dGUgaXQgYW5kL29yIG1vZGlmeQorICogICAgIGl0IHVuZGVy
IHRoZSB0ZXJtcyBvZiB0aGUgR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2Ug
YXMgcHVibGlzaGVkIGJ5CisgKiAgICAgdGhlIEZyZWUgU29mdHdhcmUgRm91
bmRhdGlvbjsgZWl0aGVyIHZlcnNpb24gMiBvZiB0aGUgTGljZW5zZSwgb3IK
KyAqICAgICAoYXQgeW91ciBvcHRpb24pIGFueSBsYXRlciB2ZXJzaW9uLgor
ICoKKyAqICAgICBBIGNvcHkgb2YgdGhlIEdOVSBHZW5lcmFsIFB1YmxpYyBM
aWNlbnNlIGNhbiBiZSBmb3VuZCBhdAorICogICAgIGh0dHA6Ly93d3cuZ251
Lm9yZy8KKyAqCisgKiBXcml0dGVuIGJ5IEdhcnkgUi4gVmFuIFNpY2tsZSA8
Zy5yLnZhbnNpY2tsZUB3b3JsZG5ldC5hdHQubmV0PgorICoKKyAqLworCisv
LyBUaGlzIGlzIHRoZSBoZWFkZXIgZm9yIHRoZSBXaW5kb3cgY2xhc3MuICBJ
dCBzZXJ2ZXMgYm90aCBhcyBhIHdpbmRvdyBjbGFzcworLy8gaW4gaXRzIG93
biByaWdodCBhbmQgYXMgYSBiYXNlIGNsYXNzIGZvciBvdGhlciB3aW5kb3ct
bGlrZSBjbGFzc2VzIChlLmcuIFByb3BlcnR5UGFnZSwKKy8vIFByb3BTaGVl
dCkuCisKKyNpbmNsdWRlIDx3aW5kb3dzLmg+CisKK2NsYXNzIFdpbmRvdwor
eworICBzdGF0aWMgQVRPTSBXaW5kb3dDbGFzc0F0b207CisgIHN0YXRpYyBI
SU5TVEFOQ0UgQXBwSW5zdGFuY2U7CisKKworICBib29sIFJlZ2lzdGVyV2lu
ZG93Q2xhc3MgKCk7CisgIHN0YXRpYyBMUkVTVUxUIENBTExCQUNLIEZpcnN0
V2luZG93UHJvY1JlZmxlY3RvciAoSFdORCBod25kLCBVSU5UIHVNc2csCisJ
CQkJCQkgICAgV1BBUkFNIHdQYXJhbSwKKwkJCQkJCSAgICBMUEFSQU0gbFBh
cmFtKTsKKyAgc3RhdGljIExSRVNVTFQgQ0FMTEJBQ0sgV2luZG93UHJvY1Jl
ZmxlY3RvciAoSFdORCBod25kLCBVSU5UIHVNc2csCisJCQkJCSAgICAgICBX
UEFSQU0gd1BhcmFtLCBMUEFSQU0gbFBhcmFtKTsKKworICBIV05EIFdpbmRv
d0hhbmRsZTsKKworICBXaW5kb3cgKlBhcmVudDsKKworcHJvdGVjdGVkOgor
ICB2b2lkIFNldEhXTkQgKEhXTkQgaCkKKyAgeworICAgIFdpbmRvd0hhbmRs
ZSA9IGg7CisgIH07CisKK3B1YmxpYzoKKyAgV2luZG93ICgpOworICB2aXJ0
dWFsIH4gV2luZG93ICgpOworCisgIHN0YXRpYyB2b2lkIFNldEFwcEluc3Rh
bmNlIChISU5TVEFOQ0UgaCkKKyAgeworICAgIEFwcEluc3RhbmNlID0gaDsK
KyAgfTsKKworICB2aXJ0dWFsIExSRVNVTFQgV2luZG93UHJvYyAoVUlOVCB1
TXNnLCBXUEFSQU0gd1BhcmFtLCBMUEFSQU0gbFBhcmFtKTsKKyAgdmlydHVh
bCBib29sIE1lc3NhZ2VMb29wICgpOworCisgIHZpcnR1YWwgYm9vbCBDcmVh
dGUgKFdpbmRvdyAqIFBhcmVudCA9IE5VTEwsCisJCSAgICAgICBEV09SRCBT
dHlsZSA9CisJCSAgICAgICBXU19PVkVSTEFQUEVEV0lORE9XIHwgV1NfVklT
SUJMRSB8IFdTX0NMSVBDSElMRFJFTik7CisgIHZvaWQgU2hvdyAoaW50IFN0
YXRlKTsKKworICBIV05EIEdldEhXTkQgKCkgY29uc3QKKyAgeworICAgIHJl
dHVybiBXaW5kb3dIYW5kbGU7CisgIH07CisgIEhJTlNUQU5DRSBHZXRJbnN0
YW5jZSAoKSBjb25zdAorICB7CisgICAgcmV0dXJuIEFwcEluc3RhbmNlOwor
ICB9OworCisgIFdpbmRvdyAqR2V0UGFyZW50ICgpIGNvbnN0CisgIHsKKyAg
ICByZXR1cm4gUGFyZW50OworICB9OworICBIV05EIEdldERsZ0l0ZW0gKGlu
dCBpZCkgY29uc3QKKyAgeworICAgIHJldHVybjo6R2V0RGxnSXRlbSAoR2V0
SFdORCAoKSwgaWQpOworICB9OworCisgIHZvaWQgUG9zdE1lc3NhZ2UgKFVJ
TlQgdU1zZywgV1BBUkFNIHdQYXJhbSA9IDAsIExQQVJBTSBsUGFyYW0gPSAw
KTsKKworICB2aXJ0dWFsIGJvb2wgT25NZXNzYWdlQXBwIChVSU5UIHVNc2cs
IFdQQVJBTSB3UGFyYW0sIExQQVJBTSBsUGFyYW0pCisgIHsKKyAgICByZXR1
cm4gZmFsc2U7CisgIH07CisKKyAgLy8gQ2VudGVyIHRoZSB3aW5kb3cgb24g
dGhlIHBhcmVudCwgb3Igb24gc2NyZWVuIGlmIG5vIHBhcmVudC4KKyAgdm9p
ZCBDZW50ZXJXaW5kb3cgKCk7CisKK307CisKKyNlbmRpZiAvLyBDSU5TVEFM
TF9XSU5ET1dfSAo=

------------=_1583532850-65438-128--
