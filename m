Return-Path: <cygwin-patches-return-9413-listarch-cygwin-patches=sources.redhat.com@cygwin.com>
Received: (qmail 48413 invoked by alias); 26 May 2019 15:10:46 -0000
Mailing-List: contact cygwin-patches-help@cygwin.com; run by ezmlm
Precedence: bulk
List-Id: <cygwin-patches.cygwin.com>
List-Subscribe: <mailto:cygwin-patches-subscribe@cygwin.com>
List-Post: <mailto:cygwin-patches@cygwin.com>
List-Archive: <http://sourceware.org/ml/cygwin-patches/>
List-Help: <mailto:cygwin-patches-help@cygwin.com>, <http://sourceware.org/ml/#faqs>
Sender: cygwin-patches-owner@cygwin.com
Mail-Followup-To: cygwin-patches@cygwin.com
Received: (qmail 48352 invoked by uid 89); 26 May 2019 15:10:46 -0000
Authentication-Results: sourceware.org; auth=none
X-Spam-SWARE-Status: No, score=-23.6 required=5.0 tests=AWL,BAYES_00,GIT_PATCH_0,GIT_PATCH_1,GIT_PATCH_2,GIT_PATCH_3,MIME_BASE64_BLANKS,RCVD_IN_DNSWL_NONE,SPF_HELO_PASS,SPF_PASS autolearn=ham version=3.3.1 spammy=
X-HELO: NAM05-DM3-obe.outbound.protection.outlook.com
Received: from mail-eopbgr730108.outbound.protection.outlook.com (HELO NAM05-DM3-obe.outbound.protection.outlook.com) (40.107.73.108) by sourceware.org (qpsmtpd/0.93/v0.84-503-g423c35a) with ESMTP; Sun, 26 May 2019 15:10:44 +0000
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=cornell.edu; s=selector2; h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck; bh=G1CgOKxcUeKpV3hEwLX/MwGbiPBAxnjQanlYhjSSDGM=; b=got0hpHLLvziz74dIakwREcYjmMH31T8y9PS7/OaB6h9S3o1OrJO1PANGh71hEs2LZNyPHd6huL6Gf0ivFxVTT+sexcBj8RoS0pQ5IjhNg/ScJ2nROY5XrmrCAyuwp+jNX4GkWOKREKVyGzmeEhsx/GQXr93EZSSg/47Edndzuc=
Received: from DM6PR04MB5211.namprd04.prod.outlook.com (20.178.24.208) by DM6PR04MB4777.namprd04.prod.outlook.com (20.176.107.206) with Microsoft SMTP Server (version=TLS1_2, cipher=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384) id 15.20.1922.15; Sun, 26 May 2019 15:10:37 +0000
Received: from DM6PR04MB5211.namprd04.prod.outlook.com ([fe80::510a:3a42:f346:a4d8]) by DM6PR04MB5211.namprd04.prod.outlook.com ([fe80::510a:3a42:f346:a4d8%7]) with mapi id 15.20.1922.021; Sun, 26 May 2019 15:10:37 +0000
From: Ken Brown <kbrown@cornell.edu>
To: "cygwin-patches@cygwin.com" <cygwin-patches@cygwin.com>
Subject: [PATCH draft 3/6] Cygwin: fhandler_pipe: set the blocking mode of the Windows pipe
Date: Sun, 26 May 2019 15:10:00 -0000
Message-ID: <20190526151019.2187-4-kbrown@cornell.edu>
References: <20190526151019.2187-1-kbrown@cornell.edu>
In-Reply-To: <20190526151019.2187-1-kbrown@cornell.edu>
authentication-results: spf=none (sender IP is ) smtp.mailfrom=kbrown@cornell.edu;
x-ms-oob-tlc-oobclassifiers: OLM:6108;
received-spf: None (protection.outlook.com: cornell.edu does not designate permitted sender hosts)
x-ms-exchange-senderadcheck: 1
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
MIME-Version: 1.0
X-MS-Exchange-CrossTenant-mailboxtype: HOSTED
X-MS-Exchange-CrossTenant-userprincipalname: ksb2@cornell.edu
X-IsSubscribed: yes
X-SW-Source: 2019-q2/txt/msg00120.txt.bz2

QWRkIG1ldGhvZHMgJ3NldF9waXBlX25vbl9ibG9ja2luZycgYW5kICdmY250
bCcgdG8ga2VlcCB0aGUgYmxvY2tpbmcNCm1vZGUgb2YgdGhlIFdpbmRvd3Mg
cGlwZSBpbiBzeW5jIHdpdGggdGhhdCBvZiB0aGUgZmhhbmRsZXJfcGlwZQ0K
b2JqZWN0LiAgVGhpcyBpcyB1c2VkIGZvciBwaXBlcyBjcmVhdGVkIHdpdGgg
dGhlICdwaXBlJyBhbmQgJ3BpcGUyJw0Kc3lzdGVtIGNhbGxzLg0KLS0tDQog
d2luc3VwL2N5Z3dpbi9maGFuZGxlci5oICAgICAgIHwgIDIgKysNCiB3aW5z
dXAvY3lnd2luL2ZoYW5kbGVyX3BpcGUuY2MgfCAzNCArKysrKysrKysrKysr
KysrKysrKysrKysrKysrKysrKy0tDQogMiBmaWxlcyBjaGFuZ2VkLCAzNCBp
bnNlcnRpb25zKCspLCAyIGRlbGV0aW9ucygtKQ0KDQpkaWZmIC0tZ2l0IGEv
d2luc3VwL2N5Z3dpbi9maGFuZGxlci5oIGIvd2luc3VwL2N5Z3dpbi9maGFu
ZGxlci5oDQppbmRleCBiOWNjN2I0NzEuLjVhZTI2MmM1YyAxMDA2NDQNCi0t
LSBhL3dpbnN1cC9jeWd3aW4vZmhhbmRsZXIuaA0KKysrIGIvd2luc3VwL2N5
Z3dpbi9maGFuZGxlci5oDQpAQCAtMTE5Miw2ICsxMTkyLDcgQEAgY2xhc3Mg
ZmhhbmRsZXJfcGlwZTogcHVibGljIGZoYW5kbGVyX2Jhc2UNCiBwcml2YXRl
Og0KICAgcGlkX3QgcG9wZW5fcGlkOw0KICAgc2l6ZV90IG1heF9hdG9taWNf
d3JpdGU7DQorICB2b2lkIHNldF9waXBlX25vbl9ibG9ja2luZyAoYm9vbCBu
b25ibG9ja2luZyk7DQogcHVibGljOg0KICAgZmhhbmRsZXJfcGlwZSAoKTsN
CiANCkBAIC0xMjA5LDYgKzEyMTAsNyBAQCBwdWJsaWM6DQogICB2b2lkIF9f
cmVnMyByYXdfcmVhZCAodm9pZCAqcHRyLCBzaXplX3QmIGxlbik7DQogICBz
c2l6ZV90IF9fcmVnMyByYXdfd3JpdGUgKGNvbnN0IHZvaWQgKnB0ciwgc2l6
ZV90IGxlbik7DQogICBpbnQgaW9jdGwgKHVuc2lnbmVkIGludCBjbWQsIHZv
aWQgKik7DQorICBpbnQgZmNudGwgKGludCBjbWQsIGludHB0cl90KTsNCiAg
IGludCBfX3JlZzIgZnN0YXQgKHN0cnVjdCBzdGF0ICpidWYpOw0KICAgaW50
IF9fcmVnMiBmc3RhdHZmcyAoc3RydWN0IHN0YXR2ZnMgKmJ1Zik7DQogICBp
bnQgX19yZWczIGZhZHZpc2UgKG9mZl90LCBvZmZfdCwgaW50KTsNCmRpZmYg
LS1naXQgYS93aW5zdXAvY3lnd2luL2ZoYW5kbGVyX3BpcGUuY2MgYi93aW5z
dXAvY3lnd2luL2ZoYW5kbGVyX3BpcGUuY2MNCmluZGV4IDQ3NjVhZGM4ZC4u
ZjgxNTk5OTJjIDEwMDY0NA0KLS0tIGEvd2luc3VwL2N5Z3dpbi9maGFuZGxl
cl9waXBlLmNjDQorKysgYi93aW5zdXAvY3lnd2luL2ZoYW5kbGVyX3BpcGUu
Y2MNCkBAIC0zNSw2ICszNSwyMyBAQCBmaGFuZGxlcl9waXBlOjpmaGFuZGxl
cl9waXBlICgpDQogICBuZWVkX2ZvcmtfZml4dXAgKHRydWUpOw0KIH0NCiAN
CisvKiBUaGlzIGFsc28gc2V0cyB0aGUgcGlwZSdzIHJlYWQgbW9kZSB0byBi
eXRlX3N0cmVhbSB1bmNvbmRpdGlvbmFsbHkuICovDQordm9pZA0KK2ZoYW5k
bGVyX3BpcGU6OnNldF9waXBlX25vbl9ibG9ja2luZyAoYm9vbCBub25ibG9j
a2luZykNCit7DQorICBOVFNUQVRVUyBzdGF0dXM7DQorICBJT19TVEFUVVNf
QkxPQ0sgaW87DQorICBGSUxFX1BJUEVfSU5GT1JNQVRJT04gZnBpOw0KKw0K
KyAgZnBpLlJlYWRNb2RlID0gRklMRV9QSVBFX0JZVEVfU1RSRUFNX01PREU7
DQorICBmcGkuQ29tcGxldGlvbk1vZGUgPSBub25ibG9ja2luZyA/IEZJTEVf
UElQRV9DT01QTEVURV9PUEVSQVRJT04NCisgICAgOiBGSUxFX1BJUEVfUVVF
VUVfT1BFUkFUSU9OOw0KKyAgc3RhdHVzID0gTnRTZXRJbmZvcm1hdGlvbkZp
bGUgKGdldF9oYW5kbGUgKCksICZpbywgJmZwaSwgc2l6ZW9mIGZwaSwNCisJ
CQkJIEZpbGVQaXBlSW5mb3JtYXRpb24pOw0KKyAgaWYgKCFOVF9TVUNDRVNT
IChzdGF0dXMpKQ0KKyAgICBkZWJ1Z19wcmludGYgKCJOdFNldEluZm9ybWF0
aW9uRmlsZShGaWxlUGlwZUluZm9ybWF0aW9uKTogJXkiLCBzdGF0dXMpOw0K
K30NCisNCiBpbnQNCiBmaGFuZGxlcl9waXBlOjppbml0IChIQU5ETEUgZiwg
RFdPUkQgYSwgbW9kZV90IG1vZGUsIGludDY0X3QgdW5pcV9pZCkNCiB7DQpA
QCAtNjIsOCArNzksNyBAQCBmaGFuZGxlcl9waXBlOjppbml0IChIQU5ETEUg
ZiwgRFdPUkQgYSwgbW9kZV90IG1vZGUsIGludDY0X3QgdW5pcV9pZCkNCiAg
IHNldF9pbm8gKHVuaXFfaWQpOw0KICAgc2V0X3VuaXF1ZV9pZCAodW5pcV9p
ZCB8ICEhKG1vZGUgJiBHRU5FUklDX1dSSVRFKSk7DQogICBpZiAob3BlbmVk
X3Byb3Blcmx5KQ0KLSAgICAvKiAuLi4gKi8NCi0gICAgOw0KKyAgICBzZXRf
cGlwZV9ub25fYmxvY2tpbmcgKGlzX25vbmJsb2NraW5nICgpKTsNCiAgIHJl
dHVybiAxOw0KIH0NCiANCkBAIC01NzYsNiArNTkyLDIwIEBAIGZoYW5kbGVy
X3BpcGU6OmlvY3RsICh1bnNpZ25lZCBpbnQgY21kLCB2b2lkICpwKQ0KICAg
cmV0dXJuIDA7DQogfQ0KIA0KK2ludA0KK2ZoYW5kbGVyX3BpcGU6OmZjbnRs
IChpbnQgY21kLCBpbnRwdHJfdCBhcmcpDQorew0KKyAgaWYgKGNtZCAhPSBG
X1NFVEZMKQ0KKyAgICByZXR1cm4gZmhhbmRsZXJfYmFzZTo6ZmNudGwgKGNt
ZCwgYXJnKTsNCisNCisgIGNvbnN0IGJvb2wgd2FzX25vbmJsb2NraW5nID0g
aXNfbm9uYmxvY2tpbmcgKCk7DQorICBpbnQgcmVzID0gZmhhbmRsZXJfYmFz
ZTo6ZmNudGwgKGNtZCwgYXJnKTsNCisgIGNvbnN0IGJvb2wgbm93X25vbmJs
b2NraW5nID0gaXNfbm9uYmxvY2tpbmcgKCk7DQorICBpZiAobm93X25vbmJs
b2NraW5nICE9IHdhc19ub25ibG9ja2luZykNCisgICAgc2V0X3BpcGVfbm9u
X2Jsb2NraW5nIChub3dfbm9uYmxvY2tpbmcpOw0KKyAgcmV0dXJuIHJlczsN
Cit9DQorDQogaW50IF9fcmVnMg0KIGZoYW5kbGVyX3BpcGU6OmZzdGF0IChz
dHJ1Y3Qgc3RhdCAqYnVmKQ0KIHsNCi0tIA0KMi4xNy4wDQoNCg==
