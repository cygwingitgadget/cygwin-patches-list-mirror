From: egor duda <deo@logos-m.ru>
To: egor duda <cygwin-patches@cygwin.com>
Subject: Re: storing symlink in extended attribute (on ntfs)
Date: Mon, 14 May 2001 07:07:00 -0000
Message-id: <178350282529.20010514180653@logos-m.ru>
References: <1791875116.20010510172000@logos-m.ru> <12912395994.20010510201521@logos-m.ru> <20010511142639.A26920@redhat.com> <64168820861.20010512154228@logos-m.ru>
X-SW-Source: 2001-q2/msg00250.html
Content-type: multipart/mixed; boundary="----------=_1583532848-65438-61"

This is a multi-part message in MIME format...

------------=_1583532848-65438-61
Content-length: 776

Hi!

Saturday, 12 May, 2001 egor duda deo@logos-m.ru wrote:

CF>> As a specific comment, I wonder if it would just make sense to store volume
CF>> information in the path_conv class to avoid going through the duplicate efforts
CF>> in symlink.

ed> i guess so. currently, GetVolumeInformation is called only when
ed> symlink is created, not resolved, but this will slow things down on
ed> file systems other than NTFS. to remove this penalty,
ed> GetVolumeInformation() should be called in symlink resolution code to, 
ed> and that's where volume information caching can save some cycles.

done. i think, however, that this patch should wait until 1.3.3

Egor.            mailto:deo@logos-m.ru ICQ 5165414 FidoNet 2:5020/496.19
symlink-in-ea-3.diff
symlink-in-ea-3.ChangeLog


------------=_1583532848-65438-61
Content-Type: text/plain; charset=us-ascii; name="symlink-in-ea-3.ChangeLog"
Content-Disposition: inline; filename="symlink-in-ea-3.ChangeLog"
Content-Transfer-Encoding: base64
Content-Length: 887

MjAwMS0wNS0xNCAgRWdvciBEdWRhICA8ZGVvQGxvZ29zLW0ucnU+CgoJKiBz
ZWN1cml0eS5oIChOVFdyaXRlRUEpOiBDaGFuZ2UgcHJvdG90eXBlLgoJKiBu
dGVhLmNjIChOVFJlYWRFQSk6IERvbid0IGNoZWNrIGZvciBnbG9iYWwgbnRl
YSBzZXR0aW5nLCBub3cKCWl0J3MgY2FsbGVyIHJlc3BvbnNpYmlsaXR5LgoJ
KE5UV3JpdGVFQSk6IERpdHRvLgoJKiBzZWN1cml0eS5jYyAoZ2V0X2ZpbGVf
YXR0cmlidXRlKTogUmVhZCBhdHRyaWJ1dGUgZnJvbSBFQSBvbmx5CglpZiAn
bnRlYScgaXMgZW5hYmxlZC4KCShzZXRfZmlsZV9hdHRyaWJ1dGUpOiBEaXR0
by4KCSogcGF0aC5oOiAoY2xhc3MgcGF0aF9jb252KTogQWRkIG1lbWJlcnMg
dG8gc3RvcmUgZmlsZSBzeXN0ZW0KCWluZm9ybWF0aW9uLgoJKiBwYXRoLmNj
IChwYXRoX2NvbnY6OnVwZGF0ZV9mc19pbmZvKTogTmV3IGZ1bmN0aW9ucy4K
CShwYXRoX2NvbnY6OmNoZWNrKTogR2V0IGZpbGUgc3lzdGVtIGluZm9ybWF0
aW9uIGZyb20gZGV2aWNlIHdoZXJlCglmaWxlIHJlc2lkZXMuCgkoZ2V0X3N5
bWxpbmtfZWEpOiBOZXcgZnVuY3Rpb24uCgkoc2V0X3N5bWxpbmtfZWEpOiBE
aXR0by4KCShzeW1saW5rKTogU3RvcmUgc3ltbGluayBpbiBleHRlbmRlZCBh
dHRyaWJ1dGUsIGlmIHBvc3NpYmxlLgo=

------------=_1583532848-65438-61
Content-Type: text/x-diff; charset=us-ascii; name="symlink-in-ea-3.diff"
Content-Disposition: inline; filename="symlink-in-ea-3.diff"
Content-Transfer-Encoding: base64
Content-Length: 11721

SW5kZXg6IG50ZWEuY2MKPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQpSQ1MgZmls
ZTogL2N2cy9zcmMvc3JjL3dpbnN1cC9jeWd3aW4vbnRlYS5jYyx2CnJldHJp
ZXZpbmcgcmV2aXNpb24gMS4zCmRpZmYgLXUgLXAgLTIgLXIxLjMgbnRlYS5j
YwotLS0gbnRlYS5jYwkyMDAwLzA5LzA4IDAyOjU2OjU0CTEuMworKysgbnRl
YS5jYwkyMDAxLzA1LzE0IDEzOjUxOjExCkBAIC04Niw4ICs4Niw0IEBAIGlu
dCBfX3N0ZGNhbGwKIE5UUmVhZEVBIChjb25zdCBjaGFyICpmaWxlLCBjb25z
dCBjaGFyICphdHRybmFtZSwgY2hhciAqYXR0cmJ1ZiwgaW50IGxlbikKIHsK
LSAgICAvKiByZXR1cm4gaW1tZWRpYXRlbHkgaWYgTlRFQSB1c2FnZSBpcyB0
dXJuZWQgb2ZmICovCi0gICAgaWYgKCEgYWxsb3dfbnRlYSkKLSAgICAgIHJl
dHVybiBGQUxTRTsKLQogICAgIEhBTkRMRSBoRmlsZVNvdXJjZTsKICAgICBp
bnQgZWFmb3VuZCA9IDA7CkBAIC0yNTUsMTAgKzI1MSw2IEBAIE5UUmVhZEVB
UmF3IChIQU5ETEUgaEZpbGVTb3VyY2UsIGludCAqbGUKIAogQk9PTCBfX3N0
ZGNhbGwKLU5UV3JpdGVFQSAoY29uc3QgY2hhciAqZmlsZSwgY29uc3QgY2hh
ciAqYXR0cm5hbWUsIGNoYXIgKmJ1ZiwgaW50IGxlbikKK05UV3JpdGVFQSAo
Y29uc3QgY2hhciAqZmlsZSwgY29uc3QgY2hhciAqYXR0cm5hbWUsIGNvbnN0
IGNoYXIgKmJ1ZiwgaW50IGxlbikKIHsKLSAgLyogcmV0dXJuIGltbWVkaWF0
ZWx5IGlmIE5URUEgdXNhZ2UgaXMgdHVybmVkIG9mZiAqLwotICBpZiAoISBh
bGxvd19udGVhKQotICAgIHJldHVybiBUUlVFOwotCiAgIEhBTkRMRSBoRmls
ZVNvdXJjZTsKICAgV0lOMzJfU1RSRUFNX0lEIFN0cmVhbUlkOwpJbmRleDog
cGF0aC5jYwo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09ClJDUyBmaWxlOiAvY3Zz
L3NyYy9zcmMvd2luc3VwL2N5Z3dpbi9wYXRoLmNjLHYKcmV0cmlldmluZyBy
ZXZpc2lvbiAxLjEzOQpkaWZmIC11IC1wIC0yIC1yMS4xMzkgcGF0aC5jYwot
LS0gcGF0aC5jYwkyMDAxLzA1LzE0IDAyOjUyOjEyCTEuMTM5CisrKyBwYXRo
LmNjCTIwMDEvMDUvMTQgMTM6NTE6MTIKQEAgLTMzMSw0ICszMzEsNDQgQEAg
bWtyZWxwYXRoIChjaGFyICpwYXRoKQogfQogCit2b2lkCitwYXRoX2NvbnY6
OnVwZGF0ZV9mc19pbmZvIChjb25zdCBjaGFyKiB3aW4zMl9wYXRoKQorewor
ICBjaGFyIHRtcF9idWYgW01BWF9QQVRIXTsKKyAgc3RybmNweSAodG1wX2J1
Ziwgd2luMzJfcGF0aCwgTUFYX1BBVEgpOworCisgIGlmICghcm9vdGRpciAo
dG1wX2J1ZikgJiYKKyAgICAgICghR2V0Q3VycmVudERpcmVjdG9yeSAoc2l6
ZW9mICh0bXBfYnVmKSwgdG1wX2J1ZikgPD0gc2l6ZW9mICh0bXBfYnVmKSB8
fAorICAgICAgICFyb290ZGlyICh0bXBfYnVmKSkpICAgICAgIAorICAgIHsK
KyAgICAgIGRlYnVnX3ByaW50ZiAoIkNhbm5vdCBnZXQgcm9vdCBjb21wb25l
bnQgb2YgcGF0aCAlcyIsIHdpbjMyX3BhdGgpOworICAgICAgcm9vdF9kaXIg
WzBdID0gZnNfbmFtZSBbMF0gPSAnXDAnOworICAgICAgZnNfZmxhZ3MgPSBm
c19zZXJpYWwgPSAwOworICAgICAgc3ltX29wdCA9IDA7CisgICAgICByZXR1
cm47CisgICAgfQorCisgIGlmIChzdHJjbXAgKHRtcF9idWYsIHJvb3RfZGly
KSAhPSAwKQorICAgIHsKKyAgICAgIHN0cm5jcHkgKHJvb3RfZGlyLCB0bXBf
YnVmLCBNQVhfUEFUSCk7CisgICAgICBpZiAoIUdldFZvbHVtZUluZm9ybWF0
aW9uIChyb290X2RpciwgTlVMTCwgMCwgJmZzX3NlcmlhbCwgTlVMTCwgJmZz
X2ZsYWdzLAorCQkJCSAgICAgZnNfbmFtZSwgc2l6ZW9mIChmc19uYW1lKSkp
CisJeworCSAgZGVidWdfcHJpbnRmICgiQ2Fubm90IGdldCB2b2x1bWUgaW5m
b3JtYXRpb24gKCVzKSwgJUUiLCByb290X2Rpcik7CisJICBmc19uYW1lIFsw
XSA9ICdcMCc7CisJICBmc19mbGFncyA9IGZzX3NlcmlhbCA9IDA7CisJICBz
eW1fb3B0ID0gMDsKKwl9CisgICAgICBlbHNlCisgICAgICAgIHsKKwkgIC8q
IEZJWE1FOiBTYW1iYSBieSBkZWZhdWx0IHJldHVybnMgIk5URlMiIGluIGZp
bGUgc3lzdGVtIG5hbWUsIGJ1dAorCSAgICogZG9lc24ndCBzdXBwb3J0IEV4
dGVuZGVkIEF0dHJpYnV0ZXMuIElmIHRoZXJlJ3MgYW55IGZhc3Qgd2F5IHRv
CisJICAgKiBkaXN0aW5ndWlzaCBiZXR3ZWVuIHNhbWJhIGFuZCByZWFsIG50
ZnMsIGl0IHNob3VsZCBiZSBpbXBsZW1lbnRlZAorCSAgICogaGVyZS4KKwkg
ICAqLworCSAgc3ltX29wdCA9IChzdHJjbXAgKGZzX25hbWUsICJOVEZTIikg
PT0gMCA/IFBDX0NIRUNLX0VBIDogMCk7CisgICAgICAgIH0KKyAgICB9Cit9
CisKIC8qIENvbnZlcnQgYW4gYXJiaXRyYXJ5IHBhdGggU1JDIHRvIGEgcHVy
ZSBXaW4zMiBwYXRoLCBzdWl0YWJsZSBmb3IKICAgIHBhc3NpbmcgdG8gV2lu
MzIgQVBJIHJvdXRpbmVzLgpAQCAtMzc1LDQgKzQxNSw4IEBAIHBhdGhfY29u
djo6Y2hlY2sgKGNvbnN0IGNoYXIgKnNyYywgdW5zaWcKICAgY2FzZV9jbGFz
aCA9IEZBTFNFOwogICBkZXZuID0gdW5pdCA9IDA7CisgIHJvb3RfZGlyWzBd
ID0gJ1wwJzsKKyAgZnNfbmFtZVswXSA9ICdcMCc7CisgIGZzX2ZsYWdzID0g
ZnNfc2VyaWFsID0gMDsKKyAgc3ltX29wdCA9IDA7CiAKICAgaWYgKCEob3B0
ICYgUENfTlVMTEVNUFRZKSkKQEAgLTQ0Miw0ICs0ODYsNiBAQCBwYXRoX2Nv
bnY6OmNoZWNrIChjb25zdCBjaGFyICpzcmMsIHVuc2lnCiAJCQkJCQkgICB1
bml0LCAmc3ltLnBmbGFncyk7CiAKKwkgIHVwZGF0ZV9mc19pbmZvIChmdWxs
X3BhdGgpOworCiAJICAvKiBkZXZuIHNob3VsZCBub3QgYmUgYSBkZXZpY2Uu
ICBJZiBpdCBpcywgdGhlbiBzdG9wIHBhcnNpbmcgbm93LiAqLwogCSAgaWYg
KGRldm4gIT0gRkhfQkFEKQpAQCAtNDcwLDUgKzUxNiw1IEBAIHBhdGhfY29u
djo6Y2hlY2sgKGNvbnN0IGNoYXIgKnNyYywgdW5zaWcKIAkgICAgfQogCi0J
ICBpbnQgbGVuID0gc3ltLmNoZWNrIChmdWxsX3BhdGgsIHN1ZmYsIG9wdCk7
CisJICBpbnQgbGVuID0gc3ltLmNoZWNrIChmdWxsX3BhdGgsIHN1ZmYsIG9w
dCB8IHN5bV9vcHQgKTsKIAogCSAgaWYgKHN5bS5jYXNlX2NsYXNoKQpAQCAt
NjM0LDE2ICs2ODAsOCBAQCBvdXQ6CiAgICAgICByZXR1cm47CiAgICAgfQot
Ci0gIERXT1JEIHNlcmlhbCwgdm9sZmxhZ3M7Ci0gIGNoYXIgZnNfbmFtZVsx
Nl07CiAKLSAgc3RyY3B5ICh0bXBfYnVmLCB0aGlzLT5wYXRoKTsKLQotICBp
ZiAoIXJvb3RkaXIgKHRtcF9idWYpIHx8Ci0gICAgICAhR2V0Vm9sdW1lSW5m
b3JtYXRpb24gKHRtcF9idWYsIE5VTEwsIDAsICZzZXJpYWwsIE5VTEwsCi0g
ICAgICAJCQkgICAgICZ2b2xmbGFncywgZnNfbmFtZSwgMTYpKQorICB1cGRh
dGVfZnNfaW5mbyAocGF0aCk7CisgIGlmICghZnNfbmFtZVswXSkKICAgICB7
Ci0gICAgICBkZWJ1Z19wcmludGYgKCJHZXRWb2x1bWVJbmZvcm1hdGlvbigl
cykgPSBFUlIsIHRoaXMtPnBhdGgoJXMpLCBzZXRfaGFzX2FjbHMoRkFMU0Up
IiwKLQkJICAgIHRtcF9idWYsIHRoaXMtPnBhdGgsIEdldExhc3RFcnJvciAo
KSk7CiAgICAgICBzZXRfaGFzX2FjbHMgKEZBTFNFKTsKICAgICAgIHNldF9o
YXNfYnVnZ3lfb3BlbiAoRkFMU0UpOwpAQCAtNjUyLDEyICs2OTAsMTIgQEAg
b3V0OgogICAgIHsKICAgICAgIHNldF9pc2Rpc2sgKCk7Ci0gICAgICBkZWJ1
Z19wcmludGYgKCJHZXRWb2x1bWVJbmZvcm1hdGlvbiglcykgPSBPSywgdGhp
cy0+cGF0aCglcyksIHNldF9oYXNfYWNscyglZCkiLAotCQkgICAgdG1wX2J1
ZiwgdGhpcy0+cGF0aCwgdm9sZmxhZ3MgJiBGU19QRVJTSVNURU5UX0FDTFMp
OworICAgICAgZGVidWdfcHJpbnRmICgicm9vdF9kaXIoJXMpLCB0aGlzLT5w
YXRoKCVzKSwgc2V0X2hhc19hY2xzKCVkKSIsCisJCSAgICByb290X2Rpciwg
dGhpcy0+cGF0aCwgZnNfZmxhZ3MgJiBGU19QRVJTSVNURU5UX0FDTFMpOwog
ICAgICAgaWYgKCFhbGxvd19zbWJudHNlYwotICAgICAgICAgICYmICgodG1w
X2J1ZlswXSA9PSAnXFwnICYmIHRtcF9idWZbMV0gPT0gJ1xcJykKLSAgICAg
ICAgICAgICAgfHwgR2V0RHJpdmVUeXBlICh0bXBfYnVmKSA9PSBEUklWRV9S
RU1PVEUpKQorICAgICAgICAgICYmICgocm9vdF9kaXJbMF0gPT0gJ1xcJyAm
JiByb290X2RpclsxXSA9PSAnXFwnKQorICAgICAgICAgICAgICB8fCBHZXRE
cml2ZVR5cGUgKHJvb3RfZGlyKSA9PSBEUklWRV9SRU1PVEUpKQogICAgICAg
ICBzZXRfaGFzX2FjbHMgKEZBTFNFKTsKICAgICAgIGVsc2UKLSAgICAgICAg
c2V0X2hhc19hY2xzICh2b2xmbGFncyAmIEZTX1BFUlNJU1RFTlRfQUNMUyk7
CisgICAgICAgIHNldF9oYXNfYWNscyAoZnNfZmxhZ3MgJiBGU19QRVJTSVNU
RU5UX0FDTFMpOwogICAgICAgLyogS25vd24gZmlsZSBzeXN0ZW1zIHdpdGgg
YnVnZ3kgb3BlbiBjYWxscy4gRnVydGhlciBleHBsYW5hdGlvbgogICAgICAg
ICAgaW4gZmhhbmRsZXIuY2MgKGZoYW5kbGVyX2Rpc2tfZmlsZTo6b3Blbiku
ICovCkBAIC0yMzE5LDQgKzIzNTcsMjYgQEAgZW5kbW50ZW50IChGSUxFICop
CiAvKioqKioqKioqKioqKioqKioqKioqKiBTeW1ib2xpYyBMaW5rIFN1cHBv
cnQgKioqKioqKioqKioqKioqKioqKioqKioqKiovCiAKKy8qIFJlYWQgc3lt
bGluayBmcm9tIEV4dGVuZGVkIEF0dHJpYnV0ZSAqLworaW50CitnZXRfc3lt
bGlua19lYSAoY29uc3QgY2hhciogZnJvbXBhdGgsIGNoYXIqIGJ1ZiwgaW50
IGJ1Zl9zaXplKQoreworICBpbnQgcmVzID0gTlRSZWFkRUEgKGZyb21wYXRo
LCBTWU1MSU5LX0VBX05BTUUsIGJ1ZiwgYnVmX3NpemUpOworICBpZiAocmVz
ID09IDApCisgICAgZGVidWdfcHJpbnRmICgiQ2Fubm90IHJlYWQgc3ltbGlu
ayBmcm9tIEVBIik7CisgIHJldHVybiAocmVzIC0gMSk7Cit9CisKKy8qIFNh
dmUgc3ltbGluayB0byBFeHRlbmRlZCBBdHRyaWJ1dGUgKi8KK0JPT0wKK3Nl
dF9zeW1saW5rX2VhIChjb25zdCBjaGFyKiBmcm9tcGF0aCwgY29uc3QgY2hh
ciogdG9wYXRoKQoreworICBpZiAoIU5UV3JpdGVFQSAoZnJvbXBhdGgsIFNZ
TUxJTktfRUFfTkFNRSwgdG9wYXRoLCBzdHJsZW4gKHRvcGF0aCkgKyAxKSkK
KyAgICB7CisgICAgICBkZWJ1Z19wcmludGYgKCJDYW5ub3Qgc2F2ZSBzeW1s
aW5rIGluIEVBIik7CisgICAgICByZXR1cm4gRkFMU0U7CisgICAgfQorICBy
ZXR1cm4gVFJVRTsKK30KKwogLyogQ3JlYXRlIGEgc3ltbGluayBmcm9tIEZS
T01QQVRIIHRvIFRPUEFUSC4gKi8KIApAQCAtMjQyMyw0ICsyNDgzLDYgQEAg
c3ltbGluayAoY29uc3QgY2hhciAqdG9wYXRoLCBjb25zdCBjaGFyIAogCQkg
ICAgJiYgV3JpdGVGaWxlIChoLCB3MzJ0b3BhdGgsIHdpbl9sZW4sICZ3cml0
dGVuLCBOVUxMKQogCQkgICAgJiYgd3JpdHRlbiA9PSB3aW5fbGVuOworCSAg
aWYgKHdpbjMyX3BhdGguZnNfZmFzdF9lYSAoKSkKKyAgICAgICAgICAgIHNl
dF9zeW1saW5rX2VhICh3aW4zMl9wYXRoLCB0b3BhdGgpOwogCX0KICAgICAg
IGVsc2UKQEAgLTI3MDYsNCArMjc2OCwxMiBAQCBzeW1saW5rX2luZm86OmNo
ZWNrIChjaGFyICpwYXRoLCBjb25zdCBzCiAJZ290byBmaWxlX25vdF9zeW1s
aW5rOwogCisgICAgICBpZiAoc3ltX2NoZWNrID4gMCAmJiBvcHQgJiBQQ19D
SEVDS19FQSAmJgorCSAgKHJlcyA9IGdldF9zeW1saW5rX2VhIChzdWZmaXgu
cGF0aCwgY29udGVudHMsIHNpemVvZiAoY29udGVudHMpKSkgPiAwKQorCXsK
KwkgIHBmbGFncyA9IFBBVEhfU1lNTElOSzsKKwkgIGRlYnVnX3ByaW50ZiAo
IkdvdCBzeW1saW5rIGZyb20gRUE6ICVzIiwgY29udGVudHMpOworCSAgZ290
byBvdXQ7CisJfQorCiAgICAgICAvKiBPcGVuIHRoZSBmaWxlLiAgKi8KIApA
QCAtMjcxNCw0ICsyNzg0LDcgQEAgc3ltbGlua19pbmZvOjpjaGVjayAoY2hh
ciAqcGF0aCwgY29uc3QgcwogCWdvdG8gZmlsZV9ub3Rfc3ltbGluazsKIAor
ICAgICAgLyogRklYTUU6IGlmIHN5bWxpbmsgaXNuJ3QgcHJlc2VudCBpbiBF
QSwgYnV0IEVBcyBhcmUgc3VwcG9ydGVkLCAKKyAgICAgICAqIHNob3VsZCB3
ZSB3cml0ZSBpdCB0aGVyZT8KKyAgICAgICAqLwogICAgICAgc3dpdGNoIChz
eW1fY2hlY2spCiAJewpJbmRleDogcGF0aC5oCj09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT0KUkNTIGZpbGU6IC9jdnMvc3JjL3NyYy93aW5zdXAvY3lnd2luL3Bh
dGguaCx2CnJldHJpZXZpbmcgcmV2aXNpb24gMS4yNgpkaWZmIC11IC1wIC0y
IC1yMS4yNiBwYXRoLmgKLS0tIHBhdGguaAkyMDAxLzA0LzE3IDIzOjEyOjEx
CTEuMjYKKysrIHBhdGguaAkyMDAxLzA1LzE0IDEzOjUxOjEyCkBAIC0yMyw1
ICsyMyw2IEBAIGVudW0gcGF0aGNvbnZfYXJnCiAgIFBDX1NZTV9DT05URU5U
Uwk9IDB4MDAwOCwKICAgUENfRlVMTAkJPSAweDAwMTAsCi0gIFBDX05VTExF
TVBUWQkJPSAweDAwMjAKKyAgUENfTlVMTEVNUFRZCQk9IDB4MDAyMCwKKyAg
UENfQ0hFQ0tfRUEJCT0gMHgwMDQwCiB9OwogCkBAIC01Nyw1ICs1OCwxMSBA
QCBjbGFzcyBwYXRoX2NvbnYKIHsKICAgY2hhciBwYXRoW01BWF9QQVRIXTsK
KyAgY2hhciByb290X2RpcltNQVhfUEFUSF07CisgIGNoYXIgZnNfbmFtZVtN
QVhfUEFUSF07CisgIERXT1JEIGZzX2ZsYWdzOworICBEV09SRCBmc19zZXJp
YWw7CisgIERXT1JEIHN5bV9vcHQ7IC8qIGFkZGl0aW9uYWwgb3B0aW9ucyB0
byBwYXNzIHRvIHN5bWxpbmtfaW5mbyByZXNvbHZlciAqLwogICB2b2lkIGFk
ZF9leHRfZnJvbV9zeW0gKHN5bWxpbmtfaW5mbyYpOworICB2b2lkIHVwZGF0
ZV9mc19pbmZvIChjb25zdCBjaGFyKik7CiAgcHVibGljOgogCkBAIC0xMjQs
OCArMTMxLDExIEBAIGNsYXNzIHBhdGhfY29udgogICBzaG9ydCBnZXRfdW5p
dG4gKCkge3JldHVybiBkZXZuID09IEZIX0JBRCA/IDAgOiB1bml0O30KICAg
RFdPUkQgZmlsZV9hdHRyaWJ1dGVzICgpIHtyZXR1cm4gZmlsZWF0dHI7fQor
ICBCT09MIGZzX2Zhc3RfZWEgKCkge3JldHVybiBzeW1fb3B0ICYgUENfQ0hF
Q0tfRUE7fQogfTsKIAogLyogU3ltbGluayBtYXJrZXIgKi8KICNkZWZpbmUg
U1lNTElOS19DT09LSUUgIiE8c3ltbGluaz4iCisKKyNkZWZpbmUgU1lNTElO
S19FQV9OQU1FICIuQ1lHU1lNTElOSyIKIAogLyogU29ja2V0IG1hcmtlciAq
LwpJbmRleDogc2VjdXJpdHkuY2MKPT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQpS
Q1MgZmlsZTogL2N2cy9zcmMvc3JjL3dpbnN1cC9jeWd3aW4vc2VjdXJpdHku
Y2MsdgpyZXRyaWV2aW5nIHJldmlzaW9uIDEuNDYKZGlmZiAtdSAtcCAtMiAt
cjEuNDYgc2VjdXJpdHkuY2MKLS0tIHNlY3VyaXR5LmNjCTIwMDEvMDQvMzAg
MjE6MTk6NDIJMS40NgorKysgc2VjdXJpdHkuY2MJMjAwMS8wNS8xNCAxMzo1
MToxMgpAQCAtNTQ1LDUgKzU0NSw4IEBAIGdldF9maWxlX2F0dHJpYnV0ZSAo
aW50IHVzZV9udHNlYywgY29uc3QKICAgICByZXR1cm4gMDsKIAotICByZXMg
PSBOVFJlYWRFQSAoZmlsZSwgIi5VTklYQVRUUiIsIChjaGFyICopIGF0dHJp
YnV0ZSwgc2l6ZW9mICgqYXR0cmlidXRlKSk7CisgIGlmIChhbGxvd19udGVh
KQorICAgIHJlcyA9IE5UUmVhZEVBIChmaWxlLCAiLlVOSVhBVFRSIiwgKGNo
YXIgKikgYXR0cmlidXRlLCBzaXplb2YgKCphdHRyaWJ1dGUpKTsKKyAgZWxz
ZQorICAgIHJlcyA9IDA7CiAKICAgLyogc3ltbGlua3MgYXJlIGV2ZXJ5dGhp
bmcgZm9yIGV2ZXJ5b25lISovCkBAIC04NjksNSArODcyLDUgQEAgc2V0X2Zp
bGVfYXR0cmlidXRlIChpbnQgdXNlX250c2VjLCBjb25zdAogICAgIGF0dHJp
YnV0ZSB8PSBTX0lSV1hVIHwgU19JUldYRyB8IFNfSVJXWE87CiAKLSAgaWYg
KCF1c2VfbnRzZWMgfHwgIWFsbG93X250c2VjKQorICBpZiAoYWxsb3dfbnRl
YSAmJiAoIXVzZV9udHNlYyB8fCAhYWxsb3dfbnRzZWMpKQogICAgIHsKICAg
ICAgIGlmICghTlRXcml0ZUVBIChmaWxlLCAiLlVOSVhBVFRSIiwKSW5kZXg6
IHNlY3VyaXR5LmgKPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQpSQ1MgZmlsZTog
L2N2cy9zcmMvc3JjL3dpbnN1cC9jeWd3aW4vc2VjdXJpdHkuaCx2CnJldHJp
ZXZpbmcgcmV2aXNpb24gMS43CmRpZmYgLXUgLXAgLTIgLXIxLjcgc2VjdXJp
dHkuaAotLS0gc2VjdXJpdHkuaAkyMDAxLzA0LzMwIDIxOjE5OjQyCTEuNwor
Kysgc2VjdXJpdHkuaAkyMDAxLzA1LzE0IDEzOjUxOjEyCkBAIC0xMDMsMyAr
MTAzLDMgQEAgZXh0ZXJuIFNFQ1VSSVRZX0FUVFJJQlVURVMgKl9fc3RkY2Fs
bCBzZQogCiBpbnQgX19zdGRjYWxsIE5UUmVhZEVBIChjb25zdCBjaGFyICpm
aWxlLCBjb25zdCBjaGFyICphdHRybmFtZSwgY2hhciAqYnVmLCBpbnQgbGVu
KTsKLUJPT0wgX19zdGRjYWxsIE5UV3JpdGVFQSAoY29uc3QgY2hhciAqZmls
ZSwgY29uc3QgY2hhciAqYXR0cm5hbWUsIGNoYXIgKmJ1ZiwgaW50IGxlbik7
CitCT09MIF9fc3RkY2FsbCBOVFdyaXRlRUEgKGNvbnN0IGNoYXIgKmZpbGUs
IGNvbnN0IGNoYXIgKmF0dHJuYW1lLCBjb25zdCBjaGFyICpidWYsIGludCBs
ZW4pOwo=

------------=_1583532848-65438-61--
