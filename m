From: "Robert Collins" <robert.collins@itdomain.com.au>
To: <cygwin-patches@cygwin.com>
Cc: <cygwin-apps@sources.redhat.com>
Subject: setup streams work..
Date: Sat, 10 Nov 2001 23:09:00 -0000
Message-id: <019d01c16a7f$ab3ee060$0200a8c0@lifelesswks>
X-SW-Source: 2001-q4/msg00195.html
Content-type: multipart/mixed; boundary="----------=_1583532850-65438-114"

This is a multi-part message in MIME format...

------------=_1583532850-65438-114
Content-length: 1553

Cross-posted for review...

Ok, I've now got file magic fairly complete.

The NIO and bz classes still need refactoring and expanding.

There's a still a chunk of code to be migrated over to the io_streams
class.

Is there any objection to this being checked into HEAD (with a little
more tidyup, but I won't bother having that reviewed :})?

Overview of changes:
* File magic detection for bz2, gz and tar file types. (I.e. you can
install from a local .tar file, as well as a local .tar.gz - once one
line in choose.cc is changed).
* io_stream hierarchy based on the classes Warren came up with, with my
single uniting class at the top.
* tar logic is stream based, not fd based, so can install directly from
http/ftp(once nio is refactored).
* Compiler warnings pushed up and all warnings bar autoload.c and the
bison system files addressed.

The file magic code here is federated across each - to overload an MS
term - class class. I.e. archive.cc knows about all archive types,
compress.cc knows all compression formats.

There's plenty more in this project I'm working on, but with the
successful install of lynx.tar.gz via a setup with this code in it, I
feel that the class hierarchy is shown to meet our needs. It's probably
able to be tweaked - for instance some instantion helper calls for the
io_stream class perhaps belong in a lower level between io_stream and
io_stream_ file|cygfile|http|ftp...

So given that the class layout works, and somethings are already
becoming easier to do, I plan to commit this to HEAD.

Any objections?

Rob

------------=_1583532850-65438-114
Content-Type: text/x-c; charset=us-ascii; name="archive.cc"
Content-Disposition: inline; filename="archive.cc"
Content-Transfer-Encoding: base64
Content-Length: 6641

LyoKICogQ29weXJpZ2h0IChjKSAyMDAxLCBSb2JlcnQgQ29sbGlucy4KICoK
ICogICAgIFRoaXMgcHJvZ3JhbSBpcyBmcmVlIHNvZnR3YXJlOyB5b3UgY2Fu
IHJlZGlzdHJpYnV0ZSBpdCBhbmQvb3IgbW9kaWZ5CiAqICAgICBpdCB1bmRl
ciB0aGUgdGVybXMgb2YgdGhlIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNl
IGFzIHB1Ymxpc2hlZCBieQogKiAgICAgdGhlIEZyZWUgU29mdHdhcmUgRm91
bmRhdGlvbjsgZWl0aGVyIHZlcnNpb24gMiBvZiB0aGUgTGljZW5zZSwgb3IK
ICogICAgIChhdCB5b3VyIG9wdGlvbikgYW55IGxhdGVyIHZlcnNpb24uCiAq
CiAqICAgICBBIGNvcHkgb2YgdGhlIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNl
bnNlIGNhbiBiZSBmb3VuZCBhdAogKiAgICAgaHR0cDovL3d3dy5nbnUub3Jn
LwogKgogKiBXcml0dGVuIGJ5IFJvYmVydCBDb2xsaW5zICA8cmJ0Y29sbGlu
c0Bob3RtYWlsLmNvbT4KICoKICovCgovKiBBcmNoaXZlIElPIG9wZXJhdGlv
bnMKICovCgojaWYgMApzdGF0aWMgY29uc3QgY2hhciAqY3ZzaWQgPQogICJc
biUlJSAkSWQ6IHNvdXJjZS5jYyx2IDIuNSAyMDAxLzExLzAxIDEzOjIyOjQ2
IHJiY29sbGlucyBFeHAgJFxuIjsKI2VuZGlmCgojaW5jbHVkZSAid2luMzIu
aCIKI2luY2x1ZGUgPHN0ZGlvLmg+CiNpbmNsdWRlICJsb2cuaCIKI2luY2x1
ZGUgInBvcnQuaCIKI2luY2x1ZGUgImNvbmNhdC5oIgoKI2luY2x1ZGUgImlv
X3N0cmVhbS5oIgojaW5jbHVkZSAiYXJjaGl2ZS5oIgojaW5jbHVkZSA8c3Rk
bGliLmg+CiNpbmNsdWRlICJ0YXIuaCIKCi8qIEluIGNhc2UgeW91IGFyZSB3
b25kZXJpbmcgd2h5IHRoZSBmaWxlIG1hZ2ljIGlzIG5vdCBpbiBvbmUgcGxh
Y2U6CiAqIEl0IGNvdWxkIGJlLiBCdXQgdGhlcmUgaXMgbGl0dGxlIChhbnk/
KSBiZW5lZml0LgogKiBXaGF0IGlzIGltcG9ydGFudCBpcyB0aGF0IHRoZSBm
aWxlIG1hZ2ljIHJlcXVpcmVkIGZvciBhbnkgX3Rhc2tfIGlzIGNlbnRyYWxp
c2VkLgogKiBPbmUgc3VjaCB0YXNrIGlzIGlkZW50aWZ5aW5nIGFyY2hpdmVz
CiAqCiAqIHRvIGZlZGVyYXRlIGludG8gZWFjaCBjbGFzcyBvbmUgbWlnaHQg
YWRkIGEgbWFnaWMgcGFyYW1ldGVyIHRvIHRoZSBjb25zdHJ1Y3Rvciwgd2hp
Y2gKICogdGhlIGNsYXNzIGNvdWxkIHRlc3QgaXRzZWxmLiAKICovCgovKiBH
TlUgVEFSOgogKiBvZmZzZXQgMjU3ICAgICBzdHJpbmcgIHVzdGFyXDA0MFww
NDBcMAogKi8KCgojZGVmaW5lIGxvbmdlc3RfbWFnaWMgMjY1CgphcmNoaXZl
ICoKYXJjaGl2ZTo6ZXh0cmFjdCAoaW9fc3RyZWFtICogb3JpZ2luYWwpCnsK
ICBpZiAoIW9yaWdpbmFsKQogICAgcmV0dXJuIE5VTEw7CiAgY2hhciBtYWdp
Y1tsb25nZXN0X21hZ2ljXTsKICBpZiAob3JpZ2luYWwtPnBlZWsgKG1hZ2lj
LCBsb25nZXN0X21hZ2ljKSA+IDApCiAgICB7CiAgICAgIGlmIChtZW1jbXAg
KCZtYWdpY1syNTddLCAidXN0YXJcMDQwXDA0MFwwIiwgOCkgPT0gMCkKCXsK
CSAgLyogdGFyICovCgkgIGFyY2hpdmVfdGFyICpydiA9IG5ldyBhcmNoaXZl
X3RhciAob3JpZ2luYWwpOwoJICBpZiAoIXJ2LT5lcnJvciAoKSkKCSAgICBy
ZXR1cm4gcnY7CgkgIHJldHVybiBOVUxMOwoJfQojaWYgMAogICAgICBlbHNl
IGlmIChtZW1jbXAgKG1hZ2ljLCAiQlpoIiwgMykgPT0gMCkKCXsKCSAgYXJj
aGl2ZV9ieiAqcnYgPSBuZXcgYXJjaGl2ZV9ieiAob3JpZ2luYWwpOwoJICBp
ZiAoIXJ2LT5lcnJvciAoKSkKCSAgICByZXR1cm4gcnY7CgkgIHJldHVybiBO
VUxMOwoJfQojZW5kaWYKICAgIH0KICByZXR1cm4gTlVMTDsKfQoKaW50CmFy
Y2hpdmU6OmV4dHJhY3RfZmlsZSAoYXJjaGl2ZSAqIHNvdXJjZSwgY29uc3Qg
Y2hhciAqcHJlZml4KQp7CiAgaWYgKCFzb3VyY2UpCiAgICByZXR1cm4gMTsK
ICBjb25zdCBjaGFyICpkZXN0ZmlsZW5hbWUgPSBjb25jYXQgKHByZWZpeCwg
c291cmNlLT5uZXh0X2ZpbGVfbmFtZSAoKSwgMCk7CiAgc3dpdGNoIChzb3Vy
Y2UtPm5leHRfZmlsZV90eXBlICgpKQogICAgewogICAgY2FzZSBBUkNISVZF
X0ZJTEVfUkVHVUxBUjoKICAgICAgewoKCS8qIFRPRE86IHJlbW92ZSBpbi10
aGUtd2F5IGRpcmVjdG9yaWVzIHZpYSBta3BhdGhfcCAqLwoJaWYgKGlvX3N0
cmVhbTo6bWtwYXRoX3AgKFBBVEhfVE9fRklMRSwgZGVzdGZpbGVuYW1lKSkK
CSAgcmV0dXJuIDE7Cglpb19zdHJlYW06OnJlbW92ZSAoZGVzdGZpbGVuYW1l
KTsKCWlvX3N0cmVhbSAqdG1wID0gaW9fc3RyZWFtOjpvcGVuIChkZXN0Zmls
ZW5hbWUsICJ3YiIpOwoJaWYgKCF0bXApCgkgIHJldHVybiAxOwoJaW9fc3Ry
ZWFtICppbiA9IHNvdXJjZS0+ZXh0cmFjdF9maWxlICgpOwoJaWYgKCFpbikK
CSAgewoJICAgIGRlbGV0ZSB0bXA7CgkgICAgcmV0dXJuIDE7CgkgIH0KCWNo
YXIgYnVmZmVyWzE2Mzg0XTsKCXNzaXplX3QgY291bnRpbiwgY291bnRvdXQ7
Cgl3aGlsZSAoKGNvdW50aW4gPSBpbi0+cmVhZCAoYnVmZmVyLCAxNjM4NCkp
ID4gMCkKCSAgewoJICAgIGNvdW50b3V0ID0gdG1wLT53cml0ZSAoYnVmZmVy
LCBjb3VudGluKTsKCSAgICBpZiAoY291bnRvdXQgIT0gY291bnRpbikKCSAg
ICAgIHsKCQlsb2cgKExPR19USU1FU1RBTVAsICJGYWlsZWQgdG8gd3JpdGUg
JWxkIGJ5dGVzIHRvICVzIiwKCQkgICAgIGNvdW50aW4sIGRlc3RmaWxlbmFt
ZSk7CgkJaW9fc3RyZWFtOjpyZW1vdmUgKGRlc3RmaWxlbmFtZSk7CgkJZGVs
ZXRlIHRtcDsKCQlkZWxldGUgaW47CgkJcmV0dXJuIDE7CgkgICAgICB9Cgkg
IH0KCWRlbGV0ZSBpbjsKCWRlbGV0ZSB0bXA7CglpZiAoY291bnRpbiA8IDAp
CgkgIHsKCSAgICBsb2cgKExPR19USU1FU1RBTVAsICJGaWxlIElPIGVycm9y
IHJlYWRpbmcgZnJvbSBhcmNoaXZlIik7CgkgICAgaW9fc3RyZWFtOjpyZW1v
dmUgKGRlc3RmaWxlbmFtZSk7CgkgIH0KICAgICAgfQogICAgICBicmVhazsK
ICAgIGNhc2UgQVJDSElWRV9GSUxFX1NZTUxJTks6CiAgICAgIHsKCS8qIFRP
RE86IHJlbW92ZSBpbi10aGUtd2F5IGRpcmVjdG9yaWVzIHZpYSBta3BhdGhf
cCAqLwoJaWYgKGlvX3N0cmVhbTo6bWtwYXRoX3AgKFBBVEhfVE9fRklMRSwg
ZGVzdGZpbGVuYW1lKSkKCSAgcmV0dXJuIDE7Cglpb19zdHJlYW06OnJlbW92
ZSAoZGVzdGZpbGVuYW1lKTsKCWludCBvayA9CgkgIGlvX3N0cmVhbTo6bWts
aW5rIChkZXN0ZmlsZW5hbWUsCgkJCSAgICAgY29uY2F0IChwcmVmaXgsIHNv
dXJjZS0+bGlua3RhcmdldCAoKSwgMCksCgkJCSAgICAgSU9fU1RSRUFNX1NZ
TUxJTkspOwoJLyogRklYTUU6IGNoZWNrIHdoYXQgdGFyJ3MgZmlsZWxlbmd0
aCBpcyBzZXQgdG8gZm9yIHN5bWxpbmtzICovCglzb3VyY2UtPnNraXBfZmls
ZSAoKTsKCXJldHVybiBvazsKICAgICAgfQogICAgY2FzZSBBUkNISVZFX0ZJ
TEVfSEFSRExJTks6CiAgICAgIHsKCS8qIFRPRE86IHJlbW92ZSBpbi10aGUt
d2F5IGRpcmVjdG9yaWVzIHZpYSBta3BhdGhfcCAqLwoJaWYgKGlvX3N0cmVh
bTo6bWtwYXRoX3AgKFBBVEhfVE9fRklMRSwgZGVzdGZpbGVuYW1lKSkKCSAg
cmV0dXJuIDE7Cglpb19zdHJlYW06OnJlbW92ZSAoZGVzdGZpbGVuYW1lKTsK
CWludCBvayA9CgkgIGlvX3N0cmVhbTo6bWtsaW5rIChkZXN0ZmlsZW5hbWUs
CgkJCSAgICAgY29uY2F0IChwcmVmaXgsIHNvdXJjZS0+bGlua3RhcmdldCAo
KSwgMCksCgkJCSAgICAgSU9fU1RSRUFNX0hBUkRMSU5LKTsKCS8qIEZJWE1F
OiBjaGVjayB3aGF0IHRhcidzIGZpbGVsZW5ndGggaXMgc2V0IHRvIGZvciBo
YXJkbGlua3MgKi8KCXNvdXJjZS0+c2tpcF9maWxlICgpOwoJcmV0dXJuIG9r
OwogICAgICB9CiAgICBjYXNlIEFSQ0hJVkVfRklMRV9ESVJFQ1RPUlk6CiAg
ICAgIHsKCWNoYXIgKnBhdGggPSAoY2hhciAqKSBhbGxvY2EgKHN0cmxlbiAo
ZGVzdGZpbGVuYW1lKSk7CglzdHJjcHkgKHBhdGgsIGRlc3RmaWxlbmFtZSk7
Cgl3aGlsZSAocGF0aFswXSAmJiBwYXRoW3N0cmxlbiAocGF0aCkgLSAxXSA9
PSAnLycpCgkgIHBhdGhbc3RybGVuIChwYXRoKSAtIDFdID0gMDsKCXNvdXJj
ZS0+c2tpcF9maWxlICgpOwoJcmV0dXJuIGlvX3N0cmVhbTo6bWtwYXRoX3Ag
KFBBVEhfVE9fRElSLCBwYXRoKTsKICAgICAgfQogICAgY2FzZSBBUkNISVZF
X0ZJTEVfSU5WQUxJRDoKICAgICAgc291cmNlLT5za2lwX2ZpbGUgKCk7CiAg
ICAgIGJyZWFrOwogICAgfQogIHJldHVybiAwOwp9CgojaWYgMApzc2l6ZV90
IGFyY2hpdmU6OnJlYWQgKHZvaWQgKmJ1ZmZlciwgc2l6ZV90IGxlbikKewog
IGxvZyAoTE9HX1RJTUVTVEFNUCwgImFyY2hpdmU6OnJlYWQgY2FsbGVkIik7
CiAgcmV0dXJuIDA7Cn0KCnNzaXplX3QgYXJjaGl2ZTo6d3JpdGUgKHZvaWQg
KmJ1ZmZlciwgc2l6ZV90IGxlbikKewogIGxvZyAoTE9HX1RJTUVTVEFNUCwg
ImFyY2hpdmU6OndyaXRlIGNhbGxlZCIpOwogIHJldHVybiAwOwp9Cgpzc2l6
ZV90IGFyY2hpdmU6OnBlZWsgKHZvaWQgKmJ1ZmZlciwgc2l6ZV90IGxlbikK
ewogIGxvZyAoTE9HX1RJTUVTVEFNUCwgImFyY2hpdmU6OnBlZWsgY2FsbGVk
Iik7CiAgcmV0dXJuIDA7Cn0KCmxvbmcKYXJjaGl2ZTo6dGVsbCAoKQp7CiAg
bG9nIChMT0dfVElNRVNUQU1QLCAiYno6OnRlbGwgY2FsbGVkIik7CiAgcmV0
dXJuIDA7Cn0KCmludAphcmNoaXZlOjplcnJvciAoKQp7CiAgbG9nIChMT0df
VElNRVNUQU1QLCAiYXJjaGl2ZTo6ZXJyb3IgY2FsbGVkIik7CiAgcmV0dXJu
IDA7Cn0KCmNvbnN0IGNoYXIgKgphcmNoaXZlOjpuZXh0X2ZpbGVfbmFtZSAo
KQp7CiAgbG9nIChMT0dfVElNRVNUQU1QLCAiYXJjaGl2ZTo6bmV4dF9maWxl
X25hbWUgY2FsbGVkIik7CiAgcmV0dXJuIE5VTEw7Cn0KCmFyY2hpdmU6On5h
cmNoaXZlICgpCnsKICBsb2cgKExPR19USU1FU1RBTVAsICJhcmNoaXZlOjp+
YXJjaGl2ZSBjYWxsZWQiKTsKICByZXR1cm47Cn0KI2VuZGlmCg==

------------=_1583532850-65438-114
Content-Type: text/x-c++; charset=us-ascii; name="archive.h"
Content-Disposition: inline; filename="archive.h"
Content-Transfer-Encoding: base64
Content-Length: 3957

LyoKICogQ29weXJpZ2h0IChjKSAyMDAxLCBSb2JlcnQgQ29sbGlucy4KICoK
ICogICAgIFRoaXMgcHJvZ3JhbSBpcyBmcmVlIHNvZnR3YXJlOyB5b3UgY2Fu
IHJlZGlzdHJpYnV0ZSBpdCBhbmQvb3IgbW9kaWZ5CiAqICAgICBpdCB1bmRl
ciB0aGUgdGVybXMgb2YgdGhlIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNl
IGFzIHB1Ymxpc2hlZCBieQogKiAgICAgdGhlIEZyZWUgU29mdHdhcmUgRm91
bmRhdGlvbjsgZWl0aGVyIHZlcnNpb24gMiBvZiB0aGUgTGljZW5zZSwgb3IK
ICogICAgIChhdCB5b3VyIG9wdGlvbikgYW55IGxhdGVyIHZlcnNpb24uCiAq
CiAqICAgICBBIGNvcHkgb2YgdGhlIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNl
bnNlIGNhbiBiZSBmb3VuZCBhdAogKiAgICAgaHR0cDovL3d3dy5nbnUub3Jn
LwogKgogKiBXcml0dGVuIGJ5IFJvYmVydCBDb2xsaW5zICA8cmJ0Y29sbGlu
c0Bob3RtYWlsLmNvbT4KICoKICovCgojaWZuZGVmIF9BUkNISVZFX0hfCiNk
ZWZpbmUgX0FSQ0hJVkVfSF8KCi8qIHRoaXMgaXMgdGhlIHBhcmVudCBjbGFz
cyBmb3IgYWxsIGFyY2hpdmUgSU8gb3BlcmF0aW9ucy4gCiAqIEl0IAogKi8K
Ci8qIFRoZSByZWFkL3dyaXRlIHRoZSBhcmNoaXZlIHN0cmVhbSB0byBnZXQg
dGhlIGFyY2hpdmUgZGF0YSBpcyBmbGF3ZWQuCiAqIFRoZSBwcm9ibGVtIGlz
IHRoYXQgeW91IHRoZW4gbmVlZCBhICpkaWZmZXJlbnQqIGd6aXAgZXRjIGNs
YXNzIHRvIGJlIGFibGUKICogdG8gdW5nemlwIGEgZ3ppcCBmcm9tIHdpdGhp
biBhbiBhcmNoaXZlLgogKiBUaGUgY29ycmVjdCB3YXkgaXMgdG8gCiAqIDEp
IHJldHJpZXZlIHRoZSBmaWxlIG5hbWUuCiAqIDIpIHRoZSB1c2VyIGNyZWF0
ZXMgdGhlaXIgb3duIG91dHB1dCBvYmplY3QuCiAqIDMpIHRoZSB1c2VyIGNh
bGxzIGV4dHJhY3RfZmlsZSAob3V0cHV0IHN0cmVhLCkuCiAqLwoKdHlwZWRl
ZiBlbnVtCnsKICBBUkNISVZFX0ZJTEVfSU5WQUxJRCwKICBBUkNISVZFX0ZJ
TEVfUkVHVUxBUiwKICBBUkNISVZFX0ZJTEVfSEFSRExJTkssCiAgQVJDSElW
RV9GSUxFX1NZTUxJTkssCiAgQVJDSElWRV9GSUxFX0RJUkVDVE9SWQp9CmFy
Y2hpdmVfZmlsZV90OwoKCmNsYXNzIGFyY2hpdmU6cHVibGljIGlvX3N0cmVh
bQp7CnB1YmxpYzoKICAvKiBnZXQgYW4gYXJjaGl2ZSBjaGlsZCBjbGFzcyBm
cm9tIGFuIGlvX3N0cmVhbSAqLwogIHN0YXRpYyBhcmNoaXZlICpleHRyYWN0
IChpb19zdHJlYW0gKik7CiAgLyogZ2V0IGFuIG91cHV0IHN0cmVhbSBmb3Ig
dGhlIG5leHQgZmlsZXMgZnJvbSB0aGUgYXJjaGl2ZS4KICAgKiByZXR1cm5z
IE5VTEwgb24gZmFpbHVyZS4KICAgKiBUaGUgc3RyZWFtIGlzIG5vdCB0YWtl
biBvdmVyIC0gaXQgd2lsbCBub3QgYmUgYXV0b21hdGljYWxseSBkZWxldGVk
CiAgICovCiAgdmlydHVhbCBpb19zdHJlYW0gKmV4dHJhY3RfZmlsZSAoKSA9
IE5VTEw7CiAgLyogZXh0cmFjdCB0aGUgbmV4dCBmaWxlIHRvIHRoZSBnaXZl
biBwcmVmaXggaW4gb25lIHN0ZXAKICAgKiByZXR1cm5zIDEgb24gZmFpbHVy
ZS4KICAgKi8KICBzdGF0aWMgaW50IGV4dHJhY3RfZmlsZSAoYXJjaGl2ZSAq
LCBjb25zdCBjaGFyICopOwoKICAvKiAKICAgKiBUbyBjcmVhdGUgYSBzdHJl
YW0gdGhhdCB3aWxsIGJlIGNvbXByZXNzZWQsIHlvdSBzaG91bGQgb3BlbiB0
aGUgdXJsLCBhbmQgdGhlbiBnZXQgYSBuZXcgc3RyZWFtCiAgICogZnJvbSBj
b21wcmVzczo6Y29tcHJlc3MuIAogICAqLwogIC8qIHJlYWQgZGF0YSAtIG5v
dCB2YWxpZCBmb3IgYXJjaGl2ZXMgKGR1aCEpIAogICAqIENvdWxkIGJlIG1h
ZGUgdmFsaWQgdmlhIHRoZSByZWFkLWNoaWxkLWRpcmVjdGx5IG1vZGVsIAog
ICAqLwovLyAgdmlydHVhbCBzc2l6ZV90IHJlYWQodm9pZCAqYnVmZmVyLCBz
aXplX3QgbGVuKSB7cmV0dXJuIC0xO307CiAgLyogcHJvdmlkZSBkYXRhIHRv
IChkb3VibGUgZHVoISkgKi8KLy8gIHZpcnR1YWwgc3NpemVfdCB3cml0ZSh2
b2lkICpidWZmZXIsIHNpemVfdCBsZW4pIHsgcmV0dXJuIC0xO307CiAgLyog
cmVhZCBkYXRhIHdpdGhvdXQgcmVtb3ZpbmcgaXQgZnJvbSB0aGUgY2xhc3Mn
cyBpbnRlcm5hbCBidWZmZXIgKi8KLy8gIHZpcnR1YWwgc3NpemVfdCBwZWVr
KHZvaWQgKmJ1ZmZlciwgc2l6ZV90IGxlbik7Ci8vICB2aXJ0dWFsIGxvbmcg
dGVsbCAoKTsKICAvKiB0cnkgZ3Vlc3NpbmcgdGhpcyBvbmUgKi8KLy8gIHZp
cnR1YWwgaW50IGVycm9yICgpOwogIC8qIEZpbmQgb3V0IHRoZSBuZXh0IHN0
cmVhbSBuYW1lIC0KICAgKiBpZSBmb3IgZm9vLnRhci5neiwgYXQgb2Zmc2V0
IDAsIG5leHRfZmlsZV9uYW1lID0gZm9vLnRhcgogICAqIGZvciBmb29iYXIg
dGhhdCBpcyBhbiBjb21wcmVzcywgbmV4dF9maWxlX25hbWUgaXMgdGhlIG5l
eHQKICAgKiBleHRyYWN0YWJsZSBmaWxlbmFtZS4KICAgKiBUaGUgd2F5IHRo
aXMgd29ya3MgaXMgdGhhdCB3aGVuIHJlYWQgcmV0dXJucyAwLCB5b3UgYXJl
IGF0IHRoZSBlbmQgb2YgKmEqIGZpbGUuCiAgICogbmV4dF9maWxlX25hbWUg
d2lsbCBhbGxvdyByZWFkIHRvIGJlIGNhbGxlZCBhZ2FpbiwgaWYgaXQgcmV0
dXJucyAhTlVMTAogICAqLwogIHZpcnR1YWwgY29uc3QgY2hhciAqbmV4dF9m
aWxlX25hbWUgKCkgPSBOVUxMOwogIHZpcnR1YWwgYXJjaGl2ZV9maWxlX3Qg
bmV4dF9maWxlX3R5cGUgKCkgPSBBUkNISVZFX0ZJTEVfSU5WQUxJRDsKICB2
aXJ0dWFsIGNvbnN0IGNoYXIgKmxpbmt0YXJnZXQgKCkgPSBOVUxMOwogIHZp
cnR1YWwgaW50IHNraXBfZmlsZSAoKSA9IDA7CiAgLyogaWYgeW91IGFyZSBz
dGlsbCBuZWVkaW5nIHRoZXNlIGhpbnRzLi4uIGdpdmUgdXAgbm93ISAqLwov
LyAgdmlydHVhbCB+Y29tcHJlc3MgKCk7CnByaXZhdGU6Ci8vICBhcmNoaXZl
ICgpIHt9Owp9OwoKI2VuZGlmIC8qIF9BUkNISVZFX0hfICovCg==

------------=_1583532850-65438-114
Content-Type: text/x-c; charset=us-ascii; name="archive_tar_file.cc"
Content-Disposition: inline; filename="archive_tar_file.cc"
Content-Transfer-Encoding: base64
Content-Length: 3518

LyoKICogQ29weXJpZ2h0IChjKSAyMDAxLCBSb2JlcnQgQ29sbGlucyAKICoK
ICogICAgIFRoaXMgcHJvZ3JhbSBpcyBmcmVlIHNvZnR3YXJlOyB5b3UgY2Fu
IHJlZGlzdHJpYnV0ZSBpdCBhbmQvb3IgbW9kaWZ5CiAqICAgICBpdCB1bmRl
ciB0aGUgdGVybXMgb2YgdGhlIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNl
IGFzIHB1Ymxpc2hlZCBieQogKiAgICAgdGhlIEZyZWUgU29mdHdhcmUgRm91
bmRhdGlvbjsgZWl0aGVyIHZlcnNpb24gMiBvZiB0aGUgTGljZW5zZSwgb3IK
ICogICAgIChhdCB5b3VyIG9wdGlvbikgYW55IGxhdGVyIHZlcnNpb24uCiAq
CiAqICAgICBBIGNvcHkgb2YgdGhlIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNl
bnNlIGNhbiBiZSBmb3VuZCBhdAogKiAgICAgaHR0cDovL3d3dy5nbnUub3Jn
LwogKgogKiBXcml0dGVuIGJ5IFJvYmVydCBDb2xsaW5zIDxyYnRjb2xsaW5z
QGhvdG1haWwuY29tPgogKgogKi8KCi8qIEFuIGluZGl2aWR1YWwgc3RyZWFt
IGZyb20gYSB0YXIgYXJjaGl2ZS4gKi8KCiNpZiAwCnN0YXRpYyBjb25zdCBj
aGFyICpjdnNpZCA9ICJcbiUlJSAkSWQ6ICBFeHAgJFxuIjsKI2VuZGlmCgoj
aW5jbHVkZSAid2luMzIuaCIKI2luY2x1ZGUgPHN0ZGlvLmg+CiNpbmNsdWRl
IDxzdGRsaWIuaD4KI2luY2x1ZGUgPHN5cy90eXBlcy5oPgojaW5jbHVkZSA8
c3lzL2ZjbnRsLmg+CiNpbmNsdWRlIDxlcnJuby5oPgoKI2luY2x1ZGUgInps
aWIvemxpYi5oIgojaW5jbHVkZSAiaW9fc3RyZWFtLmgiCiNpbmNsdWRlICJj
b21wcmVzcy5oIgojaW5jbHVkZSAiYXJjaGl2ZS5oIgojaW5jbHVkZSAidGFy
LmgiCiNpbmNsdWRlICJsb2cuaCIKI2luY2x1ZGUgImNvbmNhdC5oIgoKI2lu
Y2x1ZGUgInBvcnQuaCIKCmFyY2hpdmVfdGFyX2ZpbGU6OmFyY2hpdmVfdGFy
X2ZpbGUgKHRhcl9zdGF0ZSAmIG5ld3N0YXRlKTpzdGF0ZSAobmV3c3RhdGUp
CnsKfQoKYXJjaGl2ZV90YXJfZmlsZTo6fmFyY2hpdmVfdGFyX2ZpbGUgKCkK
ewogIHN0YXRlLmhlYWRlcl9yZWFkID0gMDsKfQoKLyogVmlydHVhbCBtZW1l
YnJzICovCnNzaXplX3QgYXJjaGl2ZV90YXJfZmlsZTo6cmVhZCAodm9pZCAq
YnVmZmVyLCBzaXplX3QgbGVuKQp7CiAgLyogaG93IG1hbnkgYnl0ZXMgZG8g
d2Ugd2FudCB0byBnaXZlIHRoZSB1c2VyICovCiAgaW50CiAgICB3YW50ID0g
bWluIChsZW4sIHN0YXRlLmZpbGVfbGVuZ3RoIC0gc3RhdGUuZmlsZV9vZmZz
ZXQpOwogIC8qIGhvdyBtYW55IGRvIHdlIG5lZWQgdG8gcmVhZCBhZnRlciB0
aGF0IHRvIGxpbmUgdXAgdGhlIGZpbGUgcG9pbnRlciAqLwogIGludAogICAg
cm91bmR1cCA9ICg1MTIgLSAod2FudCAlIDUxMikpICUgNTEyOwogIGlmICh3
YW50KQogICAgewogICAgICBzc2l6ZV90Cglnb3QgPSBzdGF0ZS5wYXJlbnQt
PnJlYWQgKGJ1ZmZlciwgd2FudCk7CiAgICAgIGNoYXIKCXRocm93YXdheVs1
MTJdOwogICAgICBzc2l6ZV90Cglnb3QyID0gc3RhdGUucGFyZW50LT5yZWFk
ICh0aHJvd2F3YXksIHJvdW5kdXApOwogICAgICBpZiAoZ290ID09IHdhbnQg
JiYgZ290MiA9PSByb3VuZHVwKQoJewoJICBzdGF0ZS5maWxlX29mZnNldCAr
PSBnb3Q7CgkgIHJldHVybiBnb3Q7Cgl9CiAgICAgIGVsc2UKCXsKCSAgLyog
dW5leHBlY3RlZCBFT0Ygb3IgcmVhZCBlcnJvciBpbiB0aGUgdGFyIHBhcmVu
dCBzdHJlYW0gKi8KCSAgLyogdGhlIHVzZXIgY2FuIHF1ZXJ5IHRoZSBwYXJl
bnQgZm9yIHRoZSBlcnJvciAqLwoJICBzdGF0ZS5sYXN0ZXJyID0gRUlPOwoJ
ICByZXR1cm4gRUlPOwoJfQogICAgfQogIHJldHVybiAwOwp9CgovKiBwcm92
aWRlIGRhdGEgdG8gKGRvdWJsZSBkdWghKSAqLwpzc2l6ZV90IGFyY2hpdmVf
dGFyX2ZpbGU6OndyaXRlICh2b2lkICpidWZmZXIsIHNpemVfdCBsZW4pCnsK
ICAvKiB3cml0ZSBub3Qgc3VwcG9ydGVkICovCiAgcmV0dXJuIEVCQURGOwp9
CgovKiByZWFkIGRhdGEgd2l0aG91dCByZW1vdmluZyBpdCBmcm9tIHRoZSBj
bGFzcydzIGludGVybmFsIGJ1ZmZlciAqLwpzc2l6ZV90IGFyY2hpdmVfdGFy
X2ZpbGU6OnBlZWsgKHZvaWQgKmJ1ZmZlciwgc2l6ZV90IGxlbikKewogIGlu
dAogICAgd2FudCA9IG1pbiAobGVuLCBzdGF0ZS5maWxlX2xlbmd0aCAtIHN0
YXRlLmZpbGVfb2Zmc2V0KTsKICBpZiAod2FudCkKICAgIHsKICAgICAgc3Np
emVfdAoJZ290ID0gc3RhdGUucGFyZW50LT5wZWVrIChidWZmZXIsIHdhbnQp
OwogICAgICBpZiAoZ290ID09IHdhbnQpCgl7CgkgIHJldHVybiBnb3Q7Cgl9
CiAgICAgIGVsc2UKCXsKCSAgLyogdW5leHBlY3RlZCBFT0Ygb3IgcmVhZCBl
cnJvciBpbiB0aGUgdGFyIHBhcmVudCBzdHJlYW0gKi8KCSAgLyogdGhlIHVz
ZXIgY2FuIHF1ZXJ5IHRoZSBwYXJlbnQgZm9yIHRoZSBlcnJvciAqLwoJICBz
dGF0ZS5sYXN0ZXJyID0gRUlPOwoJICByZXR1cm4gRUlPOwoJfQogICAgfQog
IHJldHVybiAwOwp9Cgpsb25nCmFyY2hpdmVfdGFyX2ZpbGU6OnRlbGwgKCkK
ewogIHJldHVybiBzdGF0ZS5maWxlX29mZnNldDsKfQoKLyogdHJ5IGd1ZXNz
aW5nIHRoaXMgb25lICovCmludAphcmNoaXZlX3Rhcl9maWxlOjplcnJvciAo
KQp7CiAgcmV0dXJuIHN0YXRlLmxhc3RlcnI7Cn0K

------------=_1583532850-65438-114
Content-Type: text/x-c; charset=us-ascii; name="compress.cc"
Content-Disposition: inline; filename="compress.cc"
Content-Transfer-Encoding: base64
Content-Length: 3335

LyoKICogQ29weXJpZ2h0IChjKSAyMDAxLCBSb2JlcnQgQ29sbGlucy4KICoK
ICogICAgIFRoaXMgcHJvZ3JhbSBpcyBmcmVlIHNvZnR3YXJlOyB5b3UgY2Fu
IHJlZGlzdHJpYnV0ZSBpdCBhbmQvb3IgbW9kaWZ5CiAqICAgICBpdCB1bmRl
ciB0aGUgdGVybXMgb2YgdGhlIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNl
IGFzIHB1Ymxpc2hlZCBieQogKiAgICAgdGhlIEZyZWUgU29mdHdhcmUgRm91
bmRhdGlvbjsgZWl0aGVyIHZlcnNpb24gMiBvZiB0aGUgTGljZW5zZSwgb3IK
ICogICAgIChhdCB5b3VyIG9wdGlvbikgYW55IGxhdGVyIHZlcnNpb24uCiAq
CiAqICAgICBBIGNvcHkgb2YgdGhlIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNl
bnNlIGNhbiBiZSBmb3VuZCBhdAogKiAgICAgaHR0cDovL3d3dy5nbnUub3Jn
LwogKgogKiBXcml0dGVuIGJ5IFJvYmVydCBDb2xsaW5zICA8cmJ0Y29sbGlu
c0Bob3RtYWlsLmNvbT4KICoKICovCgovKiBBcmNoaXZlIElPIG9wZXJhdGlv
bnMKICovCgojaWYgMApzdGF0aWMgY29uc3QgY2hhciAqY3ZzaWQgPQogICJc
biUlJSAkSWQ6IHNvdXJjZS5jYyx2IDIuNSAyMDAxLzExLzAxIDEzOjIyOjQ2
IHJiY29sbGlucyBFeHAgJFxuIjsKI2VuZGlmCgojaW5jbHVkZSAid2luMzIu
aCIKI2luY2x1ZGUgPHN0ZGlvLmg+CiNpbmNsdWRlICJsb2cuaCIKI2luY2x1
ZGUgInBvcnQuaCIKCiNpbmNsdWRlICJpb19zdHJlYW0uaCIKI2luY2x1ZGUg
ImNvbXByZXNzLmgiCiNpbmNsdWRlICJ6bGliL3psaWIuaCIKI2luY2x1ZGUg
ImNvbXByZXNzX2d6LmgiCiNpbmNsdWRlICJjb21wcmVzc19iei5oIgoKLyog
SW4gY2FzZSB5b3UgYXJlIHdvbmRlcmluZyB3aHkgdGhlIGZpbGUgbWFnaWMg
aXMgbm90IGluIG9uZSBwbGFjZToKICogSXQgY291bGQgYmUuIEJ1dCB0aGVy
ZSBpcyBsaXR0bGUgKGFueT8pIGJlbmVmaXQuCiAqIFdoYXQgaXMgaW1wb3J0
YW50IGlzIHRoYXQgdGhlIGZpbGUgbWFnaWMgcmVxdWlyZWQgZm9yIGFueSBf
dGFza18gaXMgY2VudHJhbGlzZWQuCiAqIE9uZSBzdWNoIHRhc2sgaXMgaWRl
bnRpZnlpbmcgY29tcHJlc3NzCiAqCiAqIHRvIGZlZGVyYXRlIGludG8gZWFj
aCBjbGFzcyBvbmUgbWlnaHQgYWRkIGEgbWFnaWMgcGFyYW1ldGVyIHRvIHRo
ZSBjb25zdHJ1Y3Rvciwgd2hpY2gKICogdGhlIGNsYXNzIGNvdWxkIHRlc3Qg
aXRzZWxmLiAKICovCgojZGVmaW5lIGxvbmdlc3RfbWFnaWMgMwoKaW9fc3Ry
ZWFtICoKY29tcHJlc3M6OmRlY29tcHJlc3MgKGlvX3N0cmVhbSAqIG9yaWdp
bmFsKQp7CiAgaWYgKCFvcmlnaW5hbCkKICAgIHJldHVybiBOVUxMOwogIGNo
YXIgbWFnaWNbbG9uZ2VzdF9tYWdpY107CiAgaWYgKG9yaWdpbmFsLT5wZWVr
IChtYWdpYywgbG9uZ2VzdF9tYWdpYykgPiAwKQogICAgewogICAgICBpZiAo
bWVtY21wIChtYWdpYywgIlwwMzdcMjEzIiwgMikgPT0gMCkKCXsKCSAgLyog
dGFyICovCgkgIGNvbXByZXNzX2d6ICpydiA9IG5ldyBjb21wcmVzc19neiAo
b3JpZ2luYWwpOwoJICBpZiAoIXJ2LT5lcnJvciAoKSkKCSAgICByZXR1cm4g
cnY7CgkgIHJldHVybiBOVUxMOwoJfQogICAgICBlbHNlIGlmIChtZW1jbXAg
KG1hZ2ljLCAiQlpoIiwgMykgPT0gMCkKCXsKCSAgY29tcHJlc3NfYnogKnJ2
ID0gbmV3IGNvbXByZXNzX2J6IChvcmlnaW5hbCk7CgkgIGlmICghcnYtPmVy
cm9yICgpKQoJICAgIHJldHVybiBydjsKCSAgcmV0dXJuIE5VTEw7Cgl9CiAg
ICB9CiAgcmV0dXJuIE5VTEw7Cn0KCnNzaXplX3QKY29tcHJlc3M6OnJlYWQg
KHZvaWQgKmJ1ZmZlciwgc2l6ZV90IGxlbikKewogIGxvZyAoTE9HX1RJTUVT
VEFNUCwgImNvbXByZXNzOjpyZWFkIGNhbGxlZCIpOwogIHJldHVybiAwOwp9
Cgpzc2l6ZV90CmNvbXByZXNzOjp3cml0ZSAodm9pZCAqYnVmZmVyLCBzaXpl
X3QgbGVuKQp7CiAgbG9nIChMT0dfVElNRVNUQU1QLCAiY29tcHJlc3M6Ondy
aXRlIGNhbGxlZCIpOwogIHJldHVybiAwOwp9Cgpzc2l6ZV90CmNvbXByZXNz
OjpwZWVrICh2b2lkICpidWZmZXIsIHNpemVfdCBsZW4pCnsKICBsb2cgKExP
R19USU1FU1RBTVAsICJjb21wcmVzczo6cGVlayBjYWxsZWQiKTsKICByZXR1
cm4gMDsKfQoKbG9uZwpjb21wcmVzczo6dGVsbCAoKQp7CiAgbG9nIChMT0df
VElNRVNUQU1QLCAiYno6OnRlbGwgY2FsbGVkIik7CiAgcmV0dXJuIDA7Cn0K
CmludApjb21wcmVzczo6ZXJyb3IgKCkKewogIGxvZyAoTE9HX1RJTUVTVEFN
UCwgImNvbXByZXNzOjplcnJvciBjYWxsZWQiKTsKICByZXR1cm4gMDsKfQoK
Y29uc3QgY2hhciAqCmNvbXByZXNzOjpuZXh0X2ZpbGVfbmFtZSAoKQp7CiAg
bG9nIChMT0dfVElNRVNUQU1QLCAiY29tcHJlc3M6Om5leHRfZmlsZV9uYW1l
IGNhbGxlZCIpOwogIHJldHVybiBOVUxMOwp9Cgpjb21wcmVzczo6fmNvbXBy
ZXNzICgpCnsKICBsb2cgKExPR19USU1FU1RBTVAsICJjb21wcmVzczo6fmNv
bXByZXNzIGNhbGxlZCIpOwogIHJldHVybjsKfQo=

------------=_1583532850-65438-114
Content-Type: text/x-c++; charset=us-ascii; name="compress.h"
Content-Disposition: inline; filename="compress.h"
Content-Transfer-Encoding: base64
Content-Length: 2501

LyoKICogQ29weXJpZ2h0IChjKSAyMDAxLCBSb2JlcnQgQ29sbGlucy4KICoK
ICogICAgIFRoaXMgcHJvZ3JhbSBpcyBmcmVlIHNvZnR3YXJlOyB5b3UgY2Fu
IHJlZGlzdHJpYnV0ZSBpdCBhbmQvb3IgbW9kaWZ5CiAqICAgICBpdCB1bmRl
ciB0aGUgdGVybXMgb2YgdGhlIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNl
IGFzIHB1Ymxpc2hlZCBieQogKiAgICAgdGhlIEZyZWUgU29mdHdhcmUgRm91
bmRhdGlvbjsgZWl0aGVyIHZlcnNpb24gMiBvZiB0aGUgTGljZW5zZSwgb3IK
ICogICAgIChhdCB5b3VyIG9wdGlvbikgYW55IGxhdGVyIHZlcnNpb24uCiAq
CiAqICAgICBBIGNvcHkgb2YgdGhlIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNl
bnNlIGNhbiBiZSBmb3VuZCBhdAogKiAgICAgaHR0cDovL3d3dy5nbnUub3Jn
LwogKgogKiBXcml0dGVuIGJ5IFJvYmVydCBDb2xsaW5zICA8cmJ0Y29sbGlu
c0Bob3RtYWlsLmNvbT4KICoKICovCgojaWZuZGVmIF9DT01QUkVTU19IXwoj
ZGVmaW5lIF9DT01QUkVTU19IXwoKLyogdGhpcyBpcyB0aGUgcGFyZW50IGNs
YXNzIGZvciBhbGwgY29tcHJlc3MgSU8gb3BlcmF0aW9ucy4gCiAqIEl0IAog
Ki8KCmNsYXNzIGNvbXByZXNzOnB1YmxpYyBpb19zdHJlYW0KewpwdWJsaWM6
CiAgLyogR2V0IGEgZGVjb21wcmVzc2VkIHN0cmVhbSBmcm9tIGEgbm9ybWFs
IHN0cmVhbS4gSWYgdGhpcyBmdW5jdGlvbiByZXR1cm5zIG5vbi1udWxsCiAg
ICogYSB2YWxpZCBjb21wcmVzcyBoZWFkZXIgd2FzIGZvdW5kLiBUaGUgaW9f
c3RyZWFtIHBvaW50ZXIgcGFzc2VkIHRvIGRlY29tcHJlc3MKICAgKiBzaG91
bGQgYmUgZGlzY2FyZGVkLiBUaGUgb2xkIGlvX3N0cmVhbSB3aWxsIGJlIGF1
dG9tYXRpY2FsbHkgY2xvc2VkIHdoZW4gdGhlIAogICAqIGRlY29tcHJlc3Np
b24gc3RyZWFtIGlzIGNsb3NlZAogICAqLwogIHN0YXRpYyBpb19zdHJlYW0g
KmRlY29tcHJlc3MgKGlvX3N0cmVhbSAqKTsKICAvKiAKICAgKiBUbyBjcmVh
dGUgYSBzdHJlYW0gdGhhdCB3aWxsIGJlIGNvbXByZXNzZWQsIHlvdSBzaG91
bGQgb3BlbiB0aGUgdXJsLCBhbmQgdGhlbiBnZXQgYSBuZXcgc3RyZWFtCiAg
ICogZnJvbSBjb21wcmVzczo6Y29tcHJlc3MuIAogICAqLwogIC8qIHJlYWQg
ZGF0YSAoZHVoISkgKi8KICB2aXJ0dWFsIHNzaXplX3QgcmVhZCAodm9pZCAq
YnVmZmVyLCBzaXplX3QgbGVuKTsKICAvKiBwcm92aWRlIGRhdGEgdG8gKGRv
dWJsZSBkdWghKSAqLwogIHZpcnR1YWwgc3NpemVfdCB3cml0ZSAodm9pZCAq
YnVmZmVyLCBzaXplX3QgbGVuKTsKICAvKiByZWFkIGRhdGEgd2l0aG91dCBy
ZW1vdmluZyBpdCBmcm9tIHRoZSBjbGFzcydzIGludGVybmFsIGJ1ZmZlciAq
LwogIHZpcnR1YWwgc3NpemVfdCBwZWVrICh2b2lkICpidWZmZXIsIHNpemVf
dCBsZW4pOwogIHZpcnR1YWwgbG9uZyB0ZWxsICgpOwogIC8qIHRyeSBndWVz
c2luZyB0aGlzIG9uZSAqLwogIHZpcnR1YWwgaW50IGVycm9yICgpOwogIC8q
IEZpbmQgb3V0IHRoZSBuZXh0IHN0cmVhbSBuYW1lIC0KICAgKiBpZSBmb3Ig
Zm9vLnRhci5neiwgYXQgb2Zmc2V0IDAsIG5leHRfZmlsZV9uYW1lID0gZm9v
LnRhcgogICAqIGZvciBmb29iYXIgdGhhdCBpcyBhbiBjb21wcmVzcywgbmV4
dF9maWxlX25hbWUgaXMgdGhlIG5leHQKICAgKiBleHRyYWN0YWJsZSBmaWxl
bmFtZS4KICAgKi8KICB2aXJ0dWFsIGNvbnN0IGNoYXIgKm5leHRfZmlsZV9u
YW1lICgpID0gTlVMTDsKICAvKiBpZiB5b3UgYXJlIHN0aWxsIG5lZWRpbmcg
dGhlc2UgaGludHMuLi4gZ2l2ZSB1cCBub3chICovCiAgICB2aXJ0dWFsIH4g
Y29tcHJlc3MgKCk7Cn07CgojZW5kaWYgLyogX0NPTVBSRVNTX0hfICovCg==

------------=_1583532850-65438-114
Content-Type: text/x-c; charset=us-ascii; name="compress_bz.cc"
Content-Disposition: inline; filename="compress_bz.cc"
Content-Transfer-Encoding: base64
Content-Length: 2274

LyoKICogQ29weXJpZ2h0IChjKSAyMDAxLCBSb2JlcnQgQ29sbGlucy4KICoK
ICogICAgIFRoaXMgcHJvZ3JhbSBpcyBmcmVlIHNvZnR3YXJlOyB5b3UgY2Fu
IHJlZGlzdHJpYnV0ZSBpdCBhbmQvb3IgbW9kaWZ5CiAqICAgICBpdCB1bmRl
ciB0aGUgdGVybXMgb2YgdGhlIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNl
IGFzIHB1Ymxpc2hlZCBieQogKiAgICAgdGhlIEZyZWUgU29mdHdhcmUgRm91
bmRhdGlvbjsgZWl0aGVyIHZlcnNpb24gMiBvZiB0aGUgTGljZW5zZSwgb3IK
ICogICAgIChhdCB5b3VyIG9wdGlvbikgYW55IGxhdGVyIHZlcnNpb24uCiAq
CiAqICAgICBBIGNvcHkgb2YgdGhlIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNl
bnNlIGNhbiBiZSBmb3VuZCBhdAogKiAgICAgaHR0cDovL3d3dy5nbnUub3Jn
LwogKgogKiBXcml0dGVuIGJ5IFJvYmVydCBDb2xsaW5zICA8cmJ0Y29sbGlu
c0Bob3RtYWlsLmNvbT4KICoKICovCgovKiBBcmNoaXZlIElPIG9wZXJhdGlv
bnMKICovCgojaWYgMApzdGF0aWMgY29uc3QgY2hhciAqY3ZzaWQgPQogICJc
biUlJSAkSWQ6IHNvdXJjZS5jYyx2IDIuNSAyMDAxLzExLzAxIDEzOjIyOjQ2
IHJiY29sbGlucyBFeHAgJFxuIjsKI2VuZGlmCgojaW5jbHVkZSAid2luMzIu
aCIKI2luY2x1ZGUgPHN0ZGlvLmg+CiNpbmNsdWRlIDxlcnJuby5oPgojaW5j
bHVkZSAibG9nLmgiCiNpbmNsdWRlICJwb3J0LmgiCgojaW5jbHVkZSAiaW9f
c3RyZWFtLmgiCiNpbmNsdWRlICJjb21wcmVzcy5oIgojaW5jbHVkZSAiY29t
cHJlc3NfYnouaCIKCmNvbXByZXNzX2J6Ojpjb21wcmVzc19ieiAoaW9fc3Ry
ZWFtICogcGFyZW50KQp7CiAgb3JpZ2luYWwgPSBOVUxMOwogIGxhc3RlcnIg
PSAwOwogIGlmICghcGFyZW50KQogICAgbGFzdGVyciA9IEVCQURGOwogIG9y
aWdpbmFsID0gcGFyZW50Owp9Cgpzc2l6ZV90IGNvbXByZXNzX2J6OjpyZWFk
ICh2b2lkICpidWZmZXIsIHNpemVfdCBsZW4pCnsKICBsb2cgKExPR19USU1F
U1RBTVAsICJjb21wcmVzc19iejo6cmVhZCBjYWxsZWQiKTsKICByZXR1cm4g
MDsKfQoKc3NpemVfdCBjb21wcmVzc19iejo6d3JpdGUgKHZvaWQgKmJ1ZmZl
ciwgc2l6ZV90IGxlbikKewogIGxvZyAoTE9HX1RJTUVTVEFNUCwgImNvbXBy
ZXNzX2J6Ojp3cml0ZSBjYWxsZWQiKTsKICByZXR1cm4gMDsKfQoKc3NpemVf
dCBjb21wcmVzc19iejo6cGVlayAodm9pZCAqYnVmZmVyLCBzaXplX3QgbGVu
KQp7CiAgbG9nIChMT0dfVElNRVNUQU1QLCAiY29tcHJlc3NfYno6OnBlZWsg
Y2FsbGVkIik7CiAgcmV0dXJuIDA7Cn0KCmxvbmcKY29tcHJlc3NfYno6OnRl
bGwgKCkKewogIGxvZyAoTE9HX1RJTUVTVEFNUCwgImNvbXByZXNzX2J6Ojp0
ZWxsIGNhbGxlZCIpOwogIHJldHVybiAwOwp9CgppbnQKY29tcHJlc3NfYno6
OmVycm9yICgpCnsKICBsb2cgKExPR19USU1FU1RBTVAsICJjb21wcmVzc19i
ejo6ZXJyb3IgY2FsbGVkIik7CiAgcmV0dXJuIDA7Cn0KCmludApjb21wcmVz
c19iejo6c2V0X210aW1lIChpbnQgdGltZSkKewogIGlmIChvcmlnaW5hbCkK
ICAgIHJldHVybiBvcmlnaW5hbC0+c2V0X210aW1lICh0aW1lKTsKICByZXR1
cm4gMTsKfQoKY29tcHJlc3NfYno6On5jb21wcmVzc19ieiAoKQp7CiAgbG9n
IChMT0dfVElNRVNUQU1QLCAiY29tcHJlc3NfYno6On5ieiBjYWxsZWQiKTsK
ICByZXR1cm47Cn0K

------------=_1583532850-65438-114
Content-Type: text/x-c++; charset=us-ascii; name="compress_bz.h"
Content-Disposition: inline; filename="compress_bz.h"
Content-Transfer-Encoding: base64
Content-Length: 2262

LyoKICogQ29weXJpZ2h0IChjKSAyMDAxLCBSb2JlcnQgQ29sbGlucy4KICoK
ICogICAgIFRoaXMgcHJvZ3JhbSBpcyBmcmVlIHNvZnR3YXJlOyB5b3UgY2Fu
IHJlZGlzdHJpYnV0ZSBpdCBhbmQvb3IgbW9kaWZ5CiAqICAgICBpdCB1bmRl
ciB0aGUgdGVybXMgb2YgdGhlIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNl
IGFzIHB1Ymxpc2hlZCBieQogKiAgICAgdGhlIEZyZWUgU29mdHdhcmUgRm91
bmRhdGlvbjsgZWl0aGVyIHZlcnNpb24gMiBvZiB0aGUgTGljZW5zZSwgb3IK
ICogICAgIChhdCB5b3VyIG9wdGlvbikgYW55IGxhdGVyIHZlcnNpb24uCiAq
CiAqICAgICBBIGNvcHkgb2YgdGhlIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNl
bnNlIGNhbiBiZSBmb3VuZCBhdAogKiAgICAgaHR0cDovL3d3dy5nbnUub3Jn
LwogKgogKiBXcml0dGVuIGJ5IFJvYmVydCBDb2xsaW5zICA8cmJ0Y29sbGlu
c0Bob3RtYWlsLmNvbT4KICoKICovCgojaWZuZGVmIF9DT01QUkVTU19CWl9I
XwojZGVmaW5lIF9DT01QUkVTU19CWl9IXwoKLyogdGhpcyBpcyB0aGUgcGFy
ZW50IGNsYXNzIGZvciBhbGwgY29tcHJlc3MgSU8gb3BlcmF0aW9ucy4gCiAq
IEl0IAogKi8KCmNsYXNzIGNvbXByZXNzX2J6OnB1YmxpYyBjb21wcmVzcwp7
CnB1YmxpYzoKICAvKiBhc3N1bWVzIGRlY29tcHJlc3Npb24gKi8KICBjb21w
cmVzc19ieiAoaW9fc3RyZWFtICopOwogIC8qIGFsbG93cyBjb21wL2RlY29t
cCBidXQgdGhpcyBpbXBsZW1lbnRhdGlvbiBvbmx5IGhhbmRsZXMgY29tcCAq
LwogIGNvbXByZXNzX2J6IChpb19zdHJlYW0gKiwgY29uc3QgY2hhciAqKTsK
ICAvKiByZWFkIGRhdGEgKGR1aCEpICovCiAgdmlydHVhbCBzc2l6ZV90IHJl
YWQgKHZvaWQgKmJ1ZmZlciwgc2l6ZV90IGxlbik7CiAgLyogcHJvdmlkZSBk
YXRhIHRvIChkb3VibGUgZHVoISkgKi8KICB2aXJ0dWFsIHNzaXplX3Qgd3Jp
dGUgKHZvaWQgKmJ1ZmZlciwgc2l6ZV90IGxlbik7CiAgLyogcmVhZCBkYXRh
IHdpdGhvdXQgcmVtb3ZpbmcgaXQgZnJvbSB0aGUgY2xhc3MncyBpbnRlcm5h
bCBidWZmZXIgKi8KICB2aXJ0dWFsIHNzaXplX3QgcGVlayAodm9pZCAqYnVm
ZmVyLCBzaXplX3QgbGVuKTsKICB2aXJ0dWFsIGxvbmcgdGVsbCAoKTsKICAv
KiB0cnkgZ3Vlc3NpbmcgdGhpcyBvbmUgKi8KICB2aXJ0dWFsIGludCBlcnJv
ciAoKTsKICAvKiBGaW5kIG91dCB0aGUgbmV4dCBzdHJlYW0gbmFtZSAtCiAg
ICogaWUgZm9yIGZvby50YXIuYnosIGF0IG9mZnNldCAwLCBuZXh0X2ZpbGVf
bmFtZSA9IGZvby50YXIKICAgKiBmb3IgZm9vYmFyIHRoYXQgaXMgYW4gY29t
cHJlc3MsIG5leHRfZmlsZV9uYW1lIGlzIHRoZSBuZXh0CiAgICogZXh0cmFj
dGFibGUgZmlsZW5hbWUuCiAgICovCiAgdmlydHVhbCBjb25zdCBjaGFyICpu
ZXh0X2ZpbGVfbmFtZSAoKQogIHsKICAgIHJldHVybiBOVUxMOwogIH07CiAg
dmlydHVhbCBpbnQgc2V0X210aW1lIChpbnQpOwogIC8qIGlmIHlvdSBhcmUg
c3RpbGwgbmVlZGluZyB0aGVzZSBoaW50cy4uLiBnaXZlIHVwIG5vdyEgKi8K
ICAgIHZpcnR1YWwgfiBjb21wcmVzc19ieiAoKTsKcHJpdmF0ZToKICAgIGNv
bXByZXNzX2J6ICgpCiAgewogIH07CiAgaW9fc3RyZWFtICpvcmlnaW5hbDsK
ICBpbnQgbGFzdGVycjsKfTsKCiNlbmRpZiAvKiBfQ09NUFJFU1NfQlpfSF8g
Ki8K

------------=_1583532850-65438-114
Content-Type: text/x-c; charset=us-ascii; name="compress_gz.cc"
Content-Disposition: inline; filename="compress_gz.cc"
Content-Transfer-Encoding: base64
Content-Length: 18691

LyoKICogQ29weXJpZ2h0IChjKSAyMDAxLCBSb2JlcnQgQ29sbGlucy4KICoK
ICogICAgIFRoaXMgcHJvZ3JhbSBpcyBmcmVlIHNvZnR3YXJlOyB5b3UgY2Fu
IHJlZGlzdHJpYnV0ZSBpdCBhbmQvb3IgbW9kaWZ5CiAqICAgICBpdCB1bmRl
ciB0aGUgdGVybXMgb2YgdGhlIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNl
IGFzIHB1Ymxpc2hlZCBieQogKiAgICAgdGhlIEZyZWUgU29mdHdhcmUgRm91
bmRhdGlvbjsgZWl0aGVyIHZlcnNpb24gMiBvZiB0aGUgTGljZW5zZSwgb3IK
ICogICAgIChhdCB5b3VyIG9wdGlvbikgYW55IGxhdGVyIHZlcnNpb24uCiAq
CiAqICAgICBBIGNvcHkgb2YgdGhlIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNl
bnNlIGNhbiBiZSBmb3VuZCBhdAogKiAgICAgaHR0cDovL3d3dy5nbnUub3Jn
LwogKgogKiBXcml0dGVuIGJ5IFJvYmVydCBDb2xsaW5zICA8cmJ0Y29sbGlu
c0Bob3RtYWlsLmNvbT4KICoKICovCgovKiBBcmNoaXZlIElPIG9wZXJhdGlv
bnMgZm9yIGd6IGZpbGVzCiAqIFBvcnRpb25zIGNvcHlyaWdodCB1bmRlciB0
aGUgemxpYiBsaWNlbmNlIC0gdGhpcyBjbGFzcyB3YXMgZGVyaXZlZCBmcm9t
IGd6aW8uYyBpbiB0aGF0CiAqIGxpYnJhcnkuCiAqLwoKI2lmIDAKc3RhdGlj
IGNvbnN0IGNoYXIgKmN2c2lkID0KICAiXG4lJSUgJElkOiBzb3VyY2UuY2Ms
diAyLjUgMjAwMS8xMS8wMSAxMzoyMjo0NiByYmNvbGxpbnMgRXhwICRcbiI7
CiNlbmRpZgoKI2luY2x1ZGUgIndpbjMyLmgiCiNpbmNsdWRlIDxzdGRpby5o
PgojaW5jbHVkZSA8c3RkbGliLmg+CiNpbmNsdWRlIDxlcnJuby5oPgojaW5j
bHVkZSAibG9nLmgiCiNpbmNsdWRlICJwb3J0LmgiCgojaW5jbHVkZSAiaW9f
c3RyZWFtLmgiCiNpbmNsdWRlICJjb21wcmVzcy5oIgojaW5jbHVkZSAiemxp
Yi96bGliLmgiCiNpbmNsdWRlICJjb21wcmVzc19nei5oIgoKI2RlZmluZSBI
RUFEX0NSQyAgICAgMHgwMgkvKiBiaXQgMSBzZXQ6IGhlYWRlciBDUkMgcHJl
c2VudCAqLwojZGVmaW5lIEVYVFJBX0ZJRUxEICAweDA0CS8qIGJpdCAyIHNl
dDogZXh0cmEgZmllbGQgcHJlc2VudCAqLwojZGVmaW5lIE9SSUdfTkFNRSAg
ICAweDA4CS8qIGJpdCAzIHNldDogb3JpZ2luYWwgZmlsZSBuYW1lIHByZXNl
bnQgKi8KI2RlZmluZSBDT01NRU5UICAgICAgMHgxMAkvKiBiaXQgNCBzZXQ6
IGZpbGUgY29tbWVudCBwcmVzZW50ICovCiNkZWZpbmUgUkVTRVJWRUQgICAg
IDB4RTAJLyogYml0cyA1Li43OiByZXNlcnZlZCAqLwoKCi8qIFRPRE8gbWFr
ZSB0aGlzIGEgc3RhdGljIG1lbWJlciBhbmQgZmVkZXJhdGUgdGhlIG1hZ2lj
IGxvZ2ljICovCnN0YXRpYyBpbnQgZ3pfbWFnaWNbMl0gPSB7IDB4MWYsIDB4
OGIgfTsJLyogZ3ppcCBtYWdpYyBoZWFkZXIgKi8KCi8qCiAqIFByZWRpY2F0
ZTogdGhlIHN0cmVhbSBpcyBvcGVuIGZvciByZWFkLiBGb3Igd3JpdGluZyB0
aGUgY2xhc3MgY29uc3RydWN0b3IgdmFyaWFudCB3aXRoCiAqIG1vZGUgbXVz
dCBiZSBjYWxsZWQgZGlyZWN0bHkKICovCmNvbXByZXNzX2d6Ojpjb21wcmVz
c19neiAoaW9fc3RyZWFtICogcGFyZW50KQp7CiAgY29uc3RydWN0IChwYXJl
bnQsICJyIik7Cn0KCmNvbXByZXNzX2d6Ojpjb21wcmVzc19neiAoaW9fc3Ry
ZWFtICogcGFyZW50LCBjb25zdCBjaGFyICpvcGVubW9kZSkKewogIGNvbnN0
cnVjdCAocGFyZW50LCBvcGVubW9kZSk7Cn0KCnZvaWQKY29tcHJlc3NfZ3o6
OmNvbnN0cnVjdCAoaW9fc3RyZWFtICogcGFyZW50LCBjb25zdCBjaGFyICpv
cGVubW9kZSkKewogIGlmICghcGFyZW50KQogICAgewogICAgICB6X2VyciA9
IFpfU1RSRUFNX0VSUk9SOwogICAgICByZXR1cm47CiAgICB9CgogIG9yaWdp
bmFsID0gcGFyZW50OwogIHBlZWtsZW4gPSAwOwogIGludCBlcnI7CiAgaW50
IGxldmVsID0gWl9ERUZBVUxUX0NPTVBSRVNTSU9OOwkvKiBjb21wcmVzc2lv
biBsZXZlbCAqLwogIGludCBzdHJhdGVneSA9IFpfREVGQVVMVF9TVFJBVEVH
WTsJLyogY29tcHJlc3Npb24gc3RyYXRlZ3kgKi8KICBjaGFyICpwID0gKGNo
YXIgKikgb3Blbm1vZGU7CiAgY2hhciBmbW9kZVs4MF07CQkvKiBjb3B5IG9m
IG9wZW5tb2RlLCB3aXRob3V0IHRoZSBjb21wcmVzc2lvbiBsZXZlbCAqLwog
IGNoYXIgKm0gPSBmbW9kZTsKCiAgc3RyZWFtLnphbGxvYyA9IChhbGxvY19m
dW5jKSBOVUxMOwogIHN0cmVhbS56ZnJlZSA9IChmcmVlX2Z1bmMpIE5VTEw7
CiAgc3RyZWFtLm9wYXF1ZSA9ICh2b2lkcGYpIE5VTEw7CiAgc3RyZWFtLm5l
eHRfaW4gPSBpbmJ1ZiA9IE5VTEw7CiAgc3RyZWFtLm5leHRfb3V0ID0gb3V0
YnVmID0gTlVMTDsKICBzdHJlYW0uYXZhaWxfaW4gPSBzdHJlYW0uYXZhaWxf
b3V0ID0gMDsKICB6X2VyciA9IFpfT0s7CiAgel9lb2YgPSAwOwogIGNyYyA9
IGNyYzMyICgwTCwgWl9OVUxMLCAwKTsKICBtc2cgPSBOVUxMOwogIHRyYW5z
cGFyZW50ID0gMDsKCiAgbW9kZSA9ICdcMCc7CiAgZG8KICAgIHsKICAgICAg
aWYgKCpwID09ICdyJykKCW1vZGUgPSAncic7CiAgICAgIGlmICgqcCA9PSAn
dycgfHwgKnAgPT0gJ2EnKQoJbW9kZSA9ICd3JzsKICAgICAgaWYgKCpwID49
ICcwJyAmJiAqcCA8PSAnOScpCgl7CgkgIGxldmVsID0gKnAgLSAnMCc7Cgl9
CiAgICAgIGVsc2UgaWYgKCpwID09ICdmJykKCXsKCSAgc3RyYXRlZ3kgPSBa
X0ZJTFRFUkVEOwoJfQogICAgICBlbHNlIGlmICgqcCA9PSAnaCcpCgl7Cgkg
IHN0cmF0ZWd5ID0gWl9IVUZGTUFOX09OTFk7Cgl9CiAgICAgIGVsc2UKCXsK
CSAgKm0rKyA9ICpwOwkJLyogY29weSB0aGUgbW9kZSAqLwoJfQogICAgfQog
IHdoaWxlICgqcCsrICYmIG0gIT0gZm1vZGUgKyBzaXplb2YgKGZtb2RlKSk7
CiAgaWYgKG1vZGUgPT0gJ1wwJykKICAgIHsKICAgICAgZGVzdHJveSAoKTsK
ICAgICAgel9lcnIgPSBaX1NUUkVBTV9FUlJPUjsKICAgICAgcmV0dXJuOwog
ICAgfQoKCiAgaWYgKG1vZGUgPT0gJ3cnKQogICAgewogICAgICBlcnIgPSBk
ZWZsYXRlSW5pdDIgKCYoc3RyZWFtKSwgbGV2ZWwsCgkJCSAgWl9ERUZMQVRF
RCwgLU1BWF9XQklUUywgOCwgc3RyYXRlZ3kpOwogICAgICAvKiB3aW5kb3dC
aXRzIGlzIHBhc3NlZCA8IDAgdG8gc3VwcHJlc3MgemxpYiBoZWFkZXIgKi8K
CiAgICAgIHN0cmVhbS5uZXh0X291dCA9IG91dGJ1ZiA9IChCeXRlICopIG1h
bGxvYyAoMTYzODQpOwogICAgICBpZiAoZXJyICE9IFpfT0sgfHwgb3V0YnVm
ID09IFpfTlVMTCkKCXsKCSAgZGVzdHJveSAoKTsKCSAgel9lcnIgPSBaX1NU
UkVBTV9FUlJPUjsKCSAgcmV0dXJuOwoJfQogICAgfQogIGVsc2UKICAgIHsK
CiAgICAgIHN0cmVhbS5uZXh0X2luID0gaW5idWYgPSAodW5zaWduZWQgY2hh
ciAqKSBtYWxsb2MgKDE2Mzg0KTsKICAgICAgZXJyID0gaW5mbGF0ZUluaXQy
ICgmc3RyZWFtLCAtTUFYX1dCSVRTKTsKICAgICAgLyogd2luZG93Qml0cyBp
cyBwYXNzZWQgPCAwIHRvIHRlbGwgdGhhdCB0aGVyZSBpcyBubyB6bGliIGhl
YWRlci4KICAgICAgICogTm90ZSB0aGF0IGluIHRoaXMgY2FzZSBpbmZsYXRl
ICpyZXF1aXJlcyogYW4gZXh0cmEgImR1bW15IiBieXRlCiAgICAgICAqIGFm
dGVyIHRoZSBjb21wcmVzc2VkIHN0cmVhbSBpbiBvcmRlciB0byBjb21wbGV0
ZSBkZWNvbXByZXNzaW9uIGFuZAogICAgICAgKiByZXR1cm4gWl9TVFJFQU1f
RU5ELiBIZXJlIHRoZSBnemlwIENSQzMyIGVuc3VyZXMgdGhhdCA0IGJ5dGVz
IGFyZQogICAgICAgKiBwcmVzZW50IGFmdGVyIHRoZSBjb21wcmVzc2VkIHN0
cmVhbS4KICAgICAgICovCiAgICAgIGlmIChlcnIgIT0gWl9PSyB8fCBpbmJ1
ZiA9PSBaX05VTEwpCgl7CgkgIGRlc3Ryb3kgKCk7CgkgIHpfZXJyID0gWl9T
VFJFQU1fRVJST1I7CgkgIHJldHVybjsKCX0KICAgIH0KICBzdHJlYW0uYXZh
aWxfb3V0ID0gMTYzODQ7CgogIGVycm5vID0gMDsKICBpZiAobW9kZSA9PSAn
dycpCiAgICB7CiAgICAgIC8qIFdyaXRlIGEgdmVyeSBzaW1wbGUgLmd6IGhl
YWRlcjoKICAgICAgICovCiAgICAgIGNoYXIgdGVtcFsyMF07CiAgICAgIHNw
cmludGYgKHRlbXAsICIlYyVjJWMlYyVjJWMlYyVjJWMlYyIsIGd6X21hZ2lj
WzBdLCBnel9tYWdpY1sxXSwKCSAgICAgICBaX0RFRkxBVEVELCAwIC8qZmxh
Z3MgKi8gLCAwLCAwLCAwLCAwIC8qdGltZSAqLyAsCgkgICAgICAgMCAvKnhm
bGFncyAqLyAsIDB4MGIpOwogICAgICBvcmlnaW5hbC0+d3JpdGUgKHRlbXAs
IDEwKTsKICAgICAgc3RhcnRwb3MgPSAxMEw7CiAgICAgIC8qIFdlIHVzZSAx
MEwgaW5zdGVhZCBvZiBmdGVsbChzLT5maWxlKSB0byBiZWNhdXNlIGZ0ZWxs
IGNhdXNlcyBhbgogICAgICAgKiBmZmx1c2ggb24gc29tZSBzeXN0ZW1zLiBU
aGlzIHZlcnNpb24gb2YgdGhlIGxpYnJhcnkgZG9lc24ndCB1c2UKICAgICAg
ICogc3RhcnRwb3MgYW55d2F5IGluIHdyaXRlIG1vZGUsIHNvIHRoaXMgaW5p
dGlhbGl6YXRpb24gaXMgbm90CiAgICAgICAqIG5lY2Vzc2FyeS4gCiAgICAg
ICAqLwogICAgfQogIGVsc2UKICAgIHsKCiAgICAgIGNoZWNrX2hlYWRlciAo
KTsJCS8qIHNraXAgdGhlIC5neiBoZWFkZXIgKi8KICAgICAgc3RhcnRwb3Mg
PSAob3JpZ2luYWwtPnRlbGwgKCkgLSBzdHJlYW0uYXZhaWxfaW4pOwogICAg
fQoKICByZXR1cm47Cn0KCi8qID09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PQogICBPdXRwdXRzIGEgbG9uZyBpbiBMU0Igb3JkZXIgdG8gdGhlIGdp
dmVuIGZpbGUKKi8Kdm9pZApjb21wcmVzc19nejo6cHV0TG9uZyAodW5zaWdu
ZWQgbG9uZyB4KQp7CiAgaW50IG47CiAgZm9yIChuID0gMDsgbiA8IDQ7IG4r
KykKICAgIHsKICAgICAgdW5zaWduZWQgY2hhciBjID0gKHVuc2lnbmVkIGNo
YXIpICh4ICYgMHhmZik7CiAgICAgIG9yaWdpbmFsLT53cml0ZSAoJmMsIDEp
OwogICAgICB4ID0geCA+PiA4OwogICAgfQp9CgoKdUxvbmcKY29tcHJlc3Nf
Z3o6OmdldExvbmcgKCkKewogIHVMb25nIHggPSAodUxvbmcpIGdldF9ieXRl
ICgpOwogIGludCBjOwoKICB4ICs9ICgodUxvbmcpIGdldF9ieXRlICgpKSA8
PCA4OwogIHggKz0gKCh1TG9uZykgZ2V0X2J5dGUgKCkpIDw8IDE2OwogIGMg
PSBnZXRfYnl0ZSAoKTsKICBpZiAoYyA9PSBFT0YpCiAgICB6X2VyciA9IFpf
REFUQV9FUlJPUjsKICB4ICs9ICgodUxvbmcpIGMpIDw8IDI0OwogIHJldHVy
biB4Owp9CgoKc3NpemVfdApjb21wcmVzc19nejo6cmVhZCAodm9pZCAqYnVm
ZmVyLCBzaXplX3QgbGVuKQp7CiAgaWYgKCFsZW4pCiAgICByZXR1cm4gMDsK
CiAgaWYgKHBlZWtsZW4pCiAgICB7CiAgICAgIHNzaXplX3QgdG1wbGVuID0g
bWluIChwZWVrbGVuLCBsZW4pOwogICAgICBwZWVrbGVuIC09IHRtcGxlbjsK
ICAgICAgbWVtY3B5IChidWZmZXIsIHBlZWtidWYsIHRtcGxlbik7CiAgICAg
IG1lbW1vdmUgKHBlZWtidWYsIHBlZWtidWYgKyB0bXBsZW4sIHRtcGxlbik7
CiAgICAgIHNzaXplX3QgdG1wcmVhZCA9IHJlYWQgKCYoKGNoYXIgKikgYnVm
ZmVyKVt0bXBsZW5dLCBsZW4gLSB0bXBsZW4pOwogICAgICBpZiAodG1wcmVh
ZCA+PSAwKQoJcmV0dXJuIHRtcHJlYWQgKyB0bXBsZW47CiAgICAgIGVsc2UK
CXJldHVybiB0bXByZWFkOwogICAgfQoKICBCeXRlZiAqc3RhcnQgPSAoQnl0
ZWYgKikgYnVmZmVyOwkvKiBzdGFydGluZyBwb2ludCBmb3IgY3JjIGNvbXB1
dGF0aW9uICovCiAgQnl0ZSAqbmV4dF9vdXQ7CQkvKiA9PSBzdHJlYW0ubmV4
dF9vdXQgYnV0IG5vdCBmb3JjZWQgZmFyIChmb3IgTVNET1MpICovCgogIGlm
IChtb2RlICE9ICdyJykKICAgIHJldHVybiBaX1NUUkVBTV9FUlJPUjsKCiAg
aWYgKHpfZXJyID09IFpfREFUQV9FUlJPUiB8fCB6X2VyciA9PSBaX0VSUk5P
KQogICAgcmV0dXJuIC0xOwogIGlmICh6X2VyciA9PSBaX1NUUkVBTV9FTkQp
CiAgICByZXR1cm4gMDsJCQkvKiBFT0YgKi8KCiAgbmV4dF9vdXQgPSAoQnl0
ZSAqKSBidWZmZXI7CiAgc3RyZWFtLm5leHRfb3V0ID0gKEJ5dGVmICopIGJ1
ZmZlcjsKICBzdHJlYW0uYXZhaWxfb3V0ID0gbGVuOwoKICB3aGlsZSAoc3Ry
ZWFtLmF2YWlsX291dCAhPSAwKQogICAgewoKICAgICAgaWYgKHRyYW5zcGFy
ZW50KQoJewoJICAvKiBDb3B5IGZpcnN0IHRoZSBsb29rYWhlYWQgYnl0ZXM6
ICovCgkgIHVJbnQgbiA9IHN0cmVhbS5hdmFpbF9pbjsKCSAgaWYgKG4gPiBz
dHJlYW0uYXZhaWxfb3V0KQoJICAgIG4gPSBzdHJlYW0uYXZhaWxfb3V0OwoJ
ICBpZiAobiA+IDApCgkgICAgewoJICAgICAgbWVtY3B5IChzdHJlYW0ubmV4
dF9vdXQsIHN0cmVhbS5uZXh0X2luLCBuKTsKCSAgICAgIG5leHRfb3V0ICs9
IG47CgkgICAgICBzdHJlYW0ubmV4dF9vdXQgPSBuZXh0X291dDsKCSAgICAg
IHN0cmVhbS5uZXh0X2luICs9IG47CgkgICAgICBzdHJlYW0uYXZhaWxfb3V0
IC09IG47CgkgICAgICBzdHJlYW0uYXZhaWxfaW4gLT0gbjsKCSAgICB9Cgkg
IGlmIChzdHJlYW0uYXZhaWxfb3V0ID4gMCkKCSAgICB7CgkgICAgICBzdHJl
YW0uYXZhaWxfb3V0IC09IG9yaWdpbmFsLT5yZWFkIChuZXh0X291dCwgc3Ry
ZWFtLmF2YWlsX291dCk7CgkgICAgfQoJICBsZW4gLT0gc3RyZWFtLmF2YWls
X291dDsKCSAgc3RyZWFtLnRvdGFsX2luICs9ICh1TG9uZykgbGVuOwoJICBz
dHJlYW0udG90YWxfb3V0ICs9ICh1TG9uZykgbGVuOwoJICBpZiAobGVuID09
IDApCgkgICAgel9lb2YgPSAxOwoJICByZXR1cm4gKGludCkgbGVuOwoJfQog
ICAgICBpZiAoc3RyZWFtLmF2YWlsX2luID09IDAgJiYgIXpfZW9mKQoJewoK
CSAgZXJybm8gPSAwOwoJICBzdHJlYW0uYXZhaWxfaW4gPSBvcmlnaW5hbC0+
cmVhZCAoaW5idWYsIDE2Mzg0KTsKCSAgaWYgKHN0cmVhbS5hdmFpbF9pbiA9
PSAwKQoJICAgIHsKCSAgICAgIHpfZW9mID0gMTsKCSAgICAgIGlmIChvcmln
aW5hbC0+ZXJyb3IgKCkpCgkJewoJCSAgel9lcnIgPSBaX0VSUk5POwoJCSAg
YnJlYWs7CgkJfQoJICAgIH0KCSAgc3RyZWFtLm5leHRfaW4gPSBpbmJ1ZjsK
CX0KICAgICAgel9lcnIgPSBpbmZsYXRlICgmKHN0cmVhbSksIFpfTk9fRkxV
U0gpOwoKICAgICAgaWYgKHpfZXJyID09IFpfU1RSRUFNX0VORCkKCXsKCSAg
LyogQ2hlY2sgQ1JDIGFuZCBvcmlnaW5hbCBzaXplICovCgkgIGNyYyA9IGNy
YzMyIChjcmMsIHN0YXJ0LCAodUludCkgKHN0cmVhbS5uZXh0X291dCAtIHN0
YXJ0KSk7CgkgIHN0YXJ0ID0gc3RyZWFtLm5leHRfb3V0OwoKCSAgaWYgKGdl
dExvbmcgKCkgIT0gY3JjKQoJICAgIHsKCSAgICAgIHpfZXJyID0gWl9EQVRB
X0VSUk9SOwoJICAgIH0KCSAgZWxzZQoJICAgIHsKCSAgICAgICh2b2lkKSBn
ZXRMb25nICgpOwoJICAgICAgLyogVGhlIHVuY29tcHJlc3NlZCBsZW5ndGgg
cmV0dXJuZWQgYnkgYWJvdmUgZ2V0bG9uZygpIG1heQoJICAgICAgICogYmUg
ZGlmZmVyZW50IGZyb20gc3RyZWFtLnRvdGFsX291dCkgaW4gY2FzZSBvZgoJ
ICAgICAgICogY29uY2F0ZW5hdGVkIC5neiBmaWxlcy4gQ2hlY2sgZm9yIHN1
Y2ggZmlsZXM6CgkgICAgICAgKi8KCSAgICAgIGNoZWNrX2hlYWRlciAoKTsK
CSAgICAgIGlmICh6X2VyciA9PSBaX09LKQoJCXsKCQkgIHVMb25nIHRvdGFs
X2luID0gc3RyZWFtLnRvdGFsX2luOwoJCSAgdUxvbmcgdG90YWxfb3V0ID0g
c3RyZWFtLnRvdGFsX291dDsKCgkJICBpbmZsYXRlUmVzZXQgKCYoc3RyZWFt
KSk7CgkJICBzdHJlYW0udG90YWxfaW4gPSB0b3RhbF9pbjsKCQkgIHN0cmVh
bS50b3RhbF9vdXQgPSB0b3RhbF9vdXQ7CgkJICBjcmMgPSBjcmMzMiAoMEws
IFpfTlVMTCwgMCk7CgkJfQoJICAgIH0KCX0KICAgICAgaWYgKHpfZXJyICE9
IFpfT0sgfHwgel9lb2YpCglicmVhazsKICAgIH0KICBjcmMgPSBjcmMzMiAo
Y3JjLCBzdGFydCwgKHVJbnQpIChzdHJlYW0ubmV4dF9vdXQgLSBzdGFydCkp
OwoKICByZXR1cm4gKGludCkgKGxlbiAtIHN0cmVhbS5hdmFpbF9vdXQpOwp9
CgoKLyogPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiAgIFdyaXRl
cyB0aGUgZ2l2ZW4gbnVtYmVyIG9mIHVuY29tcHJlc3NlZCBieXRlcyBpbnRv
IHRoZSBjb21wcmVzc2VkIGZpbGUuCiAgIGd6d3JpdGUgcmV0dXJucyB0aGUg
bnVtYmVyIG9mIGJ5dGVzIGFjdHVhbGx5IHdyaXR0ZW4gKDAgaW4gY2FzZSBv
ZiBlcnJvcikuCiovCnNzaXplX3QKY29tcHJlc3NfZ3o6OndyaXRlICh2b2lk
ICpidWZmZXIsIHNpemVfdCBsZW4pCnsKICBpZiAobW9kZSAhPSAndycpCiAg
ICByZXR1cm4gWl9TVFJFQU1fRVJST1I7CgogIHN0cmVhbS5uZXh0X2luID0g
KEJ5dGVmICopIGJ1ZmZlcjsKICBzdHJlYW0uYXZhaWxfaW4gPSBsZW47Cgog
IHdoaWxlIChzdHJlYW0uYXZhaWxfaW4gIT0gMCkKICAgIHsKCiAgICAgIGlm
IChzdHJlYW0uYXZhaWxfb3V0ID09IDApCgl7CgoJICBzdHJlYW0ubmV4dF9v
dXQgPSBvdXRidWY7CgkgIGlmIChvcmlnaW5hbC0+d3JpdGUgKG91dGJ1Ziwg
MTYzODQpICE9IDE2Mzg0KQoJICAgIHsKCSAgICAgIHpfZXJyID0gWl9FUlJO
TzsKCSAgICAgIGJyZWFrOwoJICAgIH0KCSAgc3RyZWFtLmF2YWlsX291dCA9
IDE2Mzg0OwoJfQogICAgICB6X2VyciA9IGRlZmxhdGUgKCYoc3RyZWFtKSwg
Wl9OT19GTFVTSCk7CiAgICAgIGlmICh6X2VyciAhPSBaX09LKQoJYnJlYWs7
CiAgICB9CiAgY3JjID0gY3JjMzIgKGNyYywgKGNvbnN0IEJ5dGVmICopIGJ1
ZmZlciwgbGVuKTsKCiAgcmV0dXJuIChpbnQpIChsZW4gLSBzdHJlYW0uYXZh
aWxfaW4pOwp9Cgpzc2l6ZV90CmNvbXByZXNzX2d6OjpwZWVrICh2b2lkICpi
dWZmZXIsIHNpemVfdCBsZW4pCnsKICBsb2cgKExPR19USU1FU1RBTVAsICJj
b21wcmVzc19nejo6cGVlayBjYWxsZWQiKTsKICBpZiAobW9kZSAhPSAncicp
CiAgICByZXR1cm4gWl9TVFJFQU1fRVJST1I7CiAgLyogY2FuIG9ubHkgcGVl
ayA1MTIgYnl0ZXMgKi8KICBpZiAobGVuID4gNTEyKQogICAgcmV0dXJuIEVO
T01FTTsKCiAgaWYgKGxlbiA+IHBlZWtsZW4pCiAgICB7CiAgICAgIHNpemVf
dCB3YW50ID0gbGVuIC0gcGVla2xlbjsKICAgICAgc3NpemVfdCBnb3QgPSBy
ZWFkICgmcGVla2J1ZltwZWVrbGVuXSwgd2FudCk7CiAgICAgIGlmIChnb3Qg
Pj0gMCkKCXBlZWtsZW4gKz0gZ290OwogICAgICBlbHNlCgkvKiBlcnJvciAq
LwoJcmV0dXJuIGdvdDsKICAgICAgLyogd2UgbWF5IGhhdmUgcmVhZCBsZXNz
IHRoYW4gcmVxdWVzdGVkLiAqLwogICAgICBtZW1jcHkgKGJ1ZmZlciwgcGVl
a2J1ZiwgcGVla2xlbik7CiAgICAgIHJldHVybiBwZWVrbGVuOwogICAgfQog
IGVsc2UKICAgIHsKICAgICAgbWVtY3B5IChidWZmZXIsIHBlZWtidWYsIGxl
bik7CiAgICAgIHJldHVybiBsZW47CiAgICB9Cn0KCmxvbmcKY29tcHJlc3Nf
Z3o6OnRlbGwgKCkKewogIGxvZyAoTE9HX1RJTUVTVEFNUCwgImNvbXByZXNz
X2d6Ojp0ZWxsIGNhbGxlZCIpOwogIHJldHVybiAwOwp9CgppbnQKY29tcHJl
c3NfZ3o6OmVycm9yICgpCnsKICBsb2cgKExPR19USU1FU1RBTVAsICJjb21w
cmVzc19nejo6ZXJyb3IgY2FsbGVkIik7CiAgcmV0dXJuIHpfZXJyOwp9Cgpp
bnQKY29tcHJlc3NfZ3o6OnNldF9tdGltZSAoaW50IHRpbWUpCnsKICBpZiAo
b3JpZ2luYWwpCiAgICByZXR1cm4gb3JpZ2luYWwtPnNldF9tdGltZSAodGlt
ZSk7CiAgcmV0dXJuIDE7Cn0KCnZvaWQKY29tcHJlc3NfZ3o6OmRlc3Ryb3kg
KCkKewogIGlmIChtc2cpCiAgICBmcmVlIChtc2cpOwogIGlmIChzdHJlYW0u
c3RhdGUgIT0gTlVMTCkKICAgIHsKICAgICAgaWYgKG1vZGUgPT0gJ3cnKQoJ
ewoJICB6X2VyciA9IGRlZmxhdGVFbmQgKCYoc3RyZWFtKSk7Cgl9CiAgICAg
IGVsc2UgaWYgKG1vZGUgPT0gJ3InKQoJewoJICB6X2VyciA9IGluZmxhdGVF
bmQgKCYoc3RyZWFtKSk7Cgl9CiAgICB9CgogIGlmIChpbmJ1ZikKCiAgICBm
cmVlIChpbmJ1Zik7CiAgaWYgKG91dGJ1ZikKICAgIGZyZWUgKG91dGJ1Zik7
CiAgaWYgKG9yaWdpbmFsKQogICAgZGVsZXRlIG9yaWdpbmFsOwp9Cgpjb21w
cmVzc19nejo6fmNvbXByZXNzX2d6ICgpCnsKICBsb2cgKExPR19USU1FU1RB
TVAsICJjb21wcmVzc19nejo6fmd6IGNhbGxlZCIpOwogIGlmIChtb2RlID09
ICd3JykKICAgIHsKICAgICAgel9lcnIgPSBkb19mbHVzaCAoWl9GSU5JU0gp
OwogICAgICBpZiAoel9lcnIgIT0gWl9PSykKCXsKCSAgZGVzdHJveSAoKTsK
CSAgcmV0dXJuOwoJfQoKICAgICAgcHV0TG9uZyAoY3JjKTsKICAgICAgcHV0
TG9uZyAoc3RyZWFtLnRvdGFsX2luKTsKICAgIH0KICBkZXN0cm95ICgpOwog
IHJldHVybjsKfQoKaW50CmNvbXByZXNzX2d6Ojpkb19mbHVzaCAoaW50IGZs
dXNoKQp7CiAgdUludCBsZW47CiAgaW50IGRvbmUgPSAwOwogIGlmIChtb2Rl
ICE9ICd3JykKICAgIHJldHVybiBaX1NUUkVBTV9FUlJPUjsKICBzdHJlYW0u
YXZhaWxfaW4gPSAwOwkJLyogc2hvdWxkIGJlIHplcm8gYWxyZWFkeSBhbnl3
YXkgKi8KICBmb3IgKDs7KQogICAgewogICAgICBsZW4gPSAxNjM4NCAtIHN0
cmVhbS5hdmFpbF9vdXQ7CiAgICAgIGlmIChsZW4gIT0gMCkKCXsKCSAgaWYg
KCh1SW50KSBvcmlnaW5hbC0+d3JpdGUgKG91dGJ1ZiwgbGVuKSAhPSBsZW4p
CgkgICAgewoJICAgICAgel9lcnIgPSBaX0VSUk5POwoJICAgICAgcmV0dXJu
IFpfRVJSTk87CgkgICAgfQoJICBzdHJlYW0ubmV4dF9vdXQgPSBvdXRidWY7
CgkgIHN0cmVhbS5hdmFpbF9vdXQgPSAxNjM4NDsKCX0KICAgICAgaWYgKGRv
bmUpCglicmVhazsKICAgICAgel9lcnIgPSBkZWZsYXRlICgmKHN0cmVhbSks
IGZsdXNoKTsKICAgICAgLyogSWdub3JlIHRoZSBzZWNvbmQgb2YgdHdvIGNv
bnNlY3V0aXZlIGZsdXNoZXM6ICovCiAgICAgIGlmIChsZW4gPT0gMCAmJiB6
X2VyciA9PSBaX0JVRl9FUlJPUikKCXpfZXJyID0gWl9PSzsKICAgICAgLyog
ZGVmbGF0ZSBoYXMgZmluaXNoZWQgZmx1c2hpbmcgb25seSB3aGVuIGl0IGhh
c24ndCB1c2VkIHVwCiAgICAgICAqIGFsbCB0aGUgYXZhaWxhYmxlIHNwYWNl
IGluIHRoZSBvdXRwdXQgYnVmZmVyOgogICAgICAgKi8KICAgICAgZG9uZSA9
IChzdHJlYW0uYXZhaWxfb3V0ICE9IDAgfHwgel9lcnIgPT0gWl9TVFJFQU1f
RU5EKTsKICAgICAgaWYgKHpfZXJyICE9IFpfT0sgJiYgel9lcnIgIT0gWl9T
VFJFQU1fRU5EKQoJYnJlYWs7CiAgICB9CiAgcmV0dXJuIHpfZXJyID09IFpf
U1RSRUFNX0VORCA/IFpfT0sgOiB6X2VycjsKfQoKCiNpZiAwCgpnemNsb3Nl
IChsc3QpOwojZW5kaWYKLyogPT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09CiAqICBSZWFkIGEgYnl0ZSBmcm9tIGEgZ3pfc3RyZWFtOyB1cGRhdGUg
bmV4dF9pbiBhbmQgYXZhaWxfaW4uIFJldHVybiBFT0YKICogIGZvciBlbmQg
b2YgZmlsZS4KICogIElOIGFzc2VydGlvbjogdGhlIHN0cmVhbSBzIGhhcyBi
ZWVuIHN1Y2Vzc2Z1bGx5IG9wZW5lZCBmb3IgcmVhZGluZy4KICovCmludApj
b21wcmVzc19nejo6Z2V0X2J5dGUgKCkKewogIGlmICh6X2VvZikKICAgIHJl
dHVybiBFT0Y7CiAgaWYgKHN0cmVhbS5hdmFpbF9pbiA9PSAwKQogICAgewog
ICAgICBlcnJubyA9IDA7CiAgICAgIHN0cmVhbS5hdmFpbF9pbiA9IG9yaWdp
bmFsLT5yZWFkIChpbmJ1ZiwgMTYzODQpOwogICAgICBpZiAoc3RyZWFtLmF2
YWlsX2luID09IDApCgl7CgkgIHpfZW9mID0gMTsKCSAgaWYgKG9yaWdpbmFs
LT5lcnJvciAoKSkKCSAgICB6X2VyciA9IFpfRVJSTk87CgkgIHJldHVybiBF
T0Y7Cgl9CiAgICAgIHN0cmVhbS5uZXh0X2luID0gaW5idWY7CiAgICB9CiAg
c3RyZWFtLmF2YWlsX2luLS07CiAgcmV0dXJuICooc3RyZWFtLm5leHRfaW4p
Kys7Cn0KCgovKiA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KICAg
ICAgQ2hlY2sgdGhlIGd6aXAgaGVhZGVyIG9mIGEgZ3pfc3RyZWFtIG9wZW5l
ZCBmb3IgcmVhZGluZy4gU2V0IHRoZSBzdHJlYW0KICAgIG1vZGUgdG8gdHJh
bnNwYXJlbnQgaWYgdGhlIGd6aXAgbWFnaWMgaGVhZGVyIGlzIG5vdCBwcmVz
ZW50OyBzZXQgcy0+ZXJyCiAgICB0byBaX0RBVEFfRVJST1IgaWYgdGhlIG1h
Z2ljIGhlYWRlciBpcyBwcmVzZW50IGJ1dCB0aGUgcmVzdCBvZiB0aGUgaGVh
ZGVyCiAgICBpcyBpbmNvcnJlY3QuCiAgICBJTiBhc3NlcnRpb246IHRoZSBz
dHJlYW0gcyBoYXMgYWxyZWFkeSBiZWVuIGNyZWF0ZWQgc3VjZXNzZnVsbHk7
CiAgICAgICBzLT5zdHJlYW0uYXZhaWxfaW4gaXMgemVybyBmb3IgdGhlIGZp
cnN0IHRpbWUsIGJ1dCBtYXkgYmUgbm9uLXplcm8KICAgICAgIGZvciBjb25j
YXRlbmF0ZWQgLmd6IGZpbGVzLgoqLwp2b2lkCmNvbXByZXNzX2d6OjpjaGVj
a19oZWFkZXIgKCkKewogIGludCBtZXRob2Q7CQkJLyogbWV0aG9kIGJ5dGUg
Ki8KICBpbnQgZmxhZ3M7CQkJLyogZmxhZ3MgYnl0ZSAqLwogIHVJbnQgbGVu
OwogIGludCBjOwogIC8qIENoZWNrIHRoZSBnemlwIG1hZ2ljIGhlYWRlciAq
LwogIGZvciAobGVuID0gMDsgbGVuIDwgMjsgbGVuKyspCiAgICB7CiAgICAg
IGMgPSBnZXRfYnl0ZSAoKTsKICAgICAgaWYgKGMgIT0gZ3pfbWFnaWNbbGVu
XSkKCXsKCSAgaWYgKGxlbiAhPSAwKQoJICAgIHN0cmVhbS5hdmFpbF9pbisr
LCBzdHJlYW0ubmV4dF9pbi0tOwoJICBpZiAoYyAhPSBFT0YpCgkgICAgewoJ
ICAgICAgc3RyZWFtLmF2YWlsX2luKyssIHN0cmVhbS5uZXh0X2luLS07Cgkg
ICAgICB0cmFuc3BhcmVudCA9IDE7CgkgICAgfQoJICB6X2VyciA9IHN0cmVh
bS5hdmFpbF9pbiAhPSAwID8gWl9PSyA6IFpfU1RSRUFNX0VORDsKCSAgcmV0
dXJuOwoJfQogICAgfQogIG1ldGhvZCA9IGdldF9ieXRlICgpOwogIGZsYWdz
ID0gZ2V0X2J5dGUgKCk7CiAgaWYgKG1ldGhvZCAhPSBaX0RFRkxBVEVEIHx8
IChmbGFncyAmIFJFU0VSVkVEKSAhPSAwKQogICAgewogICAgICB6X2VyciA9
IFpfREFUQV9FUlJPUjsKICAgICAgcmV0dXJuOwogICAgfQoKICAvKiBEaXNj
YXJkIHRpbWUsIHhmbGFncyBhbmQgT1MgY29kZTogKi8KICBmb3IgKGxlbiA9
IDA7IGxlbiA8IDY7IGxlbisrKQogICAgKHZvaWQpIGdldF9ieXRlICgpOwog
IGlmICgoZmxhZ3MgJiBFWFRSQV9GSUVMRCkgIT0gMCkKICAgIHsJCQkJLyog
c2tpcCB0aGUgZXh0cmEgZmllbGQgKi8KICAgICAgbGVuID0gKHVJbnQpIGdl
dF9ieXRlICgpOwogICAgICBsZW4gKz0gKCh1SW50KSBnZXRfYnl0ZSAoKSkg
PDwgODsKICAgICAgLyogbGVuIGlzIGdhcmJhZ2UgaWYgRU9GIGJ1dCB0aGUg
bG9vcCBiZWxvdyB3aWxsIHF1aXQgYW55d2F5ICovCiAgICAgIHdoaWxlIChs
ZW4tLSAhPSAwICYmIGdldF9ieXRlICgpICE9IEVPRik7CiAgICB9CiAgaWYg
KChmbGFncyAmIE9SSUdfTkFNRSkgIT0gMCkKICAgIHsJCQkJLyogc2tpcCB0
aGUgb3JpZ2luYWwgZmlsZSBuYW1lICovCiAgICAgIHdoaWxlICgoYyA9IGdl
dF9ieXRlICgpKSAhPSAwICYmIGMgIT0gRU9GKTsKICAgIH0KICBpZiAoKGZs
YWdzICYgQ09NTUVOVCkgIT0gMCkKICAgIHsJCQkJLyogc2tpcCB0aGUgLmd6
IGZpbGUgY29tbWVudCAqLwogICAgICB3aGlsZSAoKGMgPSBnZXRfYnl0ZSAo
KSkgIT0gMCAmJiBjICE9IEVPRik7CiAgICB9CiAgaWYgKChmbGFncyAmIEhF
QURfQ1JDKSAhPSAwKQogICAgewkJCQkvKiBza2lwIHRoZSBoZWFkZXIgY3Jj
ICovCiAgICAgIGZvciAobGVuID0gMDsgbGVuIDwgMjsgbGVuKyspCgkodm9p
ZCkgZ2V0X2J5dGUgKCk7CiAgICB9CiAgel9lcnIgPSB6X2VvZiA/IFpfREFU
QV9FUlJPUiA6IFpfT0s7Cn0K

------------=_1583532850-65438-114
Content-Type: text/x-c++; charset=us-ascii; name="compress_gz.h"
Content-Disposition: inline; filename="compress_gz.h"
Content-Transfer-Encoding: base64
Content-Length: 3217

LyoKICogQ29weXJpZ2h0IChjKSAyMDAxLCBSb2JlcnQgQ29sbGlucy4KICoK
ICogICAgIFRoaXMgcHJvZ3JhbSBpcyBmcmVlIHNvZnR3YXJlOyB5b3UgY2Fu
IHJlZGlzdHJpYnV0ZSBpdCBhbmQvb3IgbW9kaWZ5CiAqICAgICBpdCB1bmRl
ciB0aGUgdGVybXMgb2YgdGhlIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNl
IGFzIHB1Ymxpc2hlZCBieQogKiAgICAgdGhlIEZyZWUgU29mdHdhcmUgRm91
bmRhdGlvbjsgZWl0aGVyIHZlcnNpb24gMiBvZiB0aGUgTGljZW5zZSwgb3IK
ICogICAgIChhdCB5b3VyIG9wdGlvbikgYW55IGxhdGVyIHZlcnNpb24uCiAq
CiAqICAgICBBIGNvcHkgb2YgdGhlIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNl
bnNlIGNhbiBiZSBmb3VuZCBhdAogKiAgICAgaHR0cDovL3d3dy5nbnUub3Jn
LwogKgogKiBXcml0dGVuIGJ5IFJvYmVydCBDb2xsaW5zICA8cmJ0Y29sbGlu
c0Bob3RtYWlsLmNvbT4KICoKICovCgojaWZuZGVmIF9DT01QUkVTU19HWl9I
XwojZGVmaW5lIF9DT01QUkVTU19HWl9IXwoKLyogdGhpcyBpcyB0aGUgcGFy
ZW50IGNsYXNzIGZvciBhbGwgY29tcHJlc3MgSU8gb3BlcmF0aW9ucy4gCiAq
IEl0IAogKi8KCmNsYXNzIGNvbXByZXNzX2d6OnB1YmxpYyBjb21wcmVzcwp7
CnB1YmxpYzoKICAvKiBhc3N1bWVzIGRlY29tcHJlc3Npb24gKi8KICBjb21w
cmVzc19neiAoaW9fc3RyZWFtICopOwogIC8qIHRoZSBtb2RlIGFsbG93cyBj
b250cm9sLCBidXQgdGhpcyBpbXBsZW1lbnRhdGlvbiBvbmx5IGRvZXMgY29t
cHJlc3Npb24gKi8KICBjb21wcmVzc19neiAoaW9fc3RyZWFtICosIGNvbnN0
IGNoYXIgKik7CiAgLyogcmVhZCBkYXRhIChkdWghKSAqLwogIHZpcnR1YWwg
c3NpemVfdCByZWFkICh2b2lkICpidWZmZXIsIHNpemVfdCBsZW4pOwogIC8q
IHByb3ZpZGUgZGF0YSB0byAoZG91YmxlIGR1aCEpICovCiAgdmlydHVhbCBz
c2l6ZV90IHdyaXRlICh2b2lkICpidWZmZXIsIHNpemVfdCBsZW4pOwogIC8q
IHJlYWQgZGF0YSB3aXRob3V0IHJlbW92aW5nIGl0IGZyb20gdGhlIGNsYXNz
J3MgaW50ZXJuYWwgYnVmZmVyICovCiAgdmlydHVhbCBzc2l6ZV90IHBlZWsg
KHZvaWQgKmJ1ZmZlciwgc2l6ZV90IGxlbik7CiAgdmlydHVhbCBsb25nIHRl
bGwgKCk7CiAgLyogdHJ5IGd1ZXNzaW5nIHRoaXMgb25lICovCiAgdmlydHVh
bCBpbnQgZXJyb3IgKCk7CiAgLyogRmluZCBvdXQgdGhlIG5leHQgc3RyZWFt
IG5hbWUgLQogICAqIGllIGZvciBmb28udGFyLmd6LCBhdCBvZmZzZXQgMCwg
bmV4dF9maWxlX25hbWUgPSBmb28udGFyCiAgICogZm9yIGZvb2JhciB0aGF0
IGlzIGFuIGNvbXByZXNzLCBuZXh0X2ZpbGVfbmFtZSBpcyB0aGUgbmV4dAog
ICAqIGV4dHJhY3RhYmxlIGZpbGVuYW1lLgogICAqLwogIHZpcnR1YWwgY29u
c3QgY2hhciAqbmV4dF9maWxlX25hbWUgKCkKICB7CiAgICByZXR1cm4gTlVM
TDsKICB9OwogIHZpcnR1YWwgaW50IHNldF9tdGltZSAoaW50KTsKICAvKiBp
ZiB5b3UgYXJlIHN0aWxsIG5lZWRpbmcgdGhlc2UgaGludHMuLi4gZ2l2ZSB1
cCBub3chICovCiAgICB2aXJ0dWFsIH4gY29tcHJlc3NfZ3ogKCk7CnByaXZh
dGU6CiAgICBjb21wcmVzc19neiAoKQogIHsKICB9OwogIGNoYXIgcGVla2J1
Zls1MTJdOwogIHNpemVfdCBwZWVrbGVuOwogIHZvaWQgY29uc3RydWN0IChp
b19zdHJlYW0gKiwgY29uc3QgY2hhciAqKTsKICB2b2lkIGNoZWNrX2hlYWRl
ciAoKTsKICBpbnQgZ2V0X2J5dGUgKCk7CiAgdW5zaWduZWQgbG9uZyBnZXRM
b25nICgpOwogIHZvaWQgcHV0TG9uZyAodW5zaWduZWQgbG9uZyk7CiAgdm9p
ZCBkZXN0cm95ICgpOwogIGludCBkb19mbHVzaCAoaW50KTsKICBpb19zdHJl
YW0gKm9yaWdpbmFsOwogIC8qIGZyb20gemxpYiAqLwogIHpfc3RyZWFtIHN0
cmVhbTsKICBpbnQgel9lcnI7CQkJLyogZXJyb3IgY29kZSBmb3IgbGFzdCBz
dHJlYW0gb3BlcmF0aW9uICovCiAgaW50IHpfZW9mOwkJCS8qIHNldCBpZiBl
bmQgb2YgaW5wdXQgZmlsZSAqLwogIHVuc2lnbmVkIGNoYXIgKmluYnVmOwkJ
LyogaW5wdXQgYnVmZmVyICovCiAgdW5zaWduZWQgY2hhciAqb3V0YnVmOwkv
KiBvdXRwdXQgYnVmZmVyICovCiAgdUxvbmcgY3JjOwkJCS8qIGNyYzMyIG9m
IHVuY29tcHJlc3NlZCBkYXRhICovCiAgY2hhciAqbXNnOwkJCS8qIGVycm9y
IG1lc3NhZ2UgKi8KICBpbnQgdHJhbnNwYXJlbnQ7CQkvKiAxIGlmIGlucHV0
IGZpbGUgaXMgbm90IGEgLmd6IGZpbGUgKi8KICBjaGFyIG1vZGU7CQkJLyog
J3cnIG9yICdyJyAqLwogIGxvbmcgc3RhcnRwb3M7CQkvKiBzdGFydCBvZiBj
b21wcmVzc2VkIGRhdGEgaW4gZmlsZSAoaGVhZGVyIHNraXBwZWQpICovCn07
CgojZW5kaWYgLyogX0NPTVBSRVNTX0daX0hfICovCg==

------------=_1583532850-65438-114
Content-Type: text/x-c; charset=us-ascii; name="io_stream.cc"
Content-Disposition: inline; filename="io_stream.cc"
Content-Transfer-Encoding: base64
Content-Length: 6479

LyoKICogQ29weXJpZ2h0IChjKSAyMDAxLCBSb2JlcnQgQ29sbGlucy4KICoK
ICogICAgIFRoaXMgcHJvZ3JhbSBpcyBmcmVlIHNvZnR3YXJlOyB5b3UgY2Fu
IHJlZGlzdHJpYnV0ZSBpdCBhbmQvb3IgbW9kaWZ5CiAqICAgICBpdCB1bmRl
ciB0aGUgdGVybXMgb2YgdGhlIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNl
IGFzIHB1Ymxpc2hlZCBieQogKiAgICAgdGhlIEZyZWUgU29mdHdhcmUgRm91
bmRhdGlvbjsgZWl0aGVyIHZlcnNpb24gMiBvZiB0aGUgTGljZW5zZSwgb3IK
ICogICAgIChhdCB5b3VyIG9wdGlvbikgYW55IGxhdGVyIHZlcnNpb24uCiAq
CiAqICAgICBBIGNvcHkgb2YgdGhlIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNl
bnNlIGNhbiBiZSBmb3VuZCBhdAogKiAgICAgaHR0cDovL3d3dy5nbnUub3Jn
LwogKgogKiBXcml0dGVuIGJ5IFJvYmVydCBDb2xsaW5zICA8cmJ0Y29sbGlu
c0Bob3RtYWlsLmNvbT4KICoKICovCgovKiB0aGlzIGlzIHRoZSBwYXJlbnQg
Y2xhc3MgZm9yIGFsbCBJTyBvcGVyYXRpb25zLiBJdCdzIGZsZXhhYmxlIGVu
b3VnaCB0byBiZSBjb3ZlciBmb3IKICogSFRUUCBhY2Nlc3MsIGxvY2FsIGZp
bGUgYWNjZXNzLCBhbmQgZmlsZXMgYmVpbmcgZXh0cmFjdGVkIGZyb20gYXJj
aGl2ZXMuCiAqIEl0IGFsc28gZW5jYXBzdWxhdGVzIHRoZSBpZGVhIG9mIGFu
IGFyY2hpdmUsIGFuZCBhbGwgbm9uLWFyY2hpdmVzIGJlY29tZSB0aGUgc3Bl
Y2lhbCAKICogY2FzZS4KICovCgojaWYgMApzdGF0aWMgY29uc3QgY2hhciAq
Y3ZzaWQgPQogICJcbiUlJSAkSWQ6IHNvdXJjZS5jYyx2IDIuNSAyMDAxLzEx
LzAxIDEzOjIyOjQ2IHJiY29sbGlucyBFeHAgJFxuIjsKI2VuZGlmCgojaW5j
bHVkZSAid2luMzIuaCIKI2luY2x1ZGUgPHN0ZGlvLmg+CiNpbmNsdWRlICJs
b2cuaCIKI2luY2x1ZGUgInBvcnQuaCIKCiNpbmNsdWRlICJpb19zdHJlYW0u
aCIKI2luY2x1ZGUgImlvX3N0cmVhbV9maWxlLmgiCiNpbmNsdWRlICJpb19z
dHJlYW1fY3lnZmlsZS5oIgojaW5jbHVkZSAibWtkaXIuaCIKCi8qIFN0YXRp
YyBtZW1iZXJzICovCmlvX3N0cmVhbSAqCmlvX3N0cmVhbTo6ZmFjdG9yeSAo
aW9fc3RyZWFtICogcGFyZW50KQp7CiAgLyogc29tZXRoaW5nIGxpa2UsICAK
ICAgKiBpZiAhbmV4dF9maWxlX25hbWUgCiAgICogICByZXR1cm4gTlVMTAog
ICAqIHN3aXRjaCAobWFnaWNfaWQocGVlayAocGFyZW50KSwgbWF4X21hZ2lj
X2xlbmd0aCkpCiAgICogY2FzZSBpb19zdHJlYW0gKiBmb28gPSBuZXcgdGFy
CiAgICogY2FzZSBpb19zdHJlYW0gKiBmb28gPSBuZXcgYnoyCiAgICogcmV0
dXJuIGZvbwogICAqLwogIGxvZyAoTE9HX1RJTUVTVEFNUCwgImlvX3N0cmVh
bTo6ZmFjdG9yeSBoYXMgYmVlbiBjYWxsZWQiKTsKICByZXR1cm4gTlVMTDsK
fQoKaW9fc3RyZWFtICoKaW9fc3RyZWFtOjpvcGVuIChjb25zdCBjaGFyICpu
YW1lLCBjb25zdCBjaGFyICptb2RlKQp7CiAgaWYgKCFuYW1lIHx8IElzQmFk
U3RyaW5nUHRyIChuYW1lLCBNQVhfUEFUSCkgfHwgIW5hbWVbMF0gfHwKICAg
ICAgIW1vZGUgfHwgSXNCYWRTdHJpbmdQdHIgKG1vZGUsIDUpIHx8ICFtb2Rl
WzBdKQogICAgcmV0dXJuIE5VTEw7CiAgLyogaXRlcmF0ZSB0aHJvdWdoIHRo
ZSBrbm93biB1cmwgcHJlZml4J3MgKi8KICBpZiAoIXN0cm5jYXNlY21wICgi
ZmlsZTovLyIsIG5hbWUsIDcpKQogICAgewogICAgICBpb19zdHJlYW1fZmls
ZSAqcnYgPSBuZXcgaW9fc3RyZWFtX2ZpbGUgKCZuYW1lWzddLCBtb2RlKTsK
ICAgICAgaWYgKCFydi0+ZXJyb3IgKCkpCglyZXR1cm4gcnY7CiAgICAgIGRl
bGV0ZSBydjsKICAgICAgcmV0dXJuIE5VTEw7CiAgICB9CiAgaWYgKCFzdHJu
Y2FzZWNtcCAoImN5Z2ZpbGU6Ly8iLCBuYW1lLCAxMCkpCiAgICB7CiAgICAg
IGlvX3N0cmVhbV9jeWdmaWxlICpydiA9IG5ldyBpb19zdHJlYW1fY3lnZmls
ZSAoJm5hbWVbMTBdLCBtb2RlKTsKICAgICAgaWYgKCFydi0+ZXJyb3IgKCkp
CglyZXR1cm4gcnY7CiAgICAgIGRlbGV0ZSBydjsKICAgICAgcmV0dXJuIE5V
TEw7CiAgICB9CiAgcmV0dXJuIE5VTEw7Cn0KCmludAppb19zdHJlYW06Om1r
cGF0aF9wIChwYXRoX3R5cGVfdCBpc2FkaXIsIGNvbnN0IGNoYXIgKm5hbWUp
CnsKICBpZiAoIW5hbWUgfHwgSXNCYWRTdHJpbmdQdHIgKG5hbWUsIE1BWF9Q
QVRIKSB8fCAhbmFtZVswXSkKICAgIHJldHVybiAxOwogIC8qIGl0ZXJhdGUg
dGhyb3VnaCB0aGUga25vd24gdXJsIHByZWZpeCdzICovCiAgaWYgKCFzdHJu
Y2FzZWNtcCAoImZpbGU6Ly8iLCBuYW1lLCA3KSkKICAgIHsKICAgICAgcmV0
dXJuIG1rZGlyX3AgKGlzYWRpciA9PSBQQVRIX1RPX0RJUiA/IDEgOiAwLCAm
bmFtZVs3XSk7CiAgICB9CiAgaWYgKCFzdHJuY2FzZWNtcCAoImN5Z2ZpbGU6
Ly8iLCBuYW1lLCAxMCkpCiAgICB7CiAgICAgIHJldHVybiBjeWdta2Rpcl9w
IChpc2FkaXIgPT0gUEFUSF9UT19ESVIgPyAxIDogMCwgJm5hbWVbMTBdKTsK
ICAgIH0KICByZXR1cm4gMTsKfQoKLyogcmVtb3ZlIGEgZmlsZSBvciBkaXJl
Y3RvcnkuICovCmludAppb19zdHJlYW06OnJlbW92ZSAoY29uc3QgY2hhciAq
bmFtZSkKewogIGlmICghbmFtZSB8fCBJc0JhZFN0cmluZ1B0ciAobmFtZSwg
TUFYX1BBVEgpIHx8ICFuYW1lWzBdKQogICAgcmV0dXJuIDE7CiAgLyogaXRl
cmF0ZSB0aHJvdWdoIHRoZSBrbm93biB1cmwgcHJlZml4J3MgKi8KICBpZiAo
IXN0cm5jYXNlY21wICgiZmlsZTovLyIsIG5hbWUsIDcpKQogICAgcmV0dXJu
IGlvX3N0cmVhbV9maWxlOjpyZW1vdmUgKCZuYW1lWzddKTsKICBpZiAoIXN0
cm5jYXNlY21wICgiY3lnZmlsZTovLyIsIG5hbWUsIDEwKSkKICAgIHJldHVy
biBpb19zdHJlYW1fY3lnZmlsZTo6cmVtb3ZlICgmbmFtZVsxMF0pOwogIHJl
dHVybiAxOwp9CgppbnQKaW9fc3RyZWFtOjpta2xpbmsgKGNvbnN0IGNoYXIg
KmZyb20sIGNvbnN0IGNoYXIgKnRvLAoJCSAgIGlvX3N0cmVhbV9saW5rX3Qg
bGlua3R5cGUpCnsKICBpZiAoIWZyb20gfHwgSXNCYWRTdHJpbmdQdHIgKGZy
b20sIE1BWF9QQVRIKSB8fAogICAgICAhdG8gfHwgSXNCYWRTdHJpbmdQdHIg
KHRvLCBNQVhfUEFUSCkpCiAgICByZXR1cm4gMTsKICAvKiBpdGVyYXRlIHRo
cm91Z2ggdGhlIGtub3duIHVybCBwcmVmaXhlcyAqLwogIGlmICghc3RybmNh
c2VjbXAgKCJmaWxlOi8vIiwgZnJvbSwgNykpCiAgICB7CiAgICAgIC8qIGZp
bGUgdXJscyBjYW4gc3ltbGluayBvciBoYXJkbGluayB0byBmaWxlIHVybCdz
LiAqLwogICAgICAvKiBUT0RPOiBhbGxvdyBsaW5raW5nIHRvIGN5Z2ZpbGUg
dXJsJ3MgKi8KICAgICAgaWYgKCFzdHJuY2FzZWNtcCAoImZpbGU6Ly8iLCB0
bywgNykpCglyZXR1cm4gaW9fc3RyZWFtX2ZpbGU6Om1rbGluayAoZnJvbSwg
dG8sIGxpbmt0eXBlKTsKICAgICAgcmV0dXJuIDE7CiAgICB9CiAgaWYgKCFz
dHJuY2FzZWNtcCAoImN5Z2ZpbGU6Ly8iLCBmcm9tLCAxMCkpCiAgICB7CiAg
ICAgIC8qIGN5Z2ZpbGUgdXJscyBjYW4gc3ltbGluayBvciBoYXJkbGluayB0
byBjeWdmaWxlIHVybHMncy4gKi8KICAgICAgLyogVE9ETzogYWxsb3cgLT4g
ZmlsZSB1cmxzICovCiAgICAgIGlmICghc3RybmNhc2VjbXAgKCJjeWdmaWxl
Oi8vIiwgdG8sIDEwKSkKCXJldHVybiBpb19zdHJlYW1fY3lnZmlsZTo6bWts
aW5rIChmcm9tLCB0bywgbGlua3R5cGUpOwogICAgICByZXR1cm4gMTsKICAg
IH0KI2lmIDAKICBpZiAoIXN0cm1jYXNlY21wICgiaHR0cDovLyIsIGZyb20s
IDcpKQogICAgewogICAgICAvKiBodHRwIHVybHMgY2FuIHN5bWxpbmsgdG8g
aHR0cCBvciBmdHAgdXJsJ3MgKi8KICAgIH0KI2VuZGlmCiAgcmV0dXJuIDE7
Cn0KCmNoYXIgKgppb19zdHJlYW06OmdldHMgKGNoYXIgKmJ1ZmZlciwgc2l6
ZV90IGxlbmd0aCkKewogIGNoYXIgKnBvcyA9IGJ1ZmZlcjsKICBzaXplX3Qg
Y291bnQgPSAwOwogIHdoaWxlIChjb3VudCArIDEgPCBsZW5ndGggJiYgcmVh
ZCAocG9zLCAxKSA9PSAxKQogICAgewogICAgICBjb3VudCsrOwogICAgICBw
b3MrKzsKICAgICAgaWYgKCoocG9zIC0gMSkgPT0gJ1xuJykKCXsKCSAgLyog
ZW5kIG9mIGxpbmUgKi8KCSAgLyogVE9ETzogcmVtb3ZlIHRoZSBcciBpZiBp
dCBpcyBwcmVzZW50IGRlcGVuZGluZyBvbiB0aGUgCgkgICAqIGZpbGUncyBt
b2RlIAoJICAgKi8KCSAgYnJlYWs7Cgl9CiAgICB9CiAgaWYgKGNvdW50ID09
IDAgfHwgZXJyb3IgKCkpCiAgICAvKiBFT0Ygd2hlbiBubyBjaGFycyBmb3Vu
ZCwgb3IgYW4gZXJyb3IgKi8KICAgIHJldHVybiBOVUxMOwogICpwb3MgPSAn
XDAnOwogIHJldHVybiBidWZmZXI7Cn0KCmludAppb19zdHJlYW06OmV4aXN0
cyAoY29uc3QgY2hhciAqbmFtZSkKewogIGlmICghbmFtZSB8fCBJc0JhZFN0
cmluZ1B0ciAobmFtZSwgTUFYX1BBVEgpIHx8ICFuYW1lWzBdKQogICAgcmV0
dXJuIDE7CiAgLyogaXRlcmF0ZSB0aHJvdWdoIHRoZSBrbm93biB1cmwgcHJl
Zml4J3MgKi8KICBpZiAoIXN0cm5jYXNlY21wICgiZmlsZTovLyIsIG5hbWUs
IDcpKQogICAgcmV0dXJuIGlvX3N0cmVhbV9maWxlOjpleGlzdHMgKCZuYW1l
WzddKTsKICBpZiAoIXN0cm5jYXNlY21wICgiY3lnZmlsZTovLyIsIG5hbWUs
IDEwKSkKICAgIHJldHVybiBpb19zdHJlYW1fY3lnZmlsZTo6ZXhpc3RzICgm
bmFtZVsxMF0pOwogIHJldHVybiAxOwp9CgovKiB2aXJ0dWFsIG1lbWJlcnMg
Ki8KCmlvX3N0cmVhbTo6fmlvX3N0cmVhbSAoKQp7CiAgbG9nIChMT0dfVElN
RVNUQU1QLCAiaW9fc3RyZWFtOjp+aW9fc3RyZWFtIGNhbGxlZCIpOwogIHJl
dHVybjsKfQo=

------------=_1583532850-65438-114
Content-Type: text/x-c++; charset=us-ascii; name="io_stream.h"
Content-Disposition: inline; filename="io_stream.h"
Content-Transfer-Encoding: base64
Content-Length: 5747

LyoKICogQ29weXJpZ2h0IChjKSAyMDAxLCBSb2JlcnQgQ29sbGlucy4KICoK
ICogICAgIFRoaXMgcHJvZ3JhbSBpcyBmcmVlIHNvZnR3YXJlOyB5b3UgY2Fu
IHJlZGlzdHJpYnV0ZSBpdCBhbmQvb3IgbW9kaWZ5CiAqICAgICBpdCB1bmRl
ciB0aGUgdGVybXMgb2YgdGhlIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNl
IGFzIHB1Ymxpc2hlZCBieQogKiAgICAgdGhlIEZyZWUgU29mdHdhcmUgRm91
bmRhdGlvbjsgZWl0aGVyIHZlcnNpb24gMiBvZiB0aGUgTGljZW5zZSwgb3IK
ICogICAgIChhdCB5b3VyIG9wdGlvbikgYW55IGxhdGVyIHZlcnNpb24uCiAq
CiAqICAgICBBIGNvcHkgb2YgdGhlIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNl
bnNlIGNhbiBiZSBmb3VuZCBhdAogKiAgICAgaHR0cDovL3d3dy5nbnUub3Jn
LwogKgogKiBXcml0dGVuIGJ5IFJvYmVydCBDb2xsaW5zICA8cmJ0Y29sbGlu
c0Bob3RtYWlsLmNvbT4KICoKICovCgojaWZuZGVmIF9JT19TVFJFQU1fSF8K
I2RlZmluZSBfSU9fU1RSRUFNX0hfCgovKiB0aGlzIGlzIHRoZSBwYXJlbnQg
Y2xhc3MgZm9yIGFsbCBJTyBvcGVyYXRpb25zLiBJdCdzIGZsZXhhYmxlIGVu
b3VnaCB0byBiZSBjb3ZlciBmb3IKICogSFRUUCBhY2Nlc3MsIGxvY2FsIGZp
bGUgYWNjZXNzLCBhbmQgZmlsZXMgYmVpbmcgZXh0cmFjdGVkIGZyb20gYXJj
aGl2ZXMuCiAqIEl0IGFsc28gZW5jYXBzdWxhdGVzIHRoZSBpZGVhIG9mIGFu
IGFyY2hpdmUsIGFuZCBhbGwgbm9uLWFyY2hpdmVzIGJlY29tZSB0aGUgc3Bl
Y2lhbCAKICogY2FzZS4KICovCgovKiBTb21lIHRoaW5ncyBkb24ndCBmaXQg
Y2xlYW5seSBqdXN0IC0gVE9ETwogKiBtYWtlIG1rZGlyX3AgZml0IGluIHRo
ZSBoaWVyYXJjaHkKICovCgovL1doZXJlIGlzIHRoaXMgZGVmaW5lZD8KdHlw
ZWRlZiBzaWduZWQgbG9uZyBzc2l6ZV90OwoKI2lmIF9fR05VQ19fCiNkZWZp
bmUgX0FUVFJfKGZvbykgX19hdHRyaWJ1dGVfXyBmb28KI2Vsc2UKI2RlZmlu
ZSBfQVRUUl8oZm9vKQojZW5kaWYKCnR5cGVkZWYgZW51bQp7CiAgUEFUSF9U
T19ESVIsCiAgUEFUSF9UT19GSUxFCn0KcGF0aF90eXBlX3Q7Cgp0eXBlZGVm
IGVudW0KewogIElPX1NUUkVBTV9JTlZBTElELAogIElPX1NUUkVBTV9TVFJF
QU0sCiAgSU9fU1RSRUFNX0NPTVBSRVNTLAogIElPX1NUUkVBTV9BUkNISVZF
Cn0KaW9fc3RyZWFtX3R5cGVfdDsKCnR5cGVkZWYgZW51bQp7CiAgSU9fU1RS
RUFNX1NZTUxJTkssCiAgSU9fU1RSRUFNX0hBUkRMSU5LCn0KaW9fc3RyZWFt
X2xpbmtfdDsKCmNsYXNzIGlvX3N0cmVhbQp7CnB1YmxpYzoKICAvKiBjcmVh
dGUgYSBuZXcgc3RyZWFtIGZyb20gYW4gZXhpc3Rpbmcgb25lIC0gdXNlZCB0
byBnZXQKICAgKiBkZWNvbXByZXNzZWQgZGF0YQogICAqIG9yIG9wZW4gYXJj
aGl2ZXMuCiAgICogd2lsbCByZXR1cm4gTlVMTCBpZiB0aGVyZSBpcyBubyBz
dWItc3RyZWFtIGF2YWlsYWJsZSAoaWUgKHBlZWsoKQogICAqIGRpZG4ndCBt
YXRjaCBhbnkga25vd24gbWFnaWMgbnVtYmVyKSAmJiBuZXh0ZmlsZW5hbWUg
KCkgPSBOVUxMCiAgICovCiAgc3RhdGljIGlvX3N0cmVhbSAqZmFjdG9yeSAo
aW9fc3RyZWFtICopOwogIC8qIG9wZW4gYSBzdHJlYW0gYnkgdXJsLiBUaGUg
cGFydGljdWxhciBzdHJlYW0gdHlwZSByZXR1cm5lZAogICAqIHdpbGwgZGVw
ZW5kIG9uIHRoZSB1cmwgcGFzc2VkLgogICAqIGllIGZvciBmaWxlOi8vIGl0
IHdpbGwgYmUgYSBkaXNrIGZpbGUuCiAgICogZm9yIGZ0cDovLyBpdCB3aWxs
IHBlcmZvcm0gYW4gdXBsb2FkIHRvIGEgZnRwIHNpdGUuCiAgICogdGhlIHNl
Y29uZCBwYXJhbWV0ZXIgLSBtb2RlIGNhbiBzcGVjaWZ5IHJ8dyAmJiB0fGIu
IE90aGVyIGZsYWdzIGFyZSBub3QgY3VycmVudGx5CiAgICogc3VwcG9ydGVk
LgogICAqIEF1dG9tYXRpYyBkZWNvbXByZXNzaW9uIGRvZXMgbm90IG9jY3Vy
LiBDb21wcmVzc2VkIGZpbGVzIHdpbGwgcmV0dXJuIGEgaW9fc3RyZWFtCiAg
ICogZnJvbSBhcmNoaXZlOjpkZWNvbXByZXNzLiBUaGlzIGJlaGF2aW91ciBp
cyBieSBkZXNpZ24gLSB0byBhbGxvdyBkZWxpYmVyYXRlIGFjY2VzcwogICAq
IHRvIHRoZSBjb21wcmVzc2VkIGRhdGEuCiAgICogVG8gY3JlYXRlIGEgc3Ry
ZWFtIHRoYXQgd2lsbCBiZSBjb21wcmVzc2VkLCB5b3Ugc2hvdWxkIG9wZW4g
dGhlIHVybCwgYW5kIHRoZW4gZ2V0IGEgbmV3IHN0cmVhbQogICAqIGZyb20g
YXJjaGl2ZTo6Y29tcHJlc3MuIAogICAqIElmIGEgc3RyZWFtIGlzIG9wZW5l
ZCBmb3IgcmVhZGluZywgYW5kIGl0J3MgYW4gYXJjaGl2ZSwgdGhlIG5leHRf
ZmlsZV9uYW1lIG1ldGhvZAogICAqIHdpbGwgcmV0dXJuIG5vbi1OVUxMLiBU
byBhY2Nlc3MgdGhlIGZpbGVzIHdpdGhpbiB0aGUgYXJjaGl2ZSB1c2UgaW9f
c3RyZWFtOjpmYWN0b3J5CiAgICogdG8gY3JlYXRlIGEgbmV3IHN0cmVhbSB0
aGF0IHdpbGwgcmVhZCBmcm9tIHRoZSBhcmNoaXZlLgogICAqLwogIHN0YXRp
YyBpb19zdHJlYW0gKm9wZW4gKGNvbnN0IGNoYXIgKiwgY29uc3QgY2hhciAq
KTsKICBzdGF0aWMgaW50IHJlbW92ZSAoY29uc3QgY2hhciAqKTsKICBzdGF0
aWMgaW50IGV4aXN0cyAoY29uc3QgY2hhciAqKTsKICAvKiBlbnN1cmUgdGhh
dCB3ZSBoYXZlIGFjY2VzcyB0byB0aGUgZW50aXJlIHBhdGggKi8KICAvKiBD
cmVhdGUgYSBkaXJlY3RvcnksIGFuZCBhbnkgbmVlZGVkIHBhcmVudCBkaXJl
Y3Rvcmllcy4KICAgKiByZXR1cm5zIDEgb24gZmFpbHVyZS4KICAgKi8KICBz
dGF0aWMgaW50IG1rcGF0aF9wIChwYXRoX3R5cGVfdCwgY29uc3QgY2hhciAq
KTsKICAvKiBsaW5rIGZyb20sIHRvLCB0eXBlLiBSZXR1cm5zIDEgb24gZmFp
bHVyZSAqLwogIHN0YXRpYyBpbnQgbWtsaW5rIChjb25zdCBjaGFyICosIGNv
bnN0IGNoYXIgKiwgaW9fc3RyZWFtX2xpbmtfdCk7CiAgLyogcmVhZCBkYXRh
IChkdWghKSAqLwogIHZpcnR1YWwgc3NpemVfdCByZWFkICh2b2lkICpidWZm
ZXIsIHNpemVfdCBsZW4pID0gMDsKICAvKiBwcm92aWRlIGRhdGEgdG8gKGRv
dWJsZSBkdWghKSAqLwogIHZpcnR1YWwgc3NpemVfdCB3cml0ZSAodm9pZCAq
YnVmZmVyLCBzaXplX3QgbGVuKSA9IDA7CiAgLyogcmVhZCBkYXRhIHdpdGhv
dXQgcmVtb3ZpbmcgaXQgZnJvbSB0aGUgY2xhc3MncyBpbnRlcm5hbCBidWZm
ZXIgKi8KICB2aXJ0dWFsIHNzaXplX3QgcGVlayAodm9pZCAqYnVmZmVyLCBz
aXplX3QgbGVuKSA9IDA7CiAgLyogZXZlciByZWFkIHRoZSBmKiBmdW5jdGlv
bnMgZnJvbSBsaWJjID8gKi8KICB2aXJ0dWFsIGxvbmcgdGVsbCAoKSA9IDA7
CiAgLyogdHJ5IGd1ZXNzaW5nIHRoaXMgb25lICovCiAgdmlydHVhbCBpbnQg
ZXJyb3IgKCkgPSAwOwogIC8qIGhtbSwgeWV0IGFub3RoZXIgZm9yIHRoZSBn
dWVzc2luZyBib29rcyAqLwogIHZpcnR1YWwgY2hhciAqZ2V0cyAoY2hhciAq
LCBzaXplX3QgbGVuKTsKICAvKiB3aGF0IHNvcnQgb2Ygc3RyZWFtIGlzIHRo
aXM/CiAgICoga25vd24gdHlwZXMgYXJlOgogICAqIElPX1NUUkVBTV9JTlZB
TElEIC0gbm90IGEgdmFsaWQgc3RyZWFtLgogICAqIElPX1NUUkVBTV9TVFJF
QU0gLSBqdXN0IGFub3RoZXIgc3RyZWFtLgogICAqIElPX1NUUkVBTV9DT01Q
UkVTUyAtIGEgY29tcHJlc3NlZCBvciBjb21wcmVzc2luZyBzdHJlYW0uCiAg
ICogSU9fU1RSRUFNX0FSQ0hJVkUgLSBhbiBhcmNoaXZlIG9mIHNvbWUgc29y
dCwgd2l0aCA+IDAgZmlsZXMuCiAgICogdGhpcyBpcyBhIGNydXRjaCBmb3Ig
cmVhbCBydW50aW1lIHR5cGUgZXZhbHVhdGlvbi4KICAgKi8KICAvKiBGaW5k
IG91dCB0aGUgbmV4dCBzdHJlYW0gbmFtZSAtCiAgICogaWUgZm9yIGZvby50
YXIuZ3osIGF0IG9mZnNldCAwLCBuZXh0X2ZpbGVfbmFtZSA9IGZvby50YXIK
ICAgKiBmb3IgZm9vYmFyIHRoYXQgaXMgYW4gYXJjaGl2ZSwgbmV4dF9maWxl
X25hbWUgaXMgdGhlIG5leHQKICAgKiBleHRyYWN0YWJsZSBmaWxlbmFtZS4K
ICAgKi8KLy8gIHZpcnR1YWwgY29uc3QgY2hhciogbmV4dF9maWxlX25hbWUo
KSA9IE5VTEw7CiAgLyogc2V0IHRoZSBtb2RpZmljYXRpb24gdGltZSBvZiBh
IGZpbGUgLSByZXR1cm5zIDEgb24gZmFpbHVyZSAqLwogIHZpcnR1YWwgaW50
IHNldF9tdGltZSAoaW50KSA9IDA7CiAgLyogaWYgeW91IGFyZSBzdGlsbCBu
ZWVkaW5nIHRoZXNlIGhpbnRzLi4uIGdpdmUgdXAgbm93ISAqLwogICAgdmly
dHVhbCB+IGlvX3N0cmVhbSAoKTsKfTsKCiNlbmRpZiAvKiBfSU9fU1RSRUFN
X0hfICovCg==

------------=_1583532850-65438-114
Content-Type: text/x-c; charset=us-ascii; name="io_stream_cygfile.cc"
Content-Disposition: inline; filename="io_stream_cygfile.cc"
Content-Transfer-Encoding: base64
Content-Length: 6031

LyoKICogQ29weXJpZ2h0IChjKSAyMDAxLCBSb2JlcnQgQ29sbGlucy4KICoK
ICogICAgIFRoaXMgcHJvZ3JhbSBpcyBmcmVlIHNvZnR3YXJlOyB5b3UgY2Fu
IHJlZGlzdHJpYnV0ZSBpdCBhbmQvb3IgbW9kaWZ5CiAqICAgICBpdCB1bmRl
ciB0aGUgdGVybXMgb2YgdGhlIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNl
IGFzIHB1Ymxpc2hlZCBieQogKiAgICAgdGhlIEZyZWUgU29mdHdhcmUgRm91
bmRhdGlvbjsgZWl0aGVyIHZlcnNpb24gMiBvZiB0aGUgTGljZW5zZSwgb3IK
ICogICAgIChhdCB5b3VyIG9wdGlvbikgYW55IGxhdGVyIHZlcnNpb24uCiAq
CiAqICAgICBBIGNvcHkgb2YgdGhlIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNl
bnNlIGNhbiBiZSBmb3VuZCBhdAogKiAgICAgaHR0cDovL3d3dy5nbnUub3Jn
LwogKgogKiBXcml0dGVuIGJ5IFJvYmVydCBDb2xsaW5zICA8cmJ0Y29sbGlu
c0Bob3RtYWlsLmNvbT4KICoKICovCgojaWYgMApzdGF0aWMgY29uc3QgY2hh
ciAqY3ZzaWQgPQogICJcbiUlJSAkSWQ6IHNvdXJjZS5jYyx2IDIuNSAyMDAx
LzExLzAxIDEzOjIyOjQ2IHJiY29sbGlucyBFeHAgJFxuIjsKI2VuZGlmCgoK
I2luY2x1ZGUgIndpbjMyLmgiCiNpbmNsdWRlIDxzdGRpby5oPgojaW5jbHVk
ZSA8c3RkbGliLmg+CiNpbmNsdWRlICJsb2cuaCIKI2luY2x1ZGUgInBvcnQu
aCIKI2luY2x1ZGUgIm1vdW50LmgiCiNpbmNsdWRlICJta2Rpci5oIgojaW5j
bHVkZSAibWtsaW5rMi5oIgojaW5jbHVkZSA8dW5pc3RkLmg+CgojaW5jbHVk
ZSAiaW9fc3RyZWFtLmgiCiNpbmNsdWRlICJpb19zdHJlYW1fY3lnZmlsZS5o
IgoKLyogRm9yIHNldCBtdGltZSAqLwojZGVmaW5lIEZBQ1RPUiAoMHgxOWRi
MWRlZDUzZWE3MTBMTCkKI2RlZmluZSBOU1BFUlNFQyAxMDAwMDAwMExMCgpz
dGF0aWMgdm9pZApnZXRfcm9vdF9kaXJfbm93ICgpCnsKICBpZiAoZ2V0X3Jv
b3RfZGlyICgpKQogICAgcmV0dXJuOwogIHJlYWRfbW91bnRzICgpOwp9Cgpp
b19zdHJlYW1fY3lnZmlsZTo6aW9fc3RyZWFtX2N5Z2ZpbGUgKGNvbnN0IGNo
YXIgKm5hbWUsIGNvbnN0IGNoYXIgKm1vZGUpCnsKICBmbmFtZSA9IE5VTEw7
CiAgZnAgPSBOVUxMOwogIGVycm5vID0gMDsKICBpZiAoIW5hbWUgfHwgSXNC
YWRTdHJpbmdQdHIgKG5hbWUsIE1BWF9QQVRIKSB8fCAhbmFtZVswXSB8fAog
ICAgICAhbW9kZSB8fCBJc0JhZFN0cmluZ1B0ciAobW9kZSwgNSkgfHwgIW1v
ZGVbMF0pCiAgICByZXR1cm47CgogIC8qIGRvIHRoaXMgZXZlcnkgdGltZSBi
ZWNhdXNlIHRoZSBtb3VudCBwb2ludHMgbWF5IGNoYW5nZSBkdWUgdG8gZndk
L2JhY2sgYnV0dG9uIHVzZS4uLgogICAqIFRPRE86IG1ha2UgdGhpcyBsZXNz
Li4ubWFudWFsCiAgICovCiAgZ2V0X3Jvb3RfZGlyX25vdyAoKTsKICBpZiAo
IWdldF9yb290X2RpciAoKSkKICAgIC8qIFRPRE86IGFzc2lnbiBhIGVycm5v
IGZvciAibm8gbW91bnQgdGFibGUgOn0gIiAqLwogICAgcmV0dXJuOwoKICBm
bmFtZSA9IGN5Z3BhdGggKG5hbWUsIDApOwogIGZwID0gZm9wZW4gKGZuYW1l
LCBtb2RlKTsKICBpZiAoIWZwKQogICAgbGFzdGVyciA9IGVycm5vOwp9Cgpp
b19zdHJlYW1fY3lnZmlsZTo6fmlvX3N0cmVhbV9jeWdmaWxlICgpCnsKICBp
ZiAoZm5hbWUpCiAgICBmcmVlIChmbmFtZSk7CiAgaWYgKGZwKQogICAgZmNs
b3NlIChmcCk7Cn0KCi8qIFN0YXRpYyBtZW1iZXJzICovCmludAppb19zdHJl
YW1fY3lnZmlsZTo6ZXhpc3RzIChjb25zdCBjaGFyICpwYXRoKQp7CiAgZ2V0
X3Jvb3RfZGlyX25vdyAoKTsKICBpZiAoZ2V0X3Jvb3RfZGlyICgpICYmIF9h
Y2Nlc3MgKGN5Z3BhdGggKHBhdGgsIDApLCAwKSA9PSAwKQogICAgcmV0dXJu
IDE7CiAgcmV0dXJuIDA7Cn0KCmludAppb19zdHJlYW1fY3lnZmlsZTo6cmVt
b3ZlIChjb25zdCBjaGFyICpwYXRoKQp7CiAgaWYgKCFwYXRoKQogICAgcmV0
dXJuIDE7CiAgZ2V0X3Jvb3RfZGlyX25vdyAoKTsKICBpZiAoIWdldF9yb290
X2RpciAoKSkKICAgIC8qIFRPRE86IGFzc2lnbiBhIGVycm5vIGZvciAibm8g
bW91bnQgdGFibGUgOn0gIiAqLwogICAgcmV0dXJuIDE7CgogIHVuc2lnbmVk
IGxvbmcgdyA9IEdldEZpbGVBdHRyaWJ1dGVzIChjeWdwYXRoIChwYXRoLCAw
KSk7CiAgaWYgKHcgIT0gMHhmZmZmZmZmZiAmJiB3ICYgRklMRV9BVFRSSUJV
VEVfRElSRUNUT1JZKQogICAgewogICAgICBjaGFyICp0bXAgPSAoY2hhciAq
KSBtYWxsb2MgKHN0cmxlbiAoY3lncGF0aCAocGF0aCwgMCkpICsgMTApOwog
ICAgICBpbnQgaSA9IDA7CiAgICAgIGRvCgl7CgkgIGkrKzsKCSAgc3ByaW50
ZiAodG1wLCAiJXMub2xkLSVkIiwgY3lncGF0aCAocGF0aCwgMCksIGkpOwoJ
fQogICAgICB3aGlsZSAoR2V0RmlsZUF0dHJpYnV0ZXMgKHRtcCkgIT0gMHhm
ZmZmZmZmZik7CiAgICAgIGZwcmludGYgKHN0ZGVyciwgIndhcm5pbmc6IG1v
dmluZyBkaXJlY3RvcnkgXCIlc1wiIG91dCBvZiB0aGUgd2F5LlxuIiwKCSAg
ICAgICBwYXRoKTsKICAgICAgTW92ZUZpbGUgKGN5Z3BhdGggKHBhdGgsIDAp
LCB0bXApOwogICAgICBmcmVlICh0bXApOwogICAgfQogIHJldHVybiAhRGVs
ZXRlRmlsZUEgKGN5Z3BhdGggKHBhdGgsIDApKTsKfQoKaW50CmlvX3N0cmVh
bV9jeWdmaWxlOjpta2xpbmsgKGNvbnN0IGNoYXIgKmZyb20sIGNvbnN0IGNo
YXIgKnRvLAoJCQkgICBpb19zdHJlYW1fbGlua190IGxpbmt0eXBlKQp7CiAg
LyogRklYTUU6IGJhZHN0cmluZyBjaGVjayAqLwogIGlmICghZnJvbSB8fCAh
dG8pCiAgICByZXR1cm4gMTsKICBzd2l0Y2ggKGxpbmt0eXBlKQogICAgewog
ICAgY2FzZSBJT19TVFJFQU1fU1lNTElOSzoKICAgICAgcmV0dXJuIG1rY3ln
c3ltbGluayAoY3lncGF0aCAoZnJvbSwgMCksIHRvKTsKICAgIGNhc2UgSU9f
U1RSRUFNX0hBUkRMSU5LOgogICAgICByZXR1cm4gMTsKICAgIH0KICByZXR1
cm4gMTsKfQoKCi8qIHZpcnR1YWxzICovCgpzc2l6ZV90CmlvX3N0cmVhbV9j
eWdmaWxlOjpyZWFkICh2b2lkICpidWZmZXIsIHNpemVfdCBsZW4pCnsKICBp
ZiAoZnApCiAgICByZXR1cm4gZnJlYWQgKGJ1ZmZlciwgMSwgbGVuLCBmcCk7
CiAgcmV0dXJuIDA7Cn0KCnNzaXplX3QKaW9fc3RyZWFtX2N5Z2ZpbGU6Ondy
aXRlICh2b2lkICpidWZmZXIsIHNpemVfdCBsZW4pCnsKICBpZiAoZnApCiAg
ICByZXR1cm4gZndyaXRlIChidWZmZXIsIDEsIGxlbiwgZnApOwogIHJldHVy
biAwOwp9Cgpzc2l6ZV90CmlvX3N0cmVhbV9jeWdmaWxlOjpwZWVrICh2b2lk
ICpidWZmZXIsIHNpemVfdCBsZW4pCnsKICBsb2cgKExPR19USU1FU1RBTVAs
ICJpb19zdHJlYW1fY3lnZmlsZTo6cGVlayBjYWxsZWQiKTsKICBpZiAoZnAp
CiAgICB7CiAgICAgIGludCBwb3MgPSBmdGVsbCAoZnApOwogICAgICBzc2l6
ZV90IHJ2ID0gZnJlYWQgKGJ1ZmZlciwgMSwgbGVuLCBmcCk7CiAgICAgIGZz
ZWVrIChmcCwgcG9zLCBTRUVLX1NFVCk7CiAgICAgIHJldHVybiBydjsKICAg
IH0KICByZXR1cm4gMDsKfQoKbG9uZwppb19zdHJlYW1fY3lnZmlsZTo6dGVs
bCAoKQp7CiAgaWYgKGZwKQogICAgewogICAgICByZXR1cm4gZnRlbGwgKGZw
KTsKICAgIH0KICByZXR1cm4gMDsKfQoKaW50CmlvX3N0cmVhbV9jeWdmaWxl
OjplcnJvciAoKQp7CiAgaWYgKGZwKQogICAgcmV0dXJuIGZlcnJvciAoZnAp
OwogIHJldHVybiBsYXN0ZXJyOwp9CgppbnQKY3lnbWtkaXJfcCAoaW50IGlz
YWRpciwgY29uc3QgY2hhciAqbmFtZSkKewogIGlmICghbmFtZSB8fCBJc0Jh
ZFN0cmluZ1B0ciAobmFtZSwgTUFYX1BBVEgpIHx8ICFuYW1lWzBdKQogICAg
cmV0dXJuIDE7CiAgZ2V0X3Jvb3RfZGlyX25vdyAoKTsKICBpZiAoIWdldF9y
b290X2RpciAoKSkKICAgIC8qIFRPRE86IGFzc2lnbiBhIGVycm5vIGZvciAi
bm8gbW91bnQgdGFibGUgOn0gIiAqLwogICAgcmV0dXJuIDE7CiAgcmV0dXJu
IG1rZGlyX3AgKGlzYWRpciwgY3lncGF0aCAobmFtZSwgMCkpOwp9CgppbnQK
aW9fc3RyZWFtX2N5Z2ZpbGU6OnNldF9tdGltZSAoaW50IG10aW1lKQp7CiAg
aWYgKCFmbmFtZSkKICAgIHJldHVybiAxOwogIGxvbmcgbG9uZyBmdGltZXYg
PSBtdGltZSAqIE5TUEVSU0VDICsgRkFDVE9SOwogIEZJTEVUSU1FIGZ0aW1l
OwogIGZ0aW1lLmR3SGlnaERhdGVUaW1lID0gZnRpbWV2ID4+IDMyOwogIGZ0
aW1lLmR3TG93RGF0ZVRpbWUgPSBmdGltZXY7CiAgSEFORExFIGggPQogICAg
Q3JlYXRlRmlsZUEgKGZuYW1lLCBHRU5FUklDX1dSSVRFLCBGSUxFX1NIQVJF
X1JFQUQgfCBGSUxFX1NIQVJFX1dSSVRFLAoJCSAwLCBPUEVOX0VYSVNUSU5H
LAoJCSBGSUxFX0FUVFJJQlVURV9OT1JNQUwgfCBGSUxFX0ZMQUdfQkFDS1VQ
X1NFTUFOVElDUywgMCk7CiAgaWYgKGgpCiAgICB7CiAgICAgIFNldEZpbGVU
aW1lIChoLCAwLCAwLCAmZnRpbWUpOwogICAgICBDbG9zZUhhbmRsZSAoaCk7
CiAgICAgIHJldHVybiAwOwogICAgfQogIHJldHVybiAxOwp9Cg==

------------=_1583532850-65438-114
Content-Type: text/x-c++; charset=us-ascii; name="io_stream_cygfile.h"
Content-Disposition: inline; filename="io_stream_cygfile.h"
Content-Transfer-Encoding: base64
Content-Length: 2192

LyoKICogQ29weXJpZ2h0IChjKSAyMDAxLCBSb2JlcnQgQ29sbGlucy4KICoK
ICogICAgIFRoaXMgcHJvZ3JhbSBpcyBmcmVlIHNvZnR3YXJlOyB5b3UgY2Fu
IHJlZGlzdHJpYnV0ZSBpdCBhbmQvb3IgbW9kaWZ5CiAqICAgICBpdCB1bmRl
ciB0aGUgdGVybXMgb2YgdGhlIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNl
IGFzIHB1Ymxpc2hlZCBieQogKiAgICAgdGhlIEZyZWUgU29mdHdhcmUgRm91
bmRhdGlvbjsgZWl0aGVyIHZlcnNpb24gMiBvZiB0aGUgTGljZW5zZSwgb3IK
ICogICAgIChhdCB5b3VyIG9wdGlvbikgYW55IGxhdGVyIHZlcnNpb24uCiAq
CiAqICAgICBBIGNvcHkgb2YgdGhlIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNl
bnNlIGNhbiBiZSBmb3VuZCBhdAogKiAgICAgaHR0cDovL3d3dy5nbnUub3Jn
LwogKgogKiBXcml0dGVuIGJ5IFJvYmVydCBDb2xsaW5zICA8cmJ0Y29sbGlu
c0Bob3RtYWlsLmNvbT4KICoKICovCgojaWZuZGVmIF9JT19TVFJFQU1fQ1lH
RklMRV9IXwojZGVmaW5lIF9JT19TVFJFQU1fQ1lHRklMRV9IXwoKCi8qIGlv
X3N0cmVhbSBvbiBkaXNrIGZpbGVzIHVzaW5nIGN5Z3dpbiBwYXRocwogKiBh
bmQgcG90ZW50aWFsbHkgdW5kZXJzdGFuZGluZyBsaW5rcyBpbiB0aGUgZnV0
dXJlCiAqLwoKZXh0ZXJuIGludCBjeWdta2Rpcl9wIChpbnQgaXNhZGlyLCBj
b25zdCBjaGFyICpwYXRoKTsKCmNsYXNzIGlvX3N0cmVhbV9jeWdmaWxlOnB1
YmxpYyBpb19zdHJlYW0KewpwdWJsaWM6CiAgc3RhdGljIGludCBleGlzdHMg
KGNvbnN0IGNoYXIgKik7CiAgc3RhdGljIGludCByZW1vdmUgKGNvbnN0IGNo
YXIgKik7CiAgc3RhdGljIGludCBta2xpbmsgKGNvbnN0IGNoYXIgKiwgY29u
c3QgY2hhciAqLCBpb19zdHJlYW1fbGlua190KTsKICAgIGlvX3N0cmVhbV9j
eWdmaWxlIChjb25zdCBjaGFyICosIGNvbnN0IGNoYXIgKik7CiAgIH5pb19z
dHJlYW1fY3lnZmlsZSAoKTsKICAvKiByZWFkIGRhdGEgKGR1aCEpICovCiAg
dmlydHVhbCBzc2l6ZV90IHJlYWQgKHZvaWQgKmJ1ZmZlciwgc2l6ZV90IGxl
bik7CiAgLyogcHJvdmlkZSBkYXRhIHRvIChkb3VibGUgZHVoISkgKi8KICB2
aXJ0dWFsIHNzaXplX3Qgd3JpdGUgKHZvaWQgKmJ1ZmZlciwgc2l6ZV90IGxl
bik7CiAgLyogcmVhZCBkYXRhIHdpdGhvdXQgcmVtb3ZpbmcgaXQgZnJvbSB0
aGUgY2xhc3MncyBpbnRlcm5hbCBidWZmZXIgKi8KICB2aXJ0dWFsIHNzaXpl
X3QgcGVlayAodm9pZCAqYnVmZmVyLCBzaXplX3QgbGVuKTsKICB2aXJ0dWFs
IGxvbmcgdGVsbCAoKTsKICAvKiBjYW4ndCBndWVzcywgb2ggd2VsbCAqLwog
IHZpcnR1YWwgaW50IGVycm9yICgpOwogIHZpcnR1YWwgaW50IHNldF9tdGlt
ZSAoaW50KTsKICAvKiBkdW1teSBmb3IgaW9fc3RyZWFtX2ZpbGUgKi8KICB2
aXJ0dWFsIGNvbnN0IGNoYXIgKm5leHRfZmlsZV9uYW1lICgpCiAgewogICAg
cmV0dXJuIE5VTEw7CiAgfTsKcHJpdmF0ZToKICAvKiBhbHdheXMgcmVxdWly
ZSBwYXJhbWV0ZXJzICovCiAgICBpb19zdHJlYW1fY3lnZmlsZSAoKQogIHsK
ICB9OwogIEZJTEUgKmZwOwogIGludCBsYXN0ZXJyOwogIGNoYXIgKmZuYW1l
Owp9OwoKI2VuZGlmIC8qIF9JT19TVFJFQU1fQ1lHRklMRV9IXyAqLwo=

------------=_1583532850-65438-114
Content-Type: text/x-c; charset=us-ascii; name="io_stream_file.cc"
Content-Disposition: inline; filename="io_stream_file.cc"
Content-Transfer-Encoding: base64
Content-Length: 4693

LyoKICogQ29weXJpZ2h0IChjKSAyMDAxLCBSb2JlcnQgQ29sbGlucy4KICoK
ICogICAgIFRoaXMgcHJvZ3JhbSBpcyBmcmVlIHNvZnR3YXJlOyB5b3UgY2Fu
IHJlZGlzdHJpYnV0ZSBpdCBhbmQvb3IgbW9kaWZ5CiAqICAgICBpdCB1bmRl
ciB0aGUgdGVybXMgb2YgdGhlIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNl
IGFzIHB1Ymxpc2hlZCBieQogKiAgICAgdGhlIEZyZWUgU29mdHdhcmUgRm91
bmRhdGlvbjsgZWl0aGVyIHZlcnNpb24gMiBvZiB0aGUgTGljZW5zZSwgb3IK
ICogICAgIChhdCB5b3VyIG9wdGlvbikgYW55IGxhdGVyIHZlcnNpb24uCiAq
CiAqICAgICBBIGNvcHkgb2YgdGhlIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNl
bnNlIGNhbiBiZSBmb3VuZCBhdAogKiAgICAgaHR0cDovL3d3dy5nbnUub3Jn
LwogKgogKiBXcml0dGVuIGJ5IFJvYmVydCBDb2xsaW5zICA8cmJ0Y29sbGlu
c0Bob3RtYWlsLmNvbT4KICoKICovCgojaWYgMApzdGF0aWMgY29uc3QgY2hh
ciAqY3ZzaWQgPQogICJcbiUlJSAkSWQ6IHNvdXJjZS5jYyx2IDIuNSAyMDAx
LzExLzAxIDEzOjIyOjQ2IHJiY29sbGlucyBFeHAgJFxuIjsKI2VuZGlmCgoj
aW5jbHVkZSAid2luMzIuaCIKI2luY2x1ZGUgPHN0ZGlvLmg+CiNpbmNsdWRl
IDxzdGRsaWIuaD4KI2luY2x1ZGUgPHVuaXN0ZC5oPgojaW5jbHVkZSAibG9n
LmgiCiNpbmNsdWRlICJwb3J0LmgiCiNpbmNsdWRlICJta2xpbmsyLmgiCgoj
aW5jbHVkZSAiaW9fc3RyZWFtLmgiCiNpbmNsdWRlICJpb19zdHJlYW1fZmls
ZS5oIgoKLyogZm9yIHNldF9tdGltZSAqLwojZGVmaW5lIEZBQ1RPUiAoMHgx
OWRiMWRlZDUzZWE3MTBMTCkKI2RlZmluZSBOU1BFUlNFQyAxMDAwMDAwMExM
Cgppb19zdHJlYW1fZmlsZTo6aW9fc3RyZWFtX2ZpbGUgKGNvbnN0IGNoYXIg
Km5hbWUsIGNvbnN0IGNoYXIgKm1vZGUpCnsKICBmbmFtZSA9IE5VTEw7CiAg
ZnAgPSBOVUxMOwogIGVycm5vID0gMDsKICBpZiAoIW5hbWUgfHwgSXNCYWRT
dHJpbmdQdHIgKG5hbWUsIE1BWF9QQVRIKSB8fCAhbmFtZVswXSB8fAogICAg
ICAhbW9kZSB8fCBJc0JhZFN0cmluZ1B0ciAobW9kZSwgNSkgfHwgIW1vZGVb
MF0pCiAgICByZXR1cm47CiAgZm5hbWUgPSBzdHJkdXAgKG5hbWUpOwogIGZw
ID0gZm9wZW4gKG5hbWUsIG1vZGUpOwogIGlmICghZnApCiAgICBsYXN0ZXJy
ID0gZXJybm87Cn0KCmlvX3N0cmVhbV9maWxlOjp+aW9fc3RyZWFtX2ZpbGUg
KCkKewogIGlmIChmbmFtZSkKICAgIGZyZWUgKGZuYW1lKTsKICBpZiAoZnAp
CiAgICBmY2xvc2UgKGZwKTsKfQoKaW50CmlvX3N0cmVhbV9maWxlOjpleGlz
dHMgKGNvbnN0IGNoYXIgKnBhdGgpCnsKICBpZiAoX2FjY2VzcyAocGF0aCwg
MCkgPT0gMCkKICAgIHJldHVybiAxOwogIHJldHVybiAwOwp9CgppbnQKaW9f
c3RyZWFtX2ZpbGU6OnJlbW92ZSAoY29uc3QgY2hhciAqcGF0aCkKewogIGlm
ICghcGF0aCkKICAgIHJldHVybiAxOwoKICB1bnNpZ25lZCBsb25nIHcgPSBH
ZXRGaWxlQXR0cmlidXRlcyAocGF0aCk7CiAgaWYgKHcgIT0gMHhmZmZmZmZm
ZiAmJiB3ICYgRklMRV9BVFRSSUJVVEVfRElSRUNUT1JZKQogICAgewogICAg
ICBjaGFyICp0bXAgPSAoY2hhciAqKSBtYWxsb2MgKHN0cmxlbiAocGF0aCkg
KyAxMCk7CiAgICAgIGludCBpID0gMDsKICAgICAgZG8KCXsKCSAgaSsrOwoJ
ICBzcHJpbnRmICh0bXAsICIlcy5vbGQtJWQiLCBwYXRoLCBpKTsKCX0KICAg
ICAgd2hpbGUgKEdldEZpbGVBdHRyaWJ1dGVzICh0bXApICE9IDB4ZmZmZmZm
ZmYpOwogICAgICBmcHJpbnRmIChzdGRlcnIsICJ3YXJuaW5nOiBtb3Zpbmcg
ZGlyZWN0b3J5IFwiJXNcIiBvdXQgb2YgdGhlIHdheS5cbiIsCgkgICAgICAg
cGF0aCk7CiAgICAgIE1vdmVGaWxlIChwYXRoLCB0bXApOwogICAgICBmcmVl
ICh0bXApOwogICAgfQogIHJldHVybiAhRGVsZXRlRmlsZUEgKHBhdGgpOwoK
fQoKaW50CmlvX3N0cmVhbV9maWxlOjpta2xpbmsgKGNvbnN0IGNoYXIgKmZy
b20sIGNvbnN0IGNoYXIgKnRvLAoJCQlpb19zdHJlYW1fbGlua190IGxpbmt0
eXBlKQp7CiAgLyogRklYTUU6IGJhZHN0cmluZyBjaGVjayAqLwogIGlmICgh
ZnJvbSB8fCAhdG8pCiAgICByZXR1cm4gMTsKICBzd2l0Y2ggKGxpbmt0eXBl
KQogICAgewogICAgY2FzZSBJT19TVFJFQU1fU1lNTElOSzoKICAgICAgcmV0
dXJuIG1rY3lnc3ltbGluayAoZnJvbSwgdG8pOwogICAgY2FzZSBJT19TVFJF
QU1fSEFSRExJTks6CiAgICAgIHJldHVybiAxOwogICAgfQogIHJldHVybiAx
Owp9CgovKiB2aXJ0dWFscyAqLwoKCnNzaXplX3QgaW9fc3RyZWFtX2ZpbGU6
OnJlYWQgKHZvaWQgKmJ1ZmZlciwgc2l6ZV90IGxlbikKewogIGlmIChmcCkK
ICAgIHJldHVybiBmcmVhZCAoYnVmZmVyLCAxLCBsZW4sIGZwKTsKICByZXR1
cm4gMDsKfQoKc3NpemVfdCBpb19zdHJlYW1fZmlsZTo6d3JpdGUgKHZvaWQg
KmJ1ZmZlciwgc2l6ZV90IGxlbikKewogIGlmIChmcCkKICAgIHJldHVybiBm
d3JpdGUgKGJ1ZmZlciwgMSwgbGVuLCBmcCk7CiAgcmV0dXJuIDA7Cn0KCnNz
aXplX3QgaW9fc3RyZWFtX2ZpbGU6OnBlZWsgKHZvaWQgKmJ1ZmZlciwgc2l6
ZV90IGxlbikKewogIGxvZyAoTE9HX1RJTUVTVEFNUCwgImlvX3N0cmVhbV9m
aWxlOjpwZWVrIGNhbGxlZCIpOwogIGlmIChmcCkKICAgIHsKICAgICAgaW50
Cglwb3MgPSBmdGVsbCAoZnApOwogICAgICBzc2l6ZV90CglydiA9IGZyZWFk
IChidWZmZXIsIDEsIGxlbiwgZnApOwogICAgICBmc2VlayAoZnAsIHBvcywg
U0VFS19TRVQpOwogICAgICByZXR1cm4gcnY7CiAgICB9CiAgcmV0dXJuIDA7
Cn0KCmxvbmcKaW9fc3RyZWFtX2ZpbGU6OnRlbGwgKCkKewogIGlmIChmcCkK
ICAgIHsKICAgICAgcmV0dXJuIGZ0ZWxsIChmcCk7CiAgICB9CiAgcmV0dXJu
IDA7Cn0KCmludAppb19zdHJlYW1fZmlsZTo6ZXJyb3IgKCkKewogIGlmIChm
cCkKICAgIHJldHVybiBmZXJyb3IgKGZwKTsKICByZXR1cm4gbGFzdGVycjsK
fQoKaW50CmlvX3N0cmVhbV9maWxlOjpzZXRfbXRpbWUgKGludCBtdGltZSkK
ewogIGlmICghZm5hbWUpCiAgICByZXR1cm4gMTsKICBsb25nIGxvbmcgZnRp
bWV2ID0gbXRpbWUgKiBOU1BFUlNFQyArIEZBQ1RPUjsKICBGSUxFVElNRSBm
dGltZTsKICBmdGltZS5kd0hpZ2hEYXRlVGltZSA9IGZ0aW1ldiA+PiAzMjsK
ICBmdGltZS5kd0xvd0RhdGVUaW1lID0gZnRpbWV2OwogIEhBTkRMRSBoID0K
ICAgIENyZWF0ZUZpbGVBIChmbmFtZSwgR0VORVJJQ19XUklURSwgRklMRV9T
SEFSRV9SRUFEIHwgRklMRV9TSEFSRV9XUklURSwKCQkgMCwgT1BFTl9FWElT
VElORywKCQkgRklMRV9BVFRSSUJVVEVfTk9STUFMIHwgRklMRV9GTEFHX0JB
Q0tVUF9TRU1BTlRJQ1MsIDApOwogIGlmIChoKQogICAgewogICAgICBTZXRG
aWxlVGltZSAoaCwgMCwgMCwgJmZ0aW1lKTsKICAgICAgQ2xvc2VIYW5kbGUg
KGgpOwogICAgICByZXR1cm4gMDsKICAgIH0KICByZXR1cm4gMTsKfQo=

------------=_1583532850-65438-114
Content-Type: text/x-c++; charset=us-ascii; name="io_stream_file.h"
Content-Disposition: inline; filename="io_stream_file.h"
Content-Transfer-Encoding: base64
Content-Length: 1993

LyoKICogQ29weXJpZ2h0IChjKSAyMDAxLCBSb2JlcnQgQ29sbGlucy4KICoK
ICogICAgIFRoaXMgcHJvZ3JhbSBpcyBmcmVlIHNvZnR3YXJlOyB5b3UgY2Fu
IHJlZGlzdHJpYnV0ZSBpdCBhbmQvb3IgbW9kaWZ5CiAqICAgICBpdCB1bmRl
ciB0aGUgdGVybXMgb2YgdGhlIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNl
IGFzIHB1Ymxpc2hlZCBieQogKiAgICAgdGhlIEZyZWUgU29mdHdhcmUgRm91
bmRhdGlvbjsgZWl0aGVyIHZlcnNpb24gMiBvZiB0aGUgTGljZW5zZSwgb3IK
ICogICAgIChhdCB5b3VyIG9wdGlvbikgYW55IGxhdGVyIHZlcnNpb24uCiAq
CiAqICAgICBBIGNvcHkgb2YgdGhlIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNl
bnNlIGNhbiBiZSBmb3VuZCBhdAogKiAgICAgaHR0cDovL3d3dy5nbnUub3Jn
LwogKgogKiBXcml0dGVuIGJ5IFJvYmVydCBDb2xsaW5zICA8cmJ0Y29sbGlu
c0Bob3RtYWlsLmNvbT4KICoKICovCgojaWZuZGVmIF9JT19TVFJFQU1fRklM
RV9IXwojZGVmaW5lIF9JT19TVFJFQU1fRklMRV9IXwoKCi8qIGlvX3N0cmVh
bSBvbiBkaXNrIGZpbGVzCiAqLwoKY2xhc3MgaW9fc3RyZWFtX2ZpbGU6cHVi
bGljIGlvX3N0cmVhbQp7CnB1YmxpYzoKICBzdGF0aWMgaW50IGV4aXN0cyAo
Y29uc3QgY2hhciAqKTsKICBzdGF0aWMgaW50IHJlbW92ZSAoY29uc3QgY2hh
ciAqKTsKICBzdGF0aWMgaW50IG1rbGluayAoY29uc3QgY2hhciAqLCBjb25z
dCBjaGFyICosIGlvX3N0cmVhbV9saW5rX3QpOwogICAgaW9fc3RyZWFtX2Zp
bGUgKGNvbnN0IGNoYXIgKiwgY29uc3QgY2hhciAqKTsKICAgfmlvX3N0cmVh
bV9maWxlICgpOwogIC8qIHJlYWQgZGF0YSAoZHVoISkgKi8KICB2aXJ0dWFs
IHNzaXplX3QgcmVhZCAodm9pZCAqYnVmZmVyLCBzaXplX3QgbGVuKTsKICAv
KiBwcm92aWRlIGRhdGEgdG8gKGRvdWJsZSBkdWghKSAqLwogIHZpcnR1YWwg
c3NpemVfdCB3cml0ZSAodm9pZCAqYnVmZmVyLCBzaXplX3QgbGVuKTsKICAv
KiByZWFkIGRhdGEgd2l0aG91dCByZW1vdmluZyBpdCBmcm9tIHRoZSBjbGFz
cydzIGludGVybmFsIGJ1ZmZlciAqLwogIHZpcnR1YWwgc3NpemVfdCBwZWVr
ICh2b2lkICpidWZmZXIsIHNpemVfdCBsZW4pOwogIHZpcnR1YWwgbG9uZyB0
ZWxsICgpOwogIC8qIGNhbid0IGd1ZXNzLCBvaCB3ZWxsICovCiAgdmlydHVh
bCBpbnQgZXJyb3IgKCk7CiAgdmlydHVhbCBpbnQgc2V0X210aW1lIChpbnQp
OwogIC8qIGR1bW15IGZvciBpb19zdHJlYW1fZmlsZSAqLwogIHZpcnR1YWwg
Y29uc3QgY2hhciAqbmV4dF9maWxlX25hbWUgKCkKICB7CiAgICByZXR1cm4g
TlVMTDsKICB9Owpwcml2YXRlOgogIC8qIGFsd2F5cyByZXF1aXJlIHBhcmFt
ZXRlcnMgKi8KICAgIGlvX3N0cmVhbV9maWxlICgpCiAgewogIH07CiAgRklM
RSAqZnA7CiAgaW50IGxhc3RlcnI7CiAgY2hhciAqZm5hbWU7Cn07CgojZW5k
aWYgLyogX0lPX1NUUkVBTV9GSUxFX0hfICovCg==

------------=_1583532850-65438-114
Content-Type: text/x-diff; charset=us-ascii; name="streams.patch"
Content-Disposition: inline; filename="streams.patch"
Content-Transfer-Encoding: base64
Content-Length: 203712

SW5kZXg6IE1ha2VmaWxlLmluCj09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KUkNT
IGZpbGU6IC9jdnMvc3JjL3NyYy93aW5zdXAvY2luc3RhbGwvTWFrZWZpbGUu
aW4sdgpyZXRyaWV2aW5nIHJldmlzaW9uIDIuMjQKZGlmZiAtdSAtcCAtcjIu
MjQgTWFrZWZpbGUuaW4KLS0tIE1ha2VmaWxlLmluCTIwMDEvMTEvMDIgMDQ6
MDM6NTUJMi4yNAorKysgTWFrZWZpbGUuaW4JMjAwMS8xMS8xMSAwNjo1NDo1
MwpAQCAtMzUsNyArMzUsOSBAQCBDQwkJOj0gQENDQAogQ0NfRk9SX1RBUkdF
VAk6PSAkKENDKQogQ1hYCQk6PSBAQ1hYQAogCi1DRkxBR1MJCTo9IEBDRkxB
R1NACitDRkxBR1MJCTo9IEBDRkxBR1NAIC1XZXJyb3IgLVdpbmxpbmUgLVdh
bGwgLVdwb2ludGVyLWFyaXRoIC1XY2FzdC1hbGlnblwKKwktV3dyaXRlLXN0
cmluZ3MgLVdzdHJpY3QtcHJvdG90eXBlcyAtV21pc3NpbmctcHJvdG90eXBl
cyBcCisJLVdtaXNzaW5nLWRlY2xhcmF0aW9ucyAtV2NvbW1lbnRzCiBDWFhG
TEFHUwk6PSBAQ1hYRkxBR1NAICQoQ0ZMQUdTKSAtZm5vLWV4Y2VwdGlvbnMg
LWZuby1ydHRpCiBDWFgJCTo9IEBDWFhACiAKQEAgLTQ4LDYgKzUwLDExIEBA
IE1JTkdXX0lOQ0xVREVTCTo9IC1JLiAtSSQoc3JjZGlyKSAtSSQobWkKIAog
TUlOR1dfQ1hYRkxBR1MJOj0gLU1NRCAkKENYWEZMQUdTKSAtbW5vLWN5Z3dp
biAkKE1JTkdXX0lOQ0xVREVTKSAtbXdpbmRvd3MKIE1JTkdXX0NGTEFHUwk6
PSAtTU1EICQoQ0ZMQUdTKSAtbW5vLWN5Z3dpbiAkKE1JTkdXX0lOQ0xVREVT
KSAtbXdpbmRvd3MKKyMgdG8gYXZvaWQgZmFsc2UgZXJyb3JzIHRoYXQgYXNz
ZW1ibHkgZ2VuZXJhdGVzCitXQVJOT05MWV9DRkxBR1MgOj0gLU1NRCBAQ0ZM
QUdTQCAtV2lubGluZSAtV2FsbCAtV3BvaW50ZXItYXJpdGggLVdjYXN0LWFs
aWduIFwKKwktV3dyaXRlLXN0cmluZ3MgLVdzdHJpY3QtcHJvdG90eXBlcyAt
V21pc3NpbmctcHJvdG90eXBlcyBcCisJLVdtaXNzaW5nLWRlY2xhcmF0aW9u
cyAtV2NvbW1lbnRzIFwKKwkgLW1uby1jeWd3aW4gJChNSU5HV19JTkNMVURF
UykgLW13aW5kb3dzCiAKIFpMSUIJCTo9IHpsaWIvbGliemN5Z3cuYQogQloy
TElCCQk6PSAkKGJ1cGRpcikvYnoybGliL2xpYmJ6Mi5hCkBAIC03Myw4ICs4
MCwxMyBAQCBBTExfTERGTEFHUwk6PSAke2ZpbHRlci1vdXQgLUklLCBcCiBQ
Uk9HUwk6PSBzZXR1cCQoRVhFRVhUKQogCiBPQkpTID0gXAorCWFyY2hpdmUu
byBcCisJYXJjaGl2ZV90YXJfZmlsZS5vIFwKIAlhdXRvbG9hZC5vIFwKIAlj
aG9vc2UubyBcCisJY29tcHJlc3MubyBcCisJY29tcHJlc3NfYnoubyBcCisJ
Y29tcHJlc3NfZ3oubyBcCiAJY29uY2F0Lm8gXAogCWRlc2t0b3AubyBcCiAJ
ZGlhbG9nLm8gXApAQCAtODgsNiArMTAwLDkgQEAgT0JKUyA9IFwKIAlpbmls
ZXgubyBcCiAJaW5pcGFyc2UubyBcCiAJaW5zdGFsbC5vIFwKKwlpb19zdHJl
YW0ubyBcCisJaW9fc3RyZWFtX2N5Z2ZpbGUubyBcCisJaW9fc3RyZWFtX2Zp
bGUubyBcCiAJbG9jYWxkaXIubyBcCiAJbG9nLm8gXAogCW1haW4ubyBcCkBA
IC0xNjYsOCArMTgxLDcgQEAgdmVyc2lvbi5jIDogJChzcmNkaXIpL0NoYW5n
ZUxvZyBNYWtlZmlsZQogCVY9YGdyZXAgJ15cJCRSZXZpc2lvbi4qJyAkKHNy
Y2RpcikvQ2hhbmdlTG9nIFwKIAl8IHNlZCAtZSAncy9cJCRSZXZpc2lvbjoq
ICovLycgXAogCSAgLWUgJ3MvICokJC4qLy8nYCA7XAotCWVjaG8gImNoYXIg
KnZlcnNpb24gPSBcIiQkVlwiOyIgPiB2ZXJzaW9uLnRtcCA7XAotCWVjaG8g
InN0YXRpYyBjaGFyICppZCA9IFwiXFxuJSUlIHNldHVwLXZlcnNpb24gJCRW
XFxuXCI7IiA+PiB2ZXJzaW9uLnRtcAorCWVjaG8gImNvbnN0IGNoYXIgKnZl
cnNpb24gPSBcIiQkVlwiOyIgPiB2ZXJzaW9uLnRtcCA7XAogCW12IHZlcnNp
b24udG1wIHZlcnNpb24uYwogCiAlLm86ICUucmMKQEAgLTE5NiwxMSArMjEw
LDI5IEBAIGVuZGlmCiAKIGF1dG9sb2FkLm86IGF1dG9sb2FkLmMKIGlmZGVm
IFZFUkJPU0UKLQkkKENDKSAkKE1JTkdXX0NGTEFHUykgLWMgLW8gJEAgJDwg
LWZuby1pbmxpbmUtZnVuY3Rpb25zCisJJChDQykgJChXQVJOT05MWV9DRkxB
R1MpIC1jIC1vICRAICQ8IC1mbm8taW5saW5lLWZ1bmN0aW9ucwogZWxzZQot
CUBlY2hvICQoQ0MpIC1jICQoQ0ZMQUdTKSAuLi4gJCg8RikgLWZuby1pbmxp
bmUtZnVuY3Rpb25zCi0JQCQoQ0MpICQoTUlOR1dfQ0ZMQUdTKSAtYyAtbyAk
QCAkPCAtZm5vLWlubGluZS1mdW5jdGlvbnMKKwlAZWNobyAkKENDKSAtYyAk
KFdBUk5PTkxZX0NGTEFHUykgLi4uICQoPEYpIC1mbm8taW5saW5lLWZ1bmN0
aW9ucworCUAkKENDKSAkKFdBUk5PTkxZX0NGTEFHUykgLWMgLW8gJEAgJDwg
LWZuby1pbmxpbmUtZnVuY3Rpb25zCiBlbmRpZgorCitpbmlsZXgubzogaW5p
bGV4LmMKK2lmZGVmIFZFUkJPU0UKKwkkKENDKSAkKFdBUk5PTkxZX0NGTEFH
UykgLWMgLW8gJEAgJDwKK2Vsc2UKKwlAZWNobyAkKENDKSAtYyAkKFdBUk5P
TkxZX0NGTEFHUykgLi4uICQoPEYpCisJQCQoQ0MpICQoV0FSTk9OTFlfQ0ZM
QUdTKSAtYyAtbyAkQCAkPCAKK2VuZGlmCisKK2luaXBhcnNlLm86IGluaXBh
cnNlLmNjCitpZmRlZiBWRVJCT1NFCisJJChDWFgpIEBDWFhGTEFHU0AgJChX
QVJOT05MWV9DRkxBR1MpIC1mbm8tZXhjZXB0aW9ucyAtZm5vLXJ0dGkgLWMg
LW8gJEAgJDwgCitlbHNlCisJQGVjaG8gJChDWFgpIC1jIEBDWFhGTEFHU0Ag
JChXQVJOT05MWV9DRkxBR1MpIC4uLiAkKDxGKSAtZm5vLWV4Y2VwdGlvbnMg
LWZuby1ydHRpCisJQCQoQ1hYKSBAQ1hYRkxBR1NAICQoV0FSTk9OTFlfQ0ZM
QUdTKSAtYyAtbyAkQCAkPCAtZm5vLWV4Y2VwdGlvbnMgLWZuby1ydHRpCitl
bmRpZgorCisKIAogaW5pcGFyc2UuY2MgaW5pcGFyc2UuaCA6IGluaXBhcnNl
LnkKIAliaXNvbiAtZCAtbyBpbmlwYXJzZS5jYyAkKHNyY2RpcikvaW5pcGFy
c2UueQpJbmRleDogYXV0b2xvYWQuYwo9PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
ClJDUyBmaWxlOiAvY3ZzL3NyYy9zcmMvd2luc3VwL2NpbnN0YWxsL2F1dG9s
b2FkLmMsdgpyZXRyaWV2aW5nIHJldmlzaW9uIDIuMgpkaWZmIC11IC1wIC1y
Mi4yIGF1dG9sb2FkLmMKLS0tIGF1dG9sb2FkLmMJMjAwMS8wOC8wNyAwODow
MDo1OAkyLjIKKysrIGF1dG9sb2FkLmMJMjAwMS8xMS8xMSAwNjo1NDo1MwpA
QCAtMTIsOCArMTIsOSBAQAogICogV3JpdHRlbiBieSBESiBEZWxvcmllIDxk
akBjeWdudXMuY29tPgogICoKICAqLwotCi1zdGF0aWMgY2hhciAqY3ZzaWQg
PSAiXG4lJSUgJElkOiBhdXRvbG9hZC5jLHYgMi4yIDIwMDEvMDgvMDcgMDg6
MDA6NTggY29yaW5uYSBFeHAgJFxuIjsKKyNpZiAwCitzdGF0aWMgY29uc3Qg
Y2hhciAqY3ZzaWQgPSAiXG4lJSUgJElkOiBhdXRvbG9hZC5jLHYgMi4yIDIw
MDEvMDgvMDcgMDg6MDA6NTggY29yaW5uYSBFeHAgJFxuIjsKKyNlbmRpZgog
CiAjaW5jbHVkZSAid2luMzIuaCIKIApJbmRleDogY2hvb3NlLmNjCj09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT0KUkNTIGZpbGU6IC9jdnMvc3JjL3NyYy93aW5z
dXAvY2luc3RhbGwvY2hvb3NlLmNjLHYKcmV0cmlldmluZyByZXZpc2lvbiAy
LjY1CmRpZmYgLXUgLXAgLXIyLjY1IGNob29zZS5jYwotLS0gY2hvb3NlLmNj
CTIwMDEvMTEvMDkgMjM6Mzc6MjIJMi42NQorKysgY2hvb3NlLmNjCTIwMDEv
MTEvMTEgMDY6NTQ6NTUKQEAgLTI3LDcgKzI3LDcgQEAKIAogI2lmIDAKIHN0
YXRpYyBjb25zdCBjaGFyICpjdnNpZCA9Ci0gICJcbiUlJSAkSWQ6IGNob29z
ZS5jYyx2IDIuNjUgMjAwMS8xMS8wOSAyMzozNzoyMiByYmNvbGxpbnMgRXhw
ICRcbiI7CisgICJcbiUlJSAkSWQ6IGNob29zZS5jYyx2IDIuNjMgMjAwMS8x
MS8wOSAxNDoxMjowMCByYmNvbGxpbnMgRXhwICRcbiI7CiAjZW5kaWYKIAog
I2luY2x1ZGUgIndpbjMyLmgiCkBAIC00NSw3ICs0NSw3IEBAIHN0YXRpYyBj
b25zdCBjaGFyICpjdnNpZCA9CiAjaW5jbHVkZSAibG9nLmgiCiAjaW5jbHVk
ZSAiZmluZC5oIgogI2luY2x1ZGUgImZpbGVtYW5pcC5oIgotI2luY2x1ZGUg
Im1vdW50LmgiCisjaW5jbHVkZSAiaW9fc3RyZWFtLmgiCiAjaW5jbHVkZSAi
Y2hvb3NlLmgiCiAKICNpbmNsdWRlICJwb3J0LmgiCkBAIC0xNDAsMTAgKzE0
MCw5IEBAIHNldF9hY3Rpb24gKFBhY2thZ2UgKiBwa2csIGJvb2wgcHJlaW5j
KQogCSAgICByZXR1cm47CiAJICB9CiAJLyogdGhlIHBhc3NlZCBpbiB0cnVz
dCBsZXZlbCBpcyBtaXNzaW5nLi4uICovCi0JaWYgKCFwcmVpbmMgLyogYXV0
byBzZXQgKi8KLQkgICAgJiYgcGtnLT5pbnN0YWxsZWQgCi0JICAgICYmIHBr
Zy0+YWN0aW9uID4gQUNUSU9OX0NVUlIpIC8qIFRoZXJlIGlzIG5vIGN1cnJl
bnQgdmVyc2lvbiAqLwotCSAgICAoaW50KXBrZy0+YWN0aW9uID0gQUNUSU9O
X1NBTUVfQ1VSUjsKKwlpZiAoIXByZWluYwkJLyogYXV0byBzZXQgKi8KKwkg
ICAgJiYgcGtnLT5pbnN0YWxsZWQgJiYgcGtnLT5hY3Rpb24gPiBBQ1RJT05f
Q1VSUikJLyogVGhlcmUgaXMgbm8gY3VycmVudCB2ZXJzaW9uICovCisJICAo
aW50KSBwa2ctPmFjdGlvbiA9IEFDVElPTl9TQU1FX0NVUlI7CiAJYnJlYWs7
CiAJLyogQUNUSU9OX1NBTUVfKiBhcmUgdXNlZCB3aGVuIHRoZSBpbnN0YWxs
ZWQgdmVyc2lvbiBpcyB0aGUgc2FtZQogCSAgIGFzIHRoZSBnaXZlbiBhY3Rp
b24uICovCkBAIC05NjMsOCArOTYyLDggQEAgX3ZpZXc6Omluc2VydF91bmRl
ciAoaW50IGxpbmVuLCBwaWNrX2xpbgogICAgIHsKICAgICAgIGlmIChsaW5l
c1tuXS5nZXRfY2F0ZWdvcnkgKCkgfHwgKGxpbmVzW25dLmdldF9wa2cgKCkK
IAkJCQkgICAgICAgJiYgc3RyY2FzZWNtcCAobGluZS5nZXRfcGtnICgpLT5u
YW1lLAotCQkJCQkJICAgICAgbGluZXNbbl0uZ2V0X3BrZyAoKS0+Ci0JCQkJ
CQkgICAgICBuYW1lKSA8IDApKQorCQkJCQkJICAgICAgbGluZXNbbl0uCisJ
CQkJCQkgICAgICBnZXRfcGtnICgpLT5uYW1lKSA8IDApKQogCXsKIAkgIGlu
c2VydF9hdCAobiwgbGluZSk7CiAJICBuID0gbmxpbmVzOwpAQCAtMTAzMiw5
ICsxMDMxLDEwIEBAIF92aWV3OjpjbGljayAoaW50IHJvdywgaW50IHgpCiAJ
CXsKIAkJICBpZiAobGluZXNbbl0uZ2V0X2NhdGVnb3J5ICgpIHx8IChsaW5l
c1tuXS5nZXRfcGtnICgpCiAJCQkJCQkgICAmJiBzdHJjYXNlY21wIChwa2ct
Pm5hbWUsCi0JCQkJCQkJCSAgbGluZXNbbl0uCi0JCQkJCQkJCSAgZ2V0X3Br
ZyAoKS0+Ci0JCQkJCQkJCSAgbmFtZSkgPCAwKSkKKwkJCQkJCQkJICBsaW5l
cworCQkJCQkJCQkgIFtuXS5nZXRfcGtnCisJCQkJCQkJCSAgKCktPm5hbWUp
IDwKKwkJCQkJCSAgIDApKQogCQkgICAgewogCQkgICAgICBpbnNlcnRfYXQg
KG4sIGxpbmUpOwogCQkgICAgICBuID0gbmxpbmVzOwpAQCAtMTE1OCw3ICsx
MTU4LDggQEAgY3JlYXRlX2xpc3R2aWV3IChIV05EIGRsZywgUkVDVCAqIHIp
CiAgIGRlZmF1bHRfdHJ1c3QgKGx2LCBUUlVTVF9DVVJSKTsKICAgc2V0X3Zp
ZXdfbW9kZSAobHYsIFZJRVdfQ0FURUdPUlkpOwogICBpZiAoIVNldERsZ0l0
ZW1UZXh0IChkbGcsIElEQ19DSE9PU0VfVklFV0NBUFRJT04sIGNob29zZXIt
Pm1vZGVfY2FwdGlvbiAoKSkpCi0gICAgbG9nIChMT0dfQkFCQkxFLCAiRmFp
bGVkIHRvIHNldCBWaWV3IGJ1dHRvbiBjYXB0aW9uICVsZCIsIEdldExhc3RF
cnJvciAoKSk7CisgICAgbG9nIChMT0dfQkFCQkxFLCAiRmFpbGVkIHRvIHNl
dCBWaWV3IGJ1dHRvbiBjYXB0aW9uICVsZCIsCisJIEdldExhc3RFcnJvciAo
KSk7CiAgIGZvciAoUGFja2FnZSAqIGZvbyA9IHBhY2thZ2U7IGZvby0+bmFt
ZTsgZm9vKyspCiAgICAgYWRkX3JlcXVpcmVkIChmb28pOwogICBzdGF0aWMg
aW50IHRhW10gPSB7IElEQ19DSE9PU0VfQ1VSUiwgMCB9OwpAQCAtMTUyMCwx
NyArMTUyMSwxNiBAQCBfSW5mbzo6X0luZm8gKGNvbnN0IGNoYXIgKl9pbnN0
YWxsLCBjb25zCiBzdGF0aWMgdm9pZAogcmVhZF9pbnN0YWxsZWRfZGIgKCkK
IHsKLSAgaWYgKCFnZXRfcm9vdF9kaXIgKCkpCi0gICAgcmV0dXJuOwotCiAg
IGNoYXIgbGluZVsxMDAwXSwgcGtnbmFtZVsxMDAwXSwgaW5zdFsxMDAwXSwg
c3JjWzEwMDBdOwogICBpbnQgaW5zdHN6LCBzcmNzejsKIAotICBGSUxFICpk
YiA9IGZvcGVuIChjeWdwYXRoICgiL2V0Yy9zZXR1cC9pbnN0YWxsZWQuZGIi
LCAwKSwgInJ0Iik7CisgIGlvX3N0cmVhbSAqZGIgPQorICAgIGlvX3N0cmVh
bTo6b3BlbiAoY29uY2F0ICgiY3lnZmlsZTovLyIsICIvZXRjL3NldHVwL2lu
c3RhbGxlZC5kYiIsIDApLAorCQkgICAgICJydCIpOwogICBpZiAoIWRiKQog
ICAgIHJldHVybjsKIAotICB3aGlsZSAoZmdldHMgKGxpbmUsIDEwMDAsIGRi
KSkKKyAgd2hpbGUgKGRiLT5nZXRzIChsaW5lLCAxMDAwKSkKICAgICB7CiAg
ICAgICBpbnQgcGFyc2VhYmxlOwogICAgICAgc3JjWzBdID0gMDsKQEAgLTE1
NzAsNyArMTU3MCw3IEBAIHJlYWRfaW5zdGFsbGVkX2RiICgpCiAJICAgICAg
YnJlYWs7CiAJICAgIH0KICAgICB9Ci0gIGZjbG9zZSAoZGIpOworICBkZWxl
dGUgZGI7CiB9CiAKIGludApJbmRleDogY2hvb3NlLmgKPT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PQpSQ1MgZmlsZTogL2N2cy9zcmMvc3JjL3dpbnN1cC9jaW5z
dGFsbC9jaG9vc2UuaCx2CnJldHJpZXZpbmcgcmV2aXNpb24gMi4zCmRpZmYg
LXUgLXAgLXIyLjMgY2hvb3NlLmgKLS0tIGNob29zZS5oCTIwMDEvMTEvMDkg
MTQ6MTI6MDAJMi4zCisrKyBjaG9vc2UuaAkyMDAxLzExLzExIDA2OjU0OjU1
CkBAIC00NSw3ICs0NSw4IEBAIHR5cGVkZWYgZW51bQogICBBQ1RJT05fU0FN
RV9URVNUID0gQUNUSU9OX1RFU1QgKyBBQ1RJT05fU0FNRSwKICAgLyogTGFz
dCBhY3Rpb24uICovCiAgIEFDVElPTl9TQU1FX0xBU1QKLX0gYWN0aW9uczsK
K30KK2FjdGlvbnM7CiAKIHR5cGVkZWYgZW51bQogewpAQCAtNTQsNyArNTUs
OCBAQCB0eXBlZGVmIGVudW0KICAgVklFV19QQUNLQUdFLAogICBWSUVXX0NB
VEVHT1JZLAogICBOVklFVwotfSB2aWV3czsKK30KK3ZpZXdzOwogCiBzdHJ1
Y3QgX2hlYWRlcgogewpAQCAtNzAsNDYgKzcyLDU1IEBAIHR5cGVkZWYgY2xh
c3MgX3ZpZXcgdmlldzsKIAogY2xhc3MgcGlja19saW5lCiB7Ci0gIHB1Ymxp
YzoKLSAgICB2b2lkIHNldF9saW5lIChQYWNrYWdlICpfcGtnKTsKLSAgICB2
b2lkIHNldF9saW5lIChDYXRlZ29yeSAqX2NhdCk7Ci0gICAgdm9pZCBwYWlu
dCAoSERDIGhkYywgaW50IHgsIGludCB5LCBpbnQgcm93LCBpbnQgc2hvd19j
YXQpOwotICAgIFBhY2thZ2UgKmdldF9wa2cgKHZvaWQpIHsgcmV0dXJuIHBr
ZzsgfTsKLSAgICBDYXRlZ29yeSAqZ2V0X2NhdGVnb3J5ICh2b2lkKSB7IHJl
dHVybiBjYXQ7IH07Ci0gICAgaW50IGNsaWNrIChpbnQgeCk7Ci0gIHByaXZh
dGU6Ci0gICAgUGFja2FnZSAqcGtnOwotICAgIENhdGVnb3J5ICpjYXQ7Citw
dWJsaWM6CisgIHZvaWQgc2V0X2xpbmUgKFBhY2thZ2UgKiBfcGtnKTsKKyAg
dm9pZCBzZXRfbGluZSAoQ2F0ZWdvcnkgKiBfY2F0KTsKKyAgdm9pZCBwYWlu
dCAoSERDIGhkYywgaW50IHgsIGludCB5LCBpbnQgcm93LCBpbnQgc2hvd19j
YXQpOworICBQYWNrYWdlICpnZXRfcGtnICh2b2lkKQorICB7CisgICAgcmV0
dXJuIHBrZzsKKyAgfTsKKyAgQ2F0ZWdvcnkgKmdldF9jYXRlZ29yeSAodm9p
ZCkKKyAgeworICAgIHJldHVybiBjYXQ7CisgIH07CisgIGludCBjbGljayAo
aW50IHgpOworcHJpdmF0ZToKKyAgICBQYWNrYWdlICogcGtnOworICBDYXRl
Z29yeSAqY2F0OwogfTsKIAogY2xhc3MgX3ZpZXcKIHsKLSAgcHVibGljOgot
ICAgIGludCBudW1fY29sdW1uczsKLSAgICB2aWV3cyBnZXRfdmlld19tb2Rl
ICgpIHsgcmV0dXJuIHZpZXdfbW9kZTsgfTsKLSAgICB2b2lkIHNldF92aWV3
X21vZGUodmlld3MgX21vZGUpOwotICAgIHN0cnVjdCBfaGVhZGVyICpoZWFk
ZXJzOworcHVibGljOgorICBpbnQgbnVtX2NvbHVtbnM7CisgIHZpZXdzIGdl
dF92aWV3X21vZGUgKCkKKyAgeworICAgIHJldHVybiB2aWV3X21vZGU7Cisg
IH07CisgIHZvaWQgc2V0X3ZpZXdfbW9kZSAodmlld3MgX21vZGUpOworICBz
dHJ1Y3QgX2hlYWRlciAqaGVhZGVyczsKICAgICBfdmlldyAodmlld3MgbW9k
ZSwgSERDIGRjKTsKLSAgICBjb25zdCBjaGFyICptb2RlX2NhcHRpb24gKCk7
Ci0gICAgdm9pZCBpbnNlcnRfcGtnIChQYWNrYWdlICopOwotICAgIHZvaWQg
aW5zZXJ0X2NhdGVnb3J5IChDYXRlZ29yeSAqLCBpbnQpOwotICAgIHZvaWQg
Y2xlYXJfdmlldyAodm9pZCk7Ci0gICAgaW50IGNsaWNrIChpbnQgcm93LCBp
bnQgeCk7Ci0gICAgaW50IGN1cnJlbnRfY29sOwotICAgIGludCBuZXdfY29s
OwotICAgIGludCBzcmNfY29sOwotICAgIGludCBjYXRfY29sOwotICAgIGlu
dCBwa2dfY29sOwotICAgIGludCBsYXN0X2NvbDsKLSAgICBwaWNrX2xpbmUg
KiBsaW5lczsKLSAgICBpbnQgbmxpbmVzOworICBjb25zdCBjaGFyICptb2Rl
X2NhcHRpb24gKCk7CisgIHZvaWQgaW5zZXJ0X3BrZyAoUGFja2FnZSAqKTsK
KyAgdm9pZCBpbnNlcnRfY2F0ZWdvcnkgKENhdGVnb3J5ICosIGludCk7Cisg
IHZvaWQgY2xlYXJfdmlldyAodm9pZCk7CisgIGludCBjbGljayAoaW50IHJv
dywgaW50IHgpOworICBpbnQgY3VycmVudF9jb2w7CisgIGludCBuZXdfY29s
OworICBpbnQgc3JjX2NvbDsKKyAgaW50IGNhdF9jb2w7CisgIGludCBwa2df
Y29sOworICBpbnQgbGFzdF9jb2w7CisgIHBpY2tfbGluZSAqbGluZXM7Cisg
IGludCBubGluZXM7CiAKLSAgcHJpdmF0ZToKK3ByaXZhdGU6CiAgICAgdmll
d3Mgdmlld19tb2RlOwotICAgIHZvaWQgc2V0X2hlYWRlcnMgKHZvaWQpOwot
ICAgIHZvaWQgaW5pdF9oZWFkZXJzIChIREMgZGMpOwotICAgIHZvaWQgaW5z
ZXJ0X2F0IChpbnQsIHBpY2tfbGluZSk7Ci0gICAgdm9pZCBpbnNlcnRfdW5k
ZXIgKGludCBsaW5lbiwgcGlja19saW5lIGxpbmUpOyAKKyAgdm9pZCBzZXRf
aGVhZGVycyAodm9pZCk7CisgIHZvaWQgaW5pdF9oZWFkZXJzIChIREMgZGMp
OworICB2b2lkIGluc2VydF9hdCAoaW50LCBwaWNrX2xpbmUpOworICB2b2lk
IGluc2VydF91bmRlciAoaW50IGxpbmVuLCBwaWNrX2xpbmUgbGluZSk7CiAK
IH07CiAjZW5kaWYgLyogX19jcGx1c3BsdXMgKi8KSW5kZXg6IGNvbmNhdC5j
Ywo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09ClJDUyBmaWxlOiAvY3ZzL3NyYy9z
cmMvd2luc3VwL2NpbnN0YWxsL2NvbmNhdC5jYyx2CnJldHJpZXZpbmcgcmV2
aXNpb24gMi4yCmRpZmYgLXUgLXAgLXIyLjIgY29uY2F0LmNjCi0tLSBjb25j
YXQuY2MJMjAwMS8wNS8yNyAwNzowNTowOQkyLjIKKysrIGNvbmNhdC5jYwky
MDAxLzExLzExIDA2OjU0OjU1CkBAIC0xNiw4ICsxNiwxMiBAQAogLyogU2Vl
IGNvbmNhdC5oLiAgTm90ZSB0aGF0IHdlIGNhbm9uaWNhbGl6ZSB0aGUgcmVz
dWx0LCB0aGlzIGF2b2lkcwogICAgbXVsdGlwbGUgc2xhc2hlcyBiZWluZyBp
bnRlcnByZXRlZCBhcyBVTkNzLiAqLwogCi1zdGF0aWMgY2hhciAqY3ZzaWQg
PSAiXG4lJSUgJElkOiBjb25jYXQuY2MsdiAyLjIgMjAwMS8wNS8yNyAwNzow
NTowOSBjZ2YgRXhwICRcbiI7CisjaWYgMAorc3RhdGljIGNvbnN0IGNoYXIg
KmN2c2lkID0KKyAgIlxuJSUlICRJZDogY29uY2F0LmNjLHYgMi4yIDIwMDEv
MDUvMjcgMDc6MDU6MDkgY2dmIEV4cCAkXG4iOworI2VuZGlmCiAKKwogI2lu
Y2x1ZGUgPHN0ZGFyZy5oPgogI2luY2x1ZGUgPHN0ZGxpYi5oPgogI2luY2x1
ZGUgPHN0cmluZy5oPgpAQCAtNjEsMTIgKzY1LDEyIEBAIHZjb25jYXQgKGNv
bnN0IGNoYXIgKnMsIHZhX2xpc3QgdikKICAgc3RyY3B5IChydiwgcyk7CiAg
IHYgPSBzYXZlX3Y7CiAgIHdoaWxlICgxKQotICB7Ci0gICAgYXJnID0gdmFf
YXJnICh2LCBjaGFyICopOwotICAgIGlmIChhcmcgPT0gMCkKLSAgICAgIGJy
ZWFrOwotICAgIHN0cmNhdCAocnYsIGFyZyk7Ci0gIH0KKyAgICB7CisgICAg
ICBhcmcgPSB2YV9hcmcgKHYsIGNoYXIgKik7CisgICAgICBpZiAoYXJnID09
IDApCisJYnJlYWs7CisgICAgICBzdHJjYXQgKHJ2LCBhcmcpOworICAgIH0K
ICAgdmFfZW5kICh2KTsKIAogICBjaGFyICpkLCAqcDsKSW5kZXg6IGNvbmNh
dC5oCj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT0KUkNTIGZpbGU6IC9jdnMvc3Jj
L3NyYy93aW5zdXAvY2luc3RhbGwvY29uY2F0LmgsdgpyZXRyaWV2aW5nIHJl
dmlzaW9uIDIuMQpkaWZmIC11IC1wIC1yMi4xIGNvbmNhdC5oCi0tLSBjb25j
YXQuaAkyMDAxLzA1LzExIDAxOjQwOjM2CTIuMQorKysgY29uY2F0LmgJMjAw
MS8xMS8xMSAwNjo1NDo1NQpAQCAtMjAsMTIgKzIwLDEyIEBACiAgICBuYW1l
IG9yIFVSTCwgYW5kIHdpbGwgY2Fub25pY2FsaXplIHRoZSByZXN1bHQgYWNj
b3JkaW5nbHkKICAgIChpLmUuIHJlcGxhY2UgXCB3aXRoIC8sIGNvbGxhcHNl
IG11bHRpcGxlIC8vLyB0byBhIHNpbmdsZSAvLCBldGMuKSAgKi8KIAotY2hh
ciAqIGNvbmNhdCAoY29uc3QgY2hhciAqcywgLi4uKTsKLWNoYXIgKiB2Y29u
Y2F0IChjb25zdCBjaGFyICosIHZhX2xpc3QpOworY2hhciAqY29uY2F0IChj
b25zdCBjaGFyICpzLCAuLi4pOworY2hhciAqdmNvbmNhdCAoY29uc3QgY2hh
ciAqLCB2YV9saXN0KTsKIAogLyogY29udmVydCBzbGFzaGVzIHRvIGJhY2tz
bGFzaGVzICovCiAKLWNoYXIgKiBiYWNrc2xhc2ggKGNoYXIgKnMpOworY2hh
ciAqYmFja3NsYXNoIChjaGFyICpzKTsKIAogLyogVXNlZCB3aGVuIHRyZWF0
aW5nIC8gYW5kIFwgYXMgZXF1aXZhbGVudC4gKi8KICNkZWZpbmUgU0xBU0hf
UChjaCkgXApJbmRleDogZGVza3RvcC5jYwo9PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09ClJDUyBmaWxlOiAvY3ZzL3NyYy9zcmMvd2luc3VwL2NpbnN0YWxsL2Rl
c2t0b3AuY2MsdgpyZXRyaWV2aW5nIHJldmlzaW9uIDIuMTMKZGlmZiAtdSAt
cCAtcjIuMTMgZGVza3RvcC5jYwotLS0gZGVza3RvcC5jYwkyMDAxLzEwLzI3
IDE1OjU2OjQ2CTIuMTMKKysrIGRlc2t0b3AuY2MJMjAwMS8xMS8xMSAwNjo1
NDo1NQpAQCAtMTgsNyArMTgsMTAgQEAKICAgIHRoYXQgdW5saWtlIG90aGVy
IGRvXyogZnVuY3Rpb25zLCB0aGlzIG9uZSBpcyBjYWxsZWQgZGlyZWN0bHkg
ZnJvbQogICAgaW5zdGFsbC5jYyAqLwogCi1zdGF0aWMgY2hhciAqY3ZzaWQg
PSAiXG4lJSUgJElkOiBkZXNrdG9wLmNjLHYgMi4xMyAyMDAxLzEwLzI3IDE1
OjU2OjQ2IGNnZiBFeHAgJFxuIjsKKyNpZiAwCitzdGF0aWMgY29uc3QgY2hh
ciAqY3ZzaWQgPQorICAiXG4lJSUgJElkOiBkZXNrdG9wLmNjLHYgMi4xMyAy
MDAxLzEwLzI3IDE1OjU2OjQ2IGNnZiBFeHAgJFxuIjsKKyNlbmRpZgogCiAj
aW5jbHVkZSAid2luMzIuaCIKICNpbmNsdWRlIDxzaGxvYmouaD4KQEAgLTM5
LDkgKzQyLDcgQEAgc3RhdGljIGNoYXIgKmN2c2lkID0gIlxuJSUlICRJZDog
ZGVza3RvcAogCiAjaW5jbHVkZSAicG9ydC5oIgogCi1leHRlcm4gIkMiIHsK
LSAgdm9pZCBtYWtlX2xpbmtfMiAoY2hhciAqZXhlcGF0aCwgY2hhciAqYXJn
cywgY2hhciAqaWNvbiwgY2hhciAqbG5hbWUpOwotfTsKKyNpbmNsdWRlICJt
a2xpbmsyLmgiCiAKIHN0YXRpYyBPU1ZFUlNJT05JTkZPIHZlcmluZm87CiAK
QEAgLTUzLDcgKzU0LDcgQEAgc3RhdGljIE9TVkVSU0lPTklORk8gdmVyaW5m
bzsKIAlAKgogICAgKi8KIAotc3RhdGljIGNoYXIgKmV0Y19wcm9maWxlW10g
PSB7CitzdGF0aWMgY29uc3QgY2hhciAqZXRjX3Byb2ZpbGVbXSA9IHsKICAg
IlBBVEg9XCIvdXNyL2xvY2FsL2JpbjovdXNyL2JpbjovYmluOiRQQVRIXCIi
LAogICAiIiwKICAgIlVTRVI9XCJgaWQgLXVuYFwiIiwKQEAgLTkzLDc5ICs5
NCw4MyBAQCBzdGF0aWMgY2hhciAqYmF0bmFtZTsKIHN0YXRpYyBjaGFyICpp
Y29ubmFtZTsKIAogc3RhdGljIHZvaWQKLW1ha2VfbGluayAoY2hhciAqbGlu
a3BhdGgsIGNoYXIgKnRpdGxlLCBjaGFyICp0YXJnZXQpCittYWtlX2xpbmsg
KGNvbnN0IGNoYXIgKmxpbmtwYXRoLCBjb25zdCBjaGFyICp0aXRsZSwgY29u
c3QgY2hhciAqdGFyZ2V0KQogewogICBjaGFyIGFyZ2J1ZltfTUFYX1BBVEhd
OwogICBjaGFyICpmbmFtZSA9IGNvbmNhdCAobGlua3BhdGgsICIvIiwgdGl0
bGUsICIubG5rIiwgMCk7CiAKICAgaWYgKF9hY2Nlc3MgKGZuYW1lLCAwKSA9
PSAwKQotICAgIHJldHVybjsgLyogYWxyZWFkeSBleGlzdHMgKi8KKyAgICBy
ZXR1cm47CQkJLyogYWxyZWFkeSBleGlzdHMgKi8KIAogICBtc2cgKCJtYWtl
X2xpbmsgJXMsICVzLCAlc1xuIiwgZm5hbWUsIHRpdGxlLCB0YXJnZXQpOwog
CiAgIG1rZGlyX3AgKDAsIGZuYW1lKTsKIAotICBjaGFyICpleGVwYXRoLCAq
YXJnczsKKyAgY2hhciAqZXhlcGF0aDsKIAogICAvKiBJZiB3ZSBhcmUgcnVu
bmluZyBXaW45eCwgYnVpbGQgYSBjb21tYW5kIGxpbmUuICovCiAgIGlmICh2
ZXJpbmZvLmR3UGxhdGZvcm1JZCA9PSBWRVJfUExBVEZPUk1fV0lOMzJfTlQp
CiAgICAgewotICAgICAgZXhlcGF0aCA9IHRhcmdldDsKLSAgICAgIGFyZ3Mg
PSAiIjsKKyAgICAgIGV4ZXBhdGggPSBjb25jYXQgKHRhcmdldCwgMCk7Cisg
ICAgICBzcHJpbnRmIChhcmdidWYsICIgIik7CiAgICAgfQogICBlbHNlCiAg
ICAgewotICAgICAgY2hhciAqcGNjbWQ7CiAgICAgICBjaGFyIHdpbmRpcltN
QVhfUEFUSF07CiAKICAgICAgIEdldFdpbmRvd3NEaXJlY3RvcnkgKHdpbmRp
ciwgc2l6ZW9mICh3aW5kaXIpKTsKICAgICAgIGV4ZXBhdGggPSBjb25jYXQg
KHdpbmRpciwgQ09NTUFORDlYRVhFLCAwKTsKICAgICAgIHNwcmludGYgKGFy
Z2J1ZiwgIiVzICVzIiwgQ09NTUFORDlYQVJHUywgdGFyZ2V0KTsKLSAgICAg
IGFyZ3MgPSBhcmdidWY7CiAgICAgfQogCi0gIG1zZyAoIm1ha2VfbGlua18y
ICglcywgJXMsICVzLCAlcykiLCBleGVwYXRoLCBhcmdzLCBpY29ubmFtZSwg
Zm5hbWUpOwotICBtYWtlX2xpbmtfMiAoZXhlcGF0aCwgYXJncywgaWNvbm5h
bWUsIGZuYW1lKTsKKyAgbXNnICgibWFrZV9saW5rXzIgKCVzLCAlcywgJXMs
ICVzKSIsIGV4ZXBhdGgsIGFyZ2J1ZiwgaWNvbm5hbWUsIGZuYW1lKTsKKyAg
bWFrZV9saW5rXzIgKGV4ZXBhdGgsIGFyZ2J1ZiwgaWNvbm5hbWUsIGZuYW1l
KTsKIH0KIAogc3RhdGljIHZvaWQKLXN0YXJ0X21lbnUgKGNoYXIgKnRpdGxl
LCBjaGFyICp0YXJnZXQpCitzdGFydF9tZW51IChjb25zdCBjaGFyICp0aXRs
ZSwgY29uc3QgY2hhciAqdGFyZ2V0KQogewogICBjaGFyIHBhdGhbX01BWF9Q
QVRIXTsKICAgTFBJVEVNSURMSVNUIGlkOwogICBpbnQgaXNzeXN0ZW0gPSAo
cm9vdF9zY29wZSA9PSBJRENfUk9PVF9TWVNURU0pID8gMSA6IDA7Ci0gIFNI
R2V0U3BlY2lhbEZvbGRlckxvY2F0aW9uIChOVUxMLCBpc3N5c3RlbSA/IENT
SURMX0NPTU1PTl9QUk9HUkFNUyA6IENTSURMX1BST0dSQU1TLCAmaWQpOwor
ICBTSEdldFNwZWNpYWxGb2xkZXJMb2NhdGlvbiAoTlVMTCwKKwkJCSAgICAg
IGlzc3lzdGVtID8gQ1NJRExfQ09NTU9OX1BST0dSQU1TIDoKKwkJCSAgICAg
IENTSURMX1BST0dSQU1TLCAmaWQpOwogICBTSEdldFBhdGhGcm9tSURMaXN0
IChpZCwgcGF0aCk7CiAvLyBmb2xsb3dpbmcgbGluZXMgYWRkZWQgYmVjYXVz
ZSBpdCBhcHBlYXJzIFdpbjk1IGRvZXMgbm90IHVzZSBjb21tb24gcHJvZ3Jh
bXMKIC8vIHVubGVzcyBpdCBjb21lcyBpbnRvIHBsYXkgd2hlbiBtdWx0aXBs
ZSB1c2VycyBmb3IgV2luOTUgaXMgZW5hYmxlZAotICBtc2coIlByb2dyYW0g
ZGlyZWN0b3J5IGZvciBwcm9ncmFtIGxpbms6ICVzIixwYXRoKTsKLSAgaWYg
KCBzdHJsZW4ocGF0aCkgPT0gMCkgewotICAgICBTSEdldFNwZWNpYWxGb2xk
ZXJMb2NhdGlvbiAoTlVMTCwgQ1NJRExfUFJPR1JBTVMsICZpZCk7Ci0gICAg
IFNIR2V0UGF0aEZyb21JRExpc3QgKGlkLCBwYXRoKTsKLSAgICAgbXNnKCJQ
cm9ncmFtIGRpcmVjdG9yeSBmb3IgcHJvZ3JhbSBsaW5rIGNoYW5nZWQgdG86
ICVzIixwYXRoKTsKLSAgfQorICBtc2cgKCJQcm9ncmFtIGRpcmVjdG9yeSBm
b3IgcHJvZ3JhbSBsaW5rOiAlcyIsIHBhdGgpOworICBpZiAoc3RybGVuIChw
YXRoKSA9PSAwKQorICAgIHsKKyAgICAgIFNIR2V0U3BlY2lhbEZvbGRlckxv
Y2F0aW9uIChOVUxMLCBDU0lETF9QUk9HUkFNUywgJmlkKTsKKyAgICAgIFNI
R2V0UGF0aEZyb21JRExpc3QgKGlkLCBwYXRoKTsKKyAgICAgIG1zZyAoIlBy
b2dyYW0gZGlyZWN0b3J5IGZvciBwcm9ncmFtIGxpbmsgY2hhbmdlZCB0bzog
JXMiLCBwYXRoKTsKKyAgICB9CiAvLyBlbmQgb2YgV2luOTUgYWRkaXRpb24K
ICAgc3RyY2F0IChwYXRoLCAiL0N5Z251cyBTb2x1dGlvbnMiKTsKICAgbWFr
ZV9saW5rIChwYXRoLCB0aXRsZSwgdGFyZ2V0KTsKIH0KIAogc3RhdGljIHZv
aWQKLWRlc2t0b3BfaWNvbiAoY2hhciAqdGl0bGUsIGNoYXIgKnRhcmdldCkK
K2Rlc2t0b3BfaWNvbiAoY29uc3QgY2hhciAqdGl0bGUsIGNvbnN0IGNoYXIg
KnRhcmdldCkKIHsKICAgY2hhciBwYXRoW19NQVhfUEFUSF07CiAgIExQSVRF
TUlETElTVCBpZDsKICAgaW50IGlzc3lzdGVtID0gKHJvb3Rfc2NvcGUgPT0g
SURDX1JPT1RfU1lTVEVNKSA/IDEgOiAwOwogICAvL1NIR2V0U3BlY2lhbEZv
bGRlckxvY2F0aW9uIChOVUxMLCBpc3N5c3RlbSA/IENTSURMX0RFU0tUT1Ag
OiBDU0lETF9DT01NT05fREVTS1RPUERJUkVDVE9SWSwgJmlkKTsKLSAgU0hH
ZXRTcGVjaWFsRm9sZGVyTG9jYXRpb24gKE5VTEwsIGlzc3lzdGVtID8gQ1NJ
RExfQ09NTU9OX0RFU0tUT1BESVJFQ1RPUlkgOiBDU0lETF9ERVNLVE9QRElS
RUNUT1JZLCAmaWQpOworICBTSEdldFNwZWNpYWxGb2xkZXJMb2NhdGlvbiAo
TlVMTCwKKwkJCSAgICAgIGlzc3lzdGVtID8gQ1NJRExfQ09NTU9OX0RFU0tU
T1BESVJFQ1RPUlkgOgorCQkJICAgICAgQ1NJRExfREVTS1RPUERJUkVDVE9S
WSwgJmlkKTsKICAgU0hHZXRQYXRoRnJvbUlETGlzdCAoaWQsIHBhdGgpOwog
Ly8gZm9sbG93aW5nIGxpbmVzIGFkZGVkIGJlY2F1c2UgaXQgYXBwZWFycyBX
aW45NSBkb2VzIG5vdCB1c2UgY29tbW9uIHByb2dyYW1zCiAvLyB1bmxlc3Mg
aXQgY29tZXMgaW50byBwbGF5IHdoZW4gbXVsdGlwbGUgdXNlcnMgZm9yIFdp
bjk1IGlzIGVuYWJsZWQKLSAgbXNnKCJEZXNrdG9wIGRpcmVjdG9yeSBmb3Ig
ZGVza3RvcCBsaW5rOiAlcyIscGF0aCk7Ci0gIGlmICggc3RybGVuKHBhdGgp
ID09IDApIHsKLSAgICAgU0hHZXRTcGVjaWFsRm9sZGVyTG9jYXRpb24gKE5V
TEwsIENTSURMX0RFU0tUT1BESVJFQ1RPUlksICZpZCk7Ci0gICAgIFNIR2V0
UGF0aEZyb21JRExpc3QgKGlkLCBwYXRoKTsKLSAgICAgbXNnKCJEZXNrdG9w
IGRpcmVjdG9yeSBmb3IgZGVza29wIGxpbmsgY2hhbmdlZCB0bzogJXMiLHBh
dGgpOwotICB9CisgIG1zZyAoIkRlc2t0b3AgZGlyZWN0b3J5IGZvciBkZXNr
dG9wIGxpbms6ICVzIiwgcGF0aCk7CisgIGlmIChzdHJsZW4gKHBhdGgpID09
IDApCisgICAgeworICAgICAgU0hHZXRTcGVjaWFsRm9sZGVyTG9jYXRpb24g
KE5VTEwsIENTSURMX0RFU0tUT1BESVJFQ1RPUlksICZpZCk7CisgICAgICBT
SEdldFBhdGhGcm9tSURMaXN0IChpZCwgcGF0aCk7CisgICAgICBtc2cgKCJE
ZXNrdG9wIGRpcmVjdG9yeSBmb3IgZGVza29wIGxpbmsgY2hhbmdlZCB0bzog
JXMiLCBwYXRoKTsKKyAgICB9CiAvLyBlbmQgb2YgV2luOTUgYWRkaXRpb24K
ICAgbWFrZV9saW5rIChwYXRoLCB0aXRsZSwgdGFyZ2V0KTsKIH0KQEAgLTE4
Niw3ICsxOTEsOCBAQCBtYWtlX2N5Z3dpbl9iYXQgKCkKICAgZnByaW50ZiAo
YmF0LCAiQGVjaG8gb2ZmXG5cbiIpOwogCiAgIGZwcmludGYgKGJhdCwgIiUu
MnNcbiIsIGdldF9yb290X2RpciAoKSk7Ci0gIGZwcmludGYgKGJhdCwgImNo
ZGlyICVzXG5cbiIsIGJhY2tzbGFzaCAoY29uY2F0IChnZXRfcm9vdF9kaXIg
KCkgKyAyLCAiL2JpbiIsIDApKSk7CisgIGZwcmludGYgKGJhdCwgImNoZGly
ICVzXG5cbiIsCisJICAgYmFja3NsYXNoIChjb25jYXQgKGdldF9yb290X2Rp
ciAoKSArIDIsICIvYmluIiwgMCkpKTsKIAogICBmcHJpbnRmIChiYXQsICJi
YXNoIC0tbG9naW4gLWlcbiIpOwogCkBAIC0yMDUsMTggKzIxMSwxOCBAQCBt
YWtlX2V0Y19wcm9maWxlICgpCiAgIGNoYXIgb3M7CiAgIHN3aXRjaCAodmVy
aW5mby5kd1BsYXRmb3JtSWQpCiAgICAgewotICAgICAgY2FzZSBWRVJfUExB
VEZPUk1fV0lOMzJfTlQ6Ci0Jb3MgPSAnTic7Ci0JYnJlYWs7Ci0gICAgICBj
YXNlIFZFUl9QTEFURk9STV9XSU4zMl9XSU5ET1dTOgotCWlmICh2ZXJpbmZv
LmR3TWlub3JWZXJzaW9uID09IDApCi0JICBvcyA9ICc1JzsKLQllbHNlCi0J
ICBvcyA9ICc4JzsKLQlicmVhazsKLSAgICAgIGRlZmF1bHQ6Ci0Jb3MgPSAn
Pyc7Ci0JYnJlYWs7CisgICAgY2FzZSBWRVJfUExBVEZPUk1fV0lOMzJfTlQ6
CisgICAgICBvcyA9ICdOJzsKKyAgICAgIGJyZWFrOworICAgIGNhc2UgVkVS
X1BMQVRGT1JNX1dJTjMyX1dJTkRPV1M6CisgICAgICBpZiAodmVyaW5mby5k
d01pbm9yVmVyc2lvbiA9PSAwKQorCW9zID0gJzUnOworICAgICAgZWxzZQor
CW9zID0gJzgnOworICAgICAgYnJlYWs7CisgICAgZGVmYXVsdDoKKyAgICAg
IG9zID0gJz8nOworICAgICAgYnJlYWs7CiAgICAgfQogICBtc2cgKCJvcyBp
cyAlYyIsIG9zKTsKIApAQCAtMjI0LDE0ICsyMzAsMTQgQEAgbWFrZV9ldGNf
cHJvZmlsZSAoKQogICBpZiAoIXApCiAgICAgcmV0dXJuOwogCi0gIGludCBp
LCBhbGxvdz0xOwotICBmb3IgKGk9MDsgZXRjX3Byb2ZpbGVbaV07IGkrKykK
KyAgaW50IGksIGFsbG93ID0gMTsKKyAgZm9yIChpID0gMDsgZXRjX3Byb2Zp
bGVbaV07IGkrKykKICAgICB7CiAgICAgICBpZiAoZXRjX3Byb2ZpbGVbaV1b
MF0gPT0gJ0AnKQogCXsKIAkgIGFsbG93ID0gMDsKIAkgIG1zZyAoInByb2Zp
bGU6ICVzIiwgZXRjX3Byb2ZpbGVbaV0pOwotCSAgZm9yIChjaGFyICpjcCA9
IGV0Y19wcm9maWxlW2ldKzE7ICpjcDsgY3ArKykKKwkgIGZvciAoY29uc3Qg
Y2hhciAqY3AgPSBldGNfcHJvZmlsZVtpXSArIDE7ICpjcDsgY3ArKykKIAkg
ICAgaWYgKCpjcCA9PSBvcyB8fCAqY3AgPT0gJyonKQogCSAgICAgIGFsbG93
ID0gMTsKIAkgIG1zZyAoImFsbG93IGlzICVkXG4iLCBhbGxvdyk7CkBAIC0y
NDQsNyArMjUwLDcgQEAgbWFrZV9ldGNfcHJvZmlsZSAoKQogfQogCiBzdGF0
aWMgaW50Ci11ZXhpc3RzIChjaGFyICpwYXRoKQordWV4aXN0cyAoY29uc3Qg
Y2hhciAqcGF0aCkKIHsKICAgY2hhciAqZiA9IGN5Z3BhdGggKHBhdGgsIDAp
OwogICBpbnQgYSA9IF9hY2Nlc3MgKGYsIDApOwpAQCAtMjY2LDEyICsyNzIs
MTIgQEAgbWFrZV9wYXNzd2RfZ3JvdXAgKCkKICAgaWYgKHZlcmluZm8uZHdQ
bGF0Zm9ybUlkICE9IFZFUl9QTEFURk9STV9XSU4zMl9OVCkKICAgICB7CiAg
ICAgICBQYWNrYWdlICpwa2cgPSBnZXRwa2dieW5hbWUgKCJjeWd3aW4iKTsK
LSAgICAgIGlmIChwa2cgJiYgaXNfZG93bmxvYWRfYWN0aW9uIChwa2cpICYm
Ci0JICBwa2ctPmFjdGlvbiAhPSBBQ1RJT05fU1JDX09OTFkpCisgICAgICBp
ZiAocGtnICYmIGlzX2Rvd25sb2FkX2FjdGlvbiAocGtnKSAmJiBwa2ctPmFj
dGlvbiAhPSBBQ1RJT05fU1JDX09OTFkpCiAJewogCSAgLyogbWtwYXNzd2Qg
YW5kIG1rZ3JvdXAgYXJlIG5vdCB3b3JraW5nIG9uIDl4L01FIHVwIHRvIDEu
MS41LTQgKi8KIAkgIGNoYXIgKmJvcmRlcl92ZXJzaW9uID0gY2Fub25pY2Fs
aXplX3ZlcnNpb24gKCIxLjEuNS00Iik7Ci0JICBjaGFyICppbnN0X3ZlcnNp
b24gPSBjYW5vbmljYWxpemVfdmVyc2lvbiAocGtnLT5pbmZvW3BrZy0+dHJ1
c3RdLnZlcnNpb24pOworCSAgY2hhciAqaW5zdF92ZXJzaW9uID0KKwkgICAg
Y2Fub25pY2FsaXplX3ZlcnNpb24gKHBrZy0+aW5mb1twa2ctPnRydXN0XS52
ZXJzaW9uKTsKIAkgIGlmIChzdHJjbXAgKGluc3RfdmVyc2lvbiwgYm9yZGVy
X3ZlcnNpb24pIDw9IDApCiAJICAgIGdvdG8gb3V0OwogCX0KQEAgLTI4NSw3
ICsyOTEsNyBAQCBtYWtlX3Bhc3N3ZF9ncm91cCAoKQogICBpZiAoIXVleGlz
dHMgKCIvZXRjL2dyb3VwIikpCiAgICAgZnByaW50ZiAocCwgImJpblxcbWtn
cm91cCAtbCA+IGV0Y1xcZ3JvdXBcbiIpOwogCi0gb3V0Ogorb3V0OgogICBm
Y2xvc2UgKHApOwogfQogCkBAIC0zMTIsMjEgKzMxOCwyMyBAQCBzYXZlX2lj
b24gKCkKIH0KIAogc3RhdGljIHZvaWQKLWRvX2Rlc2t0b3Bfc2V0dXAoKQor
ZG9fZGVza3RvcF9zZXR1cCAoKQogewogICBzYXZlX2ljb24gKCk7CiAKICAg
bWFrZV9jeWd3aW5fYmF0ICgpOwogICBtYWtlX2V0Y19wcm9maWxlICgpOwog
ICBtYWtlX3Bhc3N3ZF9ncm91cCAoKTsKKworICBpZiAocm9vdF9tZW51KQor
ICAgIHsKKyAgICAgIHN0YXJ0X21lbnUgKCJDeWd3aW4gQmFzaCBTaGVsbCIs
IGJhdG5hbWUpOworICAgIH0KIAotICBpZiAocm9vdF9tZW51KSB7Ci0gICAg
c3RhcnRfbWVudSAoIkN5Z3dpbiBCYXNoIFNoZWxsIiwgYmF0bmFtZSk7Ci0g
IH0KLQotICBpZiAocm9vdF9kZXNrdG9wKSB7Ci0gICAgZGVza3RvcF9pY29u
ICgiQ3lnd2luIiwgYmF0bmFtZSk7Ci0gIH0KKyAgaWYgKHJvb3RfZGVza3Rv
cCkKKyAgICB7CisgICAgICBkZXNrdG9wX2ljb24gKCJDeWd3aW4iLCBiYXRu
YW1lKTsKKyAgICB9CiB9CiAKIHN0YXRpYyBpbnQgZGFbXSA9IHsgSURDX1JP
T1RfREVTS1RPUCwgMCB9OwpAQCAtMzQ2LDYxICszNTQsNjkgQEAgbG9hZF9k
aWFsb2cgKEhXTkQgaCkKICAgY2hlY2tfaWZfZW5hYmxlX25leHQgKGgpOwog
fQogCi1zdGF0aWMgaW50IGNoZWNrX2Rlc2t0b3AgKGNoYXIgKnRpdGxlLCBj
aGFyICp0YXJnZXQpCitzdGF0aWMgaW50CitjaGVja19kZXNrdG9wIChjb25z
dCBjaGFyICp0aXRsZSwgY29uc3QgY2hhciAqdGFyZ2V0KQogewogICBjaGFy
IHBhdGhbX01BWF9QQVRIXTsKICAgTFBJVEVNSURMSVNUIGlkOwogICBpbnQg
aXNzeXN0ZW0gPSAocm9vdF9zY29wZSA9PSBJRENfUk9PVF9TWVNURU0pID8g
MSA6IDA7Ci0gIFNIR2V0U3BlY2lhbEZvbGRlckxvY2F0aW9uIChOVUxMLCBp
c3N5c3RlbSA/IENTSURMX0NPTU1PTl9ERVNLVE9QRElSRUNUT1JZIDogQ1NJ
RExfREVTS1RPUERJUkVDVE9SWSwgJmlkKTsKKyAgU0hHZXRTcGVjaWFsRm9s
ZGVyTG9jYXRpb24gKE5VTEwsCisJCQkgICAgICBpc3N5c3RlbSA/IENTSURM
X0NPTU1PTl9ERVNLVE9QRElSRUNUT1JZIDoKKwkJCSAgICAgIENTSURMX0RF
U0tUT1BESVJFQ1RPUlksICZpZCk7CiAgIFNIR2V0UGF0aEZyb21JRExpc3Qg
KGlkLCBwYXRoKTsKICAgLy8gZm9sbG93aW5nIGxpbmVzIGFkZGVkIGJlY2F1
c2UgaXQgYXBwZWFycyBXaW45NSBkb2VzIG5vdCB1c2UgY29tbW9uIHByb2dy
YW1zCiAgIC8vIHVubGVzcyBpdCBjb21lcyBpbnRvIHBsYXkgd2hlbiBtdWx0
aXBsZSB1c2VycyBmb3IgV2luOTUgaXMgZW5hYmxlZAotICBtc2cgKCJEZXNr
dG9wIGRpcmVjdG9yeSBmb3IgZGVza3RvcCBsaW5rOiAlcyIscGF0aCk7Ci0g
IGlmIChzdHJsZW4gKHBhdGgpID09IDApIHsKLSAgICAgU0hHZXRTcGVjaWFs
Rm9sZGVyTG9jYXRpb24gKE5VTEwsIENTSURMX0RFU0tUT1BESVJFQ1RPUlks
ICZpZCk7Ci0gICAgIFNIR2V0UGF0aEZyb21JRExpc3QgKGlkLCBwYXRoKTsK
LSAgICAgbXNnICgiRGVza3RvcCBkaXJlY3RvcnkgZm9yIGRlc2tvcCBsaW5r
IGNoYW5nZWQgdG86ICVzIixwYXRoKTsKLSAgfQorICBtc2cgKCJEZXNrdG9w
IGRpcmVjdG9yeSBmb3IgZGVza3RvcCBsaW5rOiAlcyIsIHBhdGgpOworICBp
ZiAoc3RybGVuIChwYXRoKSA9PSAwKQorICAgIHsKKyAgICAgIFNIR2V0U3Bl
Y2lhbEZvbGRlckxvY2F0aW9uIChOVUxMLCBDU0lETF9ERVNLVE9QRElSRUNU
T1JZLCAmaWQpOworICAgICAgU0hHZXRQYXRoRnJvbUlETGlzdCAoaWQsIHBh
dGgpOworICAgICAgbXNnICgiRGVza3RvcCBkaXJlY3RvcnkgZm9yIGRlc2tv
cCBsaW5rIGNoYW5nZWQgdG86ICVzIiwgcGF0aCk7CisgICAgfQogICAvLyBl
bmQgb2YgV2luOTUgYWRkaXRpb24KICAgY2hhciAqZm5hbWUgPSBjb25jYXQg
KHBhdGgsICIvIiwgdGl0bGUsICIubG5rIiwgMCk7CiAKICAgaWYgKF9hY2Nl
c3MgKGZuYW1lLCAwKSA9PSAwKQotICAgIHJldHVybiAwOyAvKiBhbHJlYWR5
IGV4aXN0cyAqLworICAgIHJldHVybiAwOwkJCS8qIGFscmVhZHkgZXhpc3Rz
ICovCiAKLSAgZm5hbWUgPSBjb25jYXQgKHBhdGgsICIvIiwgdGl0bGUsICIu
cGlmIiwgMCk7IC8qIGNoZWNrIGZvciBhIHBpZiBhcyB3ZWxsICovCisgIGZu
YW1lID0gY29uY2F0IChwYXRoLCAiLyIsIHRpdGxlLCAiLnBpZiIsIDApOwkv
KiBjaGVjayBmb3IgYSBwaWYgYXMgd2VsbCAqLwogCiAgIGlmIChfYWNjZXNz
IChmbmFtZSwgMCkgPT0gMCkKLSAgICByZXR1cm4gMDsgLyogYWxyZWFkeSBl
eGlzdHMgKi8KKyAgICByZXR1cm4gMDsJCQkvKiBhbHJlYWR5IGV4aXN0cyAq
LwogCiAgIHJldHVybiBJRENfUk9PVF9ERVNLVE9QOwogfQogCi1zdGF0aWMg
aW50IGNoZWNrX3N0YXJ0bWVudSAoY2hhciAqdGl0bGUsIGNoYXIgKnRhcmdl
dCkKK3N0YXRpYyBpbnQKK2NoZWNrX3N0YXJ0bWVudSAoY29uc3QgY2hhciAq
dGl0bGUsIGNvbnN0IGNoYXIgKnRhcmdldCkKIHsKICAgY2hhciBwYXRoW19N
QVhfUEFUSF07CiAgIExQSVRFTUlETElTVCBpZDsKICAgaW50IGlzc3lzdGVt
ID0gKHJvb3Rfc2NvcGUgPT0gSURDX1JPT1RfU1lTVEVNKSA/IDEgOiAwOwot
ICBTSEdldFNwZWNpYWxGb2xkZXJMb2NhdGlvbiAoTlVMTCwgaXNzeXN0ZW0g
PyBDU0lETF9DT01NT05fUFJPR1JBTVMgOiBDU0lETF9QUk9HUkFNUywgJmlk
KTsKKyAgU0hHZXRTcGVjaWFsRm9sZGVyTG9jYXRpb24gKE5VTEwsCisJCQkg
ICAgICBpc3N5c3RlbSA/IENTSURMX0NPTU1PTl9QUk9HUkFNUyA6CisJCQkg
ICAgICBDU0lETF9QUk9HUkFNUywgJmlkKTsKICAgU0hHZXRQYXRoRnJvbUlE
TGlzdCAoaWQsIHBhdGgpOwogICAvLyBmb2xsb3dpbmcgbGluZXMgYWRkZWQg
YmVjYXVzZSBpdCBhcHBlYXJzIFdpbjk1IGRvZXMgbm90IHVzZSBjb21tb24g
cHJvZ3JhbXMKICAgLy8gdW5sZXNzIGl0IGNvbWVzIGludG8gcGxheSB3aGVu
IG11bHRpcGxlIHVzZXJzIGZvciBXaW45NSBpcyBlbmFibGVkCi0gIG1zZyAo
IlByb2dyYW0gZGlyZWN0b3J5IGZvciBwcm9ncmFtIGxpbms6ICVzIixwYXRo
KTsKLSAgaWYgKHN0cmxlbiAocGF0aCkgPT0gMCkgewotICAgICBTSEdldFNw
ZWNpYWxGb2xkZXJMb2NhdGlvbiAoTlVMTCwgQ1NJRExfUFJPR1JBTVMsICZp
ZCk7Ci0gICAgIFNIR2V0UGF0aEZyb21JRExpc3QgKGlkLCBwYXRoKTsKLSAg
ICAgbXNnICgiUHJvZ3JhbSBkaXJlY3RvcnkgZm9yIHByb2dyYW0gbGluayBj
aGFuZ2VkIHRvOiAlcyIscGF0aCk7Ci0gIH0KKyAgbXNnICgiUHJvZ3JhbSBk
aXJlY3RvcnkgZm9yIHByb2dyYW0gbGluazogJXMiLCBwYXRoKTsKKyAgaWYg
KHN0cmxlbiAocGF0aCkgPT0gMCkKKyAgICB7CisgICAgICBTSEdldFNwZWNp
YWxGb2xkZXJMb2NhdGlvbiAoTlVMTCwgQ1NJRExfUFJPR1JBTVMsICZpZCk7
CisgICAgICBTSEdldFBhdGhGcm9tSURMaXN0IChpZCwgcGF0aCk7CisgICAg
ICBtc2cgKCJQcm9ncmFtIGRpcmVjdG9yeSBmb3IgcHJvZ3JhbSBsaW5rIGNo
YW5nZWQgdG86ICVzIiwgcGF0aCk7CisgICAgfQogICAvLyBlbmQgb2YgV2lu
OTUgYWRkaXRpb24KICAgc3RyY2F0IChwYXRoLCAiL0N5Z251cyBTb2x1dGlv
bnMiKTsKICAgY2hhciAqZm5hbWUgPSBjb25jYXQgKHBhdGgsICIvIiwgdGl0
bGUsICIubG5rIiwgMCk7CiAKICAgaWYgKF9hY2Nlc3MgKGZuYW1lLCAwKSA9
PSAwKQotICAgIHJldHVybiAwOyAvKiBhbHJlYWR5IGV4aXN0cyAqLworICAg
IHJldHVybiAwOwkJCS8qIGFscmVhZHkgZXhpc3RzICovCiAKLSAgZm5hbWUg
PSBjb25jYXQgKHBhdGgsICIvIiwgdGl0bGUsICIucGlmIiwgMCk7IC8qIGNo
ZWNrIGZvciBhIHBpZiBhcyB3ZWxsICovCisgIGZuYW1lID0gY29uY2F0IChw
YXRoLCAiLyIsIHRpdGxlLCAiLnBpZiIsIDApOwkvKiBjaGVjayBmb3IgYSBw
aWYgYXMgd2VsbCAqLwogCiAgIGlmIChfYWNjZXNzIChmbmFtZSwgMCkgPT0g
MCkKLSAgICByZXR1cm4gMDsgLyogYWxyZWFkeSBleGlzdHMgKi8KKyAgICBy
ZXR1cm4gMDsJCQkvKiBhbHJlYWR5IGV4aXN0cyAqLwogCiAgIHJldHVybiBJ
RENfUk9PVF9NRU5VOwogfQpAQCAtNDA4LDcgKzQyNCw3IEBAIHN0YXRpYyBp
bnQgY2hlY2tfc3RhcnRtZW51IChjaGFyICp0aXRsZSwKIHN0YXRpYyB2b2lk
CiBzYXZlX2RpYWxvZyAoSFdORCBoKQogewotICByb290X2Rlc2t0b3A9IHJi
Z2V0IChoLCBkYSk7CisgIHJvb3RfZGVza3RvcCA9IHJiZ2V0IChoLCBkYSk7
CiAgIHJvb3RfbWVudSA9IHJiZ2V0IChoLCBtYSk7CiB9CiAKQEAgLTQyNiw3
ICs0NDIsNyBAQCBkaWFsb2dfY21kIChIV05EIGgsIGludCBpZCwgSFdORCBo
d25kY3RsCiAKICAgICBjYXNlIElET0s6CiAgICAgICBzYXZlX2RpYWxvZyAo
aCk7Ci0gICAgICBkb19kZXNrdG9wX3NldHVwKCk7CisgICAgICBkb19kZXNr
dG9wX3NldHVwICgpOwogICAgICAgTkVYVCAoSUREX1NfUE9TVElOU1RBTEwp
OwogICAgICAgYnJlYWs7CiAKQEAgLTQzOSw2ICs0NTUsNyBAQCBkaWFsb2df
Y21kIChIV05EIGgsIGludCBpZCwgSFdORCBod25kY3RsCiAgICAgICBORVhU
ICgwKTsKICAgICAgIGJyZWFrOwogICAgIH0KKyAgcmV0dXJuIDA7CiB9CiAK
IHN0YXRpYyBCT09MIENBTExCQUNLCkBAIC00NjMsOCArNDgwLDExIEBAIGRv
X2Rlc2t0b3AgKEhJTlNUQU5DRSBoKQogICB2ZXJpbmZvLmR3T1NWZXJzaW9u
SW5mb1NpemUgPSBzaXplb2YgKHZlcmluZm8pOwogICBHZXRWZXJzaW9uRXgg
KCZ2ZXJpbmZvKTsKIAotICByb290X2Rlc2t0b3AgPSBjaGVja19kZXNrdG9w
KCJDeWd3aW4iLGJhY2tzbGFzaCAoY3lncGF0aCAoIi9jeWd3aW4uYmF0Iiwg
MCkpKTsKLSAgcm9vdF9tZW51ID0gY2hlY2tfc3RhcnRtZW51KCJDeWd3aW4g
QmFzaCBTaGVsbCIsYmFja3NsYXNoIChjeWdwYXRoICgiL2N5Z3dpbi5iYXQi
LCAwKSkpOworICByb290X2Rlc2t0b3AgPQorICAgIGNoZWNrX2Rlc2t0b3Ag
KCJDeWd3aW4iLCBiYWNrc2xhc2ggKGN5Z3BhdGggKCIvY3lnd2luLmJhdCIs
IDApKSk7CisgIHJvb3RfbWVudSA9CisgICAgY2hlY2tfc3RhcnRtZW51ICgi
Q3lnd2luIEJhc2ggU2hlbGwiLAorCQkgICAgIGJhY2tzbGFzaCAoY3lncGF0
aCAoIi9jeWd3aW4uYmF0IiwgMCkpKTsKIAogICBpbnQgcnYgPSAwOwogCklu
ZGV4OiBkaWFsb2cuY2MKPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQpSQ1MgZmls
ZTogL2N2cy9zcmMvc3JjL3dpbnN1cC9jaW5zdGFsbC9kaWFsb2cuY2Msdgpy
ZXRyaWV2aW5nIHJldmlzaW9uIDIuMwpkaWZmIC11IC1wIC1yMi4zIGRpYWxv
Zy5jYwotLS0gZGlhbG9nLmNjCTIwMDEvMDUvMjcgMDc6MDU6MDkJMi4zCisr
KyBkaWFsb2cuY2MJMjAwMS8xMS8xMSAwNjo1NDo1NQpAQCAtMTYsNyArMTYs
MTAgQEAKIC8qIFRoZSBwdXJwb3NlIG9mIHRoaXMgZmlsZSBpcyB0byBwcm92
aWRlIGNvbW1vbiBmdW5jdGlvbmFsaXR5IGZvcgogICAgYWxsIHRoZSBkaWFs
b2dzIGluIHRoZSBwcm9ncmFtLiAqLwogCi1zdGF0aWMgY2hhciAqY3ZzaWQg
PSAiXG4lJSUgJElkOiBkaWFsb2cuY2MsdiAyLjMgMjAwMS8wNS8yNyAwNzow
NTowOSBjZ2YgRXhwICRcbiI7CisjaWYgMAorc3RhdGljIGNvbnN0IGNoYXIg
KmN2c2lkID0KKyAgIlxuJSUlICRJZDogZGlhbG9nLmNjLHYgMi4zIDIwMDEv
MDUvMjcgMDc6MDU6MDkgY2dmIEV4cCAkXG4iOworI2VuZGlmCiAKICNpbmNs
dWRlICJ3aW4zMi5oIgogI2luY2x1ZGUgPHN0ZGlvLmg+CkBAIC02MCwxNCAr
NjMsMTQgQEAgZXNldCAoSFdORCBoLCBpbnQgaWQsIGNvbnN0IGNoYXIgKnZh
bCkKIHZvaWQKIGVzZXQgKEhXTkQgaCwgaW50IGlkLCBpbnQgdmFsKQogewot
ICBTZXREbGdJdGVtSW50IChoLCBpZCwgKFVJTlQpdmFsLCBUUlVFKTsKKyAg
U2V0RGxnSXRlbUludCAoaCwgaWQsIChVSU5UKSB2YWwsIFRSVUUpOwogfQog
CiBpbnQKIHJiZ2V0IChIV05EIGgsIGludCAqaWRzKQogewogICBpbnQgaTsK
LSAgZm9yIChpPTA7IGlkc1tpXTsgaSsrKQorICBmb3IgKGkgPSAwOyBpZHNb
aV07IGkrKykKICAgICBpZiAoSXNEbGdCdXR0b25DaGVja2VkIChoLCBpZHNb
aV0pID09IEJTVF9DSEVDS0VEKQogICAgICAgcmV0dXJuIGlkc1tpXTsKICAg
cmV0dXJuIDA7CkBAIC03NywyMiArODAsMTcgQEAgdm9pZAogcmJzZXQgKEhX
TkQgaCwgaW50ICppZHMsIGludCBpZCkKIHsKICAgaW50IGk7Ci0gIGZvciAo
aT0wOyBpZHNbaV07IGkrKykKLSAgICBDaGVja0RsZ0J1dHRvbiAoaCwgaWRz
W2ldLCBpZD09aWRzW2ldID8gQlNUX0NIRUNLRUQgOiBCU1RfVU5DSEVDS0VE
KTsKKyAgZm9yIChpID0gMDsgaWRzW2ldOyBpKyspCisgICAgQ2hlY2tEbGdC
dXR0b24gKGgsIGlkc1tpXSwgaWQgPT0gaWRzW2ldID8gQlNUX0NIRUNLRUQg
OiBCU1RfVU5DSEVDS0VEKTsKIH0KIAogdm9pZAotZmF0YWwgKGNoYXIgKm1z
ZykKK2ZhdGFsIChjb25zdCBjaGFyICptc2cpCiB7CiAgIERXT1JEIGUgPSBH
ZXRMYXN0RXJyb3IgKCk7CiAgIGNoYXIgKmJ1ZjsKICAgRm9ybWF0TWVzc2Fn
ZSAoRk9STUFUX01FU1NBR0VfQUxMT0NBVEVfQlVGRkVSIHwgRk9STUFUX01F
U1NBR0VfRlJPTV9TWVNURU0sCi0JCSAwLAotCQkgZSwKLQkJIDAsCi0JCSAo
Q0hBUiAqKSZidWYsCi0JCSAwLAotCQkgMCk7CisJCSAwLCBlLCAwLCAoQ0hB
UiAqKSAmIGJ1ZiwgMCwgMCk7CiAgIE1lc3NhZ2VCb3ggKDAsIGJ1ZiwgbXNn
LCAwKTsKICAgZXhpdF9zZXR1cCAoMSk7CiB9CkluZGV4OiBkaWFsb2cuaAo9
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09ClJDUyBmaWxlOiAvY3ZzL3NyYy9zcmMv
d2luc3VwL2NpbnN0YWxsL2RpYWxvZy5oLHYKcmV0cmlldmluZyByZXZpc2lv
biAyLjMKZGlmZiAtdSAtcCAtcjIuMyBkaWFsb2cuaAotLS0gZGlhbG9nLmgJ
MjAwMS8wNS8yNyAwNzowNTowOQkyLjMKKysrIGRpYWxvZy5oCTIwMDEvMTEv
MTEgMDY6NTQ6NTUKQEAgLTI2LDIwICsyNiwyMCBAQCBleHRlcm4gaW50IGV4
aXRfbXNnOwogCiAvKiBwcm90b3R5cGVzIGZvciBhbGwgdGhlIGRvXyogZnVu
Y3Rpb25zIChtb3N0IGNhbGxlZCBieSBtYWluLmNjKSAqLwogCi1EKGRvX2No
b29zZSk7Ci1EKGRvX2Rlc2t0b3ApOwotRChkb19kb3dubG9hZCk7Ci1EKGRv
X2Zyb21jd2QpOwotRChkb19pbmkpOwotRChkb19pbnN0YWxsKTsKLUQoZG9f
bG9jYWxfZGlyKTsKLUQoZG9fbmV0KTsKLUQoZG9fb3RoZXIpOwotRChkb19w
b3N0aW5zdGFsbCk7Ci1EKGRvX3Jvb3QpOwotRChkb19zaXRlKTsKLUQoZG9f
c291cmNlKTsKLUQoZG9fc3BsYXNoKTsKK0QgKGRvX2Nob29zZSk7CitEIChk
b19kZXNrdG9wKTsKK0QgKGRvX2Rvd25sb2FkKTsKK0QgKGRvX2Zyb21jd2Qp
OworRCAoZG9faW5pKTsKK0QgKGRvX2luc3RhbGwpOworRCAoZG9fbG9jYWxf
ZGlyKTsKK0QgKGRvX25ldCk7CitEIChkb19vdGhlcik7CitEIChkb19wb3N0
aW5zdGFsbCk7CitEIChkb19yb290KTsKK0QgKGRvX3NpdGUpOworRCAoZG9f
c291cmNlKTsKK0QgKGRvX3NwbGFzaCk7CiAKICN1bmRlZiBECiAKQEAgLTQ4
LDI1ICs0OCwyNSBAQCBEKGRvX3NwbGFzaCk7CiAKIC8qIEdldCB0aGUgdmFs
dWUgb2YgYW4gRWRpdFRleHQgY29udHJvbC4gIFBhc3MgdGhlIHByZXZpb3Vz
bHkgc3RvcmVkCiAgICB2YWx1ZSBhbmQgaXQgd2lsbCBmcmVlIHRoZSBtZW1v
cnkgaWYgbmVlZGVkLiAqLwotIAorCiBjaGFyICplZ2V0IChIV05EIGgsIGlu
dCBpZCwgY2hhciAqdmFyKTsKIAogLyogU2FtZSwgYnV0IGNvbnZlcnQgdGhl
IHZhbHVlIHRvIGFuIGludGVnZXIgKi8KIAotaW50ICAgZWdldCAoSFdORCBo
LCBpbnQgaWQpOworaW50IGVnZXQgKEhXTkQgaCwgaW50IGlkKTsKIAogLyog
U2V0IHRoZSBFZGl0VGV4dCBjb250cm9sIHRvIHRoZSBnaXZlbiBzdHJpbmcg
b3IgaW50ZWdlciAqLwogCi12b2lkICBlc2V0IChIV05EIGgsIGludCBpZCwg
Y29uc3QgY2hhciAqdmFyKTsKLXZvaWQgIGVzZXQgKEhXTkQgaCwgaW50IGlk
LCBpbnQgdmFyKTsKK3ZvaWQgZXNldCAoSFdORCBoLCBpbnQgaWQsIGNvbnN0
IGNoYXIgKnZhcik7Cit2b2lkIGVzZXQgKEhXTkQgaCwgaW50IGlkLCBpbnQg
dmFyKTsKIAogLyogUmFkaW9CdXR0b25zLiAgaWRzIGlzIGEgbnVsbC10ZXJt
aW5hdGVkIGxpc3Qgb2YgSURzLiAgR2V0CiAgICByZXR1cm5zIHRoZSBzZWxl
Y3RlZCBJRCAob3IgemVybyksIHBhc3MgYW4gSUQgdG8gc2V0ICovCiAKLWlu
dCAgIHJiZ2V0IChIV05EIGgsIGludCAqaWRzKTsKLXZvaWQgIHJic2V0IChI
V05EIGgsIGludCAqaWRzLCBpbnQgaWQpOworaW50IHJiZ2V0IChIV05EIGgs
IGludCAqaWRzKTsKK3ZvaWQgcmJzZXQgKEhXTkQgaCwgaW50ICppZHMsIGlu
dCBpZCk7CiAKIC8qICpUaGlzKiB2ZXJzaW9uIG9mIGZhdGFsIChjb21wYXJl
IHdpdGggbXNnLmgpIHVzZXMgR2V0TGFzdEVycm9yKCkgdG8KICAgIGZvcm1h
dCBhIHN1aXRhYmxlIGVycm9yIG1lc3NhZ2UuICBTaW1pbGFyIHRvIHBlcnJv
cigpICovCiAKLXZvaWQgZmF0YWwgKGNoYXIgKm1zZyk7Cit2b2lkIGZhdGFs
IChjb25zdCBjaGFyICptc2cpIF9fYXR0cmlidXRlX18gKChub3JldHVybikp
OwpJbmRleDogZGlza2Z1bGwuY2MKPT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQpS
Q1MgZmlsZTogL2N2cy9zcmMvc3JjL3dpbnN1cC9jaW5zdGFsbC9kaXNrZnVs
bC5jYyx2CnJldHJpZXZpbmcgcmV2aXNpb24gMi4xCmRpZmYgLXUgLXAgLXIy
LjEgZGlza2Z1bGwuY2MKLS0tIGRpc2tmdWxsLmNjCTIwMDEvMDUvMjcgMDc6
MDU6MDkJMi4xCisrKyBkaXNrZnVsbC5jYwkyMDAxLzExLzExIDA2OjU0OjU1
CkBAIC0xOCwxNCArMTgsMTcgQEAKICAgIGhhbmRsZSBkaXNrcyBiaWdnZXIg
dGhhbiAyRywgYW5kIGEgbmV3IEFQSSB0aGF0IGlzbid0IGFsd2F5cwogICAg
YXZhaWxhYmxlLiAqLwogCi1zdGF0aWMgY2hhciAqY3ZzaWQgPSAiXG4lJSUg
JElkOiBkaXNrZnVsbC5jYyx2IDIuMSAyMDAxLzA1LzI3IDA3OjA1OjA5IGNn
ZiBFeHAgJFxuIjsKKyNpZiAwCitzdGF0aWMgY29uc3QgY2hhciAqY3ZzaWQg
PQorICAiXG4lJSUgJElkOiBkaXNrZnVsbC5jYyx2IDIuMSAyMDAxLzA1LzI3
IDA3OjA1OjA5IGNnZiBFeHAgJFxuIjsKKyNlbmRpZgogCiAjaW5jbHVkZSAi
d2luMzIuaCIKIAogI2luY2x1ZGUgImRpc2tmdWxsLmgiCiAKLXR5cGVkZWYg
ICBCT09MIFdJTkFQSSAoKkdERlMpKExQQ1RTVFIsIFBVTEFSR0VfSU5URUdF
UiwgUFVMQVJHRV9JTlRFR0VSLAotCQkJICAgICAgUFVMQVJHRV9JTlRFR0VS
KTsKK3R5cGVkZWYgQk9PTCBXSU5BUEkgKCpHREZTKSAoTFBDVFNUUiwgUFVM
QVJHRV9JTlRFR0VSLCBQVUxBUkdFX0lOVEVHRVIsCisJCQkgICAgIFBVTEFS
R0VfSU5URUdFUik7CiAKIGludAogZGlza2Z1bGwgKGNvbnN0IGNoYXIgKnBh
dGgpCkBAIC00Myw3ICs0Niw3IEBAIGRpc2tmdWxsIChjb25zdCBjaGFyICpw
YXRoKQogCSAgaWYgKGdkZnMgKHBhdGgsICZhdmFpbCwgJnRvdGFsLCAmZnJl
ZSkpCiAJICAgIHsKIAkgICAgICBpbnQgcGVyYyA9IGF2YWlsLlF1YWRQYXJ0
ICogMTAwIC8gdG90YWwuUXVhZFBhcnQ7Ci0JICAgICAgcmV0dXJuIDEwMC1w
ZXJjOworCSAgICAgIHJldHVybiAxMDAgLSBwZXJjOwogCSAgICB9CiAJfQog
ICAgIH0KQEAgLTYyLDcgKzY1LDcgQEAgZGlza2Z1bGwgKGNvbnN0IGNoYXIg
KnBhdGgpCiAgIGlmIChHZXREaXNrRnJlZVNwYWNlIChyb290LCAmanVuaywg
Jmp1bmssICZmcmVlX2NsdXN0ZXJzLCAmdG90YWxfY2x1c3RlcnMpKQogICAg
IHsKICAgICAgIGludCBwZXJjID0gZnJlZV9jbHVzdGVycyAqIDEwMCAvIHRv
dGFsX2NsdXN0ZXJzOwotICAgICAgcmV0dXJuIDEwMC1wZXJjOworICAgICAg
cmV0dXJuIDEwMCAtIHBlcmM7CiAgICAgfQogCiAgIHJldHVybiAwOwpJbmRl
eDogZG93bmxvYWQuY2MKPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQpSQ1MgZmls
ZTogL2N2cy9zcmMvc3JjL3dpbnN1cC9jaW5zdGFsbC9kb3dubG9hZC5jYyx2
CnJldHJpZXZpbmcgcmV2aXNpb24gMi4xMgpkaWZmIC11IC1wIC1yMi4xMiBk
b3dubG9hZC5jYwotLS0gZG93bmxvYWQuY2MJMjAwMS8wNi8xMyAxNjoxMTow
MQkyLjEyCisrKyBkb3dubG9hZC5jYwkyMDAxLzExLzExIDA2OjU0OjU1CkBA
IC0xNiw3ICsxNiwxMCBAQAogLyogVGhlIHB1cnBvc2Ugb2YgdGhpcyBmaWxl
IGlzIHRvIGRvd25sb2FkIGFsbCB0aGUgZmlsZXMgd2UgbmVlZCB0bwogICAg
ZG8gdGhlIGluc3RhbGxhdGlvbi4gKi8KIAotc3RhdGljIGNoYXIgKmN2c2lk
ID0gIlxuJSUlICRJZDogZG93bmxvYWQuY2MsdiAyLjEyIDIwMDEvMDYvMTMg
MTY6MTE6MDEgY2dmIEV4cCAkXG4iOworI2lmIDAKK3N0YXRpYyBjb25zdCBj
aGFyICpjdnNpZCA9CisgICJcbiUlJSAkSWQ6IGRvd25sb2FkLmNjLHYgMi4x
MiAyMDAxLzA2LzEzIDE2OjExOjAxIGNnZiBFeHAgJFxuIjsKKyNlbmRpZgog
CiAjaW5jbHVkZSAid2luMzIuaCIKIApAQCAtMzQsOCArMzcsNyBAQCBzdGF0
aWMgY2hhciAqY3ZzaWQgPSAiXG4lJSUgJElkOiBkb3dubG9hCiAjaW5jbHVk
ZSAibG9nLmgiCiAjaW5jbHVkZSAicG9ydC5oIgogCi1EV09SRAotZ2V0X2Zp
bGVfc2l6ZSAoY29uc3QgY2hhciAqbmFtZSkKK0RXT1JEIGdldF9maWxlX3Np
emUgKGNvbnN0IGNoYXIgKm5hbWUpCiB7CiAgIEhBTkRMRSBoOwogICBXSU4z
Ml9GSU5EX0RBVEEgYnVmOwpAQCAtNTIsMjIgKzU0LDIwIEBAIGdldF9maWxl
X3NpemUgKGNvbnN0IGNoYXIgKm5hbWUpCiB9CiAKIHN0YXRpYyBpbnQKLWRv
d25sb2FkX29uZSAoY2hhciAqbmFtZSwgaW50IGV4cGVjdGVkX3NpemUsIGlu
dCBhY3Rpb24pCitkb3dubG9hZF9vbmUgKGNoYXIgKm5hbWUsIHVuc2lnbmVk
IGludCBleHBlY3RlZF9zaXplLCBpbnQgYWN0aW9uKQogewogICBjaGFyICps
b2NhbCA9IG5hbWU7Ci0gIGludCBlcnJvcnMgPSAwOwogCiAgIERXT1JEIHNp
emU7CiAgIGlmICgoc2l6ZSA9IGdldF9maWxlX3NpemUgKGxvY2FsKSkgPiAw
KQogICAgIGlmIChzaXplID09IGV4cGVjdGVkX3NpemUgJiYgYWN0aW9uICE9
IEFDVElPTl9TUkNfT05MWQotICAmJiBhY3Rpb24gIT0gQUNUSU9OX1JFRE8g
KQorCSYmIGFjdGlvbiAhPSBBQ1RJT05fUkVETykKICAgICAgIHJldHVybiAw
OwogCiAgIG1rZGlyX3AgKDAsIGxvY2FsKTsKIAogICBpZiAoZ2V0X3VybF90
b19maWxlIChjb25jYXQgKE1JUlJPUl9TSVRFLCAiLyIsIG5hbWUsIDApLAot
CQkgICAgICAgY29uY2F0IChsb2NhbCwgIi50bXAiLCAwKSwKLQkJICAgICAg
IGV4cGVjdGVkX3NpemUpKQorCQkgICAgICAgY29uY2F0IChsb2NhbCwgIi50
bXAiLCAwKSwgZXhwZWN0ZWRfc2l6ZSkpCiAgICAgewogICAgICAgbm90ZSAo
SURTX0RPV05MT0FEX0ZBSUxFRCwgbmFtZSk7CiAgICAgICByZXR1cm4gMTsK
QEAgLTc4LDEzICs3OCwxMyBAQCBkb3dubG9hZF9vbmUgKGNoYXIgKm5hbWUs
IGludCBleHBlY3RlZF9zCiAgICAgICBpZiAoc2l6ZSA9PSBleHBlY3RlZF9z
aXplKQogCXsKIAkgIGxvZyAoMCwgIkRvd25sb2FkZWQgJXMiLCBsb2NhbCk7
Ci0gICAgaWYgKCBfYWNjZXNzIChsb2NhbCAsIDApID09IDApCi0gICAgICAg
cmVtb3ZlICggbG9jYWwgKTsKKwkgIGlmIChfYWNjZXNzIChsb2NhbCwgMCkg
PT0gMCkKKwkgICAgcmVtb3ZlIChsb2NhbCk7CiAJICByZW5hbWUgKGNvbmNh
dCAobG9jYWwsICIudG1wIiwgMCksIGxvY2FsKTsKIAl9CiAgICAgICBlbHNl
CiAJewotCSAgbG9nICgwLCAiRG93bmxvYWQgJXMgd3Jvbmcgc2l6ZSAoJWQg
YWN0dWFsIHZzICVkIGV4cGVjdGVkKSIsCisJICBsb2cgKDAsICJEb3dubG9h
ZCAlcyB3cm9uZyBzaXplICglbGQgYWN0dWFsIHZzICVkIGV4cGVjdGVkKSIs
CiAJICAgICAgIGxvY2FsLCBzaXplLCBleHBlY3RlZF9zaXplKTsKIAkgIG5v
dGUgKElEU19ET1dOTE9BRF9TSE9SVCwgbG9jYWwsIHNpemUsIGV4cGVjdGVk
X3NpemUpOwogCSAgcmV0dXJuIDE7CkBAIC05NywzMCArOTcsMjcgQEAgZG93
bmxvYWRfb25lIChjaGFyICpuYW1lLCBpbnQgZXhwZWN0ZWRfcwogdm9pZAog
ZG9fZG93bmxvYWQgKEhJTlNUQU5DRSBoKQogewotICBpbnQgaTsKICAgaW50
IGVycm9ycyA9IDA7CiAgIHRvdGFsX2Rvd25sb2FkX2J5dGVzID0gMDsKICAg
dG90YWxfZG93bmxvYWRfYnl0ZXNfc29mYXIgPSAwOwogCi0gIGZvciAoUGFj
a2FnZSAqcGtnID0gcGFja2FnZTsgcGtnLT5uYW1lOyBwa2crKykKKyAgZm9y
IChQYWNrYWdlICogcGtnID0gcGFja2FnZTsgcGtnLT5uYW1lOyBwa2crKykK
ICAgICBpZiAoaXNfZG93bmxvYWRfYWN0aW9uIChwa2cpKQogICAgICAgewog
CUluZm8gKnBpID0gcGtnLT5pbmZvICsgcGtnLT50cnVzdDsKIAlEV09SRCBz
aXplID0gZ2V0X2ZpbGVfc2l6ZSAocGktPmluc3RhbGwpOwogCWNoYXIgKmxv
Y2FsID0gcGktPmluc3RhbGw7CiAJaWYgKHBrZy0+YWN0aW9uICE9IEFDVElP
Tl9TUkNfT05MWSAmJgotCSAgICAocGtnLT5hY3Rpb24gPT0gQUNUSU9OX1JF
RE8gfHwKLQkgICAgIHNpemUgIT0gcGktPmluc3RhbGxfc2l6ZSkpCisJICAg
IChwa2ctPmFjdGlvbiA9PSBBQ1RJT05fUkVETyB8fCBzaXplICE9IHBpLT5p
bnN0YWxsX3NpemUpKQogCSAgdG90YWxfZG93bmxvYWRfYnl0ZXMgKz0gcGkt
Pmluc3RhbGxfc2l6ZTsKIAlsb2NhbCA9IHBpLT5zb3VyY2U7CiAJc2l6ZSA9
IGdldF9maWxlX3NpemUgKHBpLT5zb3VyY2UpOwogCWlmIChwa2ctPnNyY3Bp
Y2tlZCAmJgotCSAgICAocGtnLT5hY3Rpb24gPT0gQUNUSU9OX1NSQ19PTkxZ
IHx8Ci0JICAgICBzaXplICE9IHBpLT5zb3VyY2Vfc2l6ZSkpCisJICAgIChw
a2ctPmFjdGlvbiA9PSBBQ1RJT05fU1JDX09OTFkgfHwgc2l6ZSAhPSBwaS0+
c291cmNlX3NpemUpKQogCSAgdG90YWxfZG93bmxvYWRfYnl0ZXMgKz0gcGkt
PnNvdXJjZV9zaXplOwogICAgICAgfQogCi0gIGZvciAoUGFja2FnZSAqcGtn
ID0gcGFja2FnZTsgcGtnLT5uYW1lOyBwa2crKykKKyAgZm9yIChQYWNrYWdl
ICogcGtnID0gcGFja2FnZTsgcGtnLT5uYW1lOyBwa2crKykKICAgICBpZiAo
aXNfZG93bmxvYWRfYWN0aW9uIChwa2cpKQogICAgICAgewogCWludCBlID0g
MDsKSW5kZXg6IGZpbGVtYW5pcC5oCj09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0K
UkNTIGZpbGU6IC9jdnMvc3JjL3NyYy93aW5zdXAvY2luc3RhbGwvZmlsZW1h
bmlwLmgsdgpyZXRyaWV2aW5nIHJldmlzaW9uIDEuMwpkaWZmIC11IC1wIC1y
MS4zIGZpbGVtYW5pcC5oCi0tLSBmaWxlbWFuaXAuaAkyMDAxLzA2LzEzIDE2
OjExOjAxCTEuMworKysgZmlsZW1hbmlwLmgJMjAwMS8xMS8xMSAwNjo1NDo1
NQpAQCAtMjIsOCArMjIsOSBAQCB0eXBlZGVmIHN0cnVjdAogICBjaGFyIHZl
cltNQVhfUEFUSCArIDFdOwogICBjaGFyIHRhaWxbTUFYX1BBVEggKyAxXTsK
ICAgY2hhciB3aGF0WzE2XTsKLX0gZmlsZXBhcnNlOworfQorZmlsZXBhcnNl
OwogCi1pbnQgcGFyc2VfZmlsZW5hbWUgKGNvbnN0IGNoYXIgKmluX2ZuLCBm
aWxlcGFyc2UmIGYpOworaW50IHBhcnNlX2ZpbGVuYW1lIChjb25zdCBjaGFy
ICppbl9mbiwgZmlsZXBhcnNlICYgZik7CiBjaGFyICpiYXNlIChjb25zdCBj
aGFyICpuYW1lKTsKIERXT1JEIGdldF9maWxlX3NpemUgKGNvbnN0IGNoYXIg
Km5hbWUpOwpJbmRleDogZmluZC5jYwo9PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
ClJDUyBmaWxlOiAvY3ZzL3NyYy9zcmMvd2luc3VwL2NpbnN0YWxsL2ZpbmQu
Y2MsdgpyZXRyaWV2aW5nIHJldmlzaW9uIDIuMQpkaWZmIC11IC1wIC1yMi4x
IGZpbmQuY2MKLS0tIGZpbmQuY2MJMjAwMS8wNC8xOCAyMDoxMTo1OAkyLjEK
KysrIGZpbmQuY2MJMjAwMS8xMS8xMSAwNjo1NDo1NQpAQCAtMTYsNyArMTYs
MTAgQEAKIC8qIFRoZSBwdXJwb3NlIG9mIHRoaXMgZmlsZSBpcyB0byBkb2Eg
cmVjdXJzaXZlIGZpbmQgb24gYSBnaXZlbgogICAgZGlyZWN0b3J5LCBjYWxs
aW5nIGEgZ2l2ZW4gZnVuY3Rpb24gZm9yIGVhY2ggZmlsZSBmb3VuZC4gKi8K
IAotc3RhdGljIGNoYXIgKmN2c2lkID0gIlxuJSUlICRJZDogZmluZC5jYyx2
IDIuMSAyMDAxLzA0LzE4IDIwOjExOjU4IGNnZiBFeHAgJFxuIjsKKyNpZiAw
CitzdGF0aWMgY29uc3QgY2hhciAqY3ZzaWQgPQorICAiXG4lJSUgJElkOiBm
aW5kLmNjLHYgMi4xIDIwMDEvMDQvMTggMjA6MTE6NTggY2dmIEV4cCAkXG4i
OworI2VuZGlmCiAKICNpbmNsdWRlICJ3aW4zMi5oIgogI2luY2x1ZGUgPHN0
ZGlvLmg+CkBAIC0yNCw3ICsyNyw3IEBAIHN0YXRpYyBjaGFyICpjdnNpZCA9
ICJcbiUlJSAkSWQ6IGZpbmQuY2MKIAogI2luY2x1ZGUgInBvcnQuaCIKIAot
c3RhdGljIHZvaWQgKCpmb3JfZWFjaCkoY2hhciAqLCB1bnNpZ25lZCBpbnQp
Oworc3RhdGljIHZvaWQgKCpmb3JfZWFjaCkgKGNoYXIgKiwgdW5zaWduZWQg
aW50KTsKIHN0YXRpYyBjaGFyIGRpcltfTUFYX1BBVEhdLCAqZm91bmRfcGFy
dDsKIAogc3RhdGljIGludApAQCAtNDMsMjkgKzQ2LDMxIEBAIGZpbmRfc3Vi
ICgpCiAgIGlmIChoID09IElOVkFMSURfSEFORExFX1ZBTFVFKQogICAgIHJl
dHVybiAwOwogCi0gIGRvIHsKLSAgICBpZiAoc3RyY21wICh3ZmQuY0ZpbGVO
YW1lLCAiLiIpID09IDAKLQl8fCBzdHJjbXAgKHdmZC5jRmlsZU5hbWUsICIu
LiIpID09IDApCi0gICAgICBjb250aW51ZTsKLQotICAgIHN0cmNweSAoZW5k
LCB3ZmQuY0ZpbGVOYW1lKTsKLQotICAgIGlmICh3ZmQuZHdGaWxlQXR0cmli
dXRlcyAmIEZJTEVfQVRUUklCVVRFX0RJUkVDVE9SWSkKLSAgICAgIGZpbmRf
c3ViICgpOwotICAgIGVsc2UKLSAgICAgIHsKLQlmb3JfZWFjaCAoZm91bmRf
cGFydCwgd2ZkLm5GaWxlU2l6ZUxvdyk7Ci0JcnYrKzsKLSAgICAgIH0KKyAg
ZG8KKyAgICB7CisgICAgICBpZiAoc3RyY21wICh3ZmQuY0ZpbGVOYW1lLCAi
LiIpID09IDAKKwkgIHx8IHN0cmNtcCAod2ZkLmNGaWxlTmFtZSwgIi4uIikg
PT0gMCkKKwljb250aW51ZTsKKworICAgICAgc3RyY3B5IChlbmQsIHdmZC5j
RmlsZU5hbWUpOworCisgICAgICBpZiAod2ZkLmR3RmlsZUF0dHJpYnV0ZXMg
JiBGSUxFX0FUVFJJQlVURV9ESVJFQ1RPUlkpCisJZmluZF9zdWIgKCk7Cisg
ICAgICBlbHNlCisJeworCSAgZm9yX2VhY2ggKGZvdW5kX3BhcnQsIHdmZC5u
RmlsZVNpemVMb3cpOworCSAgcnYrKzsKKwl9CiAKLSAgfSB3aGlsZSAoRmlu
ZE5leHRGaWxlIChoLCAmd2ZkKSk7CisgICAgfQorICB3aGlsZSAoRmluZE5l
eHRGaWxlIChoLCAmd2ZkKSk7CiAKICAgRmluZENsb3NlIChoKTsKICAgcmV0
dXJuIHJ2OwogfQogCiBpbnQKLWZpbmQgKGNoYXIgKnN0YXJ0aW5nX2Rpciwg
dm9pZCAoKl9mb3JfZWFjaCkoY2hhciAqLCB1bnNpZ25lZCBpbnQpKQorZmlu
ZCAoY29uc3QgY2hhciAqc3RhcnRpbmdfZGlyLCB2b2lkICgqX2Zvcl9lYWNo
KSAoY2hhciAqLCB1bnNpZ25lZCBpbnQpKQogewogICBzdHJjcHkgKGRpciwg
c3RhcnRpbmdfZGlyKTsKICAgZm9yX2VhY2ggPSBfZm9yX2VhY2g7CkluZGV4
OiBmaW5kLmgKPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQpSQ1MgZmlsZTogL2N2
cy9zcmMvc3JjL3dpbnN1cC9jaW5zdGFsbC9maW5kLmgsdgpyZXRyaWV2aW5n
IHJldmlzaW9uIDIuMApkaWZmIC11IC1wIC1yMi4wIGZpbmQuaAotLS0gZmlu
ZC5oCTIwMDAvMDgvMDggMDA6Mjc6NTQJMi4wCisrKyBmaW5kLmgJMjAwMS8x
MS8xMSAwNjo1NDo1NQpAQCAtMTksNCArMTksNSBAQAogICAgKGJ5dGVzKS4g
IGZpbmQoKSByZXR1cm5zIHRoZSBudW1iZXIgb2YgZmlsZXMgZm91bmQuICBE
aXJlY3RvcmllcwogICAgYXJlIHNjYW5uZWQgYnV0IG5vdCBpbmNsdWRlZCBp
biB0aGUgImZvdW5kIiBmaWxlcy4gKi8KIAotZXh0ZXJuIGludCBmaW5kIChj
aGFyICpzdGFydGluZ19kaXIsIHZvaWQgKCpmb3JfZWFjaCkoY2hhciAqLCB1
bnNpZ25lZCBpbnQpKTsKK2V4dGVybiBpbnQgZmluZCAoY29uc3QgY2hhciAq
c3RhcnRpbmdfZGlyLAorCQkgdm9pZCAoKmZvcl9lYWNoKSAoY2hhciAqLCB1
bnNpZ25lZCBpbnQpKTsKSW5kZXg6IGZyb21jd2QuY2MKPT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PQpSQ1MgZmlsZTogL2N2cy9zcmMvc3JjL3dpbnN1cC9jaW5z
dGFsbC9mcm9tY3dkLmNjLHYKcmV0cmlldmluZyByZXZpc2lvbiAyLjEwCmRp
ZmYgLXUgLXAgLXIyLjEwIGZyb21jd2QuY2MKLS0tIGZyb21jd2QuY2MJMjAw
MS8xMS8wNSAxMzowMDozNgkyLjEwCisrKyBmcm9tY3dkLmNjCTIwMDEvMTEv
MTEgMDY6NTQ6NTUKQEAgLTI2LDcgKzI2LDggQEAKICAgIHRoYXQgd2Ugc2Vh
cmNoIHJlY3Vyc2l2ZWx5LiAqLwogCiAjaWYgMAotc3RhdGljIGNvbnN0IGNo
YXIgKmN2c2lkID0gIlxuJSUlICRJZDogZnJvbWN3ZC5jYyx2IDIuMTAgMjAw
MS8xMS8wNSAxMzowMDozNiByYmNvbGxpbnMgRXhwICRcbiI7CitzdGF0aWMg
Y29uc3QgY2hhciAqY3ZzaWQgPQorICAiXG4lJSUgJElkOiBmcm9tY3dkLmNj
LHYgMi4xMCAyMDAxLzExLzA1IDEzOjAwOjM2IHJiY29sbGlucyBFeHAgJFxu
IjsKICNlbmRpZgogCiAjaW5jbHVkZSAid2luMzIuaCIKQEAgLTUzLDcgKzU0
LDcgQEAgc3RhdGljIGludAogaXNfdGVzdF92ZXJzaW9uIChjaGFyICp2KQog
ewogICBpbnQgaTsKLSAgZm9yIChpPTA7IHZbaV0gJiYgaXNkaWdpdCAodltp
XSk7IGkrKykgOworICBmb3IgKGkgPSAwOyB2W2ldICYmIGlzZGlnaXQgKHZb
aV0pOyBpKyspOwogICByZXR1cm4gKGkgPj0gNikgPyAxIDogMDsKIH0KIApA
QCAtNjIsMTkgKzYzLDE5IEBAIGNhbm9uaWNhbGl6ZV92ZXJzaW9uIChjb25z
dCBjaGFyICp2KQogewogICBzdGF0aWMgY2hhciBudlszXVsxMDBdOwogICBz
dGF0aWMgaW50IGlkeCA9IDA7Ci0gIGNoYXIgKm5wIDsKKyAgY2hhciAqbnA7
CiAgIGNvbnN0IGNoYXIgKmRwOwogICBpbnQgaTsKIAotICBpZHggPSAoaWR4
KzEpICUgMzsKKyAgaWR4ID0gKGlkeCArIDEpICUgMzsKICAgbnAgPSBudltp
ZHhdOwogCiAgIHdoaWxlICgqdikKICAgICB7CiAgICAgICBpZiAoaXNkaWdp
dCAoKnYpKQogCXsKLQkgIGZvciAoZHA9djsgKmRwICYmIGlzZGlnaXQgKCpk
cCk7IGRwKyspIDsKLQkgIGZvciAoaT1kcC12OyBpPDEyOyBpKyspCisJICBm
b3IgKGRwID0gdjsgKmRwICYmIGlzZGlnaXQgKCpkcCk7IGRwKyspOworCSAg
Zm9yIChpID0gZHAgLSB2OyBpIDwgMTI7IGkrKykKIAkgICAgKm5wKysgPSAn
MCc7CiAJICB3aGlsZSAodiA8IGRwKQogCSAgICAqbnArKyA9ICp2Kys7CkBA
IC0xMDYsNyArMTA3LDcgQEAgZm91bmRfZmlsZSAoY2hhciAqcGF0aCwgdW5z
aWduZWQgaW50IGZzaQogICAgICAgfQogCiAgIGlmIChwID09IE5VTEwpCi0g
ICAgICBwID0gbmV3X3BhY2thZ2UgKGYucGtnKTsKKyAgICBwID0gbmV3X3Bh
Y2thZ2UgKGYucGtnKTsKIAogICBpbnQgdHJ1c3QgPSBpc190ZXN0X3ZlcnNp
b24gKGYudmVyKSA/IFRSVVNUX1RFU1QgOiBUUlVTVF9DVVJSOwogCkBAIC0x
MjAsMTEgKzEyMSwxMSBAQCBmb3VuZF9maWxlIChjaGFyICpwYXRoLCB1bnNp
Z25lZCBpbnQgZnNpCiAgICAgfQogCiAgIGlmIChwLT5pbmZvW3RydXN0XS52
ZXJzaW9uKQotICAgIGZyZWUocC0+aW5mb1t0cnVzdF0udmVyc2lvbik7Cisg
ICAgZnJlZSAocC0+aW5mb1t0cnVzdF0udmVyc2lvbik7CiAgIHAtPmluZm9b
dHJ1c3RdLnZlcnNpb24gPSBfc3RyZHVwIChmLnZlcik7CiAKICAgaWYgKHAt
PmluZm9bdHJ1c3RdLmluc3RhbGwpCi0gICAgZnJlZShwLT5pbmZvW3RydXN0
XS5pbnN0YWxsKTsKKyAgICBmcmVlIChwLT5pbmZvW3RydXN0XS5pbnN0YWxs
KTsKICAgcC0+aW5mb1t0cnVzdF0uaW5zdGFsbCA9IF9zdHJkdXAgKHBhdGgp
OwogCiAgIHAtPmluZm9bdHJ1c3RdLmluc3RhbGxfc2l6ZSA9IGZzaXplOwpA
QCAtMTUwLDcgKzE1MSw3IEBAIGRvX2Zyb21jd2QgKEhJTlNUQU5DRSBoKQog
ICBjaGFyIHNyY3BhdGhbX01BWF9QQVRIXTsKICAgZm9yIChpID0gMDsgaSA8
IG5wYWNrYWdlczsgaSsrKQogICAgIHsKLSAgICAgIHAgPSBwYWNrYWdlK2k7
CisgICAgICBwID0gcGFja2FnZSArIGk7CiAgICAgICBmb3IgKHQgPSBUUlVT
VF9QUkVWOyB0IDw9IFRSVVNUX1RFU1Q7IHQrKykKIAlpZiAocC0+aW5mb1t0
XS5pbnN0YWxsKQogCSAgewpAQCAtMTY4LDcgKzE2OSw3IEBAIGRvX2Zyb21j
d2QgKEhJTlNUQU5DRSBoKQogCSAgICAgIH0KIAkgICAgaWYgKGggIT0gSU5W
QUxJRF9IQU5ETEVfVkFMVUUpCiAJICAgICAgewotCQltc2coIi0tIGdvdCBp
dCIpOworCQltc2cgKCItLSBnb3QgaXQiKTsKIAkJRmluZENsb3NlIChoKTsK
IAkJcC0+aW5mb1t0XS5zb3VyY2UgPSBfc3RyZHVwIChzcmNwYXRoKTsKIAkJ
cC0+aW5mb1t0XS5zb3VyY2Vfc2l6ZSA9IHdmZC5uRmlsZVNpemVMb3c7Cklu
ZGV4OiBnZXR1cmwuY2MKPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQpSQ1MgZmls
ZTogL2N2cy9zcmMvc3JjL3dpbnN1cC9jaW5zdGFsbC9nZXR1cmwuY2Msdgpy
ZXRyaWV2aW5nIHJldmlzaW9uIDIuMTEKZGlmZiAtdSAtcCAtcjIuMTEgZ2V0
dXJsLmNjCi0tLSBnZXR1cmwuY2MJMjAwMS8xMS8wNyAwMDowOTowNAkyLjEx
CisrKyBnZXR1cmwuY2MJMjAwMS8xMS8xMSAwNjo1NDo1NQpAQCAtMTcsNyAr
MTcsMTAgQEAKICAgIG5ldGlvLmNjLiAgV2UgYWRkIGEgcHJvZ3Jlc3MgZGlh
bG9nIGFuZCBzb21lIGNvbnZlbmllbmNlIGZ1bmN0aW9ucwogICAgKGxpa2Ug
Y29sbGVjdCB0byBzdHJpbmcgb3IgZmlsZSAqLwogCi1zdGF0aWMgY2hhciAq
Y3ZzaWQgPSAiXG4lJSUgJElkOiBnZXR1cmwuY2MsdiAyLjExIDIwMDEvMTEv
MDcgMDA6MDk6MDQgcmJjb2xsaW5zIEV4cCAkXG4iOworI2lmIDAKK3N0YXRp
YyBjb25zdCBjaGFyICpjdnNpZCA9CisgICJcbiUlJSAkSWQ6IGdldHVybC5j
Yyx2IDIuMTAgMjAwMS8xMS8wMiAwMDo1MDoxOSByYmNvbGxpbnMgRXhwICRc
biI7CisjZW5kaWYKIAogI2luY2x1ZGUgIndpbjMyLmgiCiAjaW5jbHVkZSAi
Y29tbWN0cmwuaCIKQEAgLTYwLDEzICs2MywxMiBAQCBkaWFsb2dfY21kIChI
V05EIGgsIGludCBpZCwgSFdORCBod25kY3RsCiAgICAgY2FzZSBJRENBTkNF
TDoKICAgICAgIGV4aXRfc2V0dXAgKDApOwogICAgIH0KKyAgcmV0dXJuIDA7
CiB9CiAKIHN0YXRpYyBCT09MIENBTExCQUNLCiBkaWFsb2dfcHJvYyAoSFdO
RCBoLCBVSU5UIG1lc3NhZ2UsIFdQQVJBTSB3UGFyYW0sIExQQVJBTSBsUGFy
YW0pCiB7Ci0gIGludCBpLCBqOwotICBIV05EIGxpc3Rib3g7CiAgIHN3aXRj
aCAobWVzc2FnZSkKICAgICB7CiAgICAgY2FzZSBXTV9JTklURElBTE9HOgpA
QCAtOTAsMTYgKzkyLDE4IEBAIGRpYWxvZ19wcm9jIChIV05EIGgsIFVJTlQg
bWVzc2FnZSwgV1BBUkEKIHN0YXRpYyBXSU5BUEkgRFdPUkQKIGRpYWxvZyAo
dm9pZCAqKQogewotICBpbnQgcnYgPSAwOwogICBNU0cgbTsKLSAgSFdORCBs
b2NhbF9nd19kaWFsb2cgPSBDcmVhdGVEaWFsb2cgKGhpbnN0YW5jZSwgTUFL
RUlOVFJFU09VUkNFIChJRERfRExTVEFUVVMpLAotCQkJCSAgIDAsIGRpYWxv
Z19wcm9jKTsKKyAgSFdORCBsb2NhbF9nd19kaWFsb2cgPQorICAgIENyZWF0
ZURpYWxvZyAoaGluc3RhbmNlLCBNQUtFSU5UUkVTT1VSQ0UgKElERF9ETFNU
QVRVUyksCisJCSAgMCwgZGlhbG9nX3Byb2MpOwogICBTaG93V2luZG93IChs
b2NhbF9nd19kaWFsb2csIFNXX1NIT1dOT1JNQUwpOwogICBVcGRhdGVXaW5k
b3cgKGxvY2FsX2d3X2RpYWxvZyk7Ci0gIHdoaWxlIChHZXRNZXNzYWdlICgm
bSwgMCwgMCwgMCkgPiAwKSB7Ci0gICAgVHJhbnNsYXRlTWVzc2FnZSAoJm0p
OwotICAgIERpc3BhdGNoTWVzc2FnZSAoJm0pOwotICB9CisgIHdoaWxlIChH
ZXRNZXNzYWdlICgmbSwgMCwgMCwgMCkgPiAwKQorICAgIHsKKyAgICAgIFRy
YW5zbGF0ZU1lc3NhZ2UgKCZtKTsKKyAgICAgIERpc3BhdGNoTWVzc2FnZSAo
Jm0pOworICAgIH0KKyAgcmV0dXJuIDA7CiB9CiAKIHN0YXRpYyBEV09SRCBz
dGFydF90aWNzOwpAQCAtMTIxLDE2ICsxMjUsMTYgQEAgaW5pdF9kaWFsb2cg
KGNoYXIgKnVybCwgaW50IGxlbmd0aCkKICAgICAgIFNlbmRNZXNzYWdlIChn
d19wcHJvZ3Jlc3MsIFBCTV9TRVRSQU5HRSwgMCwgTUFLRUxQQVJBTSAoMCwg
MTAwKSk7CiAgICAgICBTZW5kTWVzc2FnZSAoZ3dfaXByb2dyZXNzLCBQQk1f
U0VUUkFOR0UsIDAsIE1BS0VMUEFSQU0gKDAsIDEwMCkpOwogICAgIH0KLSAg
Y2hhciAqc2w9dXJsLCAqY3A7Ci0gIGZvciAoY3A9dXJsOyAqY3A7IGNwKysp
CisgIGNoYXIgKnNsID0gdXJsLCAqY3A7CisgIGZvciAoY3AgPSB1cmw7ICpj
cDsgY3ArKykKICAgICBpZiAoKmNwID09ICcvJyB8fCAqY3AgPT0gJ1xcJyB8
fCAqY3AgPT0gJzonKQotICAgICAgc2wgPSBjcCsxOworICAgICAgc2wgPSBj
cCArIDE7CiAgIG1heF9ieXRlcyA9IGxlbmd0aDsKICAgU2V0V2luZG93VGV4
dCAoZ3dfdXJsLCBzbCk7CiAgIFNldFdpbmRvd1RleHQgKGd3X3JhdGUsICJD
b25uZWN0aW5nLi4uIik7CiAgIFNlbmRNZXNzYWdlIChnd19wcm9ncmVzcywg
UEJNX1NFVFBPUywgKFdQQVJBTSkgMCwgMCk7CiAgIFNob3dXaW5kb3cgKGd3
X3Byb2dyZXNzLCAobGVuZ3RoID4gMCkgPyBTV19TSE9XIDogU1dfSElERSk7
Ci0gIGlmIChsZW5ndGggPiAwICkKKyAgaWYgKGxlbmd0aCA+IDApCiAgICAg
U2V0V2luZG93VGV4dCAoZ3dfcHJvZ3Jlc3NfdGV4dCwgIlBhY2thZ2UiKTsK
ICAgZWxzZQogICAgIFNldFdpbmRvd1RleHQgKGd3X3Byb2dyZXNzX3RleHQs
ICIgICAgICAgIik7CkBAIC0xNjAsOSArMTY0LDkgQEAgcHJvZ3Jlc3MgKGlu
dCBieXRlcykKICAgaW50IGticHM7CiAgIHN0YXRpYyB1bnNpZ25lZCBpbnQg
bGFzdF90aWNzID0gMDsKICAgRFdPUkQgdGljcyA9IEdldFRpY2tDb3VudCAo
KTsKLSAgaWYgKHRpY3MgPT0gc3RhcnRfdGljcykgLy8gdG8gcHJldmVudCBk
aXZpc2lvbiBieSB6ZXJvCisgIGlmICh0aWNzID09IHN0YXJ0X3RpY3MpCS8v
IHRvIHByZXZlbnQgZGl2aXNpb24gYnkgemVybwogICAgIHJldHVybjsKLSAg
aWYgKHRpY3MgPCBsYXN0X3RpY3MgKyAyMDApIC8vIHRvIHByZXZlbnQgZmxp
Y2tlcmluZyB1cGRhdGVzCisgIGlmICh0aWNzIDwgbGFzdF90aWNzICsgMjAw
KQkvLyB0byBwcmV2ZW50IGZsaWNrZXJpbmcgdXBkYXRlcwogICAgIHJldHVy
bjsKICAgbGFzdF90aWNzID0gdGljczsKIApAQCAtMTc1LDEzICsxNzksMTQg
QEAgcHJvZ3Jlc3MgKGludCBieXRlcykKICAgICAgIGludCBwZXJjID0gYnl0
ZXMgLyAobWF4X2J5dGVzIC8gMTAwKTsKICAgICAgIFNlbmRNZXNzYWdlIChn
d19wcm9ncmVzcywgUEJNX1NFVFBPUywgKFdQQVJBTSkgcGVyYywgMCk7CiAg
ICAgICBzcHJpbnRmIChidWYsICIlM2QgJSUgICglZGsvJWRrKSAgJWQga2Iv
c1xuIiwKLQkgICAgICAgcGVyYywgYnl0ZXMvMTAwMCwgbWF4X2J5dGVzLzEw
MDAsIGticHMpOworCSAgICAgICBwZXJjLCBieXRlcyAvIDEwMDAsIG1heF9i
eXRlcyAvIDEwMDAsIGticHMpOwogICAgICAgaWYgKHRvdGFsX2Rvd25sb2Fk
X2J5dGVzID4gMCkKLSAgICAgICAgewotICAgICAgICAgIGludCB0b3RhbHBl
cmMgPSAodG90YWxfZG93bmxvYWRfYnl0ZXNfc29mYXIgKyBieXRlcykgLyAo
Ci0gICAgICAgICAgICAgICAgICAgIHRvdGFsX2Rvd25sb2FkX2J5dGVzIC8g
MTAwKTsKLSAgICAgICAgICBTZW5kTWVzc2FnZSAoZ3dfcHByb2dyZXNzLCBQ
Qk1fU0VUUE9TLCAoV1BBUkFNKSB0b3RhbHBlcmMsIDApOwotICAgICAgICB9
CisJeworCSAgaW50IHRvdGFscGVyYyA9CisJICAgICh0b3RhbF9kb3dubG9h
ZF9ieXRlc19zb2ZhciArCisJICAgICBieXRlcykgLyAodG90YWxfZG93bmxv
YWRfYnl0ZXMgLyAxMDApOworCSAgU2VuZE1lc3NhZ2UgKGd3X3Bwcm9ncmVz
cywgUEJNX1NFVFBPUywgKFdQQVJBTSkgdG90YWxwZXJjLCAwKTsKKwl9CiAg
ICAgfQogICBlbHNlCiAgICAgc3ByaW50ZiAoYnVmLCAiJWQgICVkIGtiL3Nc
biIsIGJ5dGVzLCBrYnBzKTsKQEAgLTE4OSw3ICsxOTQsOCBAQCBwcm9ncmVz
cyAoaW50IGJ5dGVzKQogICBTZXRXaW5kb3dUZXh0IChnd19yYXRlLCBidWYp
OwogfQogCi1zdHJ1Y3QgR1VCdWYgeworc3RydWN0IEdVQnVmCit7CiAgIEdV
QnVmICpuZXh0OwogICBpbnQgY291bnQ7CiAgIGNoYXIgYnVmWzIwMDBdOwpA
QCAtMjE0LDcgKzIyMCw3IEBAIGdldF91cmxfdG9fc3RyaW5nIChjaGFyICpf
dXJsKQogCiAgIEdVQnVmICpidWZzID0gMDsKICAgR1VCdWYgKipuZXh0cCA9
ICZidWZzOwotICBpbnQgdG90YWxfYnl0ZXMgPSAxOyAvKiBmb3IgdGhlIE5V
TCAqLworICBpbnQgdG90YWxfYnl0ZXMgPSAxOwkJLyogZm9yIHRoZSBOVUwg
Ki8KICAgcHJvZ3Jlc3MgKDApOwogICB3aGlsZSAoMSkKICAgICB7CkBAIC0y
NjUsNyArMjcxLDcgQEAgZ2V0X3VybF90b19maWxlIChjaGFyICpfdXJsLCBj
aGFyICpfZmlsZQogICAgIH0KICAgaW5pdF9kaWFsb2cgKF91cmwsIGV4cGVj
dGVkX2xlbmd0aCk7CiAKLSAgcmVtb3ZlIChfZmlsZW5hbWUpOyAvKiBidXQg
aWdub3JlIGVycm9ycyAqLworICByZW1vdmUgKF9maWxlbmFtZSk7CQkvKiBi
dXQgaWdub3JlIGVycm9ycyAqLwogCiAgIE5ldElPICpuID0gTmV0SU86Om9w
ZW4gKF91cmwsIGFsbG93X2Z0cF9hdXRoKTsKICAgaWYgKCFuIHx8ICFuLT5v
ayAoKSkKQEAgLTI3OCw3ICsyODQsNyBAQCBnZXRfdXJsX3RvX2ZpbGUgKGNo
YXIgKl91cmwsIGNoYXIgKl9maWxlCiAgIEZJTEUgKmYgPSBmb3BlbiAoX2Zp
bGVuYW1lLCAid2IiKTsKICAgaWYgKCFmKQogICAgIHsKLSAgICAgIGNoYXIg
KmVyciA9IHN0cmVycm9yIChlcnJubyk7CisgICAgICBjb25zdCBjaGFyICpl
cnIgPSBzdHJlcnJvciAoZXJybm8pOwogICAgICAgaWYgKCFlcnIpCiAJZXJy
ID0gIih1bmtub3duIGVycm9yKSI7CiAgICAgICBmYXRhbCAoSURTX0VSUl9P
UEVOX1dSSVRFLCBfZmlsZW5hbWUsIGVycik7CkluZGV4OiBnZXR1cmwuaAo9
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09ClJDUyBmaWxlOiAvY3ZzL3NyYy9zcmMv
d2luc3VwL2NpbnN0YWxsL2dldHVybC5oLHYKcmV0cmlldmluZyByZXZpc2lv
biAyLjIKZGlmZiAtdSAtcCAtcjIuMiBnZXR1cmwuaAotLS0gZ2V0dXJsLmgJ
MjAwMS8wNS8yOCAwODozMTowMgkyLjIKKysrIGdldHVybC5oCTIwMDEvMTEv
MTEgMDY6NTQ6NTUKQEAgLTE5LDcgKzE5LDcgQEAKIGV4dGVybiBpbnQgdG90
YWxfZG93bmxvYWRfYnl0ZXM7CiBleHRlcm4gaW50IHRvdGFsX2Rvd25sb2Fk
X2J5dGVzX3NvZmFyOwogCi1jaGFyICAqZ2V0X3VybF90b19zdHJpbmcgKGNo
YXIgKl91cmwpOwotaW50ICAgIGdldF91cmxfdG9fZmlsZSAoY2hhciAqX3Vy
bCwgY2hhciAqX2ZpbGVuYW1lLCBpbnQgZXhwZWN0ZWRfc2l6ZSwKLQkJCUJP
T0wgYWxsb3dfZnRwX2F1dGggPSBGQUxTRSk7Ci12b2lkICAgZGlzbWlzc191
cmxfc3RhdHVzX2RpYWxvZyAoKTsKK2NoYXIgKmdldF91cmxfdG9fc3RyaW5n
IChjaGFyICpfdXJsKTsKK2ludCBnZXRfdXJsX3RvX2ZpbGUgKGNoYXIgKl91
cmwsIGNoYXIgKl9maWxlbmFtZSwgaW50IGV4cGVjdGVkX3NpemUsCisJCSAg
ICAgQk9PTCBhbGxvd19mdHBfYXV0aCA9IEZBTFNFKTsKK3ZvaWQgZGlzbWlz
c191cmxfc3RhdHVzX2RpYWxvZyAoKTsKSW5kZXg6IGhhc2guY2MKPT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PQpSQ1MgZmlsZTogL2N2cy9zcmMvc3JjL3dpbnN1
cC9jaW5zdGFsbC9oYXNoLmNjLHYKcmV0cmlldmluZyByZXZpc2lvbiAyLjIK
ZGlmZiAtdSAtcCAtcjIuMiBoYXNoLmNjCi0tLSBoYXNoLmNjCTIwMDAvMDgv
MzAgMDE6MDc6NTEJMi4yCisrKyBoYXNoLmNjCTIwMDEvMTEvMTEgMDY6NTQ6
NTUKQEAgLTE1LDE0ICsxNSwxOCBAQAogCiAvKiBTaW1wbGUgaGFzaCBjbGFz
cyBmb3IgaW5zdGFsbC5jYyAqLwogCi1zdGF0aWMgY2hhciAqY3ZzaWQgPSAi
XG4lJSUgJElkOiBoYXNoLmNjLHYgMi4yIDIwMDAvMDgvMzAgMDE6MDc6NTEg
ZGogRXhwICRcbiI7CisjaWYgMAorc3RhdGljIGNvbnN0IGNoYXIgKmN2c2lk
ID0KKyAgIlxuJSUlICRJZDogaGFzaC5jYyx2IDIuMiAyMDAwLzA4LzMwIDAx
OjA3OjUxIGRqIEV4cCAkXG4iOworI2VuZGlmCiAKICNpbmNsdWRlIDxzdGRs
aWIuaD4KICNpbmNsdWRlIDxzdHJpbmcuaD4KIAogI2luY2x1ZGUgImhhc2gu
aCIKIAotY2xhc3MgaGFzaF9pbnRlcm5hbHMgeworY2xhc3MgaGFzaF9pbnRl
cm5hbHMKK3sKIHB1YmxpYzoKICAgY2hhciAqKmtleXM7CiAgIGludCBudW1r
ZXlzOwpAQCAtNTAsNyArNTQsNyBAQCB2b2lkCiBoYXNoOjphZGQgKGNoYXIg
KnN0cmluZykKIHsKICAgaW50IGk7Ci0gIGZvciAoaT0wOyBpPGgtPm51bWtl
eXM7IGkrKykKKyAgZm9yIChpID0gMDsgaSA8IGgtPm51bWtleXM7IGkrKykK
ICAgICBpZiAoc3RyY21wIChoLT5rZXlzW2ldLCBzdHJpbmcpID09IDApCiAg
ICAgICByZXR1cm47CiAgIGlmIChoLT5udW1rZXlzID49IGgtPm1heGtleXMp
CkBAIC02MCw3ICs2NCw3IEBAIGhhc2g6OmFkZCAoY2hhciAqc3RyaW5nKQog
ICAgIH0KIAogICBoLT5rZXlzW2gtPm51bWtleXNdID0gX3N0cmR1cCAoc3Ry
aW5nKTsKLSAgaC0+bnVta2V5cyArKzsKKyAgaC0+bnVta2V5cysrOwogfQog
CiAKQEAgLTY4LDcgKzcyLDcgQEAgaW50CiBoYXNoOjpoYXMgKGNoYXIgKnN0
cmluZykKIHsKICAgaW50IGk7Ci0gIGZvciAoaT0wOyBpPGgtPm51bWtleXM7
IGkrKykKKyAgZm9yIChpID0gMDsgaSA8IGgtPm51bWtleXM7IGkrKykKICAg
ICBpZiAoc3RyY21wIChoLT5rZXlzW2ldLCBzdHJpbmcpID09IDApCiAgICAg
ICByZXR1cm4gMTsKICAgcmV0dXJuIDA7CkBAIC03OSw3ICs4Myw3IEBAIGhh
c2g6OmVudW1lcmF0ZSAoY2hhciAqcHJldikKIHsKICAgaWYgKHByZXYgPT0g
MCkKICAgICBoLT5wcmV2X2luZGV4ID0gLTE7Ci0gIGgtPnByZXZfaW5kZXgg
Kys7CisgIGgtPnByZXZfaW5kZXgrKzsKICAgaWYgKGgtPnByZXZfaW5kZXgg
Pj0gaC0+bnVta2V5cykKICAgICByZXR1cm4gMDsKICAgcmV0dXJuIGgtPmtl
eXNbaC0+cHJldl9pbmRleF07CkBAIC04OCw4ICs5Miw4IEBAIGhhc2g6OmVu
dW1lcmF0ZSAoY2hhciAqcHJldikKIHN0YXRpYyBpbnQKIHJldl9sZW4gKGNv
bnN0IHZvaWQgKnZhLCBjb25zdCB2b2lkICp2YikKIHsKLSAgY2hhciAqYSA9
ICooY2hhciAqKil2YTsKLSAgY2hhciAqYiA9ICooY2hhciAqKil2YjsKKyAg
Y2hhciAqYSA9ICooY2hhciAqKikgdmE7CisgIGNoYXIgKmIgPSAqKGNoYXIg
KiopIHZiOwogICByZXR1cm4gc3RyY21wIChiLCBhKTsKIH0KIApJbmRleDog
aGFzaC5oCj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KUkNTIGZpbGU6IC9jdnMv
c3JjL3NyYy93aW5zdXAvY2luc3RhbGwvaGFzaC5oLHYKcmV0cmlldmluZyBy
ZXZpc2lvbiAyLjEKZGlmZiAtdSAtcCAtcjIuMSBoYXNoLmgKLS0tIGhhc2gu
aAkyMDAwLzA4LzMwIDAxOjA1OjQyCTIuMQorKysgaGFzaC5oCTIwMDEvMTEv
MTEgMDY6NTQ6NTUKQEAgLTE3LDExICsxNywxMiBAQAogCiBjbGFzcyBoYXNo
X2ludGVybmFsczsKIAotY2xhc3MgaGFzaCB7CitjbGFzcyBoYXNoCit7CiAg
IGhhc2hfaW50ZXJuYWxzICpoOwotIHB1YmxpYzoKLSAgaGFzaCAoKTsKLSAg
fmhhc2ggKCk7CitwdWJsaWM6CisgICAgaGFzaCAoKTsKKyAgIH5oYXNoICgp
OwogCiAgIHZvaWQgYWRkIChjaGFyICpzdHJpbmcpOwogICBpbnQgaGFzIChj
aGFyICpzdHJpbmcpOwpAQCAtMzAsNSArMzEsNSBAQCBjbGFzcyBoYXNoIHsK
ICAgdm9pZCBhZGRfc3ViZGlycyAoY2hhciAqcGF0aCk7CiAgIHZvaWQgcmV2
ZXJzZV9zb3J0ICgpOwogCi0gIGNoYXIgKmVudW1lcmF0ZSAoY2hhciAqcHJl
dj0wKTsKKyAgY2hhciAqZW51bWVyYXRlIChjaGFyICpwcmV2ID0gMCk7CiB9
OwpJbmRleDogaW5pLmNjCj09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KUkNTIGZp
bGU6IC9jdnMvc3JjL3NyYy93aW5zdXAvY2luc3RhbGwvaW5pLmNjLHYKcmV0
cmlldmluZyByZXZpc2lvbiAyLjkKZGlmZiAtdSAtcCAtcjIuOSBpbmkuY2MK
LS0tIGluaS5jYwkyMDAxLzA2LzEzIDE2OjExOjAxCTIuOQorKysgaW5pLmNj
CTIwMDEvMTEvMTEgMDY6NTQ6NTUKQEAgLTE4LDcgKzE4LDEwIEBACiAgICBm
bGV4IHBhcnNlcnMgYXJlIHByb3ZpZGVkIGFsc28uICBXZSBjaGVjayB0byBz
ZWUgaWYgdGhpcyBzZXR1cC5pbmkKICAgIGlzIG9sZGVyIHRoYW4gdGhlIG9u
ZSB3ZSB1c2VkIGxhc3QgdGltZSwgYW5kIGlmIHNvLCB3YXJuIHRoZSB1c2Vy
LiAqLwogCi1zdGF0aWMgY2hhciAqY3ZzaWQgPSAiXG4lJSUgJElkOiBpbmku
Y2MsdiAyLjkgMjAwMS8wNi8xMyAxNjoxMTowMSBjZ2YgRXhwICRcbiI7Cisj
aWYgMAorc3RhdGljIGNvbnN0IGNoYXIgKmN2c2lkID0KKyAgIlxuJSUlICRJ
ZDogaW5pLmNjLHYgMi45IDIwMDEvMDYvMTMgMTY6MTE6MDEgY2dmIEV4cCAk
XG4iOworI2VuZGlmCiAKICNpbmNsdWRlICJ3aW4zMi5oIgogCkBAIC0zMywx
MSArMzYsMTIgQEAgc3RhdGljIGNoYXIgKmN2c2lkID0gIlxuJSUlICRJZDog
aW5pLmNjLAogI2luY2x1ZGUgImdldHVybC5oIgogI2luY2x1ZGUgImRpYWxv
Zy5oIgogI2luY2x1ZGUgIm1zZy5oIgotI2luY2x1ZGUgIm1rZGlyLmgiCiAj
aW5jbHVkZSAibG9nLmgiCiAjaW5jbHVkZSAidmVyc2lvbi5oIgogI2luY2x1
ZGUgIm1vdW50LmgiCiAKKyNpbmNsdWRlICJpb19zdHJlYW0uaCIKKwogdW5z
aWduZWQgaW50IHNldHVwX3RpbWVzdGFtcCA9IDA7CiBjaGFyICpzZXR1cF92
ZXJzaW9uID0gMDsKIApAQCAtNjgsNyArNzIsNyBAQCBkb19pbmkgKEhJTlNU
QU5DRSBoKQogICBpbmlfaW5pdCAoaW5pX2ZpbGUpOwogCiAgIHNldHVwX3Rp
bWVzdGFtcCA9IDA7Ci0gIC8qeXlkZWJ1ZyA9IDE7Ki8KKyAgLyp5eWRlYnVn
ID0gMTsgKi8KIAogICBpZiAoeXlwYXJzZSAoKSB8fCBlcnJvcl9jb3VudCA+
IDApCiAgICAgewpAQCAtODAsMjQgKzg0LDI4IEBAIGRvX2luaSAoSElOU1RB
TkNFIGgpCiAgIGVsc2UKICAgICB7CiAgICAgICAvKiBzYXZlIGtub3duLWdv
b2Qgc2V0dXAuaW5pIGxvY2FsbHkgKi8KLSAgICAgIEZJTEUgKmluaWYgPSBm
b3BlbiAoInNldHVwLmluaSIsICJ3YiIpOwotICAgICAgaWYgKGluaWYpCisg
ICAgICBpb19zdHJlYW0gKmluaXN0cmVhbSA9IGlvX3N0cmVhbTo6b3BlbiAo
ImZpbGU6Ly9zZXR1cC5pbmkiLCAid2IiKTsKKyAgICAgIGlmIChpbmlzdHJl
YW0pCiAJewotCSAgZndyaXRlIChpbmlfZmlsZSwgMSwgc3RybGVuIChpbmlf
ZmlsZSksIGluaWYpOwotCSAgZmNsb3NlIChpbmlmKTsKKwkgIGluaXN0cmVh
bS0+d3JpdGUgKGluaV9maWxlLCBzdHJsZW4gKGluaV9maWxlKSk7CisJICBk
ZWxldGUgaW5pc3RyZWFtOwogCX0KICAgICB9CiAKICAgaWYgKGdldF9yb290
X2RpciAoKSkKICAgICB7Ci0gICAgICBta2Rpcl9wICgxLCBjeWdwYXRoICgi
L2V0Yy9zZXR1cCIsIDApKTsKKyAgICAgIGlvX3N0cmVhbTo6bWtwYXRoX3Ag
KFBBVEhfVE9fRElSLCAiY3lnZmlsZTovLy9ldGMvc2V0dXAiKTsKIAogICAg
ICAgdW5zaWduZWQgaW50IG9sZF90aW1lc3RhbXAgPSAwOwotICAgICAgRklM
RSAqb3RzID0gZm9wZW4gKGN5Z3BhdGggKCIvZXRjL3NldHVwL3RpbWVzdGFt
cCIsIDApLCAicnQiKTsKKyAgICAgIGlvX3N0cmVhbSAqb3RzID0KKwlpb19z
dHJlYW06Om9wZW4gKCJjeWdmaWxlOi8vL2V0Yy9zZXR1cC90aW1lc3RhbXAi
LCAicnQiKTsKICAgICAgIGlmIChvdHMpCiAJewotCSAgZnNjYW5mIChvdHMs
ICIldSIsICZvbGRfdGltZXN0YW1wKTsKLQkgIGZjbG9zZSAob3RzKTsKKwkg
IGNoYXIgdGVtcFsyMF07CisJICBtZW1zZXQgKHRlbXAsICdcMCcsIDIwKTsK
KwkgIGlmIChvdHMtPnJlYWQgKHRlbXAsIDE5KSkKKwkgICAgc3NjYW5mICh0
ZW1wLCAiJXUiLCAmb2xkX3RpbWVzdGFtcCk7CisJICBkZWxldGUgb3RzOwog
CSAgaWYgKG9sZF90aW1lc3RhbXAgJiYgc2V0dXBfdGltZXN0YW1wCiAJICAg
ICAgJiYgKG9sZF90aW1lc3RhbXAgPiBzZXR1cF90aW1lc3RhbXApKQogCSAg
ICB7CkBAIC0xMDgsMTYgKzExNiwyMCBAQCBkb19pbmkgKEhJTlNUQU5DRSBo
KQogCX0KICAgICAgIGlmIChzZXR1cF90aW1lc3RhbXApCiAJewotCSAgRklM
RSAqbnRzID0gZm9wZW4gKGN5Z3BhdGggKCIvZXRjL3NldHVwL3RpbWVzdGFt
cCIsIDApLCAid3QiKTsKKwkgIGlvX3N0cmVhbSAqbnRzID0KKwkgICAgaW9f
c3RyZWFtOjpvcGVuICgiY3lnZmlsZTovLy9ldGMvc2V0dXAvdGltZXN0YW1w
IiwgInd0Iik7CiAJICBpZiAobnRzKQogCSAgICB7Ci0JICAgICAgZnByaW50
ZiAobnRzLCAiJXUiLCBzZXR1cF90aW1lc3RhbXApOwotCSAgICAgIGZjbG9z
ZSAobnRzKTsKKwkgICAgICBjaGFyIHRlbXBbMjBdOworCSAgICAgIHNwcmlu
dGYgKHRlbXAsICIldSIsIHNldHVwX3RpbWVzdGFtcCk7CisJICAgICAgbnRz
LT53cml0ZSAodGVtcCwgc3RybGVuICh0ZW1wKSk7CisJICAgICAgZGVsZXRl
IG50czsKIAkgICAgfQogCX0KICAgICB9CiAKLSAgbXNnICgic2V0dXBfdmVy
c2lvbiBpcyAlcywgb3VyX3ZlcnNpb24gaXMgJXMiLCBzZXR1cF92ZXJzaW9u
PzoiKG51bGwpIiwgdmVyc2lvbik7CisgIG1zZyAoInNldHVwX3ZlcnNpb24g
aXMgJXMsIG91cl92ZXJzaW9uIGlzICVzIiwgc2V0dXBfdmVyc2lvbiA/IDog
IihudWxsKSIsCisgICAgICAgdmVyc2lvbik7CiAgIGlmIChzZXR1cF92ZXJz
aW9uKQogICAgIHsKICAgICAgIGNoYXIgKmluaV92ZXJzaW9uID0gY2Fub25p
Y2FsaXplX3ZlcnNpb24gKHNldHVwX3ZlcnNpb24pOwpAQCAtMTMxLDcgKzE0
Myw4IEBAIGRvX2luaSAoSElOU1RBTkNFIGgpCiAKIGV4dGVybiBpbnQgeXls
aW5lbm87CiAKLWV4dGVybiAiQyIgaW50IHl5ZXJyb3IgKGNoYXIgKnMsIC4u
LikKK2V4dGVybiAiQyIgaW50Cit5eWVycm9yIChjaGFyICpzLCAuLi4pCiB7
CiAgIGNoYXIgYnVmWzEwMDBdOwogICBpbnQgbGVuOwpAQCAtMTU0LDE0ICsx
NjcsMTYgQEAgZXh0ZXJuICJDIiBpbnQgeXllcnJvciAoY2hhciAqcywgLi4u
KQogICAgICAgc3RyY3B5IChlcnJvcl9idWYsIGJ1Zik7CiAgICAgfQogICBl
cnJvcl9jb3VudCsrOworICAvKiBUT0RPOiBpcyByZXR1cm4gMCBjb3JyZWN0
PyAqLworICByZXR1cm4gMDsKIH0KIAotZXh0ZXJuICJDIiBpbnQgZnByaW50
ZiAoRklMRSAqZiwgY29uc3QgY2hhciAqcywgLi4uKTsKK2V4dGVybiAiQyIg
aW50IGZwcmludGYgKEZJTEUgKiBmLCBjb25zdCBjaGFyICpzLCAuLi4pOwog
CiBzdGF0aWMgY2hhciBzdGRlcnJidWZbMTAwMF07CiAKIGludAotZnByaW50
ZiAoRklMRSAqZiwgY29uc3QgY2hhciAqZm10LCAuLi4pCitmcHJpbnRmIChG
SUxFICogZiwgY29uc3QgY2hhciAqZm10LCAuLi4pCiB7CiAgIGNoYXIgYnVm
WzEwMDBdOwogICBpbnQgcnY7CkBAIC0xNzQsNyArMTg5LDcgQEAgZnByaW50
ZiAoRklMRSAqZiwgY29uc3QgY2hhciAqZm10LCAuLi4pCiAgICAgICBpZiAo
Y2hhciAqbmwgPSBzdHJjaHIgKHN0ZGVycmJ1ZiwgJ1xuJykpCiAJewogCSAg
Km5sID0gMDsKLQkgIC8qT3V0cHV0RGVidWdTdHJpbmcgKHN0ZGVycmJ1Zik7
Ki8KKwkgIC8qT3V0cHV0RGVidWdTdHJpbmcgKHN0ZGVycmJ1Zik7ICovCiAJ
ICBNZXNzYWdlQm94ICgwLCBidWYsICJDeWd3aW4gU2V0dXAiLCAwKTsKIAkg
IHN0ZGVycmJ1ZlswXSA9IDA7CiAJfQpJbmRleDogaW5pLmgKPT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PQpSQ1MgZmlsZTogL2N2cy9zcmMvc3JjL3dpbnN1cC9j
aW5zdGFsbC9pbmkuaCx2CnJldHJpZXZpbmcgcmV2aXNpb24gMi4xOQpkaWZm
IC11IC1wIC1yMi4xOSBpbmkuaAotLS0gaW5pLmgJMjAwMS8xMS8wOSAxNDox
MjowMAkyLjE5CisrKyBpbmkuaAkyMDAxLzExLzExIDA2OjU0OjU2CkBAIC00
MSwxNCArNDEsMTYgQEAgdHlwZWRlZiBlbnVtCiAgIFRSVVNUX0NVUlIsCiAg
IFRSVVNUX1RFU1QsCiAgIE5UUlVTVAotfSB0cnVzdHM7Cit9Cit0cnVzdHM7
CiAKIHR5cGVkZWYgZW51bQogewogICBFWENMVURFX05PTkUgPSAwLAogICBF
WENMVURFX0JZX1NFVFVQLAogICBFWENMVURFX05PVF9GT1VORAotfSBleGNs
dWRlczsKK30KK2V4Y2x1ZGVzOwogCiAjZGVmaW5lIGlzX2Rvd25sb2FkX2Fj
dGlvbihwa2cpIFwKICAgKChwa2cpLT5hY3Rpb24gPT0gQUNUSU9OX1BSRVYg
fHwgXApAQCAtNzUsNTUgKzc3LDU4IEBAIHR5cGVkZWYgZW51bQogI2RlZmlu
ZSBTUkNBQ1RJT05fWUVTCQkxCiB0eXBlZGVmIHN0cnVjdCBfSW5mbwogewot
ICBjaGFyICp2ZXJzaW9uOwkvKiB2ZXJzaW9uIHBhcnQgb2YgZmlsZW5hbWUg
Ki8KLSAgY2hhciAqaW5zdGFsbDsJLyogZmlsZSBuYW1lIHRvIGluc3RhbGwg
Ki8KKyAgY2hhciAqdmVyc2lvbjsJCS8qIHZlcnNpb24gcGFydCBvZiBmaWxl
bmFtZSAqLworICBjaGFyICppbnN0YWxsOwkJLyogZmlsZSBuYW1lIHRvIGlu
c3RhbGwgKi8KICAgdW5zaWduZWQgaW50IGluc3RhbGxfc2l6ZTsJLyogaW4g
Ynl0ZXMgKi8KLSAgaW50IGluc3RhbGxfZXhpc3RzOwkvKiBpbnN0YWxsIGZp
bGUgZXhpc3RzIG9uIGRpc2sgKi8KLSAgaW50IGRlcml2ZWQ7CQkvKiBUcnVl
IGlmIHdlICJmaWd1cmVkIG91dCIgdGhhdCB0aGlzIHZlcnNpb24gc2hvdWxk
Ci0JCQkgICBnbyBoZXJlIGJ1dCBpdCB3YXMgbm90IGluIHNldHVwLmluaSAq
LwotICBjaGFyICpzb3VyY2U7CQkvKiBzb3VyY2VzIGZvciBpbnN0YWxsZWQg
YmluYXJpZXMgKi8KKyAgaW50IGluc3RhbGxfZXhpc3RzOwkJLyogaW5zdGFs
bCBmaWxlIGV4aXN0cyBvbiBkaXNrICovCisgIGludCBkZXJpdmVkOwkJCS8q
IFRydWUgaWYgd2UgImZpZ3VyZWQgb3V0IiB0aGF0IHRoaXMgdmVyc2lvbiBz
aG91bGQKKwkJCQkgICBnbyBoZXJlIGJ1dCBpdCB3YXMgbm90IGluIHNldHVw
LmluaSAqLworICBjaGFyICpzb3VyY2U7CQkJLyogc291cmNlcyBmb3IgaW5z
dGFsbGVkIGJpbmFyaWVzICovCiAgIHVuc2lnbmVkIGludCBzb3VyY2Vfc2l6
ZTsJLyogaW4gYnl0ZXMgKi8KLSAgaW50IHNvdXJjZV9leGlzdHM7CS8qIHNv
dXJjZSBmaWxlIGV4aXN0cyBvbiBkaXNrICovCisgIGludCBzb3VyY2VfZXhp
c3RzOwkJLyogc291cmNlIGZpbGUgZXhpc3RzIG9uIGRpc2sgKi8KICNpZmRl
ZiBfX2NwbHVzcGx1cwotICBfSW5mbyAoY29uc3QgY2hhciAqX2luc3RhbGws
IGNvbnN0IGNoYXIgKl92ZXJzaW9uLAotCSBpbnQgX2luc3RhbGxfc2l6ZSwg
Y29uc3QgY2hhciAqX3NvdXJjZSA9IE5VTEwsCi0JIGludCBfc291cmNlX3Np
emUgPSAwKTsKKyAgICBfSW5mbyAoY29uc3QgY2hhciAqX2luc3RhbGwsIGNv
bnN0IGNoYXIgKl92ZXJzaW9uLAorCSAgIGludCBfaW5zdGFsbF9zaXplLCBj
b25zdCBjaGFyICpfc291cmNlID0gTlVMTCwKKwkgICBpbnQgX3NvdXJjZV9z
aXplID0gMCk7CiAjZW5kaWYKLX0gSW5mbzsJCQkvKiArMSBmb3IgVFJVU1Rf
VU5LTk9XTiAqLworfQorSW5mbzsJCQkJLyogKzEgZm9yIFRSVVNUX1VOS05P
V04gKi8KIAogdHlwZWRlZiBzdHJ1Y3QgX0NhdGVnb3J5UGFja2FnZQogewot
ICBzdHJ1Y3QgX0NhdGVnb3J5UGFja2FnZSAqbmV4dDsgIC8qIFRoZSBuZXh0
IHBhY2thZ2UgcG9pbnRlciBpbiB0aGUgbGlzdCAqLwotICBjaGFyICpwa2du
YW1lOwkJICAvKiBUaGlzIHNob3VsZCBiZSBQYWNrYWdlICosIGJ1dCB0aGUg
cGFja2FnZXMgY2FuIG1vdmUqLwotfSBDYXRlZ29yeVBhY2thZ2U7CisgIHN0
cnVjdCBfQ2F0ZWdvcnlQYWNrYWdlICpuZXh0OwkvKiBUaGUgbmV4dCBwYWNr
YWdlIHBvaW50ZXIgaW4gdGhlIGxpc3QgKi8KKyAgY2hhciAqcGtnbmFtZTsJ
CS8qIFRoaXMgc2hvdWxkIGJlIFBhY2thZ2UgKiwgYnV0IHRoZSBwYWNrYWdl
cyBjYW4gbW92ZSAqLworfQorQ2F0ZWdvcnlQYWNrYWdlOwogCiBzdHJ1Y3Qg
X0NhdGVnb3J5CiB7Ci0gIHN0cnVjdCBfQ2F0ZWdvcnkgKm5leHQ7IC8qIHRo
ZSBuZXh0IGNhdGVnb3J5IGluIHRoZSBsaXN0ICovCi0gIGNoYXIgKm5hbWU7
CQkgIC8qIHRoZSBjYXRlZ29yeSAqLwotICBDYXRlZ29yeVBhY2thZ2UgKnBh
Y2thZ2VzOyAvKiB0aGUgcGFja2FnZXMgaW4gdGhpcyBjYXRlZ29yeSAqLwor
ICBzdHJ1Y3QgX0NhdGVnb3J5ICpuZXh0OwkvKiB0aGUgbmV4dCBjYXRlZ29y
eSBpbiB0aGUgbGlzdCAqLworICBjaGFyICpuYW1lOwkJCS8qIHRoZSBjYXRl
Z29yeSAqLworICBDYXRlZ29yeVBhY2thZ2UgKnBhY2thZ2VzOwkvKiB0aGUg
cGFja2FnZXMgaW4gdGhpcyBjYXRlZ29yeSAqLwogfTsKIAogdHlwZWRlZiBz
dHJ1Y3QgX0RlcGVuZGVuY3kKIHsKLSAgc3RydWN0IF9EZXBlbmRlbmN5ICpu
ZXh0OyAvKiB0aGUgbmV4dCBwYWNrYWdlIGluIHRoaXMgZGVwZW5kZW5jeSBs
aXN0ICovCi0gIGNoYXIgKnBhY2thZ2U7CS8qIHRoZSBuYW1lIG9mIHRoZSBw
YWNrYWdlIHRoYXQgaXMgZGVwZW5kZWQgb24gKi8KLX0gRGVwZW5kZW5jeTsg
CQkvKiBEZXBlbmRlbmNpZXMgY2FuIGJlIHVzZWQgZm9yCi0JCQkgICByZWNv
bW1lbmRlZC9yZXF1aXJlZC9yZWxhdGVkLi4uICovCisgIHN0cnVjdCBfRGVw
ZW5kZW5jeSAqbmV4dDsJLyogdGhlIG5leHQgcGFja2FnZSBpbiB0aGlzIGRl
cGVuZGVuY3kgbGlzdCAqLworICBjaGFyICpwYWNrYWdlOwkJLyogdGhlIG5h
bWUgb2YgdGhlIHBhY2thZ2UgdGhhdCBpcyBkZXBlbmRlZCBvbiAqLworfQor
RGVwZW5kZW5jeTsJCQkvKiBEZXBlbmRlbmNpZXMgY2FuIGJlIHVzZWQgZm9y
CisJCQkJICAgcmVjb21tZW5kZWQvcmVxdWlyZWQvcmVsYXRlZC4uLiAqLwog
c3RydWN0IF9QYWNrYWdlCiB7Ci0gIGNoYXIgKm5hbWU7CQkvKiBwYWNrYWdl
IG5hbWUsIGxpa2UgImN5Z3dpbiIgKi8KLSAgY2hhciAqc2Rlc2M7CQkvKiBz
aG9ydCBkZXNjcmlwdGlvbiAocmVwbGFjZXMgIm5hbWUiIGlmIHByb3ZpZGVk
KSAqLwotICBjaGFyICpsZGVzYzsJCS8qIGxvbmcgZGVzY3JpcHRpb24gKG11
bHRpLWxpbmUpICovCi0gIENhdGVnb3J5ICpjYXRlZ29yeTsgICAvKiB0aGUg
Y2F0ZWdvcmllcyB0aGUgcGFja2FnZSBiZWxvbmdzIHRvICovIAotICBEZXBl
bmRlbmN5ICpyZXF1aXJlZDsgLyogdGhlIHBhY2thZ2VzIHJlcXVpcmVkIGZv
ciB0aGlzIHBhY2thZ2UgdG8gd29yayAqLwotICBhY3Rpb25zIGFjdGlvbjsJ
LyogQSByYW5nZSBvZiBzdGF0ZXMgYXBwbGljYWJsZSB0byB0aGlzIHBhY2th
Z2UgKi8KLSAgdHJ1c3RzIHRydXN0OwkJLyogU2VsZWN0cyBhbW9uZyBpbmZv
W10gYmVsb3csIGEgc3Vic2V0IG9mIGFjdGlvbiAqLwotICBpbnQgc3JjcGlj
a2VkOwkvKiBUcnVlIGlmIHNvdXJjZSBpcyByZXF1aXJlZCAqLwotCi0gIElu
Zm8gKmluc3RhbGxlZDsJLyogSW5mbyBvbiBpbnN0YWxsZWQgcGFja2FnZSAq
LwotICB0cnVzdHMgaW5zdGFsbGVkX2l4OwkvKiBJbmRleCBpbnRvIGluZm8g
YXJyYXkgZm9yIGN1cnJlbnRseSBpbnN0YWxsZWQgcGFja2FnZSAqLwotICBl
eGNsdWRlcyBleGNsdWRlOwkvKiB0cnVlIGlmIHRoaXMgcGFja2FnZSBzaG91
bGQgYmUgZXhjbHVkZWQgKi8KKyAgY2hhciAqbmFtZTsJCQkvKiBwYWNrYWdl
IG5hbWUsIGxpa2UgImN5Z3dpbiIgKi8KKyAgY2hhciAqc2Rlc2M7CQkJLyog
c2hvcnQgZGVzY3JpcHRpb24gKHJlcGxhY2VzICJuYW1lIiBpZiBwcm92aWRl
ZCkgKi8KKyAgY2hhciAqbGRlc2M7CQkJLyogbG9uZyBkZXNjcmlwdGlvbiAo
bXVsdGktbGluZSkgKi8KKyAgQ2F0ZWdvcnkgKmNhdGVnb3J5OwkJLyogdGhl
IGNhdGVnb3JpZXMgdGhlIHBhY2thZ2UgYmVsb25ncyB0byAqLworICBEZXBl
bmRlbmN5ICpyZXF1aXJlZDsJCS8qIHRoZSBwYWNrYWdlcyByZXF1aXJlZCBm
b3IgdGhpcyBwYWNrYWdlIHRvIHdvcmsgKi8KKyAgYWN0aW9ucyBhY3Rpb247
CQkvKiBBIHJhbmdlIG9mIHN0YXRlcyBhcHBsaWNhYmxlIHRvIHRoaXMgcGFj
a2FnZSAqLworICB0cnVzdHMgdHJ1c3Q7CQkJLyogU2VsZWN0cyBhbW9uZyBp
bmZvW10gYmVsb3csIGEgc3Vic2V0IG9mIGFjdGlvbiAqLworICBpbnQgc3Jj
cGlja2VkOwkJLyogVHJ1ZSBpZiBzb3VyY2UgaXMgcmVxdWlyZWQgKi8KKwor
ICBJbmZvICppbnN0YWxsZWQ7CQkvKiBJbmZvIG9uIGluc3RhbGxlZCBwYWNr
YWdlICovCisgIHRydXN0cyBpbnN0YWxsZWRfaXg7CQkvKiBJbmRleCBpbnRv
IGluZm8gYXJyYXkgZm9yIGN1cnJlbnRseSBpbnN0YWxsZWQgcGFja2FnZSAq
LworICBleGNsdWRlcyBleGNsdWRlOwkJLyogdHJ1ZSBpZiB0aGlzIHBhY2th
Z2Ugc2hvdWxkIGJlIGV4Y2x1ZGVkICovCiAKICAgLyogVGhlIHJlYXNvbiBm
b3IgdGhpcyB3ZWlyZCBsYXlvdXQgaXMgdG8gYWxsb3cgZm9yIGxvb3BzIHRo
YXQgc2NhbiBlaXRoZXIKICAgICAgdGhlIGluZm8gYXJyYXksIGJhc2VkIG9u
IHRydXN0IHZhbHVlIG9yIHRoZSBpbmZvc2NhbiBhcnJheSBiYXNlZCBvbiBh
IHBvaW50ZXIsCkBAIC0xNDAsMjAgKzE0NSwyMiBAQCBleHRlcm4gQ2F0ZWdv
cnkgKmNhdGVnb3J5OwogZXh0ZXJuIGludCBuY2F0ZWdvcmllczsKIAogI2lm
ZGVmIF9fY3BsdXNwbHVzCi1leHRlcm4gIkMiIHsKK2V4dGVybiAiQyIKK3sK
ICNlbmRpZgogCi1QYWNrYWdlICpuZXdfcGFja2FnZSAoY2hhciAqbmFtZSk7
Ci12b2lkCWluaV9pbml0IChjaGFyICpzdHJpbmcpOwotUGFja2FnZSAqZ2V0
cGtnYnluYW1lIChjb25zdCBjaGFyICpwa2duYW1lKTsKLXZvaWQgICAgbmV3
X3JlcXVpcmVtZW50IChQYWNrYWdlICpwYWNrYWdlLCBjaGFyICpkZXBlbmRz
b24pOwotQ2F0ZWdvcnkgKmdldGNhdGVnb3J5YnluYW1lIChjb25zdCBjaGFy
ICpjYXRlZ29yeW5hbWUpOwotQ2F0ZWdvcnkgKmdldHBhY2thZ2VjYXRlZ29y
eWJ5bmFtZSAoUGFja2FnZSAqcGtnLCBjb25zdCBjaGFyICpjYXRlZ29yeW5h
bWUpOyAKLUNhdGVnb3J5ICpyZWdpc3Rlcl9jYXRlZ29yeSAoY29uc3QgY2hh
ciAqbmFtZSk7Ci12b2lkICAgIGFkZF9jYXRlZ29yeSAoUGFja2FnZSAqcGFj
a2FnZSwgQ2F0ZWdvcnkgKmNhdCk7CisgIFBhY2thZ2UgKm5ld19wYWNrYWdl
IChjaGFyICpuYW1lKTsKKyAgdm9pZCBpbmlfaW5pdCAoY2hhciAqc3RyaW5n
KTsKKyAgUGFja2FnZSAqZ2V0cGtnYnluYW1lIChjb25zdCBjaGFyICpwa2du
YW1lKTsKKyAgdm9pZCBuZXdfcmVxdWlyZW1lbnQgKFBhY2thZ2UgKiBwYWNr
YWdlLCBjaGFyICpkZXBlbmRzb24pOworICBDYXRlZ29yeSAqZ2V0Y2F0ZWdv
cnlieW5hbWUgKGNvbnN0IGNoYXIgKmNhdGVnb3J5bmFtZSk7CisgIENhdGVn
b3J5ICpnZXRwYWNrYWdlY2F0ZWdvcnlieW5hbWUgKFBhY2thZ2UgKiBwa2cs
CisJCQkJICAgICAgY29uc3QgY2hhciAqY2F0ZWdvcnluYW1lKTsKKyAgQ2F0
ZWdvcnkgKnJlZ2lzdGVyX2NhdGVnb3J5IChjb25zdCBjaGFyICpuYW1lKTsK
KyAgdm9pZCBhZGRfY2F0ZWdvcnkgKFBhY2thZ2UgKiBwYWNrYWdlLCBDYXRl
Z29yeSAqIGNhdCk7CiAKICNpZmRlZiBfX2NwbHVzcGx1cwogfQogI2VuZGlm
CiAKLSNlbmRpZiAvKiBfSU5JX0hfICovCisjZW5kaWYJCQkJLyogX0lOSV9I
XyAqLwpJbmRleDogaW5pbGV4LmwKPT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQpS
Q1MgZmlsZTogL2N2cy9zcmMvc3JjL3dpbnN1cC9jaW5zdGFsbC9pbmlsZXgu
bCx2CnJldHJpZXZpbmcgcmV2aXNpb24gMi41CmRpZmYgLXUgLXAgLXIyLjUg
aW5pbGV4LmwKLS0tIGluaWxleC5sCTIwMDEvMDkvMjEgMTc6NTc6NTIJMi41
CisrKyBpbmlsZXgubAkyMDAxLzExLzExIDA2OjU0OjU2CkBAIC0yNyw3ICsy
Nyw3IEBACiAjZGVmaW5lIFlZX0lOUFVUKGJ1ZixyZXN1bHQsbWF4X3NpemUp
IHsgcmVzdWx0ID0gaW5pX2dldGNoYXIoYnVmLCBtYXhfc2l6ZSk7IH0KIAog
c3RhdGljIGludCBpbmlfZ2V0Y2hhcihjaGFyICpidWYsIGludCBtYXhfc2l6
ZSk7Ci1zdGF0aWMgdm9pZCBpZ25vcmVfbGluZSAoKTsKK3N0YXRpYyB2b2lk
IGlnbm9yZV9saW5lICh2b2lkKTsKIAogJX0KIApAQCAtMTE5LDcgKzExOSw3
IEBAIHN0YXRpYyB2b2lkCiBpZ25vcmVfbGluZSAoKQogewogICBjaGFyIGM7
Ci0gIHdoaWxlIChjID0gaW5wdXQgKCkpCisgIHdoaWxlICgoYyA9IGlucHV0
ICgpKSkKICAgICB7CiAgICAgICBpZiAoYyA9PSBFT0YpCiAJcmV0dXJuOwpJ
bmRleDogaW5zdGFsbC5jYwo9PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09ClJDUyBm
aWxlOiAvY3ZzL3NyYy9zcmMvd2luc3VwL2NpbnN0YWxsL2luc3RhbGwuY2Ms
dgpyZXRyaWV2aW5nIHJldmlzaW9uIDIuMjEKZGlmZiAtdSAtcCAtcjIuMjEg
aW5zdGFsbC5jYwotLS0gaW5zdGFsbC5jYwkyMDAxLzExLzAyIDAwOjUwOjE5
CTIuMjEKKysrIGluc3RhbGwuY2MJMjAwMS8xMS8xMSAwNjo1NDo1NgpAQCAt
MTcsOSArMTcsMTIgQEAKICAgIHRoZSBpbnN0YWxsIGxpc3QgKGluIGluaS5o
KS4gIE5vdGUgdGhhdCB3ZSB1c2UgYSBzZXBhcmF0ZSB0aHJlYWQgdG8KICAg
IG1haW50YWluIHRoZSBwcm9ncmVzcyBkaWFsb2csIHNvIHdlIGF2b2lkIHRo
ZSBjb21wbGV4aXR5IG9mCiAgICBoYW5kbGluZyB0d28gdGFza3MgaW4gb25l
IHRocmVhZC4gIFdlIGFsc28gY3JlYXRlIG9yIHVwZGF0ZSBhbGwgdGhlCi0g
ICBmaWxlcyBpbiAvZXRjL3NldHVwLyogYW5kIGNyZWF0ZSB0aGUgbW91bnQg
cG9pbnRzLiAqLworICAgZmlsZXMgaW4gL2V0Yy9zZXR1cC9cKiBhbmQgY3Jl
YXRlIHRoZSBtb3VudCBwb2ludHMuICovCiAKLXN0YXRpYyBjaGFyICpjdnNp
ZCA9ICJcbiUlJSAkSWQ6IGluc3RhbGwuY2MsdiAyLjIxIDIwMDEvMTEvMDIg
MDA6NTA6MTkgcmJjb2xsaW5zIEV4cCAkXG4iOworI2lmIDAKK3N0YXRpYyBj
b25zdCBjaGFyICpjdnNpZCA9CisgICJcbiUlJSAkSWQ6IGluc3RhbGwuY2Ms
diAyLjIxIDIwMDEvMTEvMDIgMDA6NTA6MTkgcmJjb2xsaW5zIEV4cCAkXG4i
OworI2VuZGlmCiAKICNpbmNsdWRlICJ3aW4zMi5oIgogI2luY2x1ZGUgImNv
bW1jdHJsLmgiCkBAIC0zOSw3ICs0Miw2IEBAIHN0YXRpYyBjaGFyICpjdnNp
ZCA9ICJcbiUlJSAkSWQ6IGluc3RhbGwKICNpbmNsdWRlICJnZXR1cmwuaCIK
ICNpbmNsdWRlICJta2Rpci5oIgogI2luY2x1ZGUgInN0YXRlLmgiCi0jaW5j
bHVkZSAidGFyLmgiCiAjaW5jbHVkZSAiZGlza2Z1bGwuaCIKICNpbmNsdWRl
ICJtc2cuaCIKICNpbmNsdWRlICJtb3VudC5oIgpAQCAtNDcsNiArNDksMTEg
QEAgc3RhdGljIGNoYXIgKmN2c2lkID0gIlxuJSUlICRJZDogaW5zdGFsbAog
I2luY2x1ZGUgImhhc2guaCIKICNpbmNsdWRlICJtb3VudC5oIgogI2luY2x1
ZGUgImZpbGVtYW5pcC5oIgorI2luY2x1ZGUgImlvX3N0cmVhbS5oIgorI2lu
Y2x1ZGUgImNvbXByZXNzLmgiCisjaW5jbHVkZSAiY29tcHJlc3NfZ3ouaCIK
KyNpbmNsdWRlICJhcmNoaXZlLmgiCisjaW5jbHVkZSAidGFyLmgiCiAKICNp
bmNsdWRlICJwb3J0LmgiCiAKQEAgLTcxLDEzICs3OCwxMiBAQCBkaWFsb2df
Y21kIChIV05EIGgsIGludCBpZCwgSFdORCBod25kY3RsCiAgICAgY2FzZSBJ
RENBTkNFTDoKICAgICAgIGV4aXRfc2V0dXAgKDEpOwogICAgIH0KKyAgcmV0
dXJuIDA7CiB9CiAKIHN0YXRpYyBCT09MIENBTExCQUNLCiBkaWFsb2dfcHJv
YyAoSFdORCBoLCBVSU5UIG1lc3NhZ2UsIFdQQVJBTSB3UGFyYW0sIExQQVJB
TSBsUGFyYW0pCiB7Ci0gIGludCBpLCBqOwotICBIV05EIGxpc3Rib3g7CiAg
IHN3aXRjaCAobWVzc2FnZSkKICAgICB7CiAgICAgY2FzZSBXTV9JTklURElB
TE9HOgpAQCAtMTAyLDE5ICsxMDgsMTkgQEAgZGlhbG9nICh2b2lkICopCiAg
IGludCBydiA9IDA7CiAgIE1TRyBtOwogICBIV05EIGluc19kaWFsb2cgPSBD
cmVhdGVEaWFsb2cgKGhpbnN0YW5jZSwgTUFLRUlOVFJFU09VUkNFIChJRERf
SU5TVEFUVVMpLAotCQkJCSAgIDAsIGRpYWxvZ19wcm9jKTsKKwkJCQkgIDAs
IGRpYWxvZ19wcm9jKTsKICAgaWYgKGluc19kaWFsb2cgPT0gMCkKICAgICBm
YXRhbCAoImNyZWF0ZSBkaWFsb2ciKTsKICAgU2hvd1dpbmRvdyAoaW5zX2Rp
YWxvZywgU1dfU0hPV05PUk1BTCk7CiAgIFVwZGF0ZVdpbmRvdyAoaW5zX2Rp
YWxvZyk7Ci0gIHdoaWxlIChHZXRNZXNzYWdlICgmbSwgMCwgMCwgMCkgPiAw
KSB7Ci0gICAgVHJhbnNsYXRlTWVzc2FnZSAoJm0pOwotICAgIERpc3BhdGNo
TWVzc2FnZSAoJm0pOwotICB9CisgIHdoaWxlIChHZXRNZXNzYWdlICgmbSwg
MCwgMCwgMCkgPiAwKQorICAgIHsKKyAgICAgIFRyYW5zbGF0ZU1lc3NhZ2Ug
KCZtKTsKKyAgICAgIERpc3BhdGNoTWVzc2FnZSAoJm0pOworICAgIH0KKyAg
cmV0dXJuIHJ2OwogfQogCi1zdGF0aWMgRFdPUkQgc3RhcnRfdGljczsKLQog
c3RhdGljIHZvaWQKIGluaXRfZGlhbG9nICgpCiB7CkBAIC0xNjAsMTQgKzE2
NiwxMyBAQCBwcm9ncmVzcyAoaW50IGJ5dGVzKQogc3RhdGljIHZvaWQKIGJh
ZHJlbmFtZSAoY2hhciAqbywgY2hhciAqbikKIHsKLSAgY2hhciBidWZbMTAw
MF07Ci0gIGNoYXIgKmVyciA9IHN0cmVycm9yIChlcnJubyk7CisgIGNvbnN0
IGNoYXIgKmVyciA9IHN0cmVycm9yIChlcnJubyk7CiAgIGlmICghZXJyKQog
ICAgIGVyciA9ICIodW5rbm93biBlcnJvcikiOwogICBub3RlIChJRFNfRVJS
X1JFTkFNRSwgbywgbiwgZXJyKTsKIH0KIAotc3RhdGljIGNoYXIgKnN0YW5k
YXJkX2RpcnNbXSA9IHsKK3N0YXRpYyBjb25zdCBjaGFyICpzdGFuZGFyZF9k
aXJzW10gPSB7CiAgICIvYmluIiwKICAgIi9ldGMiLAogICAiL2xpYiIsCkBA
IC0xOTEsMTQgKzE5NiwxNCBAQCBoYXNoOjphZGRfc3ViZGlycyAoY2hhciAq
cGF0aCkKIHsKICAgY2hhciAqbm9ucCwgKnBwOwogICBmb3IgKG5vbnAgPSBw
YXRoOyAqbm9ucCA9PSAnXFwnIHx8ICpub25wID09ICcvJzsgbm9ucCsrKTsK
LSAgZm9yIChwcCA9IHBhdGggKyBzdHJsZW4ocGF0aCkgLSAxOyBwcD5ub25w
OyBwcC0tKQorICBmb3IgKHBwID0gcGF0aCArIHN0cmxlbiAocGF0aCkgLSAx
OyBwcCA+IG5vbnA7IHBwLS0pCiAgICAgaWYgKCpwcCA9PSAnLycgfHwgKnBw
ID09ICdcXCcpCiAgICAgICB7Ci0JaW50IGksIHM9MDsKKwlpbnQgaSwgcyA9
IDA7CiAJY2hhciBjID0gKnBwOwogCSpwcCA9IDA7Ci0JZm9yIChpPTA7IHN0
YW5kYXJkX2RpcnNbaV07IGkrKykKLQkgIGlmIChzdHJjbXAgKHN0YW5kYXJk
X2RpcnNbaV0rMSwgcGF0aCkgPT0gMCkKKwlmb3IgKGkgPSAwOyBzdGFuZGFy
ZF9kaXJzW2ldOyBpKyspCisJICBpZiAoc3RyY21wIChzdGFuZGFyZF9kaXJz
W2ldICsgMSwgcGF0aCkgPT0gMCkKIAkgICAgewogCSAgICAgIHMgPSAxOwog
CSAgICAgIGJyZWFrOwpAQCAtMjA5LDI0ICsyMTQsMTggQEAgaGFzaDo6YWRk
X3N1YmRpcnMgKGNoYXIgKnBhdGgpCiAgICAgICB9CiB9CiAKLXN0YXRpYyBp
bnQKLWV4aXN0cyAoY29uc3QgY2hhciAqZmlsZSkKLXsKLSAgaWYgKF9hY2Nl
c3MgKGZpbGUsIDApID09IDApCi0gICAgcmV0dXJuIDE7Ci0gIHJldHVybiAw
OwotfQotCiBzdGF0aWMgaW50IG51bV9pbnN0YWxscywgbnVtX3VuaW5zdGFs
bHM7CiAKIHN0YXRpYyB2b2lkCi11bmluc3RhbGxfb25lIChQYWNrYWdlICpw
a2csIGJvb2wgc3JjKQordW5pbnN0YWxsX29uZSAoUGFja2FnZSAqIHBrZywg
Ym9vbCBzcmMpCiB7CiAgIGhhc2ggZGlyczsKICAgY2hhciBsaW5lW19NQVhf
UEFUSF07CiAKLSAgZ3pGaWxlIGxzdCA9IGd6b3BlbiAoY3lncGF0aCAoIi9l
dGMvc2V0dXAvIiwgcGtnLT5uYW1lLAotCQkJCShzcmMgPyAiLXNyYy5sc3Qu
Z3oiIDogIi5sc3QuZ3oiKSwgMCksICJyYiIpOworICBpb19zdHJlYW0gKnRt
cCA9CisgICAgaW9fc3RyZWFtOjpvcGVuIChjb25jYXQgKCJjeWdmaWxlOi8v
L2V0Yy9zZXR1cC8iLCBwa2ctPm5hbWUsCisJCQkgICAgIChzcmMgPyAiLXNy
Yy5sc3QuZ3oiIDogIi5sc3QuZ3oiKSwgMCksICJyYiIpOworICBpb19zdHJl
YW0gKmxzdCA9IGNvbXByZXNzOjpkZWNvbXByZXNzICh0bXApOwogICBpZiAo
bHN0KQogICAgIHsKICAgICAgIFNldFdpbmRvd1RleHQgKGluc19wa2duYW1l
LCBwa2ctPm5hbWUpOwpAQCAtMjM2LDEwICsyMzUsMTAgQEAgdW5pbnN0YWxs
X29uZSAoUGFja2FnZSAqcGtnLCBib29sIHNyYykKICAgICAgIGVsc2UKIAls
b2cgKDAsICJVbmluc3RhbGxpbmcgb2xkICVzIiwgcGtnLT5uYW1lKTsKIAot
ICAgICAgd2hpbGUgKGd6Z2V0cyAobHN0LCBsaW5lLCBzaXplb2YgKGxpbmUp
KSkKKyAgICAgIHdoaWxlIChsc3QtPmdldHMgKGxpbmUsIHNpemVvZiAobGlu
ZSkpKQogCXsKLQkgIGlmIChsaW5lW3N0cmxlbihsaW5lKS0xXSA9PSAnXG4n
KQotCSAgICBsaW5lW3N0cmxlbihsaW5lKS0xXSA9IDA7CisJICBpZiAobGlu
ZVtzdHJsZW4gKGxpbmUpIC0gMV0gPT0gJ1xuJykKKwkgICAgbGluZVtzdHJs
ZW4gKGxpbmUpIC0gMV0gPSAwOwogCiAJICBkaXJzLmFkZF9zdWJkaXJzIChs
aW5lKTsKIApAQCAtMjUxLDcgKzI1MCw3IEBAIHVuaW5zdGFsbF9vbmUgKFBh
Y2thZ2UgKnBrZywgYm9vbCBzcmMpCiAJICAgICAgRGVsZXRlRmlsZSAoZCk7
CiAJICAgIH0KIAl9Ci0gICAgICBnemNsb3NlIChsc3QpOworICAgICAgZGVs
ZXRlIGxzdDsKIAogICAgICAgcmVtb3ZlIChjeWdwYXRoICgiL2V0Yy9zZXR1
cC8iLCBwa2ctPm5hbWUsICIubHN0Lmd6IiwgMCkpOwogCkBAIC0yNzUsNDUg
KzI3NCw1NCBAQCB1bmluc3RhbGxfb25lIChQYWNrYWdlICpwa2csIGJvb2wg
c3JjKQogCiAKIHN0YXRpYyBpbnQKLWluc3RhbGxfb25lIChQYWNrYWdlICpw
a2csIGJvb2wgaXNTcmMpCitpbnN0YWxsX29uZSAoUGFja2FnZSAqIHBrZywg
Ym9vbCBpc1NyYykKIHsKICAgaW50IGVycm9ycyA9IDA7Ci0gIGNoYXIgKmV4
dHJhOworICBjb25zdCBjaGFyICpleHRyYTsKICAgY29uc3QgY2hhciAqZmls
ZTsKICAgaW50IGZpbGVfc2l6ZTsKKyAgYXJjaGl2ZSAqdGhlZmlsZSA9IE5V
TEw7CiAgIEluZm8gKnBpID0gcGtnLT5pbmZvICsgcGtnLT50cnVzdDsKIAog
ICBpZiAoIWlzU3JjKQogICAgIHsKICAgICAgIGV4dHJhID0gIiI7CiAgICAg
ICBmaWxlX3NpemUgPSBwaS0+aW5zdGFsbF9zaXplOwotICAgICAgZmlsZSA9
IHBpLT5pbnN0YWxsOworICAgICAgZmlsZSA9IGNvbmNhdCAoImZpbGU6Ly8i
LCBwaS0+aW5zdGFsbCwgMCk7CiAgICAgfQogICBlbHNlIGlmIChwaS0+c291
cmNlKQogICAgIHsKICAgICAgIGV4dHJhID0gIi1zcmMiOwogICAgICAgZmls
ZV9zaXplID0gcGktPnNvdXJjZV9zaXplOwotICAgICAgZmlsZSA9IHBpLT5z
b3VyY2U7CisgICAgICBmaWxlID0gY29uY2F0ICgiZmlsZTovLyIsIHBpLT5z
b3VyY2UsIDApOwogICAgIH0KICAgZWxzZQogICAgIHJldHVybiAwOwogCiAg
IGNoYXIgbmFtZVtzdHJsZW4gKHBrZy0+bmFtZSkgKyBzdHJsZW4gKGV4dHJh
KSArIDFdOwogICBzdHJjYXQgKHN0cmNweSAobmFtZSwgcGtnLT5uYW1lKSwg
ZXh0cmEpOwotICAKKworICAvKiBGSVhNRTogdGhpcyBtYXkgZmlsZSBub3cg
Ki8KICAgY2hhciAqYmFzZWYgPSBiYXNlIChmaWxlKTsKICAgU2V0V2luZG93
VGV4dCAoaW5zX3BrZ25hbWUsIGJhc2VmKTsKIAotICBpZiAoIWV4aXN0cyAo
ZmlsZSkpCisgIGlmICghaW9fc3RyZWFtOjpleGlzdHMgKGZpbGUpKQogICAg
IGZpbGUgPSBiYXNlZjsKLSAgaWYgKCFleGlzdHMgKGZpbGUpKQorICBpZiAo
IWlvX3N0cmVhbTo6ZXhpc3RzIChmaWxlKSkKICAgICB7CiAgICAgICBub3Rl
IChJRFNfRVJSX09QRU5fUkVBRCwgZmlsZSwgIk5vIHN1Y2ggZmlsZSIpOwog
ICAgICAgcmV0dXJuIDE7CiAgICAgfQogCi0gIGd6RmlsZSBsc3QgPSBnem9w
ZW4gKGN5Z3BhdGggKCIvZXRjL3NldHVwLyIsIG5hbWUsICIubHN0Lmd6Iiwg
MCksCi0JCSAgICAgICAid2I5Iik7CisgIGlvX3N0cmVhbSAqdG1wID0KKyAg
ICBpb19zdHJlYW06Om9wZW4gKGNvbmNhdCAoImN5Z2ZpbGU6Ly8vZXRjL3Nl
dHVwLyIsIG5hbWUsICIubHN0Lmd6IiwgMCksCisJCSAgICAgIndiIik7Cisg
IGlvX3N0cmVhbSAqbHN0ID0gbmV3IGNvbXByZXNzX2d6ICh0bXAsICJ3OSIp
OworICBpZiAobHN0LT5lcnJvciAoKSkKKyAgICB7CisgICAgICBkZWxldGUg
bHN0OworICAgICAgbHN0ID0gTlVMTDsKKyAgICB9CiAKICAgcGFja2FnZV9i
eXRlcyA9IGZpbGVfc2l6ZTsKIApAQCAtMzQyLDQ0ICszNTAsNjAgQEAgaW5z
dGFsbF9vbmUgKFBhY2thZ2UgKnBrZywgYm9vbCBpc1NyYykKICAgICBjYXNl
IEFDVElPTl9URVNUOgogICAgICAgc3RyY2F0IChtc2csICIgdGVzdCB2ZXJz
aW9uLi4uIik7CiAgICAgICBicmVhazsKKyAgICBkZWZhdWx0OgorICAgICAg
LyogRklYTUU6IGxvZyB0aGlzIHNvbWVob3cgKi8KKyAgICAgIGJyZWFrOwog
ICAgIH0KIAogICBTZXRXaW5kb3dUZXh0IChpbnNfYWN0aW9uLCBtc2cpOwog
ICBsb2cgKDAsICIlcyVzIiwgbXNnLCBmaWxlKTsKLSAgdGFyX29wZW4gKGZp
bGUpOwotCi0gIGNoYXIgKmZuOwotICB3aGlsZSAoZm4gPSB0YXJfbmV4dF9m
aWxlICgpKQorICB0bXAgPSBpb19zdHJlYW06Om9wZW4gKGZpbGUsICJyYiIp
OworICBpZiAodG1wKQogICAgIHsKLSAgICAgIGNoYXIgKmRlc3RfZmlsZTsK
KyAgICAgIGlvX3N0cmVhbSAqdG1wMiA9IGNvbXByZXNzOjpkZWNvbXByZXNz
ICh0bXApOworICAgICAgaWYgKHRtcDIpCisJdGhlZmlsZSA9IGFyY2hpdmU6
OmV4dHJhY3QgKHRtcDIpOworICAgICAgZWxzZQorCXRoZWZpbGUgPSBhcmNo
aXZlOjpleHRyYWN0ICh0bXApOworICAgICAgLyogRklYTUU6IHBvdGVudGlh
bCBsZWFrIG9mIGVpdGhlciAqdG1wIG9yICp0bXAyICovCisgICAgICBpZiAo
dGhlZmlsZSkKKwl7CisJICBjb25zdCBjaGFyICpmbjsKKwkgIHdoaWxlICgo
Zm4gPSB0aGVmaWxlLT5uZXh0X2ZpbGVfbmFtZSAoKSkpCisJICAgIHsKKwkg
ICAgICBjaGFyICpkZXN0X2ZpbGU7CiAKLSAgICAgIGlmIChsc3QpCi0JZ3pw
cmludGYgKGxzdCwgIiVzXG4iLCBmbik7CisJICAgICAgaWYgKGxzdCkKKwkJ
bHN0LT53cml0ZSAoY29uY2F0IChmbiwgIlxuIiwgMCksIHN0cmxlbiAoZm4p
ICsgMSk7CiAKLSAgICAgIGRlc3RfZmlsZSA9IGN5Z3BhdGggKGlzU3JjID8g
Ii91c3Ivc3JjLyIgOiAiLyIsIGZuLCBOVUxMKTsKKwkgICAgICBkZXN0X2Zp
bGUgPQorCQljb25jYXQgKCJjeWdmaWxlOi8vIiwgaXNTcmMgPyAiL3Vzci9z
cmMvIiA6ICIvIiwgTlVMTCk7CiAKLSAgICAgIFNldFdpbmRvd1RleHQgKGlu
c19maWxlbmFtZSwgZGVzdF9maWxlKTsKLSAgICAgIGxvZyAoTE9HX0JBQkJM
RSwgIkluc3RhbGxpbmcgZmlsZSAlcyIsIGRlc3RfZmlsZSk7Ci0gICAgICBp
ZiAodGFyX3JlYWRfZmlsZSAoZGVzdF9maWxlKSAhPSAwKQotCXsKLQkgIGxv
ZyAoMCwgIlVuYWJsZSB0byBpbnN0YWxsIGZpbGUgJXMiLCBkZXN0X2ZpbGUp
OwotCSAgZXJyb3JzKys7Ci0JfQorCSAgICAgIC8qIEZJWE1FOiBjb25jYXQg
bGVha3MgbWVtb3J5ICovCisJICAgICAgU2V0V2luZG93VGV4dCAoaW5zX2Zp
bGVuYW1lLCBjb25jYXQgKGRlc3RfZmlsZSwgZm4sIDApKTsKKwkgICAgICBs
b2cgKExPR19CQUJCTEUsICJJbnN0YWxsaW5nIGZpbGUgJXMlcyIsIGRlc3Rf
ZmlsZSwgZm4pOworCSAgICAgIGlmIChhcmNoaXZlOjpleHRyYWN0X2ZpbGUg
KHRoZWZpbGUsIGRlc3RfZmlsZSkgIT0gMCkKKwkJeworCQkgIGxvZyAoMCwg
IlVuYWJsZSB0byBpbnN0YWxsIGZpbGUgJXMlcyIsIGRlc3RfZmlsZSwgZm4p
OworCQkgIGVycm9ycysrOworCQl9CisKKwkgICAgICBwcm9ncmVzcyAodG1w
LT50ZWxsICgpKTsKKwkgICAgICBmcmVlIChkZXN0X2ZpbGUpOworCSAgICAg
IG51bV9pbnN0YWxscysrOworCSAgICB9CisJICBkZWxldGUgdGhlZmlsZTsK
IAotICAgICAgcHJvZ3Jlc3MgKHRhcl9mdGVsbCAoKSk7Ci0gICAgICBmcmVl
IChkZXN0X2ZpbGUpOyAKLSAgICAgIG51bV9pbnN0YWxscysrOworCSAgdG90
YWxfYnl0ZXNfc29mYXIgKz0gZmlsZV9zaXplOworCX0KICAgICB9Ci0gIHRh
cl9jbG9zZSAoKTsKLQotICB0b3RhbF9ieXRlc19zb2ZhciArPSBmaWxlX3Np
emU7CiAgIHByb2dyZXNzICgwKTsKIAogICBpbnQgZGYgPSBkaXNrZnVsbCAo
Z2V0X3Jvb3RfZGlyICgpKTsKICAgU2VuZE1lc3NhZ2UgKGluc19kaXNrZnVs
bCwgUEJNX1NFVFBPUywgKFdQQVJBTSkgZGYsIDApOwogCiAgIGlmIChsc3Qp
Ci0gICAgZ3pjbG9zZSAobHN0KTsKKyAgICBkZWxldGUgbHN0OwogCiAgIGlm
ICghZXJyb3JzKQogICAgIHsKQEAgLTM4Nyw3ICs0MTEsOSBAQCBpbnN0YWxs
X29uZSAoUGFja2FnZSAqcGtnLCBib29sIGlzU3JjKQogICAgICAgcGtnLT5p
bnN0YWxsZWRfaXggPSBwa2ctPnRydXN0OwogICAgICAgaWYgKHBrZy0+aW5z
dGFsbGVkKQogCWZyZWUgKHBrZy0+aW5zdGFsbGVkKTsKLSAgICAgIHBrZy0+
aW5zdGFsbGVkID0gbmV3IEluZm8gKGluZi0+aW5zdGFsbCwgaW5mLT52ZXJz
aW9uLCBpbmYtPmluc3RhbGxfc2l6ZSwgaW5mLT5zb3VyY2UsIGluZi0+c291
cmNlX3NpemUpOworICAgICAgcGtnLT5pbnN0YWxsZWQgPQorCW5ldyBJbmZv
IChpbmYtPmluc3RhbGwsIGluZi0+dmVyc2lvbiwgaW5mLT5pbnN0YWxsX3Np
emUsIGluZi0+c291cmNlLAorCQkgIGluZi0+c291cmNlX3NpemUpOwogICAg
IH0KIAogICByZXR1cm4gZXJyb3JzOwpAQCAtNDA0LDIyICs0MzAsMjYgQEAg
Y2hlY2tfZm9yX29sZF9jeWd3aW4gKCkKICAgICByZXR1cm47CiAKICAgY2hh
ciBtc2dbc2l6ZW9mIChidWYpICsgMTMyXTsKLSAgc3ByaW50ZiAobXNnLCAi
QW4gb2xkIHZlcnNpb24gb2YgY3lnd2luMS5kbGwgd2FzIGZvdW5kIGhlcmU6
XHJcbiVzXHJcbkRlbGV0ZT8iLCBidWYpOwotICBzd2l0Y2ggKE1lc3NhZ2VC
b3ggKE5VTEwsIG1zZywKLQkJICAgICAgIldoYXQncyB0aGF0IGRvaW5nIHRo
ZXJlPyIsIE1CX1lFU05PIHwgTUJfSUNPTlFVRVNUSU9OIHwgTUJfVEFTS01P
REFMKSkKKyAgc3ByaW50ZiAobXNnLAorCSAgICJBbiBvbGQgdmVyc2lvbiBv
ZiBjeWd3aW4xLmRsbCB3YXMgZm91bmQgaGVyZTpcclxuJXNcclxuRGVsZXRl
PyIsCisJICAgYnVmKTsKKyAgc3dpdGNoIChNZXNzYWdlQm94CisJICAoTlVM
TCwgbXNnLCAiV2hhdCdzIHRoYXQgZG9pbmcgdGhlcmU/IiwKKwkgICBNQl9Z
RVNOTyB8IE1CX0lDT05RVUVTVElPTiB8IE1CX1RBU0tNT0RBTCkpCiAgICAg
ewogICAgIGNhc2UgSURZRVM6CiAgICAgICBpZiAoIURlbGV0ZUZpbGUgKGJ1
ZikpCiAJewogCSAgc3ByaW50ZiAobXNnLCAiQ291bGRuJ3QgZGVsZXRlIGZp
bGUgJXMuXHJcbiIKLQkJCSJJcyB0aGUgRExMIGluIHVzZSBieSBhbm90aGVy
IGFwcGxpY2F0aW9uP1xyXG4iCi0JCQkiWW91IHNob3VsZCBkZWxldGUgdGhl
IG9sZCB2ZXJzaW9uIG9mIGN5Z3dpbjEuZGxsXHJcbmF0IHlvdXIgZWFybGll
c3QgY29udmVuaWVuY2UuIiwKLQkJCWJ1Zik7Ci0JICBNZXNzYWdlQm94IChO
VUxMLCBidWYsICJDb3VsZG4ndCBkZWxldGUgZmlsZSIsIE1CX09LIHwgTUJf
SUNPTkVYQ0xBTUFUSU9OIHwgTUJfVEFTS01PREFMKTsKKwkJICAgIklzIHRo
ZSBETEwgaW4gdXNlIGJ5IGFub3RoZXIgYXBwbGljYXRpb24/XHJcbiIKKwkJ
ICAgIllvdSBzaG91bGQgZGVsZXRlIHRoZSBvbGQgdmVyc2lvbiBvZiBjeWd3
aW4xLmRsbFxyXG5hdCB5b3VyIGVhcmxpZXN0IGNvbnZlbmllbmNlLiIsCisJ
CSAgIGJ1Zik7CisJICBNZXNzYWdlQm94IChOVUxMLCBidWYsICJDb3VsZG4n
dCBkZWxldGUgZmlsZSIsCisJCSAgICAgIE1CX09LIHwgTUJfSUNPTkVYQ0xB
TUFUSU9OIHwgTUJfVEFTS01PREFMKTsKIAl9CiAgICAgICBicmVhazsKICAg
ICBkZWZhdWx0OgotCWJyZWFrOworICAgICAgYnJlYWs7CiAgICAgfQogCiAg
IHJldHVybjsKQEAgLTQzNyw3ICs0NjcsNyBAQCBkb19pbnN0YWxsIChISU5T
VEFOQ0UgaCkKIAogICBta2Rpcl9wICgxLCBnZXRfcm9vdF9kaXIgKCkpOwog
Ci0gIGZvciAoaT0wOyBzdGFuZGFyZF9kaXJzW2ldOyBpKyspCisgIGZvciAo
aSA9IDA7IHN0YW5kYXJkX2RpcnNbaV07IGkrKykKICAgICB7CiAgICAgICBj
aGFyICpwID0gY3lncGF0aCAoc3RhbmRhcmRfZGlyc1tpXSwgMCk7CiAgICAg
ICBta2Rpcl9wICgxLCBwKTsKQEAgLTQ0NSwxMSArNDc1LDggQEAgZG9faW5z
dGFsbCAoSElOU1RBTkNFIGgpCiAgICAgfQogCiAgIC8qIENyZWF0ZSAvdmFy
L3J1bi91dG1wICovCi0gIGNoYXIgKnV0bXAgPSBjeWdwYXRoICgiL3Zhci9y
dW4vdXRtcCIsIDApOwotICBGSUxFICp1ZnAgPSBmb3BlbiAodXRtcCwgIndi
Iik7Ci0gIGlmICh1ZnApCi0gICAgZmNsb3NlICh1ZnApOwotICBmcmVlICh1
dG1wKTsKKyAgaW9fc3RyZWFtICp1dG1wID0gaW9fc3RyZWFtOjpvcGVuICgi
Y3lnZmlsZTovLy92YXIvcnVuL3V0bXAiLCAid2IiKTsKKyAgZGVsZXRlIHV0
bXA7CiAKICAgZGlzbWlzc191cmxfc3RhdHVzX2RpYWxvZyAoKTsKIApAQCAt
NDY5LDcgKzQ5Niw3IEBAIGRvX2luc3RhbGwgKEhJTlNUQU5DRSBoKQogICBj
cmVhdGVfbW91bnQgKCIvdXNyL2xpYiIsIGN5Z3BhdGggKCIvbGliIiwgMCks
IGlzdGV4dCwgaXNzeXN0ZW0pOwogICBzZXRfY3lnZHJpdmVfZmxhZ3MgKGlz
dGV4dCwgaXNzeXN0ZW0pOwogCi0gIGZvciAoUGFja2FnZSAqcGtnID0gcGFj
a2FnZTsgcGtnLT5uYW1lOyBwa2crKykKKyAgZm9yIChQYWNrYWdlICogcGtn
ID0gcGFja2FnZTsgcGtnLT5uYW1lOyBwa2crKykKICAgICB7CiAgICAgICBJ
bmZvICpwaSA9IHBrZy0+aW5mbyArIHBrZy0+dHJ1c3Q7CiAgICAgICBpZiAo
cGtnLT5hY3Rpb24gIT0gQUNUSU9OX1NSQ19PTkxZKQpAQCAtNDc4LDcgKzUw
NSw3IEBAIGRvX2luc3RhbGwgKEhJTlNUQU5DRSBoKQogCXRvdGFsX2J5dGVz
ICs9IHBpLT5zb3VyY2Vfc2l6ZTsKICAgICB9CiAKLSAgZm9yIChQYWNrYWdl
ICpwa2cgPSBwYWNrYWdlOyBwa2ctPm5hbWU7IHBrZysrKQorICBmb3IgKFBh
Y2thZ2UgKiBwa2cgPSBwYWNrYWdlOyBwa2ctPm5hbWU7IHBrZysrKQogICAg
IHsKICAgICAgIGlmIChpc191bmluc3RhbGxfYWN0aW9uIChwa2cpKQogCXsK
QEAgLTQ5OSw3ICs1MjYsNyBAQCBkb19pbnN0YWxsIChISU5TVEFOQ0UgaCkK
IAkgICAgICBlcnJvcnMrKzsKIAkgICAgfQogCX0KLSAgICB9IC8vIGVuZCBv
ZiBiaWcgcGFja2FnZSBsb29wCisgICAgfQkJCQkvLyBlbmQgb2YgYmlnIHBh
Y2thZ2UgbG9vcAogCiAgIFNob3dXaW5kb3cgKGluc19kaWFsb2csIFNXX0hJ
REUpOwogCkBAIC01MTQsNyArNTQxLDcgQEAgZG9faW5zdGFsbCAoSElOU1RB
TkNFIGgpCiAKICAgaWYgKCFuZGIpCiAgICAgewotICAgICAgY2hhciAqZXJy
ID0gc3RyZXJyb3IgKGVycm5vKTsKKyAgICAgIGNvbnN0IGNoYXIgKmVyciA9
IHN0cmVycm9yIChlcnJubyk7CiAgICAgICBpZiAoIWVycikKIAllcnIgPSAi
KHVua25vd24gZXJyb3IpIjsKICAgICAgIGZhdGFsIChJRFNfRVJSX09QRU5f
V1JJVEUsIG5kYiwgZXJyKTsKQEAgLTUyMywxOCArNTUwLDE5IEBAIGRvX2lu
c3RhbGwgKEhJTlNUQU5DRSBoKQogICBpZiAob2RiKQogICAgIHsKICAgICAg
IGNoYXIgbGluZVsxMDAwXSwgcGtnbmFtZVsxMDAwXTsKLSAgICAgIGludCBw
cmludGl0OwogICAgICAgd2hpbGUgKGZnZXRzIChsaW5lLCAxMDAwLCBvZGIp
KQogCXsKIAkgIHNzY2FuZiAobGluZSwgIiVzIiwgcGtnbmFtZSk7CiAJICBQ
YWNrYWdlICpwa2cgPSBnZXRwa2dieW5hbWUgKHBrZ25hbWUpOwotCSAgaWYg
KCFwa2cgfHwgKCFpc19kb3dubG9hZF9hY3Rpb24gKHBrZykgJiYgcGtnLT5h
Y3Rpb24gIT0gQUNUSU9OX1VOSU5TVEFMTCkpCisJICBpZiAoIXBrZworCSAg
ICAgIHx8ICghaXNfZG93bmxvYWRfYWN0aW9uIChwa2cpCisJCSAgJiYgcGtn
LT5hY3Rpb24gIT0gQUNUSU9OX1VOSU5TVEFMTCkpCiAJICAgIGZwdXRzIChs
aW5lLCBuZGIpOwogCX0KIAogICAgIH0KIAotICBmb3IgKFBhY2thZ2UgKnBr
ZyA9IHBhY2thZ2U7IHBrZy0+bmFtZTsgcGtnKyspCisgIGZvciAoUGFja2Fn
ZSAqIHBrZyA9IHBhY2thZ2U7IHBrZy0+bmFtZTsgcGtnKyspCiAgICAgaWYg
KGlzX2Rvd25sb2FkX2FjdGlvbiAocGtnKSkKICAgICAgIHsKIAlJbmZvICpw
aSA9IHBrZy0+aW5mbyArIHBrZy0+aW5zdGFsbGVkX2l4OwpJbmRleDogbG9j
YWxkaXIuY2MKPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQpSQ1MgZmlsZTogL2N2
cy9zcmMvc3JjL3dpbnN1cC9jaW5zdGFsbC9sb2NhbGRpci5jYyx2CnJldHJp
ZXZpbmcgcmV2aXNpb24gMi4zCmRpZmYgLXUgLXAgLXIyLjMgbG9jYWxkaXIu
Y2MKLS0tIGxvY2FsZGlyLmNjCTIwMDEvMTEvMDYgMDM6NDE6MDAJMi4zCisr
KyBsb2NhbGRpci5jYwkyMDAxLzExLzExIDA2OjU0OjU2CkBAIC0xNSwxMSAr
MTUsMTMgQEAKICAqLwogCiAvKiBUaGUgcHVycG9zZSBvZiB0aGlzIGZpbGUg
aXMgdG8gYXNrIHRoZSB1c2VyIHdoZXJlIHRoZXkgd2FudCB0aGUKLSAgIHJv
b3Qgb2YgdGhlIGluc3RhbGxhdGlvbiB0byBiZSwgYW5kIHRvIGFzayB3aGV0
aGVyIHRoZSB1c2VyIHByZWZlcnMKLSAgIHRleHQgb3IgYmluYXJ5IG1vdW50
cy4gKi8KKyAqIGxvY2FsbHkgZG93bmxvYWRlZCBwYWNrYWdlIGZpbGVzIHRv
IGJlIGNhY2hlZAorICovCiAKLXN0YXRpYyBjaGFyICpjdnNpZCA9Ci0gICJc
biUlJSAkSWQ6IGxvY2FsZGlyLmNjLHYgMi4zIDIwMDEvMTEvMDYgMDM6NDE6
MDAgcmJjb2xsaW5zIEV4cCAkXG4iOworI2lmIDAKK3N0YXRpYyBjb25zdCBj
aGFyICpjdnNpZCA9CisgICJcbiUlJSAkSWQ6IGxvY2FsZGlyLmNjLHYgMi4y
IDIwMDEvMTEvMDEgMTM6MjI6NDYgcmJjb2xsaW5zIEV4cCAkXG4iOworI2Vu
ZGlmCiAKICNpbmNsdWRlICJ3aW4zMi5oIgogI2luY2x1ZGUgPHNobG9iai5o
PgpAQCAtMzUsMzQgKzM3LDIzIEBAIHN0YXRpYyBjaGFyICpjdnNpZCA9CiAj
aW5jbHVkZSAiY29uY2F0LmgiCiAjaW5jbHVkZSAibG9nLmgiCiAjaW5jbHVk
ZSAibWtkaXIuaCIKKyNpbmNsdWRlICJpb19zdHJlYW0uaCIKIAotc3RhdGlj
IHZvaWQKLWdldF9yb290X2Rpcl9ub3cgKCkKLXsKLSAgaW50IGlzdGV4dDsK
LSAgaW50IGlzc3lzdGVtOwotICBpZiAoZ2V0X3Jvb3RfZGlyICgpKQotICAg
IHJldHVybjsKLSAgcmVhZF9tb3VudHMgKCk7Ci19Ci0KIHZvaWQKIHNhdmVf
bG9jYWxfZGlyICgpCiB7Ci0gIGdldF9yb290X2Rpcl9ub3cgKCk7Ci0gIGlm
ICghZ2V0X3Jvb3RfZGlyICgpKQotICAgIHJldHVybjsKLQogICBta2Rpcl9w
ICgxLCBsb2NhbF9kaXIpOwogCi0gIEZJTEUgKmYgPSBmb3BlbiAoY3lncGF0
aCAoIi9ldGMvc2V0dXAvbGFzdC1jYWNoZSIsIDApLCAid2IiKTsKLSAgaWYg
KCFmKQotICAgIHJldHVybjsKLSAgZnByaW50ZiAoZiwgIiVzIiwgbG9jYWxf
ZGlyKTsKLSAgZmNsb3NlIChmKTsKKyAgaW9fc3RyZWFtICpmID0gaW9fc3Ry
ZWFtOjpvcGVuICgiY3lnZmlsZTovLy9ldGMvc2V0dXAvbGFzdC1jYWNoZSIs
ICJ3YiIpOworICBpZiAoZikKKyAgICB7CisgICAgICBjaGFyIHRlbXBbMTAw
MF07CisgICAgICBzcHJpbnRmICh0ZW1wLCAiJXMiLCBsb2NhbF9kaXIpOwor
ICAgICAgZi0+d3JpdGUgKHRlbXAsIHN0cmxlbiAodGVtcCkpOworICAgICAg
ZGVsZXRlIGY7CisgICAgfQogfQogCi0KIHN0YXRpYyB2b2lkCiBjaGVja19p
Zl9lbmFibGVfbmV4dCAoSFdORCBoKQogewpAQCAtMTE2LDcgKzEwNyw2IEBA
IGJyb3dzZSAoSFdORCBoKQogICAgIH0KIH0KIAotCiBzdGF0aWMgQk9PTAog
ZGlhbG9nX2NtZCAoSFdORCBoLCBpbnQgaWQsIEhXTkQgaHduZGN0bCwgVUlO
VCBjb2RlKQogewpAQCAtMTc2LDYgKzE2Niw3IEBAIGRpYWxvZ19jbWQgKEhX
TkQgaCwgaW50IGlkLCBIV05EIGh3bmRjdGwKICAgICAgIE5FWFQgKDApOwog
ICAgICAgYnJlYWs7CiAgICAgfQorICByZXR1cm4gMDsKIH0KIAogc3RhdGlj
IEJPT0wgQ0FMTEJBQ0sKQEAgLTIwMCwxMyArMTkxLDEzIEBAIGRvX2xvY2Fs
X2RpciAoSElOU1RBTkNFIGgpCiAgIHN0YXRpYyBpbnQgaW5pdGVkID0gMDsK
ICAgaWYgKCFpbml0ZWQpCiAgICAgewotICAgICAgRklMRSAqZiA9IGZvcGVu
IChjeWdwYXRoICgiL2V0Yy9zZXR1cC9sYXN0LWNhY2hlIiwgMCksICJydCIp
OworICAgICAgaW9fc3RyZWFtICpmID0KKwlpb19zdHJlYW06Om9wZW4gKCJj
eWdmaWxlOi8vL2V0Yy9zZXR1cC9sYXN0LWNhY2hlIiwgInJ0Iik7CiAgICAg
ICBpZiAoZikKIAl7CiAJICBjaGFyIGxvY2FsZGlyWzEwMDBdOwotCSAgbG9j
YWxkaXJbMF0gPSAnXDAnOwotCSAgY2hhciAqZmdfcmV0ID0gZmdldHMgKGxv
Y2FsZGlyLCAxMDAwLCBmKTsKLQkgIGZjbG9zZSAoZik7CisJICBjaGFyICpm
Z19yZXQgPSBmLT5nZXRzIChsb2NhbGRpciwgMTAwMCk7CisJICBkZWxldGUg
ZjsKIAkgIGlmIChmZ19yZXQpCiAJICAgIHsKIAkgICAgICBmcmVlIChsb2Nh
bF9kaXIpOwpJbmRleDogbG9nLmNjCj09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0K
UkNTIGZpbGU6IC9jdnMvc3JjL3NyYy93aW5zdXAvY2luc3RhbGwvbG9nLmNj
LHYKcmV0cmlldmluZyByZXZpc2lvbiAyLjQKZGlmZiAtdSAtcCAtcjIuNCBs
b2cuY2MKLS0tIGxvZy5jYwkyMDAxLzA1LzI3IDA3OjA1OjA5CTIuNAorKysg
bG9nLmNjCTIwMDEvMTEvMTEgMDY6NTQ6NTcKQEAgLTE1LDcgKzE1LDEwIEBA
CiAKIC8qIFRoZSBwdXJwb3NlIG9mIHRoaXMgZmlsZSBpcyB0byBjZW50cmFs
aXplIGFsbCB0aGUgbG9nZ2luZyBmdW5jdGlvbnMuICovCiAKLXN0YXRpYyBj
aGFyICpjdnNpZCA9ICJcbiUlJSAkSWQ6IGxvZy5jYyx2IDIuNCAyMDAxLzA1
LzI3IDA3OjA1OjA5IGNnZiBFeHAgJFxuIjsKKyNpZiAwCitzdGF0aWMgY29u
c3QgY2hhciAqY3ZzaWQgPQorICAiXG4lJSUgJElkOiBsb2cuY2MsdiAyLjQg
MjAwMS8wNS8yNyAwNzowNTowOSBjZ2YgRXhwICRcbiI7CisjZW5kaWYKIAog
I2luY2x1ZGUgIndpbjMyLmgiCiAjaW5jbHVkZSA8c3RkaW8uaD4KQEAgLTMy
LDcgKzM1LDggQEAgc3RhdGljIGNoYXIgKmN2c2lkID0gIlxuJSUlICRJZDog
bG9nLmNjLAogI2luY2x1ZGUgIm1rZGlyLmgiCiAjaW5jbHVkZSAibW91bnQu
aCIKIAotc3RydWN0IExvZ0VudCB7CitzdHJ1Y3QgTG9nRW50Cit7CiAgIExv
Z0VudCAqbmV4dDsKICAgaW50IGZsYWdzOwogICB0aW1lX3Qgd2hlbjsKQEAg
LTQzLDcgKzQ3LDcgQEAgc3RhdGljIExvZ0VudCAqZmlyc3RfbG9nZW50ID0g
MDsKIHN0YXRpYyBMb2dFbnQgKipuZXh0X2xvZ2VudCA9ICZmaXJzdF9sb2dl
bnQ7CiAKIHZvaWQKLWxvZyAoaW50IGZsYWdzLCBjaGFyICpmbXQsIC4uLikK
K2xvZyAoaW50IGZsYWdzLCBjb25zdCBjaGFyICpmbXQsIC4uLikKIHsKICAg
Y2hhciBidWZbMTAwMF07CiAgIHZhX2xpc3QgYXJnczsKQEAgLTcwLDcgKzc0
LDcgQEAgbG9nIChpbnQgZmxhZ3MsIGNoYXIgKmZtdCwgLi4uKQogfQogCiB2
b2lkCi1sb2dfc2F2ZSAoaW50IGJhYmJsZSwgY2hhciAqZmlsZW5hbWUsIGlu
dCBhcHBlbmQpCitsb2dfc2F2ZSAoaW50IGJhYmJsZSwgY29uc3QgY2hhciAq
ZmlsZW5hbWUsIGludCBhcHBlbmQpCiB7CiAgIHN0YXRpYyBpbnQgYmVlbl9o
ZXJlID0gMDsKICAgaWYgKGJlZW5faGVyZSkKQEAgLTg4LDEyICs5MiwxMiBA
QCBsb2dfc2F2ZSAoaW50IGJhYmJsZSwgY2hhciAqZmlsZW5hbWUsIGluCiAK
ICAgTG9nRW50ICpsOwogCi0gIGZvciAobD1maXJzdF9sb2dlbnQ7IGw7IGw9
bC0+bmV4dCkKKyAgZm9yIChsID0gZmlyc3RfbG9nZW50OyBsOyBsID0gbC0+
bmV4dCkKICAgICB7CiAgICAgICBpZiAoYmFiYmxlIHx8ICEobC0+ZmxhZ3Mg
JiBMT0dfQkFCQkxFKSkKIAl7CiAJICBmcHV0cyAobC0+bXNnLCBmKTsKLQkg
IGlmIChsLT5tc2dbc3RybGVuKGwtPm1zZyktMV0gIT0gJ1xuJykKKwkgIGlm
IChsLT5tc2dbc3RybGVuIChsLT5tc2cpIC0gMV0gIT0gJ1xuJykKIAkgICAg
ZnB1dGMgKCdcbicsIGYpOwogCX0KICAgICB9CkluZGV4OiBsb2cuaAo9PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09ClJDUyBmaWxlOiAvY3ZzL3NyYy9zcmMvd2lu
c3VwL2NpbnN0YWxsL2xvZy5oLHYKcmV0cmlldmluZyByZXZpc2lvbiAyLjEK
ZGlmZiAtdSAtcCAtcjIuMSBsb2cuaAotLS0gbG9nLmgJMjAwMC8wOC8yNSAw
MTozMjowOAkyLjEKKysrIGxvZy5oCTIwMDEvMTEvMTEgMDY6NTQ6NTcKQEAg
LTIwLDEzICsyMCwxNCBAQAogI2RlZmluZSBMT0dfQkFCQkxFCTEKICNkZWZp
bmUgTE9HX1RJTUVTVEFNUAkyCiAKLXZvaWQgbG9nIChpbnQgZmxhZ3MsIGNo
YXIgKmZtdCwgLi4uKTsKK3ZvaWQgbG9nIChpbnQgZmxhZ3MsIGNvbnN0IGNo
YXIgKmZtdCwgLi4uKQorICBfX2F0dHJpYnV0ZV9fICgoZm9ybWF0IChwcmlu
dGYsIDIsIDMpKSk7CiAKIC8qIEhlcmUsICJiYWJibGUiIG1lYW5zIHRvIHdy
aXRlIG91dCB0aGUgYmFiYmxlIGFsc28uICBJZiAiYXBwZW5kIiBpcwogICAg
bm9uemVybywgdGhlIGxvZyBpcyBhcHBlbmRlZCB0byBhbnkgZXhpc3Rpbmcg
ZmlsZS4gKi8KIAotdm9pZCBsb2dfc2F2ZSAoaW50IGJhYmJsZSwgY2hhciAq
ZmlsZW5hbWUsIGludCBhcHBlbmQpOwordm9pZCBsb2dfc2F2ZSAoaW50IGJh
YmJsZSwgY29uc3QgY2hhciAqZmlsZW5hbWUsIGludCBhcHBlbmQpOwogCiAv
KiBUaGlzIGlzIHRoZSBvbmx5IGxlZ2FsIHdheSB0byBleGl0LiAgSXQgd3Jp
dGVzIG91dCBhbGwgdGhlIGxvZ3MgYW5kIHRoaW5ncyAqLwogCi12b2lkIGV4
aXRfc2V0dXAgKGludCBleGl0X2NvZGUpOwordm9pZCBleGl0X3NldHVwIChp
bnQgZXhpdF9jb2RlKSBfX2F0dHJpYnV0ZV9fICgobm9yZXR1cm4pKTsKSW5k
ZXg6IG1haW4uY2MKPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQpSQ1MgZmlsZTog
L2N2cy9zcmMvc3JjL3dpbnN1cC9jaW5zdGFsbC9tYWluLmNjLHYKcmV0cmll
dmluZyByZXZpc2lvbiAyLjgKZGlmZiAtdSAtcCAtcjIuOCBtYWluLmNjCi0t
LSBtYWluLmNjCTIwMDEvMTEvMDEgMDE6NTg6MTkJMi44CisrKyBtYWluLmNj
CTIwMDEvMTEvMTEgMDY6NTQ6NTcKQEAgLTIzLDcgKzIzLDEwIEBACiAgICB0
aG9zZSBkb24ndCBjb3VudCwgYWx0aG91Z2ggdGhleSBjb3VsZCkuICBSZXBs
YWNlIHRoZSBJRERfU18qIHdpdGgKICAgIElERF8qIGlmIHlvdSBjcmVhdGUg
YSByZWFsIGRpYWxvZyBmb3IgdGhvc2Ugc3RlcHMuICovCiAKLXN0YXRpYyBj
aGFyICpjdnNpZCA9ICJcbiUlJSAkSWQ6IG1haW4uY2MsdiAyLjggMjAwMS8x
MS8wMSAwMTo1ODoxOSByYmNvbGxpbnMgRXhwICRcbiI7CisjaWYgMAorc3Rh
dGljIGNvbnN0IGNoYXIgKmN2c2lkID0KKyAgIlxuJSUlICRJZDogbWFpbi5j
Yyx2IDIuOCAyMDAxLzExLzAxIDAxOjU4OjE5IHJiY29sbGlucyBFeHAgJFxu
IjsKKyNlbmRpZgogCiAjaW5jbHVkZSAid2luMzIuaCIKIApAQCAtNjIsMTAg
KzY1LDEwIEBAIHZvaWQKIHNldF9kZWZhdWx0X2RhY2wgKCkKIHsKICAgLyog
VG8gYXNzdXJlIHRoYXQgdGhlIGNyZWF0ZWQgZmlsZXMgaGF2ZSBhIHVzZWZ1
bCBBQ0wsIHRoZSAKLSAgZGVmYXVsdCBEQUNMIGluIHRoZSBwcm9jZXNzIHRv
a2VuIGlzIHNldCB0byBmdWxsIGFjY2VzcyB0bwotICBldmVyeW9uZS4gVGhp
cyBhcHBsaWVzIHRvIGZpbGVzIGFuZCBzdWJkaXJlY3RvcmllcyBjcmVhdGVk
Ci0gIGluIGRpcmVjdG9yaWVzIHdoaWNoIGRvbid0IHByb3BhZ2F0ZSBwZXJt
aXNzaW9ucyB0byBjaGlsZAotICBvYmplY3RzLiAqLworICAgICBkZWZhdWx0
IERBQ0wgaW4gdGhlIHByb2Nlc3MgdG9rZW4gaXMgc2V0IHRvIGZ1bGwgYWNj
ZXNzIHRvCisgICAgIGV2ZXJ5b25lLiBUaGlzIGFwcGxpZXMgdG8gZmlsZXMg
YW5kIHN1YmRpcmVjdG9yaWVzIGNyZWF0ZWQKKyAgICAgaW4gZGlyZWN0b3Jp
ZXMgd2hpY2ggZG9uJ3QgcHJvcGFnYXRlIHBlcm1pc3Npb25zIHRvIGNoaWxk
CisgICAgIG9iamVjdHMuICovCiAKICAgLyogQ3JlYXRlIGEgYnVmZmVyIHdo
aWNoIGhhcyBlbm91Z2ggcm9vbSB0byBjb250YWluIHRoZSBUT0tFTl9ERUZB
VUxUX0RBQ0wKICAgICAgc3RydWN0dXJlIHBsdXMgYW4gQUNMIHdpdGggb25l
IEFDRS4gKi8KQEAgLTg0LDggKzg3LDggQEAgc2V0X2RlZmF1bHRfZGFjbCAo
KQogCiAgIC8qIEdldCB0aGUgU0lEIGZvciAiRXZlcnlvbmUiLiAqLwogICBQ
U0lEIHNpZDsKLSAgU0lEX0lERU5USUZJRVJfQVVUSE9SSVRZIHNpZF9hdXRo
ID0gU0VDVVJJVFlfV09STERfU0lEX0FVVEhPUklUWTsKLSAgaWYgKCFBbGxv
Y2F0ZUFuZEluaXRpYWxpemVTaWQoJnNpZF9hdXRoLCAxLCAwLCAwLCAwLCAw
LCAwLCAwLCAwLCAwLCAmc2lkKSkKKyAgU0lEX0lERU5USUZJRVJfQVVUSE9S
SVRZIHNpZF9hdXRoID0geyBTRUNVUklUWV9XT1JMRF9TSURfQVVUSE9SSVRZ
IH07CisgIGlmICghQWxsb2NhdGVBbmRJbml0aWFsaXplU2lkICgmc2lkX2F1
dGgsIDEsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsICZzaWQpKQogICAgIHsK
ICAgICAgIGxvZyAoTE9HX1RJTUVTVEFNUCwgIkFsbG9jYXRlQW5kSW5pdGlh
bGl6ZVNpZCgpIGZhaWxlZDogJWx1IiwKIAkgICBHZXRMYXN0RXJyb3IgKCkp
OwpAQCAtOTQsMTYgKzk3LDE4IEBAIHNldF9kZWZhdWx0X2RhY2wgKCkKIAog
ICAvKiBDcmVhdGUgdGhlIEFDRSB3aGljaCBncmFudHMgZnVsbCBhY2Nlc3Mg
dG8gIkV2ZXJ5b25lIiBhbmQgc3RvcmUgaXQKICAgICAgaW4gZGFjbC0+RGVm
YXVsdERhY2wuICovCi0gIGlmICghQWRkQWNjZXNzQWxsb3dlZEFjZSAoZGFj
bC0+RGVmYXVsdERhY2wsIEFDTF9SRVZJU0lPTiwgR0VORVJJQ19BTEwsIHNp
ZCkpCisgIGlmICghQWRkQWNjZXNzQWxsb3dlZEFjZQorICAgICAgKGRhY2wt
PkRlZmF1bHREYWNsLCBBQ0xfUkVWSVNJT04sIEdFTkVSSUNfQUxMLCBzaWQp
KQogICAgIHsKLSAgICAgIGxvZyAoTE9HX1RJTUVTVEFNUCwgIkFkZEFjY2Vz
c0FsbG93ZWRBY2UoKSBmYWlsZWQ6ICVsdSIsIEdldExhc3RFcnJvciAoKSk7
CisgICAgICBsb2cgKExPR19USU1FU1RBTVAsICJBZGRBY2Nlc3NBbGxvd2Vk
QWNlKCkgZmFpbGVkOiAlbHUiLAorCSAgIEdldExhc3RFcnJvciAoKSk7CiAg
ICAgICBnb3RvIG91dDsKICAgICB9CiAKICAgLyogR2V0IHRoZSBwcm9jZXNz
ZXMgYWNjZXNzIHRva2VuLiAqLwogICBIQU5ETEUgdG9rZW47CiAgIGlmICgh
T3BlblByb2Nlc3NUb2tlbiAoR2V0Q3VycmVudFByb2Nlc3MgKCksCi0gIAkJ
CSBUT0tFTl9SRUFEIHwgVE9LRU5fQURKVVNUX0RFRkFVTFQsICZ0b2tlbikp
CisJCQkgVE9LRU5fUkVBRCB8IFRPS0VOX0FESlVTVF9ERUZBVUxULCAmdG9r
ZW4pKQogICAgIHsKICAgICAgIGxvZyAoTE9HX1RJTUVTVEFNUCwgIk9wZW5Q
cm9jZXNzVG9rZW4oKSBmYWlsZWQ6ICVsdSIsIEdldExhc3RFcnJvciAoKSk7
CiAgICAgICBnb3RvIG91dDsKQEAgLTEyMyw5ICsxMjgsNyBAQCBvdXQ6CiAK
IGludCBXSU5BUEkKIFdpbk1haW4gKEhJTlNUQU5DRSBoLAotCSBISU5TVEFO
Q0UgaFByZXZJbnN0YW5jZSwKLQkgTFBTVFIgY29tbWFuZF9saW5lLAotCSBp
bnQgY21kX3Nob3cpCisJIEhJTlNUQU5DRSBoUHJldkluc3RhbmNlLCBMUFNU
UiBjb21tYW5kX2xpbmUsIGludCBjbWRfc2hvdykKIHsKICAgaGluc3RhbmNl
ID0gaDsKIApAQCAtMTQ0LDcgKzE0Nyw3IEBAIFdpbk1haW4gKEhJTlNUQU5D
RSBoLAogICBmb3IgKGFyZ2MgPSAwLCBhcmd2ID0gX19hcmd2OyAqYXJndjsg
YXJndisrKQogICAgIGxvZyAoTE9HX1RJTUVTVEFNUCwgIiVkIC0gJyVzJ1xu
IiwgYXJnYysrLCAqYXJndik7CiAgIGxvZyAoTE9HX1RJTUVTVEFNUCwgIiVk
IHBhcmFtZXRlcnMgcGFzc2VkXG4iLCBhcmdjKTsKLSAgCisKICAgLyogU2V0
IHRoZSBkZWZhdWx0IERBQ0wgb25seSBvbiBOVC9XMksuIDl4L01FIGhhcyBu
byBpZGVhIG9mIGFjY2VzcwogICAgICBjb250cm9sIGxpc3RzIGFuZCBzZWN1
cml0eSBhdCBhbGwuICovCiAgIGlmIChpc3dpbm50KQpAQCAtMTU0LDIwICsx
NTcsNDggQEAgV2luTWFpbiAoSElOU1RBTkNFIGgsCiAgICAgewogICAgICAg
c3dpdGNoIChuZXh0X2RpYWxvZykKIAl7Ci0JY2FzZSBJRERfU1BMQVNIOglk
b19zcGxhc2ggKGgpOwlicmVhazsKLQljYXNlIElERF9TT1VSQ0U6CWRvX3Nv
dXJjZSAoaCk7CWJyZWFrOwotCWNhc2UgSUREX0xPQ0FMX0RJUjoJZG9fbG9j
YWxfZGlyIChoKTsgYnJlYWs7Ci0JY2FzZSBJRERfUk9PVDoJCWRvX3Jvb3Qg
KGgpOwlicmVhazsKLQljYXNlIElERF9ORVQ6CQlkb19uZXQgKGgpOwlicmVh
azsKLQljYXNlIElERF9TSVRFOgkJZG9fc2l0ZSAoaCk7CWJyZWFrOwotCWNh
c2UgSUREX09USEVSX1VSTDoJZG9fb3RoZXIgKGgpOwlicmVhazsKLQljYXNl
IElERF9TX0xPQURfSU5JOglkb19pbmkgKGgpOwlicmVhazsKLQljYXNlIElE
RF9TX0ZST01fQ1dEOglkb19mcm9tY3dkIChoKTsJYnJlYWs7Ci0JY2FzZSBJ
RERfQ0hPT1NFOglkb19jaG9vc2UgKGgpOwlicmVhazsKLQljYXNlIElERF9T
X0RPV05MT0FEOglkb19kb3dubG9hZCAoaCk7IGJyZWFrOwotCWNhc2UgSURE
X1NfSU5TVEFMTDoJZG9faW5zdGFsbCAoaCk7CWJyZWFrOwotCWNhc2UgSURE
X0RFU0tUT1A6CWRvX2Rlc2t0b3AgKGgpOyBicmVhazsKLQljYXNlIElERF9T
X1BPU1RJTlNUQUxMOglkb19wb3N0aW5zdGFsbCAoaCk7IGJyZWFrOworCWNh
c2UgSUREX1NQTEFTSDoKKwkgIGRvX3NwbGFzaCAoaCk7CisJICBicmVhazsK
KwljYXNlIElERF9TT1VSQ0U6CisJICBkb19zb3VyY2UgKGgpOworCSAgYnJl
YWs7CisJY2FzZSBJRERfTE9DQUxfRElSOgorCSAgZG9fbG9jYWxfZGlyICho
KTsKKwkgIGJyZWFrOworCWNhc2UgSUREX1JPT1Q6CisJICBkb19yb290ICho
KTsKKwkgIGJyZWFrOworCWNhc2UgSUREX05FVDoKKwkgIGRvX25ldCAoaCk7
CisJICBicmVhazsKKwljYXNlIElERF9TSVRFOgorCSAgZG9fc2l0ZSAoaCk7
CisJICBicmVhazsKKwljYXNlIElERF9PVEhFUl9VUkw6CisJICBkb19vdGhl
ciAoaCk7CisJICBicmVhazsKKwljYXNlIElERF9TX0xPQURfSU5JOgorCSAg
ZG9faW5pIChoKTsKKwkgIGJyZWFrOworCWNhc2UgSUREX1NfRlJPTV9DV0Q6
CisJICBkb19mcm9tY3dkIChoKTsKKwkgIGJyZWFrOworCWNhc2UgSUREX0NI
T09TRToKKwkgIGRvX2Nob29zZSAoaCk7CisJICBicmVhazsKKwljYXNlIElE
RF9TX0RPV05MT0FEOgorCSAgZG9fZG93bmxvYWQgKGgpOworCSAgYnJlYWs7
CisJY2FzZSBJRERfU19JTlNUQUxMOgorCSAgZG9faW5zdGFsbCAoaCk7CisJ
ICBicmVhazsKKwljYXNlIElERF9ERVNLVE9QOgorCSAgZG9fZGVza3RvcCAo
aCk7CisJICBicmVhazsKKwljYXNlIElERF9TX1BPU1RJTlNUQUxMOgorCSAg
ZG9fcG9zdGluc3RhbGwgKGgpOworCSAgYnJlYWs7CiAKIAlkZWZhdWx0Ogog
CSAgbmV4dF9kaWFsb2cgPSAwOwpAQCAtMTc2LDQgKzIwNyw2IEBAIFdpbk1h
aW4gKEhJTlNUQU5DRSBoLAogICAgIH0KIAogICBleGl0X3NldHVwICgwKTsK
KyAgLyogS2VlcCBnY2MgaGFwcHkgOn0gKi8KKyAgcmV0dXJuIDA7CiB9Cklu
ZGV4OiBta2Rpci5jYwo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09ClJDUyBmaWxl
OiAvY3ZzL3NyYy9zcmMvd2luc3VwL2NpbnN0YWxsL21rZGlyLmNjLHYKcmV0
cmlldmluZyByZXZpc2lvbiAyLjIKZGlmZiAtdSAtcCAtcjIuMiBta2Rpci5j
YwotLS0gbWtkaXIuY2MJMjAwMS8wNS8yNyAwNzowNTowOQkyLjIKKysrIG1r
ZGlyLmNjCTIwMDEvMTEvMTEgMDY6NTQ6NTcKQEAgLTE1LDcgKzE1LDEwIEBA
CiAKIC8qIHNlZSBta2Rpci5oICovCiAKLXN0YXRpYyBjaGFyICpjdnNpZCA9
ICJcbiUlJSAkSWQ6IG1rZGlyLmNjLHYgMi4yIDIwMDEvMDUvMjcgMDc6MDU6
MDkgY2dmIEV4cCAkXG4iOworI2lmIDAKK3N0YXRpYyBjb25zdCBjaGFyICpj
dnNpZCA9CisgICJcbiUlJSAkSWQ6IG1rZGlyLmNjLHYgMi4yIDIwMDEvMDUv
MjcgMDc6MDU6MDkgY2dmIEV4cCAkXG4iOworI2VuZGlmCiAKICNpbmNsdWRl
ICJ3aW4zMi5oIgogCkBAIC00NSw3ICs0OCw4IEBAIG1rZGlyX3AgKGludCBp
c2FkaXIsIGNvbnN0IGNoYXIgKmluX3BhdGgKIAl7CiAJICBpZiAoZ3NlID09
IEVSUk9SX0FMUkVBRFlfRVhJU1RTKQogCSAgICB7Ci0JICAgICAgZnByaW50
ZiAoc3RkZXJyLCAid2FybmluZzogZGVsZXRpbmcgXCIlc1wiIHNvIEkgY2Fu
IG1ha2UgYSBkaXJlY3RvcnkgdGhlcmVcbiIsCisJICAgICAgZnByaW50ZiAo
c3RkZXJyLAorCQkgICAgICAgIndhcm5pbmc6IGRlbGV0aW5nIFwiJXNcIiBz
byBJIGNhbiBtYWtlIGEgZGlyZWN0b3J5IHRoZXJlXG4iLAogCQkgICAgICAg
cGF0aCk7CiAJICAgICAgaWYgKERlbGV0ZUZpbGVBIChwYXRoKSkKIAkJcmV0
dXJuIG1rZGlyX3AgKGlzYWRpciwgcGF0aCk7CkluZGV4OiBta2xpbmsyLmMK
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PQpSQ1MgZmlsZTogL2N2cy9zcmMvc3Jj
L3dpbnN1cC9jaW5zdGFsbC9ta2xpbmsyLmMsdgpyZXRyaWV2aW5nIHJldmlz
aW9uIDIuMApkaWZmIC11IC1wIC1yMi4wIG1rbGluazIuYwotLS0gbWtsaW5r
Mi5jCTIwMDAvMDgvMDggMDA6Mjc6NTQJMi4wCisrKyBta2xpbmsyLmMJMjAw
MS8xMS8xMSAwNjo1NDo1NwpAQCAtMSw3ICsxLDEyIEBACisjaW5jbHVkZSA8
c3RkbGliLmg+CiAjaW5jbHVkZSAid2luMzIuaCIKICNpbmNsdWRlICJzaGxv
YmouaCIKKyNpbmNsdWRlICJta2xpbmsyLmgiCiAKLXN0YXRpYyBjaGFyICpj
dnNpZCA9ICJcbiUlJSAkSWQ6IG1rbGluazIuYyx2IDIuMCAyMDAwLzA4LzA4
IDAwOjI3OjU0IGRqIEV4cCAkXG4iOworI2lmIDAKK3N0YXRpYyBjb25zdCBj
aGFyICpjdnNpZCA9CisgICJcbiUlJSAkSWQ6IG1rbGluazIuYyx2IDIuMCAy
MDAwLzA4LzA4IDAwOjI3OjU0IGRqIEV4cCAkXG4iOworI2VuZGlmCiAKIC8q
IFRoaXMgcGFydCBvZiB0aGUgY29kZSBtdXN0IGJlIGluIEMgYmVjYXVzZSB0
aGUgQysrIGludGVyZmFjZSB0byBDT00KIGRvZXNuJ3Qgd29yay4gKi8KQEAg
LTExLDcgKzE2LDcgQEAgbWFrZV9saW5rXzIgKGNoYXIgKmV4ZXBhdGgsIGNo
YXIgKmFyZ3MsIAogewogICBJU2hlbGxMaW5rICpzbDsKICAgSVBlcnNpc3RG
aWxlICpwZjsKLSAgV0NIQVIgd2lkZXBhdGggW19NQVhfUEFUSF07CisgIFdD
SEFSIHdpZGVwYXRoW19NQVhfUEFUSF07CiAKICAgQ29DcmVhdGVJbnN0YW5j
ZSAoJkNMU0lEX1NoZWxsTGluaywgTlVMTCwKIAkJICAgIENMU0NUWF9JTlBS
T0NfU0VSVkVSLCAmSUlEX0lTaGVsbExpbmssIChMUFZPSUQgKikgJiBzbCk7
CkBAIC0yNiw0ICszMSwzMSBAQCBtYWtlX2xpbmtfMiAoY2hhciAqZXhlcGF0
aCwgY2hhciAqYXJncywgCiAKICAgcGYtPmxwVnRibC0+UmVsZWFzZSAocGYp
OwogICBzbC0+bHBWdGJsLT5SZWxlYXNlIChzbCk7Cit9CisKKyNkZWZpbmUg
U1lNTElOS19DT09LSUUgIiE8c3ltbGluaz4iCisKKy8qIFByZWRpY2F0ZTog
ZmlsZSBpcyBub3QgY3VycmVudGx5IGluIGV4aXN0ZW5jZS4KKyAqIEEgZmls
ZSByYWNlIGNhbiBvY2N1ciBvdGhlcndpc2UuCisgKi8KK2ludAorbWtjeWdz
eW1saW5rIChjb25zdCBjaGFyICpmcm9tLCBjb25zdCBjaGFyICp0bykKK3sK
KyAgY2hhciBidWZbNTEyXTsKKyAgdW5zaWduZWQgbG9uZyB3OworICBIQU5E
TEUgaCA9IENyZWF0ZUZpbGVBIChmcm9tLCBHRU5FUklDX1dSSVRFLCAwLCAw
LCBDUkVBVEVfTkVXLAorCQkgICBGSUxFX0FUVFJJQlVURV9OT1JNQUwsIDAp
OworICBpZiAoaCA9PSBJTlZBTElEX0hBTkRMRV9WQUxVRSkKKyAgICByZXR1
cm4gMTsKKyAgc3RyY3B5IChidWYsIFNZTUxJTktfQ09PS0lFKTsKKyAgc3Ry
Y2F0IChidWYsIHRvKTsKKyAgaWYgKFdyaXRlRmlsZSAoaCwgYnVmLCBzdHJs
ZW4gKGJ1ZikgKyAxLCAmdywgTlVMTCkpCisgICAgeworICAgICAgQ2xvc2VI
YW5kbGUgKGgpOworICAgICAgU2V0RmlsZUF0dHJpYnV0ZXNBIChmcm9tLCBG
SUxFX0FUVFJJQlVURV9TWVNURU0pOworICAgICAgcmV0dXJuIDA7CisgICAg
fQorICBDbG9zZUhhbmRsZSAoaCk7CisgIERlbGV0ZUZpbGVBIChmcm9tKTsK
KyAgcmV0dXJuIDE7CiB9CkluZGV4OiBtb3VudC5jYwo9PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09ClJDUyBmaWxlOiAvY3ZzL3NyYy9zcmMvd2luc3VwL2NpbnN0
YWxsL21vdW50LmNjLHYKcmV0cmlldmluZyByZXZpc2lvbiAyLjYKZGlmZiAt
dSAtcCAtcjIuNiBtb3VudC5jYwotLS0gbW91bnQuY2MJMjAwMS8xMC8zMSAx
MzoxNTowNQkyLjYKKysrIG1vdW50LmNjCTIwMDEvMTEvMTEgMDY6NTQ6NTcK
QEAgLTE3LDcgKzE3LDEwIEBACiAgICBDeWd3aW4ncyBtb3VudCB0YWJsZS4g
IElmIHRoZSBmb3JtYXQgb3IgbG9jYXRpb24gb2YgdGhlIG1vdW50IHRhYmxl
CiAgICBjaGFuZ2VzLCB0aGlzIGlzIHRoZSBmaWxlIHRvIGNoYW5nZSB0byBt
YXRjaCBpdC4gKi8KIAotc3RhdGljIGNoYXIgKmN2c2lkID0gIlxuJSUlICRJ
ZDogbW91bnQuY2MsdiAyLjYgMjAwMS8xMC8zMSAxMzoxNTowNSByYmNvbGxp
bnMgRXhwICRcbiI7CisjaWYgMAorc3RhdGljIGNvbnN0IGNoYXIgKmN2c2lk
ID0KKyAgIlxuJSUlICRJZDogbW91bnQuY2MsdiAyLjYgMjAwMS8xMC8zMSAx
MzoxNTowNSByYmNvbGxpbnMgRXhwICRcbiI7CisjZW5kaWYKIAogI2luY2x1
ZGUgIndpbjMyLmgiCiAKQEAgLTM0LDE4ICszNywxOCBAQCBzdGF0aWMgY2hh
ciAqY3ZzaWQgPSAiXG4lJSUgJElkOiBtb3VudC5jCiAjaW5jbHVkZSAiY29u
Y2F0LmgiCiAKIHN0YXRpYyBzdHJ1Y3QgbW50Ci0gIHsKLSAgICBjb25zdCBj
aGFyICpuYXRpdmU7Ci0gICAgY2hhciAqcG9zaXg7Ci0gICAgaW50IGlzdGV4
dDsKLSAgfSBtb3VudF90YWJsZVsyNTVdOworeworICBjb25zdCBjaGFyICpu
YXRpdmU7CisgIGNoYXIgKnBvc2l4OworICBpbnQgaXN0ZXh0OworfQorbW91
bnRfdGFibGVbMjU1XTsKIAogc3RydWN0IG1udCAqcm9vdF9oZXJlID0gTlVM
TDsKIAogc3RhdGljIGNoYXIgKgogZmluZDIgKEhLRVkgcmtleSwgaW50ICpp
c3RleHQsIGNoYXIgKndoYXQpCiB7Ci0gIGNoYXIgYnVmWzEwMDBdOwogICBj
aGFyICpyZXR2YWwgPSAwOwogICBEV09SRCByZXR2YWxsZW4gPSAwOwogICBE
V09SRCBmbGFncyA9IDA7CkBAIC01OSw4ICs2Miw5IEBAIGZpbmQyIChIS0VZ
IHJrZXksIGludCAqaXN0ZXh0LCBjaGFyICp3aGEKICAgICAgID09IEVSUk9S
X1NVQ0NFU1MpCiAgICAgewogICAgICAgcmV0dmFsID0gKGNoYXIgKikgbWFs
bG9jIChNQVhfUEFUSCArIDEpOwotICAgICAgaWYgKFJlZ1F1ZXJ5VmFsdWVF
eCAoa2V5LCAibmF0aXZlIiwgMCwgJnR5cGUsIChCWVRFICopIHJldHZhbCwg
JnJldHZhbGxlbikKLQkgICE9IEVSUk9SX1NVQ0NFU1MpCisgICAgICBpZiAo
UmVnUXVlcnlWYWx1ZUV4CisJICAoa2V5LCAibmF0aXZlIiwgMCwgJnR5cGUs
IChCWVRFICopIHJldHZhbCwKKwkgICAmcmV0dmFsbGVuKSAhPSBFUlJPUl9T
VUNDRVNTKQogCXsKIAkgIGZyZWUgKHJldHZhbCk7CiAJICByZXR2YWwgPSAw
OwpAQCAtNjgsNyArNzIsNyBAQCBmaW5kMiAoSEtFWSBya2V5LCBpbnQgKmlz
dGV4dCwgY2hhciAqd2hhCiAgICAgfQogCiAgIHJldHZhbGxlbiA9IHNpemVv
ZiAoZmxhZ3MpOwotICBSZWdRdWVyeVZhbHVlRXggKGtleSwgImZsYWdzIiwg
MCwgJnR5cGUsIChCWVRFICopJmZsYWdzLCAmcmV0dmFsbGVuKTsKKyAgUmVn
UXVlcnlWYWx1ZUV4IChrZXksICJmbGFncyIsIDAsICZ0eXBlLCAoQllURSAq
KSAmIGZsYWdzLCAmcmV0dmFsbGVuKTsKIAogICBSZWdDbG9zZUtleSAoa2V5
KTsKIApAQCAtODIsOSArODYsOCBAQCB2b2lkCiBjcmVhdGVfbW91bnQgKGNv
bnN0IGNoYXIgKnBvc2l4LCBjb25zdCBjaGFyICp3aW4zMiwgaW50IGlzdGV4
dCwgaW50IGlzc3lzdGVtKQogewogICBjaGFyIGJ1ZlsxMDAwXTsKLSAgY2hh
ciAqcmV0dmFsID0gMDsKICAgSEtFWSBrZXk7Ci0gIERXT1JEIHJldHZhbGxl
biA9IDAsIGRpc3Bvc2l0aW9uOworICBEV09SRCBkaXNwb3NpdGlvbjsKICAg
RFdPUkQgZmxhZ3M7CiAKICAgcmVtb3ZlX21vdW50IChwb3NpeCk7CkBAIC05
MiwyMyArOTUsMjQgQEAgY3JlYXRlX21vdW50IChjb25zdCBjaGFyICpwb3Np
eCwgY29uc3QgYwogICBzcHJpbnRmIChidWYsICJTb2Z0d2FyZVxcJXNcXCVz
XFwlc1xcJXMiLAogCSAgIENZR1dJTl9JTkZPX0NZR05VU19SRUdJU1RSWV9O
QU1FLAogCSAgIENZR1dJTl9JTkZPX0NZR1dJTl9SRUdJU1RSWV9OQU1FLAot
CSAgIENZR1dJTl9JTkZPX0NZR1dJTl9NT1VOVF9SRUdJU1RSWV9OQU1FLAot
CSAgIHBvc2l4KTsKKwkgICBDWUdXSU5fSU5GT19DWUdXSU5fTU9VTlRfUkVH
SVNUUllfTkFNRSwgcG9zaXgpOwogCiAgIEhLRVkga3IgPSBpc3N5c3RlbSA/
IEhLRVlfTE9DQUxfTUFDSElORSA6IEhLRVlfQ1VSUkVOVF9VU0VSOwotICBp
ZiAoUmVnQ3JlYXRlS2V5RXggKGtyLCBidWYsIDAsICJDeWd3aW4iLCAwLCBL
RVlfQUxMX0FDQ0VTUywKKyAgaWYgKFJlZ0NyZWF0ZUtleUV4IChrciwgYnVm
LCAwLCAoY2hhciAqKSAiQ3lnd2luIiwgMCwgS0VZX0FMTF9BQ0NFU1MsCiAJ
CSAgICAgIDAsICZrZXksICZkaXNwb3NpdGlvbikgIT0gRVJST1JfU1VDQ0VT
UykKICAgICBmYXRhbCAoIm1vdW50Iik7CiAKLSAgUmVnU2V0VmFsdWVFeCAo
a2V5LCAibmF0aXZlIiwgMCwgUkVHX1NaLCAoQllURSAqKSB3aW4zMiwgc3Ry
bGVuICh3aW4zMikgKyAxKTsKKyAgUmVnU2V0VmFsdWVFeCAoa2V5LCAibmF0
aXZlIiwgMCwgUkVHX1NaLCAoQllURSAqKSB3aW4zMiwKKwkJIHN0cmxlbiAo
d2luMzIpICsgMSk7CiAgIGZsYWdzID0gMDsKICAgaWYgKCFpc3RleHQpCiAg
ICAgZmxhZ3MgfD0gTU9VTlRfQklOQVJZOwogICBpZiAoaXNzeXN0ZW0pCiAg
ICAgZmxhZ3MgfD0gTU9VTlRfU1lTVEVNOwotICBSZWdTZXRWYWx1ZUV4IChr
ZXksICJmbGFncyIsIDAsIFJFR19EV09SRCwgKEJZVEUgKikmZmxhZ3MsIHNp
emVvZiAoZmxhZ3MpKTsKLSAgCi0gIFJlZ0Nsb3NlS2V5KGtleSk7CisgIFJl
Z1NldFZhbHVlRXggKGtleSwgImZsYWdzIiwgMCwgUkVHX0RXT1JELCAoQllU
RSAqKSAmIGZsYWdzLAorCQkgc2l6ZW9mIChmbGFncykpOworCisgIFJlZ0Ns
b3NlS2V5IChrZXkpOwogICByZWFkX21vdW50cyAoKTsKIH0KIApAQCAtMTIw
LDggKzEyNCw3IEBAIHJlbW92ZTEgKEhLRVkgcmtleSwgY29uc3QgY2hhciAq
cG9zaXgpCiAgIHNwcmludGYgKGJ1ZiwgIlNvZnR3YXJlXFwlc1xcJXNcXCVz
XFwlcyIsCiAJICAgQ1lHV0lOX0lORk9fQ1lHTlVTX1JFR0lTVFJZX05BTUUs
CiAJICAgQ1lHV0lOX0lORk9fQ1lHV0lOX1JFR0lTVFJZX05BTUUsCi0JICAg
Q1lHV0lOX0lORk9fQ1lHV0lOX01PVU5UX1JFR0lTVFJZX05BTUUsCi0JICAg
cG9zaXgpOworCSAgIENZR1dJTl9JTkZPX0NZR1dJTl9NT1VOVF9SRUdJU1RS
WV9OQU1FLCBwb3NpeCk7CiAKICAgUmVnRGVsZXRlS2V5IChya2V5LCBidWYp
OwogfQpAQCAtMTQ0LDI4ICsxNDcsMjggQEAgc2V0X2N5Z2RyaXZlX2ZsYWdz
IChIS0VZIGtleSwgaW50IGlzdGV4dAogICAgICAgZWxzZQogCWN5Z2RyaXZl
X2ZsYWdzICY9IH5NT1VOVF9CSU5BUlk7CiAgICAgICBSZWdTZXRWYWx1ZUV4
IChrZXksIENZR1dJTl9JTkZPX0NZR0RSSVZFX0ZMQUdTLCAwLCBSRUdfRFdP
UkQsCi0JCSAgICAgKEJZVEUgKikmY3lnZHJpdmVfZmxhZ3MsIHNpemVvZiAo
Y3lnZHJpdmVfZmxhZ3MpKTsKKwkJICAgICAoQllURSAqKSAmIGN5Z2RyaXZl
X2ZsYWdzLCBzaXplb2YgKGN5Z2RyaXZlX2ZsYWdzKSk7CiAgICAgfQogfQog
CiBzdGF0aWMgTE9ORwotZ2V0X2N5Z2RyaXZlX2ZsYWdzIChIS0VZIGtleSwg
RFdPUkQgKmN5Z2RyaXZlX2ZsYWdzKQorZ2V0X2N5Z2RyaXZlX2ZsYWdzIChI
S0VZIGtleSwgRFdPUkQgKiBjeWdkcml2ZV9mbGFncykKIHsKLSAgRFdPUkQg
cmV0dmFsbGVuID0gc2l6ZW9mKCpjeWdkcml2ZV9mbGFncyk7CisgIERXT1JE
IHJldHZhbGxlbiA9IHNpemVvZiAoKmN5Z2RyaXZlX2ZsYWdzKTsKICAgTE9O
RyBzdGF0dXMgPSBSZWdRdWVyeVZhbHVlRXggKGtleSwgQ1lHV0lOX0lORk9f
Q1lHRFJJVkVfRkxBR1MsIDAsIDAsCi0JCQkJIChCWVRFICopY3lnZHJpdmVf
ZmxhZ3MsICZyZXR2YWxsZW4pOworCQkJCSAoQllURSAqKSBjeWdkcml2ZV9m
bGFncywgJnJldHZhbGxlbik7CiAgIHJldHVybiBzdGF0dXM7CiB9CiAKIHN0
YXRpYyBEV09SRAotZGVmYXVsdF9jeWdkcml2ZShIS0VZIGtleSkKK2RlZmF1
bHRfY3lnZHJpdmUgKEhLRVkga2V5KQogewogICBSZWdTZXRWYWx1ZUV4IChr
ZXksIENZR1dJTl9JTkZPX0NZR0RSSVZFX1BSRUZJWCwgMCwgUkVHX1NaLAot
CQkgKEJZVEUgKilDWUdXSU5fSU5GT19DWUdEUklWRV9ERUZBVUxUX1BSRUZJ
WCwKKwkJIChCWVRFICopIENZR1dJTl9JTkZPX0NZR0RSSVZFX0RFRkFVTFRf
UFJFRklYLAogCQkgc3RybGVuIChDWUdXSU5fSU5GT19DWUdEUklWRV9ERUZB
VUxUX1BSRUZJWCkgKyAxKTsKICAgRFdPUkQgY3lnZHJpdmVfZmxhZ3MgPSBN
T1VOVF9BVVRPOwogICBSZWdTZXRWYWx1ZUV4IChrZXksIENZR1dJTl9JTkZP
X0NZR0RSSVZFX0ZMQUdTLCAwLCBSRUdfRFdPUkQsCi0JCSAoQllURSAqKSZj
eWdkcml2ZV9mbGFncywgc2l6ZW9mIChjeWdkcml2ZV9mbGFncykpOworCQkg
KEJZVEUgKikgJiBjeWdkcml2ZV9mbGFncywgc2l6ZW9mIChjeWdkcml2ZV9m
bGFncykpOwogICByZXR1cm4gY3lnZHJpdmVfZmxhZ3M7CiB9CiAKQEAgLTE4
NSw3ICsxODgsNyBAQCBzZXRfY3lnZHJpdmVfZmxhZ3MgKGludCBpc3RleHQs
IGludCBpc3N5CiAgICAgICBIS0VZIGtleTsKICAgICAgIERXT1JEIGRpc3Bv
c2l0aW9uOwogICAgICAgTE9ORyBzdGF0dXMgPSBSZWdDcmVhdGVLZXlFeCAo
SEtFWV9MT0NBTF9NQUNISU5FLCBidWYsIDAsIDAsIDAsCi0gICAgICAJCQkJ
ICAgIEtFWV9BTExfQUNDRVNTLCAwLCAma2V5LCAmZGlzcG9zaXRpb24pOwor
CQkJCSAgICBLRVlfQUxMX0FDQ0VTUywgMCwgJmtleSwgJmRpc3Bvc2l0aW9u
KTsKICAgICAgIGlmIChzdGF0dXMgPT0gRVJST1JfU1VDQ0VTUykKIAl7CiAJ
ICBEV09SRCBjeWdkcml2ZV9mbGFncyA9IDA7CkBAIC0xOTUsMTQgKzE5OCwx
NSBAQCBzZXRfY3lnZHJpdmVfZmxhZ3MgKGludCBpc3RleHQsIGludCBpc3N5
CiAJICAgICAgc2V0X2N5Z2RyaXZlX2ZsYWdzIChrZXksIGlzdGV4dCwgY3ln
ZHJpdmVfZmxhZ3MpOwogCSAgICAgIGZvdW5kX3N5c3RlbSA9IDE7CiAJICAg
IH0KLQkgIFJlZ0Nsb3NlS2V5KGtleSk7CisJICBSZWdDbG9zZUtleSAoa2V5
KTsKIAl9CiAgICAgfQogCiAgIEhLRVkga2V5OwogICBEV09SRCBkaXNwb3Np
dGlvbjsKLSAgTE9ORyBzdGF0dXMgPSBSZWdDcmVhdGVLZXlFeCAoSEtFWV9D
VVJSRU5UX1VTRVIsIGJ1ZiwgMCwgMCwgMCwgS0VZX0FMTF9BQ0NFU1MsCi0J
CQkJMCwgJmtleSwgJmRpc3Bvc2l0aW9uKTsKKyAgTE9ORyBzdGF0dXMgPQor
ICAgIFJlZ0NyZWF0ZUtleUV4IChIS0VZX0NVUlJFTlRfVVNFUiwgYnVmLCAw
LCAwLCAwLCBLRVlfQUxMX0FDQ0VTUywKKwkJICAgIDAsICZrZXksICZkaXNw
b3NpdGlvbik7CiAgIGlmIChzdGF0dXMgIT0gRVJST1JfU1VDQ0VTUykKICAg
ICBmYXRhbCAoInNldF9jeWdkcml2ZV9mbGFncyIpOwogCkBAIC0yMTAsMjAg
KzIxNCwyMCBAQCBzZXRfY3lnZHJpdmVfZmxhZ3MgKGludCBpc3RleHQsIGlu
dCBpc3N5CiAgIHN0YXR1cyA9IGdldF9jeWdkcml2ZV9mbGFncyAoa2V5LCAm
Y3lnZHJpdmVfZmxhZ3MpOwogICBpZiAoc3RhdHVzID09IEVSUk9SX0ZJTEVf
Tk9UX0ZPVU5EICYmICFmb3VuZF9zeXN0ZW0pCiAgICAgewotICAgICAgY3ln
ZHJpdmVfZmxhZ3MgPSBkZWZhdWx0X2N5Z2RyaXZlKGtleSk7CisgICAgICBj
eWdkcml2ZV9mbGFncyA9IGRlZmF1bHRfY3lnZHJpdmUgKGtleSk7CiAgICAg
ICBzdGF0dXMgPSBFUlJPUl9TVUNDRVNTOwogICAgIH0KIAogICBpZiAoc3Rh
dHVzID09IEVSUk9SX1NVQ0NFU1MpCiAgICAgc2V0X2N5Z2RyaXZlX2ZsYWdz
IChrZXksIGlzdGV4dCwgY3lnZHJpdmVfZmxhZ3MpOwogCi0gIFJlZ0Nsb3Nl
S2V5KGtleSk7CisgIFJlZ0Nsb3NlS2V5IChrZXkpOwogfQogCiBzdGF0aWMg
aW50CiBpbl90YWJsZSAoc3RydWN0IG1udCAqbSkKIHsKLSAgZm9yIChzdHJ1
Y3QgbW50ICptMSA9IG1vdW50X3RhYmxlOyBtMSA8IG07IG0xKyspCisgIGZv
ciAoc3RydWN0IG1udCAqIG0xID0gbW91bnRfdGFibGU7IG0xIDwgbTsgbTEr
KykKICAgICBpZiAoc3RyY2FzZWNtcCAobTEtPnBvc2l4LCBtLT5wb3NpeCkg
PT0gMCkKICAgICAgIHJldHVybiAxOwogICByZXR1cm4gMDsKQEAgLTI0Nyw3
ICsyNTEsNyBAQCBpc19hZG1pbiAoKQogCiAgIC8vIEdldCB0aGUgcHJvY2Vz
cyB0b2tlbiBmb3IgdGhlIGN1cnJlbnQgcHJvY2VzcwogICBIQU5ETEUgdG9r
ZW47Ci0gIEJPT0wgc3RhdHVzID0gT3BlblByb2Nlc3NUb2tlbiAoR2V0Q3Vy
cmVudFByb2Nlc3MoKSwgVE9LRU5fUVVFUlksICZ0b2tlbik7CisgIEJPT0wg
c3RhdHVzID0gT3BlblByb2Nlc3NUb2tlbiAoR2V0Q3VycmVudFByb2Nlc3Mg
KCksIFRPS0VOX1FVRVJZLCAmdG9rZW4pOwogICBpZiAoIXN0YXR1cykKICAg
ICByZXR1cm4gMDsKIApAQCAtMjU1LDI2ICsyNTksMzMgQEAgaXNfYWRtaW4g
KCkKICAgVUNIQVIgdG9rZW5faW5mb1sxMDI0XTsKICAgUFRPS0VOX0dST1VQ
UyBncm91cHMgPSAoUFRPS0VOX0dST1VQUykgdG9rZW5faW5mbzsKICAgRFdP
UkQgdG9rZW5faW5mb19sZW4gPSBzaXplb2YgKHRva2VuX2luZm8pOwotICBz
dGF0dXMgPSBHZXRUb2tlbkluZm9ybWF0aW9uICh0b2tlbiwgVG9rZW5Hcm91
cHMsIHRva2VuX2luZm8sIHRva2VuX2luZm9fbGVuLCAmdG9rZW5faW5mb19s
ZW4pOwotICBDbG9zZUhhbmRsZSh0b2tlbik7CisgIHN0YXR1cyA9CisgICAg
R2V0VG9rZW5JbmZvcm1hdGlvbiAodG9rZW4sIFRva2VuR3JvdXBzLCB0b2tl
bl9pbmZvLCB0b2tlbl9pbmZvX2xlbiwKKwkJCSAmdG9rZW5faW5mb19sZW4p
OworICBDbG9zZUhhbmRsZSAodG9rZW4pOwogICBpZiAoIXN0YXR1cykKICAg
ICByZXR1cm4gMDsKIAogICAvLyBDcmVhdGUgdGhlIEFkbWluaXN0cmF0b3Jz
IGdyb3VwIFNJRAogICBQU0lEIGFkbWluX3NpZDsKLSAgU0lEX0lERU5USUZJ
RVJfQVVUSE9SSVRZIGF1dGhvcml0eSA9IFNFQ1VSSVRZX05UX0FVVEhPUklU
WTsKLSAgc3RhdHVzID0gQWxsb2NhdGVBbmRJbml0aWFsaXplU2lkICgmYXV0
aG9yaXR5LCAyLCBTRUNVUklUWV9CVUlMVElOX0RPTUFJTl9SSUQsIERPTUFJ
Tl9BTElBU19SSURfQURNSU5TLCAwLCAwLCAwLCAwLCAwLCAwLCAmYWRtaW5f
c2lkKTsKKyAgU0lEX0lERU5USUZJRVJfQVVUSE9SSVRZIGF1dGhvcml0eSA9
IHsgU0VDVVJJVFlfTlRfQVVUSE9SSVRZIH07CisgIHN0YXR1cyA9CisgICAg
QWxsb2NhdGVBbmRJbml0aWFsaXplU2lkICgmYXV0aG9yaXR5LCAyLCBTRUNV
UklUWV9CVUlMVElOX0RPTUFJTl9SSUQsCisJCQkgICAgICBET01BSU5fQUxJ
QVNfUklEX0FETUlOUywgMCwgMCwgMCwgMCwgMCwgMCwKKwkJCSAgICAgICZh
ZG1pbl9zaWQpOwogICBpZiAoIXN0YXR1cykKICAgICByZXR1cm4gMDsKIAog
ICAvLyBDaGVjayB0byBzZWUgaWYgdGhlIHVzZXIgaXMgYSBtZW1iZXIgb2Yg
dGhlIEFkbWluaXN0cmF0b3JzIGdyb3VwCiAgIHN0YXR1cyA9IDA7Ci0gIGZv
ciAoVUlOVCBpPTA7IGk8Z3JvdXBzLT5Hcm91cENvdW50OyBpKyspIHsKLSAg
ICBpZiAoRXF1YWxTaWQoZ3JvdXBzLT5Hcm91cHNbaV0uU2lkLCBhZG1pbl9z
aWQpKSB7Ci0gICAgICBzdGF0dXMgPSAxOwotICAgICAgYnJlYWs7CisgIGZv
ciAoVUlOVCBpID0gMDsgaSA8IGdyb3Vwcy0+R3JvdXBDb3VudDsgaSsrKQor
ICAgIHsKKyAgICAgIGlmIChFcXVhbFNpZCAoZ3JvdXBzLT5Hcm91cHNbaV0u
U2lkLCBhZG1pbl9zaWQpKQorCXsKKwkgIHN0YXR1cyA9IDE7CisJICBicmVh
azsKKwl9CiAgICAgfQotICB9CiAKICAgLy8gRGVzdHJveSB0aGUgQWRtaW5p
c3RyYXRvcnMgZ3JvdXAgU0lECiAgIEZyZWVTaWQgKGFkbWluX3NpZCk7CkBA
IC0yOTMsNyArMzA0LDcgQEAgcmVhZF9tb3VudHMgKCkKICAgY2hhciBidWZb
MTAwMDBdOwogCiAgIHJvb3RfaGVyZSA9IE5VTEw7Ci0gIGZvciAobW50ICpt
MSA9IG1vdW50X3RhYmxlOyBtMS0+cG9zaXg7IG0xKyspCisgIGZvciAobW50
ICogbTEgPSBtb3VudF90YWJsZTsgbTEtPnBvc2l4OyBtMSsrKQogICAgIHsK
ICAgICAgIGZyZWUgKG0xLT5wb3NpeCk7CiAgICAgICBpZiAobTEtPm5hdGl2
ZSkKQEAgLTMxMywxMCArMzI0LDEwIEBAIHJlYWRfbW91bnRzICgpCiAJICAg
ICAgIENZR1dJTl9JTkZPX0NZR1dJTl9NT1VOVF9SRUdJU1RSWV9OQU1FKTsK
IAogICAgICAgSEtFWSBrZXkgPSBpc3N5c3RlbSA/IEhLRVlfTE9DQUxfTUFD
SElORSA6IEhLRVlfQ1VSUkVOVF9VU0VSOwotICAgICAgaWYgKFJlZ0NyZWF0
ZUtleUV4IChrZXksIGJ1ZiwgMCwgIkN5Z3dpbiIsIDAsIEtFWV9BTExfQUND
RVNTLAorICAgICAgaWYgKFJlZ0NyZWF0ZUtleUV4IChrZXksIGJ1ZiwgMCwg
KGNoYXIgKikgIkN5Z3dpbiIsIDAsIEtFWV9BTExfQUNDRVNTLAogCQkJICAw
LCAma2V5LCAmZGlzcG9zaXRpb24pICE9IEVSUk9SX1NVQ0NFU1MpCiAJYnJl
YWs7Ci0gICAgICBmb3IgKGludCBpID0gMDsgO2krKywgbSsrKQorICAgICAg
Zm9yIChpbnQgaSA9IDA7OyBpKyssIG0rKykKIAl7CiAJICBtLT5wb3NpeCA9
IChjaGFyICopIG1hbGxvYyAoTUFYX1BBVEggKyAxKTsKIAkgIHBvc2l4X3Bh
dGhfc2l6ZSA9IE1BWF9QQVRIOwpAQCAtMzQyLDcgKzM1Myw3IEBAIHJlYWRf
bW91bnRzICgpCiAJICAgICAgbS0+bmF0aXZlID0gZmluZDIgKGtleSwgJm0t
PmlzdGV4dCwgbS0+cG9zaXgpOwogCSAgICAgIGlmICghbS0+bmF0aXZlKQog
CQlnb3RvIG5vX2dvOwotCQkgIAorCiAJICAgICAgaWYgKHN0cmNtcCAobS0+
cG9zaXgsICIvIikgPT0gMCkKIAkJewogCQkgIHJvb3RfaGVyZSA9IG07CkBA
IC0zNzEsNyArMzgyLDcgQEAgcmVhZF9tb3VudHMgKCkKICAgICAgIG0tPnBv
c2l4ID0gc3RyZHVwICgiLyIpOwogICAgICAgY2hhciB3aW5kaXJbX01BWF9Q
QVRIXTsKICAgICAgIHJvb3RfdGV4dCA9IElEQ19ST09UX0JJTkFSWTsKLSAg
ICAgIHJvb3Rfc2NvcGUgPSAoaXNfYWRtaW4oKSkgPyBJRENfUk9PVF9TWVNU
RU0gOiBJRENfUk9PVF9VU0VSOworICAgICAgcm9vdF9zY29wZSA9IChpc19h
ZG1pbiAoKSk/IElEQ19ST09UX1NZU1RFTSA6IElEQ19ST09UX1VTRVI7CiAg
ICAgICBHZXRXaW5kb3dzRGlyZWN0b3J5ICh3aW5kaXIsIHNpemVvZiAod2lu
ZGlyKSk7CiAgICAgICB3aW5kaXJbMl0gPSAwOwogICAgICAgc2V0X3Jvb3Rf
ZGlyIChjb25jYXQgKHdpbmRpciwgIlxcY3lnd2luIiwgMCkpOwpAQCAtNDI1
LDggKzQzNiw4IEBAIGNoYXIgKgogY3lncGF0aCAoY29uc3QgY2hhciAqcywg
Li4uKQogewogICB2YV9saXN0IHY7Ci0gIGludCBpLCBtYXhfbGVuID0gLTE7
Ci0gIHN0cnVjdCBtbnQgKm0sICptYXRjaDsKKyAgaW50IG1heF9sZW4gPSAt
MTsKKyAgc3RydWN0IG1udCAqbSwgKm1hdGNoID0gTlVMTDsKIAogICB2YV9z
dGFydCAodiwgcyk7CiAgIGNoYXIgKnBhdGggPSB2Y29uY2F0IChzLCB2KTsK
QEAgLTQzNSw3ICs0NDYsNyBAQCBjeWdwYXRoIChjb25zdCBjaGFyICpzLCAu
Li4pCiAgIGlmIChzdHJuY21wIChwYXRoLCAiLy4vIiwgMykgPT0gMCkKICAg
ICBtZW1tb3ZlIChwYXRoICsgMSwgcGF0aCArIDMsIHN0cmxlbiAocGF0aCAr
IDMpICsgMSk7CiAKLSAgZm9yIChtID0gbW91bnRfdGFibGU7IG0tPnBvc2l4
IDsgbSsrKQorICBmb3IgKG0gPSBtb3VudF90YWJsZTsgbS0+cG9zaXg7IG0r
KykKICAgICB7CiAgICAgICBpbnQgbiA9IHN0cmxlbiAobS0+cG9zaXgpOwog
ICAgICAgaWYgKG4gPCBtYXhfbGVuIHx8ICFwYXRoX3ByZWZpeF9wIChtLT5w
b3NpeCwgcGF0aCwgbikpCkBAIC00NDQsOCArNDU1LDExIEBAIGN5Z3BhdGgg
KGNvbnN0IGNoYXIgKnMsIC4uLikKICAgICAgIG1hdGNoID0gbTsKICAgICB9
CiAKKyAgaWYgKCFtYXRjaCkKKyAgICByZXR1cm4gTlVMTDsKKwogICBjaGFy
ICpuYXRpdmU7Ci0gIGlmIChtYXhfbGVuID09IHN0cmxlbiAocGF0aCkpCisg
IGlmIChtYXhfbGVuID09IChpbnQpIHN0cmxlbiAocGF0aCkpCiAgICAgbmF0
aXZlID0gc3RyZHVwIChtYXRjaC0+bmF0aXZlKTsKICAgZWxzZQogICAgIG5h
dGl2ZSA9IGNvbmNhdCAobWF0Y2gtPm5hdGl2ZSwgIi8iLCBwYXRoICsgbWF4
X2xlbiwgTlVMTCk7CkluZGV4OiBtb3VudC5oCj09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT0KUkNTIGZpbGU6IC9jdnMvc3JjL3NyYy93aW5zdXAvY2luc3RhbGwv
bW91bnQuaCx2CnJldHJpZXZpbmcgcmV2aXNpb24gMi4zCmRpZmYgLXUgLXAg
LXIyLjMgbW91bnQuaAotLS0gbW91bnQuaAkyMDAxLzA1LzI3IDA3OjA1OjA5
CTIuMworKysgbW91bnQuaAkyMDAxLzExLzExIDA2OjU0OjU3CkBAIC0xNywx
MyArMTcsMTQgQEAKICAgIG5vbnplcm8gaWYgdGhlIGV4aXN0aW5nIG1vdW50
IGlzIGEgdGV4dCBtb3VudCwgZWxzZSB6ZXJvIGZvcgogICAgYmluYXJ5LiAq
LwogCi1jaGFyICoJZmluZF9tb3VudCAoaW50ICppc3RleHQsIGludCAqaXNz
eXN0ZW0sIGNoYXIgKnBhdGgpOworY2hhciAqZmluZF9tb3VudCAoaW50ICpp
c3RleHQsIGludCAqaXNzeXN0ZW0sIGNoYXIgKnBhdGgpOwogCiAvKiBTaW1p
bGFyIHRvIHRoZSBtb3VudCBhbmQgdW1vdW50IGZ1bmN0aW9ucywgYnV0IHNp
bXBsaWZpZWQgKi8KIAotdm9pZAljcmVhdGVfbW91bnQgKGNvbnN0IGNoYXIg
KnBvc2l4LCBjb25zdCBjaGFyICp3aW4zMiwgaW50IGlzdGV4dCwgaW50IGlz
c3lzdGVtKTsKLXZvaWQJcmVtb3ZlX21vdW50IChjb25zdCBjaGFyICpwb3Np
eCk7Ci12b2lkCXJlYWRfbW91bnRzICgpOwordm9pZCBjcmVhdGVfbW91bnQg
KGNvbnN0IGNoYXIgKnBvc2l4LCBjb25zdCBjaGFyICp3aW4zMiwgaW50IGlz
dGV4dCwKKwkJICAgaW50IGlzc3lzdGVtKTsKK3ZvaWQgcmVtb3ZlX21vdW50
IChjb25zdCBjaGFyICpwb3NpeCk7Cit2b2lkIHJlYWRfbW91bnRzICgpOwog
CiAvKiBTZXRzIHRoZSBjeWdkcml2ZSBmbGFncy4gIFVzZWQgdG8gbWFrZSB0
aGUgYXV0b21vdW50ZWQgZHJpdmVzJyBiaW5hcnkvdGV4dAogbW9kZSBjb25z
aXN0ZW50IHdpdGggdGhlIHN0YW5kYXJkIEN5Z3dpbiBtb3VudHMuICovCklu
ZGV4OiBtc2cuY2MKPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQpSQ1MgZmlsZTog
L2N2cy9zcmMvc3JjL3dpbnN1cC9jaW5zdGFsbC9tc2cuY2MsdgpyZXRyaWV2
aW5nIHJldmlzaW9uIDIuMQpkaWZmIC11IC1wIC1yMi4xIG1zZy5jYwotLS0g
bXNnLmNjCTIwMDAvMDgvMjUgMDE6MzI6MDgJMi4xCisrKyBtc2cuY2MJMjAw
MS8xMS8xMSAwNjo1NDo1NwpAQCAtMTYsNyArMTYsMTAgQEAKIC8qIFRoZSBw
dXJwb3NlIG9mIHRoaXMgZmlsZSBpcyB0byBjZW50cmFsaXplIGFsbCB0aGUg
bWVzc2FnZQogICAgZnVuY3Rpb25zLiAqLwogCi1zdGF0aWMgY2hhciAqY3Zz
aWQgPSAiXG4lJSUgJElkOiBtc2cuY2MsdiAyLjEgMjAwMC8wOC8yNSAwMToz
MjowOCBkaiBFeHAgJFxuIjsKKyNpZiAwCitzdGF0aWMgY29uc3QgY2hhciAq
Y3ZzaWQgPQorICAiXG4lJSUgJElkOiBtc2cuY2MsdiAyLjEgMjAwMC8wOC8y
NSAwMTozMjowOCBkaiBFeHAgJFxuIjsKKyNlbmRpZgogCiAjaW5jbHVkZSAi
d2luMzIuaCIKICNpbmNsdWRlIDxzdGRpby5oPgpAQCAtMjUsNyArMjgsNyBA
QCBzdGF0aWMgY2hhciAqY3ZzaWQgPSAiXG4lJSUgJElkOiBtc2cuY2MsCiAj
aW5jbHVkZSAibG9nLmgiCiAKIHZvaWQKLW1zZyAoY2hhciAqZm10LCAuLi4p
Cittc2cgKGNvbnN0IGNoYXIgKmZtdCwgLi4uKQogewogICBjaGFyIGJ1Zlsx
MDAwXTsKICAgdmFfbGlzdCBhcmdzOwpAQCAtMzUsNyArMzgsNyBAQCBtc2cg
KGNoYXIgKmZtdCwgLi4uKQogfQogCiBzdGF0aWMgaW50Ci1tYm94IChjaGFy
ICpuYW1lLCBpbnQgdHlwZSwgaW50IGlkLCB2YV9saXN0IGFyZ3MpCittYm94
IChjb25zdCBjaGFyICpuYW1lLCBpbnQgdHlwZSwgaW50IGlkLCB2YV9saXN0
IGFyZ3MpCiB7CiAgIGNoYXIgYnVmWzEwMDBdLCBmbXRbMTAwMF07CiAKSW5k
ZXg6IG1zZy5oCj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KUkNTIGZpbGU6IC9j
dnMvc3JjL3NyYy93aW5zdXAvY2luc3RhbGwvbXNnLmgsdgpyZXRyaWV2aW5n
IHJldmlzaW9uIDIuMApkaWZmIC11IC1wIC1yMi4wIG1zZy5oCi0tLSBtc2cu
aAkyMDAwLzA4LzA4IDAwOjI3OjU0CTIuMAorKysgbXNnLmgJMjAwMS8xMS8x
MSAwNjo1NDo1NwpAQCAtMTcsNyArMTcsNyBAQAogICAgT3V0cHV0RGVidWdT
dHJpbmcsIHdoaWNoIGNhbiBiZSBzZWVuIHdoaWxlIGRlYnVnZ2luZyB1bmRl
ciBHREIgb3IKICAgIHZpYSBhIGRlYnVnIG1lc3NhZ2UgbW9uaXRvci4gKi8K
IAotdm9pZCBtc2coY2hhciAqZm10LCAuLi4pOwordm9pZCBtc2cgKGNvbnN0
IGNoYXIgKmZtdCwgLi4uKTsKIAogLyogVGhpcyBwb3BzIHVwIGEgZGlhbG9n
IHdpdGggdGV4dCBmcm9tIHRoZSBzdHJpbmcgdGFibGUgKCJpZCIpLCB3aGlj
aAogICAgaXMgaW50ZXJwcmV0ZWQgbGlrZSBwcmludGYuICBUaGUgcHJvZ3Jh
bSBleGl0cyB3aGVuIHRoZSB1c2VyCkluZGV4OiBuZXQuY2MKPT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PQpSQ1MgZmlsZTogL2N2cy9zcmMvc3JjL3dpbnN1cC9j
aW5zdGFsbC9uZXQuY2MsdgpyZXRyaWV2aW5nIHJldmlzaW9uIDIuNgpkaWZm
IC11IC1wIC1yMi42IG5ldC5jYwotLS0gbmV0LmNjCTIwMDEvMTEvMDEgMTM6
MjI6NDYJMi42CisrKyBuZXQuY2MJMjAwMS8xMS8xMSAwNjo1NDo1NwpAQCAt
MTYsNyArMTYsMTAgQEAKIC8qIFRoZSBwdXJwb3NlIG9mIHRoaXMgZmlsZSBp
cyB0byBnZXQgdGhlIG5ldHdvcmsgY29uZmlndXJhdGlvbgogICAgaW5mb3Jt
YXRpb24gZnJvbSB0aGUgdXNlci4gKi8KIAotc3RhdGljIGNoYXIgKmN2c2lk
ID0gIlxuJSUlICRJZDogbmV0LmNjLHYgMi42IDIwMDEvMTEvMDEgMTM6MjI6
NDYgcmJjb2xsaW5zIEV4cCAkXG4iOworI2lmIDAKK3N0YXRpYyBjb25zdCBj
aGFyICpjdnNpZCA9CisgICJcbiUlJSAkSWQ6IG5ldC5jYyx2IDIuNiAyMDAx
LzExLzAxIDEzOjIyOjQ2IHJiY29sbGlucyBFeHAgJFxuIjsKKyNlbmRpZgog
CiAjaW5jbHVkZSAid2luMzIuaCIKICNpbmNsdWRlIDxzdGRpby5oPgpAQCAt
MTA4LDYgKzExMSw3IEBAIGRpYWxvZ19jbWQgKEhXTkQgaCwgaW50IGlkLCBI
V05EIGh3bmRjdGwKICAgICAgIE5FWFQgKDApOwogICAgICAgYnJlYWs7CiAg
ICAgfQorICByZXR1cm4gMDsKIH0KIAogc3RhdGljIEJPT0wgQ0FMTEJBQ0sK
QEAgLTExOSwxMSArMTIzLDE0IEBAIGRpYWxvZ19wcm9jIChIV05EIGgsIFVJ
TlQgbWVzc2FnZSwgV1BBUkEKICAgICAgIGxvYWRfZGlhbG9nIChoKTsKIAog
ICAgICAgLy8gQ2hlY2sgdG8gc2VlIGlmIGFueSByYWRpbyBidXR0b25zIGFy
ZSBzZWxlY3RlZC4gSWYgbm90LCBzZWxlY3QgYSBkZWZhdWx0LgotICAgICAg
aWYgKCghU2VuZE1lc3NhZ2UoR2V0RGxnSXRlbSAoaCwgSURDX05FVF9JRTUp
LCBCTV9HRVRDSEVDSywgMCwgMCkgPT0gQlNUX0NIRUNLRUQpCi0gICAgICAg
ICYmICghU2VuZE1lc3NhZ2UoR2V0RGxnSXRlbSAoaCwgSURDX05FVF9QUk9Y
WSksIEJNX0dFVENIRUNLLCAwLCAwKSA9PSBCU1RfQ0hFQ0tFRCkpCi0gICAg
ICAgIHsKLSAgICAgICAgICBTZW5kTWVzc2FnZShHZXREbGdJdGVtIChoLCBJ
RENfTkVUX0RJUkVDVCksIEJNX0NMSUNLLCAwLCAwKTsKLSAgICAgICAgfQor
ICAgICAgaWYgKAorCSAgKCFTZW5kTWVzc2FnZSAoR2V0RGxnSXRlbSAoaCwg
SURDX05FVF9JRTUpLCBCTV9HRVRDSEVDSywgMCwgMCkgPT0KKwkgICBCU1Rf
Q0hFQ0tFRCkKKwkgICYmICghU2VuZE1lc3NhZ2UgKEdldERsZ0l0ZW0gKGgs
IElEQ19ORVRfUFJPWFkpLCBCTV9HRVRDSEVDSywgMCwgMCkKKwkgICAgICA9
PSBCU1RfQ0hFQ0tFRCkpCisJeworCSAgU2VuZE1lc3NhZ2UgKEdldERsZ0l0
ZW0gKGgsIElEQ19ORVRfRElSRUNUKSwgQk1fQ0xJQ0ssIDAsIDApOworCX0K
ICAgICAgIHJldHVybiBGQUxTRTsKICAgICBjYXNlIFdNX0NPTU1BTkQ6CiAg
ICAgICByZXR1cm4gSEFORExFX1dNX0NPTU1BTkQgKGgsIHdQYXJhbSwgbFBh
cmFtLCBkaWFsb2dfY21kKTsKQEAgLTE0NSw0ICsxNTIsMyBAQCBkb19uZXQg
KEhJTlNUQU5DRSBoKQogICAgICAgIChuZXRfbWV0aG9kID09IElEQ19ORVRf
SUU1KSA/ICJJRTUiIDoKICAgICAgICAobmV0X21ldGhvZCA9PSBJRENfTkVU
X0RJUkVDVCkgPyAiRGlyZWN0IiA6ICJQcm94eSIpOwogfQotCkluZGV4OiBu
ZXRpby5jYwo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09ClJDUyBmaWxlOiAvY3Zz
L3NyYy9zcmMvd2luc3VwL2NpbnN0YWxsL25ldGlvLmNjLHYKcmV0cmlldmlu
ZyByZXZpc2lvbiAyLjMKZGlmZiAtdSAtcCAtcjIuMyBuZXRpby5jYwotLS0g
bmV0aW8uY2MJMjAwMS8wNS8yOCAwODozMTowMgkyLjMKKysrIG5ldGlvLmNj
CTIwMDEvMTEvMTEgMDY6NTQ6NTcKQEAgLTE3LDcgKzE3LDEwIEBACiAgICBt
ZXRob2RzIGtub3duIHRvIHNldHVwLiAgVG8gYWRkIGEgbmV3IG1ldGhvZCwg
Y3JlYXRlIGEgcGFpciBvZgogICAgbmlvLSouW2NoXSBmaWxlcyBhbmQgYWRk
IHRoZSBsb2dpYyB0byBOZXRJTzo6b3BlbiBoZXJlICovCiAKLXN0YXRpYyBj
aGFyICpjdnNpZCA9ICJcbiUlJSAkSWQ6IG5ldGlvLmNjLHYgMi4zIDIwMDEv
MDUvMjggMDg6MzE6MDIgY29yaW5uYSBFeHAgJFxuIjsKKyNpZiAwCitzdGF0
aWMgY29uc3QgY2hhciAqY3ZzaWQgPQorICAiXG4lJSUgJElkOiBuZXRpby5j
Yyx2IDIuMyAyMDAxLzA1LzI4IDA4OjMxOjAyIGNvcmlubmEgRXhwICRcbiI7
CisjZW5kaWYKIAogI2luY2x1ZGUgIndpbjMyLmgiCiAjaW5jbHVkZSA8c3Rk
aW8uaD4KQEAgLTc4LDcgKzgxLDcgQEAgTmV0SU86OnNldF91cmwgKGNoYXIg
KlB1cmwpCiAgICplcCA9IDA7CiAgIHByb3RvID0gX3N0cmR1cCAoYnApOwog
ICAqZXAgPSAnOic7Ci0gIGJwID0gZXArMzsKKyAgYnAgPSBlcCArIDM7CiAK
ICAgZXAgPSBicCArIHN0cmNzcG4gKGJwLCAiOi8iKTsKICAgYyA9ICplcDsK
QEAgLTg4LDcgKzkxLDcgQEAgTmV0SU86OnNldF91cmwgKGNoYXIgKlB1cmwp
CiAKICAgaWYgKCplcCA9PSAnOicpCiAgICAgewotICAgICAgcG9ydCA9IGF0
b2kgKGVwKzEpOworICAgICAgcG9ydCA9IGF0b2kgKGVwICsgMSk7CiAgICAg
ICBlcCA9IHN0cmNociAoZXAsICcvJyk7CiAgICAgfQogCkBAIC0xMTIsNyAr
MTE1LDkgQEAgTmV0SU8gKgogTmV0SU86Om9wZW4gKGNoYXIgKnVybCwgQk9P
TCBhbGxvd19mdHBfYXV0aCkKIHsKICAgTmV0SU8gKnJ2ID0gMDsKLSAgZW51
bSB7aHR0cCwgZnRwLCBmaWxlfSBwcm90bzsKKyAgZW51bQorICB7IGh0dHAs
IGZ0cCwgZmlsZSB9CisgIHByb3RvOwogICBpZiAoc3RybmNtcCAodXJsLCAi
aHR0cDovLyIsIDcpID09IDApCiAgICAgcHJvdG8gPSBodHRwOwogICBlbHNl
IGlmIChzdHJuY21wICh1cmwsICJmdHA6Ly8iLCA2KSA9PSAwKQpAQCAtMTM2
LDYgKzE0MSw5IEBAIE5ldElPOjpvcGVuIChjaGFyICp1cmwsIEJPT0wgYWxs
b3dfZnRwX2EKIAljYXNlIGZ0cDoKIAkgIHJ2ID0gbmV3IE5ldElPX0ZUUCAo
dXJsLCBhbGxvd19mdHBfYXV0aCk7CiAJICBicmVhazsKKwljYXNlIGZpbGU6
CisJICBydiA9IG5ldyBOZXRJT19GaWxlICh1cmwpOworCSAgYnJlYWs7CiAJ
fQogICAgIH0KIApAQCAtMjAzLDYgKzIxMSw3IEBAIGF1dGhfY21kIChIV05E
IGgsIGludCBpZCwgSFdORCBod25kY3RsLCAKICAgICAgIGV4aXRfc2V0dXAg
KDEpOwogICAgICAgYnJlYWs7CiAgICAgfQorICByZXR1cm4gMDsKIH0KIAog
c3RhdGljIEJPT0wgQ0FMTEJBQ0sKSW5kZXg6IG5ldGlvLmgKPT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PQpSQ1MgZmlsZTogL2N2cy9zcmMvc3JjL3dpbnN1cC9j
aW5zdGFsbC9uZXRpby5oLHYKcmV0cmlldmluZyByZXZpc2lvbiAyLjIKZGlm
ZiAtdSAtcCAtcjIuMiBuZXRpby5oCi0tLSBuZXRpby5oCTIwMDEvMDUvMjgg
MDg6MzE6MDIJMi4yCisrKyBuZXRpby5oCTIwMDEvMTEvMTEgMDY6NTQ6NTcK
QEAgLTE2LDcgKzE2LDggQEAKIC8qIFRoaXMgaXMgdGhlIHBhcmVudCBjbGFz
cyBmb3IgYWxsIHRoZSBhY2Nlc3MgbWV0aG9kcyBrbm93biB0byBzZXR1cAog
ICAgKGkuZS4gd2F5cyB0byBkb3dubG9hZCBmaWxlcyBmcm9tIHRoZSBpbnRl
cm5ldCBvciBvdGhlciBzb3VyY2VzICovCiAKLWNsYXNzIE5ldElPIHsKK2Ns
YXNzIE5ldElPCit7CiBwcm90ZWN0ZWQ6CiAgIE5ldElPIChjaGFyICp1cmws
IEJPT0wgYWxsb3dfZnRwX2F1dGggPSBGQUxTRSk7CiAgIHZvaWQgc2V0X3Vy
bCAoY2hhciAqdXJsKTsKQEAgLTMxLDEzICszMiwxMyBAQCBwdWJsaWM6CiAg
IGNoYXIgKmhvc3Q7CiAgIGludCBwb3J0OwogICBjaGFyICpwYXRoOwotICB2
aXJ0dWFsIH5OZXRJTyAoKTsKKyAgICB2aXJ0dWFsIH4gTmV0SU8gKCk7CiAK
ICAgLyogVGhlIHVzZXIgY2FsbHMgdGhpcyBmdW5jdGlvbiB0byBjcmVhdGUg
YSBzdWl0YWJsZSBhY2Nlc3NvciBmb3IKICAgICAgdGhlIGdpdmVuIFVSTC4g
IEl0IHVzZXMgdGhlIG5ldHdvcmsgc2V0dXAgc3RhdGUgaW4gc3RhdGUuaC4g
IElmCiAgICAgIGFueXRoaW5nIGZhaWxzLCBlaXRoZXIgdGhlIHJldHVybiB2
YWx1ZXMgaXMgTlVMTCBvciB0aGUgcmV0dXJuZWQKICAgICAgb2JqZWN0IGlz
ICFvaygpICovCi0gIHN0YXRpYyBOZXRJTyAqIG9wZW4gKGNoYXIgKnVybCwg
Qk9PTCBhbGxvd19mdHBfYXV0aCA9IEZBTFNFKTsKKyAgc3RhdGljIE5ldElP
ICpvcGVuIChjaGFyICp1cmwsIEJPT0wgYWxsb3dfZnRwX2F1dGggPSBGQUxT
RSk7CiAKICAgLyogSWYgIW9rKCkgdGhhdCBtZWFucyB0aGUgdHJhbnNmZXIg
aXNuJ3QgaGFwcGVuaW5nLiAqLwogICB2aXJ0dWFsIGludCBvayAoKTsKSW5k
ZXg6IG5pby1maWxlLmNjCj09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KUkNTIGZp
bGU6IC9jdnMvc3JjL3NyYy93aW5zdXAvY2luc3RhbGwvbmlvLWZpbGUuY2Ms
dgpyZXRyaWV2aW5nIHJldmlzaW9uIDIuMgpkaWZmIC11IC1wIC1yMi4yIG5p
by1maWxlLmNjCi0tLSBuaW8tZmlsZS5jYwkyMDAxLzA2LzEzIDE2OjExOjAx
CTIuMgorKysgbmlvLWZpbGUuY2MJMjAwMS8xMS8xMSAwNjo1NDo1NwpAQCAt
MTYsNyArMTYsMTAgQEAKIC8qIFRoZSBwdXJwb3NlIG9mIHRoaXMgZmlsZSBp
cyB0byBtYW5hZ2UgYWNjZXNzIHRvIGZpbGVzIHN0b3JlZCBvbiB0aGUKICAg
IGxvY2FsIGRpc2sgKGkuZS4gImRvd25sb2FkaW5nIiBzZXR1cC5pbmkpLiAg
Q2FsbGVkIGZyb20gbmV0aW8uY2MgKi8KIAotc3RhdGljIGNoYXIgKmN2c2lk
ID0gIlxuJSUlICRJZDogbmlvLWZpbGUuY2MsdiAyLjIgMjAwMS8wNi8xMyAx
NjoxMTowMSBjZ2YgRXhwICRcbiI7CisjaWYgMAorc3RhdGljIGNvbnN0IGNo
YXIgKmN2c2lkID0KKyAgIlxuJSUlICRJZDogbmlvLWZpbGUuY2MsdiAyLjIg
MjAwMS8wNi8xMyAxNjoxMTowMSBjZ2YgRXhwICRcbiI7CisjZW5kaWYKIAog
I2luY2x1ZGUgIndpbjMyLmgiCiAjaW5jbHVkZSA8c3RkaW8uaD4KQEAgLTI5
LDE4ICszMiwxNyBAQCBzdGF0aWMgY2hhciAqY3ZzaWQgPSAiXG4lJSUgJElk
OiBuaW8tZmlsCiAjaW5jbHVkZSAibXNnLmgiCiAjaW5jbHVkZSAiZmlsZW1h
bmlwLmgiCiAKLU5ldElPX0ZpbGU6Ok5ldElPX0ZpbGUgKGNoYXIgKlB1cmwp
Ci0gIDogTmV0SU8gKFB1cmwpCitOZXRJT19GaWxlOjpOZXRJT19GaWxlIChj
aGFyICpQdXJsKToKK05ldElPIChQdXJsKQogewotICBzdHJ1Y3Qgc3RhdCBz
OwogICBmZCA9IGZvcGVuIChwYXRoLCAicmIiKTsKICAgaWYgKGZkKQogICAg
IHsKLSAgICAgIGZpbGVfc2l6ZSA9IGdldF9maWxlX3NpemUocGF0aCk7Cisg
ICAgICBmaWxlX3NpemUgPSBnZXRfZmlsZV9zaXplIChwYXRoKTsKICAgICB9
CiAgIGVsc2UKICAgICB7Ci0gICAgICBjaGFyICplcnIgPSBzdHJlcnJvciAo
ZXJybm8pOworICAgICAgY29uc3QgY2hhciAqZXJyID0gc3RyZXJyb3IgKGVy
cm5vKTsKICAgICAgIGlmICghZXJyKQogCWVyciA9ICIodW5rbm93biBlcnJv
cikiOwogICAgICAgbm90ZSAoSURTX0VSUl9PUEVOX1JFQUQsIHBhdGgsIGVy
cik7CkBAIC01MCw3ICs1Miw3IEBAIE5ldElPX0ZpbGU6Ok5ldElPX0ZpbGUg
KGNoYXIgKlB1cmwpCiBOZXRJT19GaWxlOjp+TmV0SU9fRmlsZSAoKQogewog
ICBpZiAoZmQpCi0gICAgZmNsb3NlICgoRklMRSAqKWZkKTsKKyAgICBmY2xv
c2UgKChGSUxFICopIGZkKTsKIH0KIAogaW50CkBAIC02Miw1ICs2NCw1IEBA
IE5ldElPX0ZpbGU6Om9rICgpCiBpbnQKIE5ldElPX0ZpbGU6OnJlYWQgKGNo
YXIgKmJ1ZiwgaW50IG5ieXRlcykKIHsKLSAgcmV0dXJuIGZyZWFkIChidWYs
IDEsIG5ieXRlcywgKEZJTEUgKilmZCk7CisgIHJldHVybiBmcmVhZCAoYnVm
LCAxLCBuYnl0ZXMsIChGSUxFICopIGZkKTsKIH0KSW5kZXg6IG5pby1maWxl
LmgKPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PQpSQ1MgZmlsZTogL2N2cy9zcmMv
c3JjL3dpbnN1cC9jaW5zdGFsbC9uaW8tZmlsZS5oLHYKcmV0cmlldmluZyBy
ZXZpc2lvbiAyLjAKZGlmZiAtdSAtcCAtcjIuMCBuaW8tZmlsZS5oCi0tLSBu
aW8tZmlsZS5oCTIwMDAvMDgvMDggMDA6Mjc6NTQJMi4wCisrKyBuaW8tZmls
ZS5oCTIwMDEvMTEvMTEgMDY6NTQ6NTcKQEAgLTE1LDExICsxNSwxMiBAQAog
CiAvKiBzZWUgbmlvLWZpbGUuY2MgKi8KIAotY2xhc3MgTmV0SU9fRmlsZSA6
IHB1YmxpYyBOZXRJTyB7CitjbGFzcyBOZXRJT19GaWxlOnB1YmxpYyBOZXRJ
TworewogcHVibGljOgogICBOZXRJT19GaWxlIChjaGFyICp1cmwpOwogICB2
b2lkICpmZDsKLSAgfk5ldElPX0ZpbGUgKCk7CisgICB+TmV0SU9fRmlsZSAo
KTsKICAgdmlydHVhbCBpbnQgb2sgKCk7CiAgIHZpcnR1YWwgaW50IHJlYWQg
KGNoYXIgKmJ1ZiwgaW50IG5ieXRlcyk7CiB9OwpJbmRleDogbmlvLWZ0cC5j
Ywo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09ClJDUyBmaWxlOiAvY3ZzL3NyYy9z
cmMvd2luc3VwL2NpbnN0YWxsL25pby1mdHAuY2MsdgpyZXRyaWV2aW5nIHJl
dmlzaW9uIDIuNgpkaWZmIC11IC1wIC1yMi42IG5pby1mdHAuY2MKLS0tIG5p
by1mdHAuY2MJMjAwMS8xMS8wOSAxMzowMzowMgkyLjYKKysrIG5pby1mdHAu
Y2MJMjAwMS8xMS8xMSAwNjo1NDo1NwpAQCAtMTcsNyArMTcsOCBAQAogICAg
Y2hhbm5lbHMuICBJdCBpcyBpbnRlbnRpb25hbGx5IHNpbXBsaXN0aWMuICov
CiAKICNpZiAwCi1zdGF0aWMgY29uc3QgY2hhciAqY3ZzaWQgPSAiXG4lJSUg
JElkOiBuaW8tZnRwLmNjLHYgMi42IDIwMDEvMTEvMDkgMTM6MDM6MDIgcmJj
b2xsaW5zIEV4cCAkXG4iOworc3RhdGljIGNvbnN0IGNoYXIgKmN2c2lkID0K
KyAgIlxuJSUlICRJZDogbmlvLWZ0cC5jYyx2IDIuNiAyMDAxLzExLzA5IDEz
OjAzOjAyIHJiY29sbGlucyBFeHAgJFxuIjsKICNlbmRpZgogCiAjaW5jbHVk
ZSAid2luMzIuaCIKQEAgLTQxLDIwICs0MiwyMiBAQCBzdGF0aWMgaW50IGNt
ZF9wb3J0ID0gMDsKIHN0YXRpYyBjaGFyICpsYXN0X2xpbmU7CiAKIHN0YXRp
YyBpbnQKLWZ0cF9saW5lIChTaW1wbGVTb2NrZXQgKnMpCitmdHBfbGluZSAo
U2ltcGxlU29ja2V0ICogcykKIHsKLSAgZG8gewotICAgIGxhc3RfbGluZSA9
IHMtPmdldHMgKCk7Ci0gICAgbG9nIChMT0dfQkFCQkxFLCAiZnRwID4gJXMi
LCBsYXN0X2xpbmUgPyBsYXN0X2xpbmUgOiAiZXJyb3IiKTsKLSAgfSB3aGls
ZSAobGFzdF9saW5lICYmICghaXNkaWdpdCAobGFzdF9saW5lWzBdKSB8fCBs
YXN0X2xpbmVbM10gIT0gJyAnKSk7Ci0gIHJldHVybiBhdG9pIChsYXN0X2xp
bmUgPzogIjAiKTsKKyAgZG8KKyAgICB7CisgICAgICBsYXN0X2xpbmUgPSBz
LT5nZXRzICgpOworICAgICAgbG9nIChMT0dfQkFCQkxFLCAiZnRwID4gJXMi
LCBsYXN0X2xpbmUgPyBsYXN0X2xpbmUgOiAiZXJyb3IiKTsKKyAgICB9Cisg
IHdoaWxlIChsYXN0X2xpbmUgJiYgKCFpc2RpZ2l0IChsYXN0X2xpbmVbMF0p
IHx8IGxhc3RfbGluZVszXSAhPSAnICcpKTsKKyAgcmV0dXJuIGF0b2kgKGxh
c3RfbGluZSA/IDogIjAiKTsKIH0KIAotTmV0SU9fRlRQOjpOZXRJT19GVFAg
KGNoYXIgKlB1cmwsIEJPT0wgYWxsb3dfZnRwX2F1dGgpCi0gIDogTmV0SU8g
KFB1cmwsIGFsbG93X2Z0cF9hdXRoKQorTmV0SU9fRlRQOjpOZXRJT19GVFAg
KGNoYXIgKlB1cmwsIEJPT0wgYWxsb3dfZnRwX2F1dGgpOk5ldElPIChQdXJs
LCBhbGxvd19mdHBfYXV0aCkKIHsKICAgcyA9IDA7Ci0gIGludCBjb2RlOwor
ICBpbnQKKyAgICBjb2RlOwogCiAgIGlmIChwb3J0ID09IDApCiAgICAgcG9y
dCA9IDIxOwpAQCAtNjMsNyArNjYsOCBAQCBOZXRJT19GVFA6Ok5ldElPX0ZU
UCAoY2hhciAqUHVybCwgQk9PTCBhCiAgICAgewogICAgICAgaWYgKGNtZCkK
IAljbWQtPnByaW50ZiAoIlFVSVRcclxuIik7Ci0gICAgICBkZWxldGUgY21k
OworICAgICAgZGVsZXRlCisJY21kOwogICAgICAgZnJlZSAoY21kX2hvc3Qp
OwogICAgICAgY21kID0gMDsKICAgICAgIGNtZF9ob3N0ID0gMDsKQEAgLTcx
LDE0ICs3NSwxNSBAQCBOZXRJT19GVFA6Ok5ldElPX0ZUUCAoY2hhciAqUHVy
bCwgQk9PTCBhCiAKICAgaWYgKGNtZCA9PSAwKQogICAgIHsKLSAgICAgIFNp
bXBsZVNvY2tldCAqYyA9IG5ldyBTaW1wbGVTb2NrZXQgKGhvc3QsIHBvcnQp
OworICAgICAgU2ltcGxlU29ja2V0ICoKKwljID0gbmV3IFNpbXBsZVNvY2tl
dCAoaG9zdCwgcG9ydCk7CiAgICAgICBjb2RlID0gZnRwX2xpbmUgKGMpOwog
Ci1hdXRoX3JldHJ5OgorICAgIGF1dGhfcmV0cnk6CiAgICAgICBpZiAobmV0
X2Z0cF91c2VyKQotICAgICAgICBjLT5wcmludGYgKCJVU0VSICVzXHJcbiIs
IG5ldF9mdHBfdXNlcik7CisJYy0+cHJpbnRmICgiVVNFUiAlc1xyXG4iLCBu
ZXRfZnRwX3VzZXIpOwogICAgICAgZWxzZQotICAgICAgICBjLT5wcmludGYg
KCJVU0VSIGFub255bW91c1xyXG4iKTsKKwljLT5wcmludGYgKCJVU0VSIGFu
b255bW91c1xyXG4iKTsKICAgICAgIGNvZGUgPSBmdHBfbGluZSAoYyk7CiAg
ICAgICBpZiAoY29kZSA9PSAzMzEpCiAJewpAQCAtODgsOCArOTMsOCBAQCBh
dXRoX3JldHJ5OgogCSAgICBjLT5wcmludGYgKCJQQVNTIGN5Z3dpbi1zZXR1
cEBcclxuIik7CiAJICBjb2RlID0gZnRwX2xpbmUgKGMpOwogCX0KLSAgICAg
IGlmIChjb2RlID09IDUzMCkgLyogQXV0aGVudGljYXRpb24gZmFpbGVkLCBy
ZXRyeSAqLwotICAgICAgICB7CisgICAgICBpZiAoY29kZSA9PSA1MzApCQkv
KiBBdXRoZW50aWNhdGlvbiBmYWlsZWQsIHJldHJ5ICovCisJewogCSAgZ2V0
X2Z0cF9hdXRoICgpOwogCSAgaWYgKG5ldF9mdHBfdXNlciAmJiBuZXRfZnRw
X3Bhc3N3ZCkKIAkgICAgZ290byBhdXRoX3JldHJ5OwpAQCAtOTcsNyArMTAy
LDggQEAgYXV0aF9yZXRyeToKIAogICAgICAgaWYgKGNvZGUgPCAyMDAgfHwg
Y29kZSA+PSAzMDApCiAJewotCSAgZGVsZXRlIGM7CisJICBkZWxldGUKKwkg
ICAgYzsKIAkgIHJldHVybjsKIAl9CiAKQEAgLTExMCwyNyArMTE2LDMzIEBA
IGF1dGhfcmV0cnk6CiAgICAgfQogCiAgIGNtZC0+cHJpbnRmICgiUEFTVlxy
XG4iKTsKLSAgZG8gewotICAgIGNvZGUgPSBmdHBfbGluZSAoY21kKTsKLSAg
fSB3aGlsZSAoY29kZSA9PSAyMjYpOyAvKiBwcmV2aW91cyBSRVRSICovCisg
IGRvCisgICAgeworICAgICAgY29kZSA9IGZ0cF9saW5lIChjbWQpOworICAg
IH0KKyAgd2hpbGUgKGNvZGUgPT0gMjI2KTsJCS8qIHByZXZpb3VzIFJFVFIg
Ki8KICAgaWYgKGNvZGUgIT0gMjI3KQogICAgIHJldHVybjsKIAotICBjaGFy
ICpwYXJlbiA9IHN0cmNociAobGFzdF9saW5lLCAnKCcpOworICBjaGFyICoK
KyAgICBwYXJlbiA9IHN0cmNociAobGFzdF9saW5lLCAnKCcpOwogICBpZiAo
IXBhcmVuKQogICAgIHJldHVybjsKIAotICBpbnQgaTEsIGkyLCBpMywgaTQs
IHAxLCBwMjsKLSAgc3NjYW5mIChwYXJlbisxLCAiJWQsJWQsJWQsJWQsJWQs
JWQiLCAmaTEsICZpMiwgJmkzLCAmaTQsICZwMSwgJnAyKTsKLSAgY2hhciB0
bXBbMjBdOworICBpbnQKKyAgICBpMSwgaTIsIGkzLCBpNCwgcDEsIHAyOwor
ICBzc2NhbmYgKHBhcmVuICsgMSwgIiVkLCVkLCVkLCVkLCVkLCVkIiwgJmkx
LCAmaTIsICZpMywgJmk0LCAmcDEsICZwMik7CisgIGNoYXIKKyAgICB0bXBb
MjBdOwogICBzcHJpbnRmICh0bXAsICIlZC4lZC4lZC4lZCIsIGkxLCBpMiwg
aTMsIGk0KTsKLSAgcyA9IG5ldyBTaW1wbGVTb2NrZXQgKHRtcCwgcDEqMjU2
ICsgcDIpOworICBzID0gbmV3IFNpbXBsZVNvY2tldCAodG1wLCBwMSAqIDI1
NiArIHAyKTsKIAogICBjbWQtPnByaW50ZiAoIlJFVFIgJXNcclxuIiwgcGF0
aCk7CiAgIGNvZGUgPSBmdHBfbGluZSAoY21kKTsKICAgaWYgKGNvZGUgIT0g
MTUwICYmIGNvZGUgIT0gMTI1KQogICAgIHsKLSAgICAgIGRlbGV0ZSBzOwor
ICAgICAgZGVsZXRlCisJczsKICAgICAgIHMgPSAwOwogICAgICAgcmV0dXJu
OwogICAgIH0KSW5kZXg6IG5pby1mdHAuaAo9PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09ClJDUyBmaWxlOiAvY3ZzL3NyYy9zcmMvd2luc3VwL2NpbnN0YWxsL25p
by1mdHAuaCx2CnJldHJpZXZpbmcgcmV2aXNpb24gMi4yCmRpZmYgLXUgLXAg
LXIyLjIgbmlvLWZ0cC5oCi0tLSBuaW8tZnRwLmgJMjAwMS8wNS8yOCAwODoz
MTowMgkyLjIKKysrIG5pby1mdHAuaAkyMDAxLzExLzExIDA2OjU0OjU3CkBA
IC0xNywxMiArMTcsMTMgQEAKIAogY2xhc3MgU2ltcGxlU29ja2V0OwogCi1j
bGFzcyBOZXRJT19GVFAgOiBwdWJsaWMgTmV0SU8geworY2xhc3MgTmV0SU9f
RlRQOnB1YmxpYyBOZXRJTworewogICBTaW1wbGVTb2NrZXQgKnM7CiAKIHB1
YmxpYzoKLSAgTmV0SU9fRlRQIChjaGFyICp1cmwsIEJPT0wgYWxsb3dfZnRw
X2F1dGggPSBGQUxTRSk7Ci0gIHZpcnR1YWwgfk5ldElPX0ZUUCAoKTsKKyAg
ICBOZXRJT19GVFAgKGNoYXIgKnVybCwgQk9PTCBhbGxvd19mdHBfYXV0aCA9
IEZBTFNFKTsKKyAgICB2aXJ0dWFsIH4gTmV0SU9fRlRQICgpOwogCiAgIC8q
IElmICFvaygpIHRoYXQgbWVhbnMgdGhlIHRyYW5zZmVyIGlzbid0IGhhcHBl
bmluZy4gKi8KICAgdmlydHVhbCBpbnQgb2sgKCk7CkluZGV4OiBuaW8taHR0
cC5jYwo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09ClJDUyBmaWxlOiAvY3ZzL3Ny
Yy9zcmMvd2luc3VwL2NpbnN0YWxsL25pby1odHRwLmNjLHYKcmV0cmlldmlu
ZyByZXZpc2lvbiAyLjYKZGlmZiAtdSAtcCAtcjIuNiBuaW8taHR0cC5jYwot
LS0gbmlvLWh0dHAuY2MJMjAwMS8xMS8wOSAxMzowMzowMgkyLjYKKysrIG5p
by1odHRwLmNjCTIwMDEvMTEvMTEgMDY6NTQ6NTcKQEAgLTE3LDcgKzE3LDgg
QEAKICAgIGNoYW5uZWxzLiAgSXQgaXMgaW50ZW50aW9uYWxseSBzaW1wbGlz
dGljLiAqLwogCiAjaWYgMAotc3RhdGljIGNvbnN0IGNoYXIgKmN2c2lkID0g
IlxuJSUlICRJZDogbmlvLWh0dHAuY2MsdiAyLjYgMjAwMS8xMS8wOSAxMzow
MzowMiByYmNvbGxpbnMgRXhwICRcbiI7CitzdGF0aWMgY29uc3QgY2hhciAq
Y3ZzaWQgPQorICAiXG4lJSUgJElkOiBuaW8taHR0cC5jYyx2IDIuNiAyMDAx
LzExLzA5IDEzOjAzOjAyIHJiY29sbGlucyBFeHAgJFxuIjsKICNlbmRpZgog
CiAjaW5jbHVkZSAid2luMzIuaCIKQEAgLTM1LDExICszNiwxMSBAQCBzdGF0
aWMgY29uc3QgY2hhciAqY3ZzaWQgPSAiXG4lJSUgJElkOiBuCiAjaW5jbHVk
ZSAibmlvLWh0dHAuaCIKIAogc3RhdGljIGNoYXIgc2l4MnByWzY0XSA9IHsK
LSAgICAnQScsJ0InLCdDJywnRCcsJ0UnLCdGJywnRycsJ0gnLCdJJywnSics
J0snLCdMJywnTScsCi0gICAgJ04nLCdPJywnUCcsJ1EnLCdSJywnUycsJ1Qn
LCdVJywnVicsJ1cnLCdYJywnWScsJ1onLAotICAgICdhJywnYicsJ2MnLCdk
JywnZScsJ2YnLCdnJywnaCcsJ2knLCdqJywnaycsJ2wnLCdtJywKLSAgICAn
bicsJ28nLCdwJywncScsJ3InLCdzJywndCcsJ3UnLCd2JywndycsJ3gnLCd5
JywneicsCi0gICAgJzAnLCcxJywnMicsJzMnLCc0JywnNScsJzYnLCc3Jywn
OCcsJzknLCcrJywnLycKKyAgJ0EnLCAnQicsICdDJywgJ0QnLCAnRScsICdG
JywgJ0cnLCAnSCcsICdJJywgJ0onLCAnSycsICdMJywgJ00nLAorICAnTics
ICdPJywgJ1AnLCAnUScsICdSJywgJ1MnLCAnVCcsICdVJywgJ1YnLCAnVycs
ICdYJywgJ1knLCAnWicsCisgICdhJywgJ2InLCAnYycsICdkJywgJ2UnLCAn
ZicsICdnJywgJ2gnLCAnaScsICdqJywgJ2snLCAnbCcsICdtJywKKyAgJ24n
LCAnbycsICdwJywgJ3EnLCAncicsICdzJywgJ3QnLCAndScsICd2JywgJ3cn
LCAneCcsICd5JywgJ3onLAorICAnMCcsICcxJywgJzInLCAnMycsICc0Jywg
JzUnLCAnNicsICc3JywgJzgnLCAnOScsICcrJywgJy8nCiB9OwogCiBzdGF0
aWMgY2hhciAqCkBAIC01Niw3ICs1Nyw3IEBAIGJhc2U2NF9lbmNvZGUgKGNo
YXIgKnVzZXJuYW1lLCBjaGFyICpwYXMKICAgc3RyY3B5ICh1cCwgdXNlcm5h
bWUpOwogICBzdHJjYXQgKHVwLCAiOiIpOwogICBzdHJjYXQgKHVwLCBwYXNz
d29yZCk7Ci0gIGVwID0gKHVuc2lnbmVkIGNoYXIgKil1cCArIHN0cmxlbiAo
dXApOworICBlcCA9ICh1bnNpZ25lZCBjaGFyICopIHVwICsgc3RybGVuICh1
cCk7CiAgICplcCsrID0gMDsKICAgKmVwKysgPSAwOwogICAqZXArKyA9IDA7
CkBAIC02NSw3ICs2Niw3IEBAIGJhc2U2NF9lbmNvZGUgKGNoYXIgKnVzZXJu
YW1lLCBjaGFyICpwYXMKIAogICBycCA9IHJ2OwogCi0gIGZvciAoZXAgPSAo
dW5zaWduZWQgY2hhciAqKXVwOyAqZXA7IGVwICs9IDMpCisgIGZvciAoZXAg
PSAodW5zaWduZWQgY2hhciAqKSB1cDsgKmVwOyBlcCArPSAzKQogICAgIHsK
ICAgICAgIGJsb2NrWzBdID0gc2l4MnByW2VwWzBdID4+IDJdOwogICAgICAg
YmxvY2tbMV0gPSBzaXgycHJbKChlcFswXSA8PCA0KSAmIDB4MzApIHwgKChl
cFsxXSA+PiA0KSAmIDB4MGYpXTsKQEAgLTg2LDEwICs4Nyw5IEBAIGJhc2U2
NF9lbmNvZGUgKGNoYXIgKnVzZXJuYW1lLCBjaGFyICpwYXMKICAgcmV0dXJu
IHJ2OwogfQogCi1OZXRJT19IVFRQOjpOZXRJT19IVFRQIChjaGFyICpQdXJs
LCBCT09MIGFsbG93X2Z0cF9hdXRoKQotICA6IE5ldElPIChQdXJsLCBhbGxv
d19mdHBfYXV0aCkKK05ldElPX0hUVFA6Ok5ldElPX0hUVFAgKGNoYXIgKlB1
cmwsIEJPT0wgYWxsb3dfZnRwX2F1dGgpOk5ldElPIChQdXJsLCBhbGxvd19m
dHBfYXV0aCkKIHsKLSByZXRyeV9nZXQ6CityZXRyeV9nZXQ6CiAgIGlmIChw
b3J0ID09IDApCiAgICAgcG9ydCA9IDgwOwogCkBAIC05OCw5ICs5OCwxMCBA
QCBOZXRJT19IVFRQOjpOZXRJT19IVFRQIChjaGFyICpQdXJsLCBCT09MCiAg
IGVsc2UKICAgICBzID0gbmV3IFNpbXBsZVNvY2tldCAoaG9zdCwgcG9ydCk7
CiAKLSAgaWYgKCFzLT5vaygpKQorICBpZiAoIXMtPm9rICgpKQogICAgIHsK
LSAgICAgIGRlbGV0ZSBzOworICAgICAgZGVsZXRlCisJczsKICAgICAgIHMg
PSBOVUxMOwogICAgICAgcmV0dXJuOwogICAgIH0KQEAgLTEyMSw2MSArMTIy
LDY5IEBAIE5ldElPX0hUVFA6Ok5ldElPX0hUVFAgKGNoYXIgKlB1cmwsIEJP
T0wKIAogICBzLT5wcmludGYgKCJcclxuIik7CiAKLSAgY2hhciAqbCA9IHMt
PmdldHMgKCk7Ci0gIGludCBjb2RlOworICBjaGFyICoKKyAgICBsID0gcy0+
Z2V0cyAoKTsKKyAgaW50CisgICAgY29kZTsKICAgaWYgKCFsKQogICAgIHJl
dHVybjsKICAgc3NjYW5mIChsLCAiJSpzICVkIiwgJmNvZGUpOwogICBpZiAo
Y29kZSA+PSAzMDAgJiYgY29kZSA8IDQwMCkKICAgICB7Ci0gICAgICB3aGls
ZSAoKGwgPSBzLT5nZXRzICgpKSAhPSAwKSB7Ci0JaWYgKF9zdHJuaWNtcCAo
bCwgIkxvY2F0aW9uOiIsIDkpID09IDApCi0JICB7Ci0JICAgIGNoYXIgKnUg
PSBsICsgOTsKLQkgICAgd2hpbGUgKCp1ID09ICcgJyB8fCAqdSA9PSAnXHQn
KQotCSAgICAgIHUrKzsKLQkgICAgc2V0X3VybCAodSk7Ci0JICAgIGRlbGV0
ZSBzOwotCSAgICBnb3RvIHJldHJ5X2dldDsKLQkgIH0KLSAgICAgIH0KKyAg
ICAgIHdoaWxlICgobCA9IHMtPmdldHMgKCkpICE9IDApCisJeworCSAgaWYg
KF9zdHJuaWNtcCAobCwgIkxvY2F0aW9uOiIsIDkpID09IDApCisJICAgIHsK
KwkgICAgICBjaGFyICoKKwkJdSA9IGwgKyA5OworCSAgICAgIHdoaWxlICgq
dSA9PSAnICcgfHwgKnUgPT0gJ1x0JykKKwkJdSsrOworCSAgICAgIHNldF91
cmwgKHUpOworCSAgICAgIGRlbGV0ZQorCQlzOworCSAgICAgIGdvdG8gcmV0
cnlfZ2V0OworCSAgICB9CisJfQogICAgIH0KLSAgaWYgKGNvZGUgPT0gNDAx
KSAvKiBhdXRob3JpemF0aW9uIHJlcXVpcmVkICovCisgIGlmIChjb2RlID09
IDQwMSkJCS8qIGF1dGhvcml6YXRpb24gcmVxdWlyZWQgKi8KICAgICB7CiAg
ICAgICBnZXRfYXV0aCAoKTsKLSAgICAgIGRlbGV0ZSBzOworICAgICAgZGVs
ZXRlCisJczsKICAgICAgIGdvdG8gcmV0cnlfZ2V0OwogICAgIH0KLSAgaWYg
KGNvZGUgPT0gNDA3KSAvKiBwcm94eSBhdXRob3JpemF0aW9uIHJlcXVpcmVk
ICovCisgIGlmIChjb2RlID09IDQwNykJCS8qIHByb3h5IGF1dGhvcml6YXRp
b24gcmVxdWlyZWQgKi8KICAgICB7CiAgICAgICBnZXRfcHJveHlfYXV0aCAo
KTsKLSAgICAgIGRlbGV0ZSBzOworICAgICAgZGVsZXRlCisJczsKICAgICAg
IGdvdG8gcmV0cnlfZ2V0OwogICAgIH0KLSAgaWYgKGNvZGUgPT0gNTAwIC8q
IGZ0cCBhdXRoZW50aWNhdGlvbiB0aHJvdWdoIHByb3h5IHJlcXVpcmVkICov
Ci0gICAgICAmJiBuZXRfbWV0aG9kID09IElEQ19ORVRfUFJPWFkKLSAgICAg
ICYmICFzdHJuY21wICh1cmwsICJmdHA6Ly8iLCA2KSkKKyAgaWYgKGNvZGUg
PT0gNTAwCQkvKiBmdHAgYXV0aGVudGljYXRpb24gdGhyb3VnaCBwcm94eSBy
ZXF1aXJlZCAqLworICAgICAgJiYgbmV0X21ldGhvZCA9PSBJRENfTkVUX1BS
T1hZICYmICFzdHJuY21wICh1cmwsICJmdHA6Ly8iLCA2KSkKICAgICB7CiAg
ICAgICBnZXRfZnRwX2F1dGggKCk7CiAgICAgICBpZiAobmV0X2Z0cF91c2Vy
ICYmIG5ldF9mdHBfcGFzc3dkKQotICAgICAgICB7Ci0JICBkZWxldGUgczsK
Kwl7CisJICBkZWxldGUKKwkgICAgczsKIAkgIHVybCA9IGNvbmNhdCAoImZ0
cDovLyIsIG5ldF9mdHBfdXNlciwKLQkgIAkJIjoiLCBuZXRfZnRwX3Bhc3N3
ZCwKLQkJCSJAIiwgdXJsICsgNiwgMCk7Ci0gICAgICAgICAgZ290byByZXRy
eV9nZXQ7CisJCQkiOiIsIG5ldF9mdHBfcGFzc3dkLCAiQCIsIHVybCArIDYs
IDApOworCSAgZ290byByZXRyeV9nZXQ7CiAJfQogICAgIH0KICAgaWYgKGNv
ZGUgPj0gMzAwKQogICAgIHsKLSAgICAgIGRlbGV0ZSBzOworICAgICAgZGVs
ZXRlCisJczsKICAgICAgIHMgPSAwOwogICAgICAgcmV0dXJuOworICAgIH0K
KyAgd2hpbGUgKChsID0gcy0+Z2V0cyAoKSkgIT0gMCkKKyAgICB7CisgICAg
ICBpZiAoX3N0cm5pY21wIChsLCAiQ29udGVudC1MZW5ndGg6IiwgMTUpID09
IDApCisJc3NjYW5mIChsLCAiJSpzICVkIiwgJmZpbGVfc2l6ZSk7CiAgICAg
fQotICB3aGlsZSAoKGwgPSBzLT5nZXRzICgpKSAhPSAwKSB7Ci0gICAgaWYg
KF9zdHJuaWNtcCAobCwgIkNvbnRlbnQtTGVuZ3RoOiIsIDE1KSA9PSAwKQot
ICAgICAgc3NjYW5mIChsLCAiJSpzICVkIiwgJmZpbGVfc2l6ZSk7Ci0gIH0K
IH0KIAogTmV0SU9fSFRUUDo6fk5ldElPX0hUVFAgKCkKSW5kZXg6IG5pby1o
dHRwLmgKPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PQpSQ1MgZmlsZTogL2N2cy9z
cmMvc3JjL3dpbnN1cC9jaW5zdGFsbC9uaW8taHR0cC5oLHYKcmV0cmlldmlu
ZyByZXZpc2lvbiAyLjIKZGlmZiAtdSAtcCAtcjIuMiBuaW8taHR0cC5oCi0t
LSBuaW8taHR0cC5oCTIwMDEvMDUvMjggMDg6MzE6MDIJMi4yCisrKyBuaW8t
aHR0cC5oCTIwMDEvMTEvMTEgMDY6NTQ6NTcKQEAgLTE3LDEyICsxNywxMyBA
QAogCiBjbGFzcyBTaW1wbGVTb2NrZXQ7CiAKLWNsYXNzIE5ldElPX0hUVFAg
OiBwdWJsaWMgTmV0SU8geworY2xhc3MgTmV0SU9fSFRUUDpwdWJsaWMgTmV0
SU8KK3sKICAgU2ltcGxlU29ja2V0ICpzOwogCiBwdWJsaWM6Ci0gIE5ldElP
X0hUVFAgKGNoYXIgKnVybCwgQk9PTCBhbGxvd19mdHBfYXV0aCA9IEZBTFNF
KTsKLSAgdmlydHVhbCB+TmV0SU9fSFRUUCAoKTsKKyAgICBOZXRJT19IVFRQ
IChjaGFyICp1cmwsIEJPT0wgYWxsb3dfZnRwX2F1dGggPSBGQUxTRSk7Cisg
ICAgdmlydHVhbCB+IE5ldElPX0hUVFAgKCk7CiAKICAgLyogSWYgIW9rKCkg
dGhhdCBtZWFucyB0aGUgdHJhbnNmZXIgaXNuJ3QgaGFwcGVuaW5nLiAqLwog
ICB2aXJ0dWFsIGludCBvayAoKTsKSW5kZXg6IG5pby1pZTUuY2MKPT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PQpSQ1MgZmlsZTogL2N2cy9zcmMvc3JjL3dpbnN1
cC9jaW5zdGFsbC9uaW8taWU1LmNjLHYKcmV0cmlldmluZyByZXZpc2lvbiAy
LjIKZGlmZiAtdSAtcCAtcjIuMiBuaW8taWU1LmNjCi0tLSBuaW8taWU1LmNj
CTIwMDAvMDgvMzAgMDE6MDU6NDIJMi4yCisrKyBuaW8taWU1LmNjCTIwMDEv
MTEvMTEgMDY6NTQ6NTcKQEAgLTE4LDcgKzE4LDEwIEBACiAgICBtdXN0IGFs
cmVhZHkgaGF2ZSBpbnN0YWxsZWQgYW5kIGNvbmZpZ3VyZWQgSUU1LiAgVGhp
cyBtb2R1bGUgaXMKICAgIGNhbGxlZCBmcm9tIG5ldGlvLmNjLCB3aGljaCBp
cyBjYWxsZWQgZnJvbSBnZXR1cmwuY2MgKi8KIAotc3RhdGljIGNoYXIgKmN2
c2lkID0gIlxuJSUlICRJZDogbmlvLWllNS5jYyx2IDIuMiAyMDAwLzA4LzMw
IDAxOjA1OjQyIGRqIEV4cCAkXG4iOworI2lmIDAKK3N0YXRpYyBjb25zdCBj
aGFyICpjdnNpZCA9CisgICJcbiUlJSAkSWQ6IG5pby1pZTUuY2MsdiAyLjIg
MjAwMC8wOC8zMCAwMTowNTo0MiBkaiBFeHAgJFxuIjsKKyNlbmRpZgogCiAj
aW5jbHVkZSAid2luMzIuaCIKIApAQCAtMzEsOCArMzQsOCBAQCBzdGF0aWMg
Y2hhciAqY3ZzaWQgPSAiXG4lJSUgJElkOiBuaW8taWU1CiAKIHN0YXRpYyBI
SU5URVJORVQgaW50ZXJuZXQgPSAwOwogCi1OZXRJT19JRTU6Ok5ldElPX0lF
NSAoY2hhciAqX3VybCkKLSAgOiBOZXRJTyAoX3VybCkKK05ldElPX0lFNTo6
TmV0SU9fSUU1IChjaGFyICpfdXJsKToKK05ldElPIChfdXJsKQogewogICBp
bnQgcmVzZW5kID0gMDsKIApAQCAtNTUsMTIgKzU4LDExIEBAIE5ldElPX0lF
NTo6TmV0SU9fSUU1IChjaGFyICpfdXJsKQogICAgIElOVEVSTkVUX0ZMQUdf
S0VFUF9DT05ORUNUSU9OIHwKICAgICBJTlRFUk5FVF9GTEFHX1BSQUdNQV9O
T0NBQ0hFIHwKICAgICBJTlRFUk5FVF9GTEFHX1JFTE9BRCB8Ci0gICAgSU5U
RVJORVRfRkxBR19FWElTVElOR19DT05ORUNUIHwKLSAgICBJTlRFUk5FVF9G
TEFHX1BBU1NJVkU7CisgICAgSU5URVJORVRfRkxBR19FWElTVElOR19DT05O
RUNUIHwgSU5URVJORVRfRkxBR19QQVNTSVZFOwogCiAgIGNvbm5lY3Rpb24g
PSBJbnRlcm5ldE9wZW5VcmwgKGludGVybmV0LCB1cmwsIE5VTEwsIDAsIGZs
YWdzLCAwKTsKIAotIHRyeV9hZ2FpbjoKK3RyeV9hZ2FpbjoKIAogICBpZiAo
bmV0X3VzZXIgJiYgbmV0X3Bhc3N3ZCkKICAgICB7CkBAIC04Nyw3ICs4OSw3
IEBAIE5ldElPX0lFNTo6TmV0SU9fSUU1IChjaGFyICpfdXJsKQogICAgICAg
aWYgKEdldExhc3RFcnJvciAoKSA9PSBFUlJPUl9JTlRFUk5FVF9FWFRFTkRF
RF9FUlJPUikKIAl7CiAJICBjaGFyIGJ1ZlsyMDAwXTsKLQkgIERXT1JEIGUs
IGw9c2l6ZW9mIChidWYpOworCSAgRFdPUkQgZSwgbCA9IHNpemVvZiAoYnVm
KTsKIAkgIEludGVybmV0R2V0TGFzdFJlc3BvbnNlSW5mbyAoJmUsIGJ1Ziwg
JmwpOwogCSAgTWVzc2FnZUJveCAoMCwgYnVmLCAiSW50ZXJuZXQgRXJyb3Ii
LCAwKTsKIAl9CkBAIC0xMDcsMTYgKzEwOSwxNiBAQCBOZXRJT19JRTU6Ok5l
dElPX0lFNSAoY2hhciAqX3VybCkKIAkJCSBIVFRQX1FVRVJZX1NUQVRVU19D
T0RFIHwgSFRUUF9RVUVSWV9GTEFHX05VTUJFUiwKIAkJCSAmdHlwZSwgJnR5
cGVfcywgTlVMTCkpCiAJewotCSAgaWYgKHR5cGUgPT0gNDAxKSAvKiBhdXRo
b3JpemF0aW9uIHJlcXVpcmVkICovCisJICBpZiAodHlwZSA9PSA0MDEpCS8q
IGF1dGhvcml6YXRpb24gcmVxdWlyZWQgKi8KIAkgICAgewotCSAgICAgIGZs
dXNoX2lvKCk7CisJICAgICAgZmx1c2hfaW8gKCk7CiAJICAgICAgZ2V0X2F1
dGggKCk7CiAJICAgICAgcmVzZW5kID0gMTsKIAkgICAgICBnb3RvIHRyeV9h
Z2FpbjsKIAkgICAgfQotCSAgZWxzZSBpZiAodHlwZSA9PSA0MDcpIC8qIHBy
b3h5IGF1dGhvcml6YXRpb24gcmVxdWlyZWQgKi8KKwkgIGVsc2UgaWYgKHR5
cGUgPT0gNDA3KQkvKiBwcm94eSBhdXRob3JpemF0aW9uIHJlcXVpcmVkICov
CiAJICAgIHsKLQkgICAgICBmbHVzaF9pbygpOworCSAgICAgIGZsdXNoX2lv
ICgpOwogCSAgICAgIGdldF9wcm94eV9hdXRoICgpOwogCSAgICAgIHJlc2Vu
ZCA9IDE7CiAJICAgICAgZ290byB0cnlfYWdhaW47CkBAIC0xMzUsOSArMTM3
LDExIEBAIE5ldElPX0lFNTo6Zmx1c2hfaW8gKCkKIHsKICAgRFdPUkQgYWN0
dWFsID0gMDsKICAgY2hhciBidWZbMTAyNF07Ci0gIGRvIHsKLSAgICBJbnRl
cm5ldFJlYWRGaWxlIChjb25uZWN0aW9uLCBidWYsIDEwMjQsICZhY3R1YWwp
OwotICB9IHdoaWxlIChhY3R1YWwgPiAwKTsKKyAgZG8KKyAgICB7CisgICAg
ICBJbnRlcm5ldFJlYWRGaWxlIChjb25uZWN0aW9uLCBidWYsIDEwMjQsICZh
Y3R1YWwpOworICAgIH0KKyAgd2hpbGUgKGFjdHVhbCA+IDApOwogfQogCiBO
ZXRJT19JRTU6On5OZXRJT19JRTUgKCkKSW5kZXg6IG5pby1pZTUuaAo9PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09ClJDUyBmaWxlOiAvY3ZzL3NyYy9zcmMvd2lu
c3VwL2NpbnN0YWxsL25pby1pZTUuaCx2CnJldHJpZXZpbmcgcmV2aXNpb24g
Mi4xCmRpZmYgLXUgLXAgLXIyLjEgbmlvLWllNS5oCi0tLSBuaW8taWU1LmgJ
MjAwMC8wOC8yNCAwMjo0ODoxNAkyLjEKKysrIG5pby1pZTUuaAkyMDAxLzEx
LzExIDA2OjU0OjU3CkBAIC0xNSwxMiArMTUsMTMgQEAKIAogLyogc2VlIG5p
by1pZTUuY2MgKi8KIAotY2xhc3MgTmV0SU9fSUU1IDogcHVibGljIE5ldElP
IHsKK2NsYXNzIE5ldElPX0lFNTpwdWJsaWMgTmV0SU8KK3sKICAgSElOVEVS
TkVUIGNvbm5lY3Rpb247CiBwdWJsaWM6Ci0gIE5ldElPX0lFNSAoY2hhciAq
dXJsKTsKLSAgfk5ldElPX0lFNSAoKTsKKyAgICBOZXRJT19JRTUgKGNoYXIg
KnVybCk7CisgICB+TmV0SU9fSUU1ICgpOwogICB2aXJ0dWFsIGludCBvayAo
KTsKICAgdmlydHVhbCBpbnQgcmVhZCAoY2hhciAqYnVmLCBpbnQgbmJ5dGVz
KTsKLSAgdm9pZCBmbHVzaF9pbygpOworICB2b2lkIGZsdXNoX2lvICgpOwog
fTsKSW5kZXg6IG90aGVyLmNjCj09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KUkNT
IGZpbGU6IC9jdnMvc3JjL3NyYy93aW5zdXAvY2luc3RhbGwvb3RoZXIuY2Ms
dgpyZXRyaWV2aW5nIHJldmlzaW9uIDIuMQpkaWZmIC11IC1wIC1yMi4xIG90
aGVyLmNjCi0tLSBvdGhlci5jYwkyMDAwLzA4LzI1IDAxOjMyOjA4CTIuMQor
Kysgb3RoZXIuY2MJMjAwMS8xMS8xMSAwNjo1NDo1NwpAQCAtMTYsNyArMTYs
MTAgQEAKIC8qIFRoaXMgaGFuZGxlcyB0aGUgIm90aGVyIFVSTCIgb3B0aW9u
IGZyb20gdGhlIG1pcnJvciBzaXRlCiAgICBzZWxlY3Rpb24uICovCiAKLXN0
YXRpYyBjaGFyICpjdnNpZCA9ICJcbiUlJSAkSWQ6IG90aGVyLmNjLHYgMi4x
IDIwMDAvMDgvMjUgMDE6MzI6MDggZGogRXhwICRcbiI7CisjaWYgMAorc3Rh
dGljIGNvbnN0IGNoYXIgKmN2c2lkID0KKyAgIlxuJSUlICRJZDogb3RoZXIu
Y2MsdiAyLjEgMjAwMC8wOC8yNSAwMTozMjowOCBkaiBFeHAgJFxuIjsKKyNl
bmRpZgogCiAjaW5jbHVkZSAid2luMzIuaCIKICNpbmNsdWRlIDxzaGxvYmou
aD4KQEAgLTc2LDYgKzc5LDcgQEAgZGlhbG9nX2NtZCAoSFdORCBoLCBpbnQg
aWQsIEhXTkQgaHduZGN0bAogICAgICAgTkVYVCAoMCk7CiAgICAgICBicmVh
azsKICAgICB9CisgIHJldHVybiAwOwogfQogCiBzdGF0aWMgQk9PTCBDQUxM
QkFDSwpAQCAtMTAyLDQgKzEwNiwzIEBAIGRvX290aGVyIChISU5TVEFOQ0Ug
aCkKIAogICBsb2cgKDAsICJzaXRlOiAlcyIsIG90aGVyX3VybCk7CiB9Ci0K
SW5kZXg6IHBvcnQuaAo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09ClJDUyBmaWxl
OiAvY3ZzL3NyYy9zcmMvd2luc3VwL2NpbnN0YWxsL3BvcnQuaCx2CnJldHJp
ZXZpbmcgcmV2aXNpb24gMi4wCmRpZmYgLXUgLXAgLXIyLjAgcG9ydC5oCi0t
LSBwb3J0LmgJMjAwMC8wOC8wOCAwMDoyNzo1NAkyLjAKKysrIHBvcnQuaAky
MDAxLzExLzExIDA2OjU0OjU3CkBAIC0yNCw1ICsyNCw0IEBACiAKICNkZWZp
bmUgX2FjY2VzcyBhY2Nlc3MKICNkZWZpbmUgX3N0cmR1cCBzdHJkdXAKLQog
I2VuZGlmCkluZGV4OiBwb3N0aW5zdGFsbC5jYwo9PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09ClJDUyBmaWxlOiAvY3ZzL3NyYy9zcmMvd2luc3VwL2NpbnN0YWxs
L3Bvc3RpbnN0YWxsLmNjLHYKcmV0cmlldmluZyByZXZpc2lvbiAyLjMKZGlm
ZiAtdSAtcCAtcjIuMyBwb3N0aW5zdGFsbC5jYwotLS0gcG9zdGluc3RhbGwu
Y2MJMjAwMS8xMC8yNyAxNTo1Njo0NwkyLjMKKysrIHBvc3RpbnN0YWxsLmNj
CTIwMDEvMTEvMTEgMDY6NTQ6NTcKQEAgLTE2LDcgKzE2LDEwIEBACiAvKiBU
aGUgcHVycG9zZSBvZiB0aGlzIGZpbGUgaXMgdG8gcnVuIGFsbCB0aGUgcG9z
dC1pbnN0YWxsIHNjcmlwdHMKICAgIGluIHRoZWlyIHZhcmlvdXMgZm9ybXMu
ICovCiAKLXN0YXRpYyBjaGFyICpjdnNpZCA9ICJcbiUlJSAkSWQ6IHBvc3Rp
bnN0YWxsLmNjLHYgMi4zIDIwMDEvMTAvMjcgMTU6NTY6NDcgY2dmIEV4cCAk
XG4iOworI2lmIDAKK3N0YXRpYyBjb25zdCBjaGFyICpjdnNpZCA9CisgICJc
biUlJSAkSWQ6IHBvc3RpbnN0YWxsLmNjLHYgMi4zIDIwMDEvMTAvMjcgMTU6
NTY6NDcgY2dmIEV4cCAkXG4iOworI2VuZGlmCiAKICNpbmNsdWRlICJ3aW4z
Mi5oIgogCkBAIC0zMiwxNCArMzUsMTQgQEAgc3RhdGljIGNoYXIgKmN2c2lk
ID0gIlxuJSUlICRJZDogcG9zdGlucwogI2luY2x1ZGUgInBvcnQuaCIKIAog
c3RhdGljIGNoYXIgKnNoID0gMDsKLXN0YXRpYyBjaGFyICpjbWQgPSAwOwor
c3RhdGljIGNvbnN0IGNoYXIgKmNtZCA9IDA7CiBzdGF0aWMgT1NWRVJTSU9O
SU5GTyB2ZXJpbmZvOwogCiBzdGF0aWMgdm9pZAotcnVuIChjaGFyICpzaCwg
Y2hhciAqYXJncywgY2hhciAqZmlsZSkKK3J1biAoY29uc3QgY2hhciAqc2gs
IGNvbnN0IGNoYXIgKmFyZ3MsIGNvbnN0IGNoYXIgKmZpbGUpCiB7CiAgIEJP
T0wgYjsKLSAgY2hhciBjbWRsaW5lIFtfTUFYX1BBVEhdOworICBjaGFyIGNt
ZGxpbmVbX01BWF9QQVRIXTsKICAgU1RBUlRVUElORk8gc2k7CiAgIFBST0NF
U1NfSU5GT1JNQVRJT04gcGk7CiAKQEAgLTQ3LDcgKzUwLDcgQEAgcnVuIChj
aGFyICpzaCwgY2hhciAqYXJncywgY2hhciAqZmlsZSkKICAgbWVtc2V0ICgm
cGksIDAsIHNpemVvZiAocGkpKTsKICAgbWVtc2V0ICgmc2ksIDAsIHNpemVv
ZiAoc2kpKTsKICAgc2kuY2IgPSBzaXplb2YgKHNpKTsKLSAgc2kubHBUaXRs
ZSA9ICJDeWd3aW4gU2V0dXAgUG9zdC1JbnN0YWxsIFNjcmlwdCI7CisgIHNp
LmxwVGl0bGUgPSAoY2hhciAqKSAiQ3lnd2luIFNldHVwIFBvc3QtSW5zdGFs
bCBTY3JpcHQiOwogICBzaS5kd0ZsYWdzID0gU1RBUlRGX1VTRVBPU0lUSU9O
OwogCiAgIGIgPSBDcmVhdGVQcm9jZXNzICgwLCBjbWRsaW5lLCAwLCAwLCAw
LApAQCAtODYsNyArODksNyBAQCBlYWNoIChjaGFyICpmbmFtZSwgdW5zaWdu
ZWQgaW50IHNpemUpCiAJICBjeWdwYXRoICgiL2V0Yy9wb3N0aW5zdGFsbC8i
LCBmbmFtZSwgIi5kb25lIiwgMCkpOwogfQogCi1zdGF0aWMgY2hhciAqc2hl
bGxzIFtdID0geworc3RhdGljIGNvbnN0IGNoYXIgKnNoZWxsc1tdID0gewog
ICAiL2Jpbi9zaC5leGUiLAogICAiL3Vzci9iaW4vc2guZXhlIiwKICAgIi9i
aW4vYmFzaC5leGUiLApAQCAtOTksNyArMTAyLDcgQEAgZG9fcG9zdGluc3Rh
bGwgKEhJTlNUQU5DRSBoKQogewogICBuZXh0X2RpYWxvZyA9IDA7CiAgIGlu
dCBpOwotICBmb3IgKGk9MDsgc2hlbGxzW2ldOyBpKyspCisgIGZvciAoaSA9
IDA7IHNoZWxsc1tpXTsgaSsrKQogICAgIHsKICAgICAgIHNoID0gYmFja3Ns
YXNoIChjeWdwYXRoIChzaGVsbHNbaV0sIDApKTsKICAgICAgIGlmIChfYWNj
ZXNzIChzaCwgMCkgPT0gMCkKQEAgLTExMiw4ICsxMTUsOCBAQCBkb19wb3N0
aW5zdGFsbCAoSElOU1RBTkNFIGgpCiAgIEdldEVudmlyb25tZW50VmFyaWFi
bGUgKCJQQVRIIiwgb2xkX3BhdGgsIHNpemVvZiAob2xkX3BhdGgpKTsKICAg
U2V0RW52aXJvbm1lbnRWYXJpYWJsZSAoIlBBVEgiLAogCQkJICBiYWNrc2xh
c2ggKGN5Z3BhdGggKCIvYmluOyIsCi0JCQkJCSAgICAgZ2V0X3Jvb3RfZGly
ICgpLCAiL3Vzci9iaW47IiwKLQkJCQkJICAgICBvbGRfcGF0aCwgMCkpKTsK
KwkJCQkJICAgICAgZ2V0X3Jvb3RfZGlyICgpLCAiL3Vzci9iaW47IiwKKwkJ
CQkJICAgICAgb2xkX3BhdGgsIDApKSk7CiAKICAgU2V0RW52aXJvbm1lbnRW
YXJpYWJsZSAoIkNZR1dJTlJPT1QiLCBnZXRfcm9vdF9kaXIgKCkpOwogICBT
ZXRDdXJyZW50RGlyZWN0b3J5IChnZXRfcm9vdF9kaXIgKCkpOwpJbmRleDog
cm9vdC5jYwo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09ClJDUyBmaWxlOiAvY3Zz
L3NyYy9zcmMvd2luc3VwL2NpbnN0YWxsL3Jvb3QuY2MsdgpyZXRyaWV2aW5n
IHJldmlzaW9uIDIuNgpkaWZmIC11IC1wIC1yMi42IHJvb3QuY2MKLS0tIHJv
b3QuY2MJMjAwMS8xMS8wMSAxMzoyMjo0NgkyLjYKKysrIHJvb3QuY2MJMjAw
MS8xMS8xMSAwNjo1NDo1OApAQCAtMTcsNyArMTcsMTAgQEAKICAgIHJvb3Qg
b2YgdGhlIGluc3RhbGxhdGlvbiB0byBiZSwgYW5kIHRvIGFzayB3aGV0aGVy
IHRoZSB1c2VyIHByZWZlcnMKICAgIHRleHQgb3IgYmluYXJ5IG1vdW50cy4g
Ki8KIAotc3RhdGljIGNoYXIgKmN2c2lkID0gIlxuJSUlICRJZDogcm9vdC5j
Yyx2IDIuNiAyMDAxLzExLzAxIDEzOjIyOjQ2IHJiY29sbGlucyBFeHAgJFxu
IjsKKyNpZiAwCitzdGF0aWMgY29uc3QgY2hhciAqY3ZzaWQgPQorICAiXG4l
JSUgJElkOiByb290LmNjLHYgMi42IDIwMDEvMTEvMDEgMTM6MjI6NDYgcmJj
b2xsaW5zIEV4cCAkXG4iOworI2VuZGlmCiAKICNpbmNsdWRlICJ3aW4zMi5o
IgogI2luY2x1ZGUgPHNobG9iai5oPgpAQCAtMzksNyArNDIsOCBAQCBzdGF0
aWMgaW50IHN1W10gPSB7IElEQ19ST09UX1NZU1RFTSwgSURDCiBzdGF0aWMg
dm9pZAogY2hlY2tfaWZfZW5hYmxlX25leHQgKEhXTkQgaCkKIHsKLSAgRW5h
YmxlV2luZG93IChHZXREbGdJdGVtIChoLCBJRE9LKSwgcm9vdF90ZXh0ICYm
IGdldF9yb290X2RpciAoKSAmJiByb290X3Njb3BlKTsKKyAgRW5hYmxlV2lu
ZG93IChHZXREbGdJdGVtIChoLCBJRE9LKSwgcm9vdF90ZXh0ICYmIGdldF9y
b290X2RpciAoKQorCQkmJiByb290X3Njb3BlKTsKIH0KIAogc3RhdGljIHZv
aWQKQEAgLTE0Myw3ICsxNDcsNyBAQCBkaWFsb2dfY21kIChIV05EIGgsIGlu
dCBpZCwgSFdORCBod25kY3RsCiAgICAgY2FzZSBJRE9LOgogICAgICAgc2F2
ZV9kaWFsb2cgKGgpOwogCi0gICAgICBpZiAoISBkaXJlY3RvcnlfaXNfYWJz
b2x1dGUgKCkpCisgICAgICBpZiAoIWRpcmVjdG9yeV9pc19hYnNvbHV0ZSAo
KSkKIAl7CiAJICBub3RlIChJRFNfUk9PVF9BQlNPTFVURSk7CiAJICBicmVh
azsKQEAgLTE2OSw2ICsxNzMsNyBAQCBkaWFsb2dfY21kIChIV05EIGgsIGlu
dCBpZCwgSFdORCBod25kY3RsCiAgICAgICBORVhUICgwKTsKICAgICAgIGJy
ZWFrOwogICAgIH0KKyAgcmV0dXJuIDA7CiB9CiAKIHN0YXRpYyBCT09MIENB
TExCQUNLCkBAIC0xOTksNCArMjA0LDMgQEAgZG9fcm9vdCAoSElOU1RBTkNF
IGgpCiAgICAgICAgKHJvb3RfdGV4dCA9PSBJRENfUk9PVF9URVhUKSA/ICJ0
ZXh0IiA6ICJiaW5hcnkiLAogICAgICAgIChyb290X3Njb3BlID09IElEQ19S
T09UX1VTRVIpID8gInVzZXIiIDogInN5c3RlbSIpOwogfQotCkluZGV4OiBz
aW1wc29jay5jYwo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09ClJDUyBmaWxlOiAv
Y3ZzL3NyYy9zcmMvd2luc3VwL2NpbnN0YWxsL3NpbXBzb2NrLmNjLHYKcmV0
cmlldmluZyByZXZpc2lvbiAyLjQKZGlmZiAtdSAtcCAtcjIuNCBzaW1wc29j
ay5jYwotLS0gc2ltcHNvY2suY2MJMjAwMS8xMS8wOSAxMzowMzowMgkyLjQK
KysrIHNpbXBzb2NrLmNjCTIwMDEvMTEvMTEgMDY6NTQ6NTgKQEAgLTE2LDcg
KzE2LDggQEAKIC8qIFNpbXBsaWZpZWQgc29ja2V0IGFjY2VzcyBmdW5jdGlv
bnMgKi8KIAogI2lmIDAKLXN0YXRpYyBjb25zdCBjaGFyICpjdnNpZCA9ICJc
biUlJSAkSWQ6IHNpbXBzb2NrLmNjLHYgMi40IDIwMDEvMTEvMDkgMTM6MDM6
MDIgcmJjb2xsaW5zIEV4cCAkXG4iOworc3RhdGljIGNvbnN0IGNoYXIgKmN2
c2lkID0KKyAgIlxuJSUlICRJZDogc2ltcHNvY2suY2MsdiAyLjQgMjAwMS8x
MS8wOSAxMzowMzowMiByYmNvbGxpbnMgRXhwICRcbiI7CiAjZW5kaWYKIAog
I2luY2x1ZGUgIndpbjMyLmgiCkBAIC0zNyw3ICszOCw3IEBAIFNpbXBsZVNv
Y2tldDo6U2ltcGxlU29ja2V0IChjb25zdCBjaGFyICoKICAgICB7CiAgICAg
ICBpbml0dGVkID0gMTsKICAgICAgIFdTQURBVEEgZDsKLSAgICAgIFdTQVN0
YXJ0dXAgKE1BS0VXT1JEICgxLDEpLCAmZCk7CisgICAgICBXU0FTdGFydHVw
IChNQUtFV09SRCAoMSwgMSksICZkKTsKICAgICB9CiAKICAgcyA9IElOVkFM
SURfU09DS0VUOwpAQCAtODAsNyArODEsNyBAQCBTaW1wbGVTb2NrZXQ6OlNp
bXBsZVNvY2tldCAoY29uc3QgY2hhciAqCiAgIG5hbWUuc2luX3BvcnQgPSBo
dG9ucyAocG9ydCk7CiAgIG1lbWNweSAoJm5hbWUuc2luX2FkZHIsIGlwLCA0
KTsKIAotICBpZiAoY29ubmVjdCAocywgKHNvY2thZGRyICopJm5hbWUsIHNp
emVvZihuYW1lKSkpCisgIGlmIChjb25uZWN0IChzLCAoc29ja2FkZHIgKikg
JiBuYW1lLCBzaXplb2YgKG5hbWUpKSkKICAgICB7CiAgICAgICBtc2cgKCJD
YW4ndCBjb25uZWN0IHRvICVzOiVkIiwgaG9zdG5hbWUsIHBvcnQpOwogICAg
ICAgY2xvc2Vzb2NrZXQgKHMpOwpAQCAtMTQ2LDcgKzE0Nyw3IEBAIFNpbXBs
ZVNvY2tldDo6ZmlsbCAoKQogICAgIH0KICAgZWxzZSBpZiAociA8IDAgJiYg
cHV0cCA9PSBnZXRwKQogICAgIHsKLSAgICAgIGludmFsaWRhdGUoKTsKKyAg
ICAgIGludmFsaWRhdGUgKCk7CiAgICAgfQogICByZXR1cm4gcjsKIH0KQEAg
LTE1Niw3ICsxNTcsNyBAQCBTaW1wbGVTb2NrZXQ6OmdldHMgKCkKIHsKICAg
aWYgKGdldHAgPiAwICYmIHB1dHAgPiBnZXRwKQogICAgIHsKLSAgICAgIG1l
bW1vdmUgKGJ1ZiwgYnVmK2dldHAsIHB1dHAtZ2V0cCk7CisgICAgICBtZW1t
b3ZlIChidWYsIGJ1ZiArIGdldHAsIHB1dHAgLSBnZXRwKTsKICAgICAgIHB1
dHAgLT0gZ2V0cDsKICAgICAgIGdldHAgPSAwOwogICAgIH0KQEAgLTE2Niw3
ICsxNjcsNyBAQCBTaW1wbGVTb2NrZXQ6OmdldHMgKCkKIAogICAvLyBnZXRw
IGlzIHplcm8sIGFsd2F5cywgaGVyZSwgYW5kIHB1dHAgaXMgdGhlIGNvdW50
CiAgIGNoYXIgKm5sOwotICB3aGlsZSAoKG5sID0gKGNoYXIgKiltZW1jaHIg
KGJ1ZiwgJ1xuJywgcHV0cCkpID09IE5VTEwgJiYgcHV0cCA8IFNTQlVGU1op
CisgIHdoaWxlICgobmwgPSAoY2hhciAqKSBtZW1jaHIgKGJ1ZiwgJ1xuJywg
cHV0cCkpID09IE5VTEwgJiYgcHV0cCA8IFNTQlVGU1opCiAgICAgaWYgKGZp
bGwgKCkgPD0gMCkKICAgICAgIGJyZWFrOwogCkBAIC0xOTYsMTEgKzE5Nywx
MSBAQCBTaW1wbGVTb2NrZXQ6OnJlYWQgKGNoYXIgKnVidWYsIGludCB1bGVu
CiAgIGlmICghb2sgKCkpCiAgICAgcmV0dXJuIC0xOwogCi0gIGludCBuLCBy
dj0wOworICBpbnQgbiwgcnYgPSAwOwogICBpZiAocHV0cCA+IGdldHApCiAg
ICAgewotICAgICAgbiA9IE1JTiAodWxlbiwgcHV0cC1nZXRwKTsKLSAgICAg
IG1lbW1vdmUgKHVidWYsIGJ1ZitnZXRwLCBuKTsKKyAgICAgIG4gPSBNSU4g
KHVsZW4sIHB1dHAgLSBnZXRwKTsKKyAgICAgIG1lbW1vdmUgKHVidWYsIGJ1
ZiArIGdldHAsIG4pOwogICAgICAgZ2V0cCArPSBuOwogICAgICAgdWJ1ZiAr
PSBuOwogICAgICAgdWxlbiAtPSBuOwpAQCAtMjEwLDkgKzIxMSw5IEBAIFNp
bXBsZVNvY2tldDo6cmVhZCAoY2hhciAqdWJ1ZiwgaW50IHVsZW4KICAgICB7
CiAgICAgICBuID0gcmVjdiAocywgdWJ1ZiwgdWxlbiwgMCk7CiAgICAgICBp
ZiAobiA8IDApCi0gICAgICAgIGludmFsaWRhdGUoKTsKKwlpbnZhbGlkYXRl
ICgpOwogICAgICAgaWYgKG4gPD0gMCkKLSAgICAgICAgcmV0dXJuIHJ2ID4g
MCA/IHJ2IDogbjsKKwlyZXR1cm4gcnYgPiAwID8gcnYgOiBuOwogICAgICAg
dWJ1ZiArPSBuOwogICAgICAgdWxlbiAtPSBuOwogICAgICAgcnYgKz0gbjsK
SW5kZXg6IHNpbXBzb2NrLmgKPT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQpSQ1Mg
ZmlsZTogL2N2cy9zcmMvc3JjL3dpbnN1cC9jaW5zdGFsbC9zaW1wc29jay5o
LHYKcmV0cmlldmluZyByZXZpc2lvbiAyLjMKZGlmZiAtdSAtcCAtcjIuMyBz
aW1wc29jay5oCi0tLSBzaW1wc29jay5oCTIwMDEvMTEvMDkgMTM6MDM6MDIJ
Mi4zCisrKyBzaW1wc29jay5oCTIwMDEvMTEvMTEgMDY6NTQ6NTgKQEAgLTE1
LDcgKzE1LDggQEAKIAogLyogU2ltcGxpZmllZCBzb2NrZXQgYWNjZXNzIGZ1
bmN0aW9ucyAqLwogCi1jbGFzcyBTaW1wbGVTb2NrZXQgeworY2xhc3MgU2lt
cGxlU29ja2V0Cit7CiAKICAgU09DS0VUIHM7CiAgIGNoYXIgKmJ1ZjsKQEAg
LTIzLDkgKzI0LDkgQEAgY2xhc3MgU2ltcGxlU29ja2V0IHsKICAgaW50IGZp
bGwgKCk7CiAgIHZvaWQgaW52YWxpZGF0ZSAodm9pZCk7CiAKLSBwdWJsaWM6
Ci0gIFNpbXBsZVNvY2tldCAoY29uc3QgY2hhciAqaG9zdG5hbWUsIGludCBw
b3J0KTsKLSAgflNpbXBsZVNvY2tldCAoKTsKK3B1YmxpYzoKKyAgICBTaW1w
bGVTb2NrZXQgKGNvbnN0IGNoYXIgKmhvc3RuYW1lLCBpbnQgcG9ydCk7Cisg
ICB+U2ltcGxlU29ja2V0ICgpOwogCiAgIGludCBvayAoKTsKIApAQCAtMzMs
NSArMzQsNSBAQCBjbGFzcyBTaW1wbGVTb2NrZXQgewogICBpbnQgd3JpdGUg
KGNvbnN0IGNoYXIgKmJ1ZiwgaW50IGxlbik7CiAKICAgY2hhciAqZ2V0cyAo
KTsKLSAgaW50CXJlYWQgKGNoYXIgKmJ1ZiwgaW50IGxlbik7CisgIGludCBy
ZWFkIChjaGFyICpidWYsIGludCBsZW4pOwogfTsKSW5kZXg6IHNpdGUuY2MK
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PQpSQ1MgZmlsZTogL2N2cy9zcmMvc3Jj
L3dpbnN1cC9jaW5zdGFsbC9zaXRlLmNjLHYKcmV0cmlldmluZyByZXZpc2lv
biAyLjcKZGlmZiAtdSAtcCAtcjIuNyBzaXRlLmNjCi0tLSBzaXRlLmNjCTIw
MDEvMDUvMjcgMDc6MDU6MDkJMi43CisrKyBzaXRlLmNjCTIwMDEvMTEvMTEg
MDY6NTQ6NTgKQEAgLTE2LDcgKzE2LDEwIEBACiAvKiBUaGUgcHVycG9zZSBv
ZiB0aGlzIGZpbGUgaXMgdG8gZ2V0IHRoZSBsaXN0IG9mIG1pcnJvciBzaXRl
cyBhbmQgYXNrCiAgICB0aGUgdXNlciB3aGljaCBtaXJyb3Igc2l0ZSB0aGV5
IHdhbnQgdG8gZG93bmxvYWQgZnJvbS4gKi8KIAotc3RhdGljIGNoYXIgKmN2
c2lkID0gIlxuJSUlICRJZDogc2l0ZS5jYyx2IDIuNyAyMDAxLzA1LzI3IDA3
OjA1OjA5IGNnZiBFeHAgJFxuIjsKKyNpZiAwCitzdGF0aWMgY29uc3QgY2hh
ciAqY3ZzaWQgPQorICAiXG4lJSUgJElkOiBzaXRlLmNjLHYgMi43IDIwMDEv
MDUvMjcgMDc6MDU6MDkgY2dmIEV4cCAkXG4iOworI2VuZGlmCiAKICNpbmNs
dWRlICJ3aW4zMi5oIgogI2luY2x1ZGUgPHN0ZGlvLmg+CkBAIC0yOSwxOSAr
MzIsMjEgQEAgc3RhdGljIGNoYXIgKmN2c2lkID0gIlxuJSUlICRJZDogc2l0
ZS5jYwogI2luY2x1ZGUgImdldHVybC5oIgogI2luY2x1ZGUgIm1zZy5oIgog
I2luY2x1ZGUgImNvbmNhdC5oIgotI2luY2x1ZGUgIm1vdW50LmgiCiAjaW5j
bHVkZSAibG9nLmgiCisjaW5jbHVkZSAiaW9fc3RyZWFtLmgiCiAKICNpbmNs
dWRlICJwb3J0LmgiCiAKICNkZWZpbmUgTk9fSURYICgtMSkKICNkZWZpbmUg
T1RIRVJfSURYICgtMikKIAotdHlwZWRlZiBzdHJ1Y3QgewordHlwZWRlZiBz
dHJ1Y3QKK3sKICAgY2hhciAqdXJsOwogICBjaGFyICpkaXNwbGF5ZWRfdXJs
OwogICBjaGFyICpzb3J0X2tleTsKLX0gc2l0ZV9saXN0X3R5cGU7Cit9Citz
aXRlX2xpc3RfdHlwZTsKIAogc3RhdGljIHNpdGVfbGlzdF90eXBlICpzaXRl
X2xpc3QgPSAwOwogc3RhdGljIGludCBsaXN0X2lkeCA9IE5PX0lEWDsKQEAg
LTgyLDMxICs4NywyMSBAQCBzYXZlX2RpYWxvZyAoSFdORCBoKQogICAgIH0K
IH0KIAotc3RhdGljIHZvaWQKLWdldF9yb290X2Rpcl9ub3cgKCkKLXsKLSAg
aW50IGlzdGV4dDsKLSAgaW50IGlzc3lzdGVtOwotICBpZiAoZ2V0X3Jvb3Rf
ZGlyICgpKQotICAgIHJldHVybjsKLSAgcmVhZF9tb3VudHMgKCk7Ci19Ci0K
IHZvaWQKIHNhdmVfc2l0ZV91cmwgKCkKIHsKLSAgaWYgKCEgTUlSUk9SX1NJ
VEUpCi0gICAgcmV0dXJuOwotCi0gIGdldF9yb290X2Rpcl9ub3cgKCk7Ci0g
IGlmICghZ2V0X3Jvb3RfZGlyICgpKQorICBpZiAoIU1JUlJPUl9TSVRFKQog
ICAgIHJldHVybjsKIAotICBGSUxFICpmID0gZm9wZW4gKGN5Z3BhdGggKCIv
ZXRjL3NldHVwL2xhc3QtbWlycm9yIiwgMCksICJ3YiIpOwotICBpZiAoIWYp
Ci0gICAgcmV0dXJuOwotICBmcHJpbnRmIChmLCAiJXNcbiIsIE1JUlJPUl9T
SVRFKTsKLSAgZmNsb3NlIChmKTsKKyAgaW9fc3RyZWFtICpmID0gaW9fc3Ry
ZWFtOjpvcGVuICgiY3lnZmlsZTovLy9ldGMvc2V0dXAvbGFzdC1taXJyb3Ii
LCAid2IiKTsKKyAgaWYgKGYpCisgICAgeworICAgICAgY2hhciB0ZW1wW19N
QVhfUEFUSF07CisgICAgICAvKiBUT0RPOiBwb3RlbnRpYWwgYnVmZmVyIG92
ZXJmbG93LiB3ZSBuZWVkIHNucHJpbnRmIGFzYXAuICovCisgICAgICBzcHJp
bnRmICh0ZW1wLCAiJXNcbiIsIE1JUlJPUl9TSVRFKTsKKyAgICAgIGYtPndy
aXRlICh0ZW1wLCBzdHJsZW4gKHRlbXApKTsKKyAgICAgIGRlbGV0ZSBmOwor
ICAgIH0KIH0KIAogc3RhdGljIEJPT0wKQEAgLTE0MSw2ICsxMzYsNyBAQCBk
aWFsb2dfY21kIChIV05EIGgsIGludCBpZCwgSFdORCBod25kY3RsCiAgICAg
ICBORVhUICgwKTsKICAgICAgIGJyZWFrOwogICAgIH0KKyAgcmV0dXJuIDA7
CiB9CiAKIHN0YXRpYyBCT09MIENBTExCQUNLCkBAIC0xNTIsMTIgKzE0OCwx
NCBAQCBkaWFsb2dfcHJvYyAoSFdORCBoLCBVSU5UIG1lc3NhZ2UsIFdQQVJB
CiAgICAgewogICAgIGNhc2UgV01fSU5JVERJQUxPRzoKICAgICAgIGxpc3Ri
b3ggPSBHZXREbGdJdGVtIChoLCBJRENfVVJMX0xJU1QpOwotICAgICAgZm9y
IChpPTA7IHNpdGVfbGlzdFtpXS51cmw7IGkrKykKKyAgICAgIGZvciAoaSA9
IDA7IHNpdGVfbGlzdFtpXS51cmw7IGkrKykKIAl7Ci0JICBqID0gU2VuZE1l
c3NhZ2UgKGxpc3Rib3gsIExCX0FERFNUUklORywgMCwgKExQQVJBTSlzaXRl
X2xpc3RbaV0uZGlzcGxheWVkX3VybCk7CisJICBqID0KKwkgICAgU2VuZE1l
c3NhZ2UgKGxpc3Rib3gsIExCX0FERFNUUklORywgMCwKKwkJCSAoTFBBUkFN
KSBzaXRlX2xpc3RbaV0uZGlzcGxheWVkX3VybCk7CiAJICBTZW5kTWVzc2Fn
ZSAobGlzdGJveCwgTEJfU0VUSVRFTURBVEEsIGosIGkpOwogCX0KLSAgICAg
IGogPSBTZW5kTWVzc2FnZSAobGlzdGJveCwgTEJfQUREU1RSSU5HLCAwLCAo
TFBBUkFNKSJPdGhlciBVUkwiKTsKKyAgICAgIGogPSBTZW5kTWVzc2FnZSAo
bGlzdGJveCwgTEJfQUREU1RSSU5HLCAwLCAoTFBBUkFNKSAiT3RoZXIgVVJM
Iik7CiAgICAgICBTZW5kTWVzc2FnZSAobGlzdGJveCwgTEJfU0VUSVRFTURB
VEEsIGosIE9USEVSX0lEWCk7CiAgICAgICBsb2FkX2RpYWxvZyAoaCk7CiAg
ICAgICByZXR1cm4gRkFMU0U7CkBAIC0xNzAsOCArMTY4LDggQEAgZGlhbG9n
X3Byb2MgKEhXTkQgaCwgVUlOVCBtZXNzYWdlLCBXUEFSQQogc3RhdGljIGlu
dAogc2l0ZV9zb3J0IChjb25zdCB2b2lkICp2YSwgY29uc3Qgdm9pZCAqdmIp
CiB7Ci0gIHNpdGVfbGlzdF90eXBlICphID0gKHNpdGVfbGlzdF90eXBlICop
dmE7Ci0gIHNpdGVfbGlzdF90eXBlICpiID0gKHNpdGVfbGlzdF90eXBlICop
dmI7CisgIHNpdGVfbGlzdF90eXBlICphID0gKHNpdGVfbGlzdF90eXBlICop
IHZhOworICBzaXRlX2xpc3RfdHlwZSAqYiA9IChzaXRlX2xpc3RfdHlwZSAq
KSB2YjsKICAgcmV0dXJuIHN0cmNtcCAoYS0+c29ydF9rZXksIGItPnNvcnRf
a2V5KTsKIH0KIApAQCAtMTkwLDEwICsxODgsMTAgQEAgZ2V0X3NpdGVfbGlz
dCAoSElOU1RBTkNFIGgpCiAKIAogICAvKiBudWxsIHBsdXMgYWNjb3VudCBm
b3IgcG9zc2libHkgbWlzc2luZyBOTCBwbHVzIGFjY291bnQgZm9yICJPdGhl
cgotICAgIFVSTCIgZnJvbSBwcmV2aW91cyBydW4uICovCisgICAgIFVSTCIg
ZnJvbSBwcmV2aW91cyBydW4uICovCiAgIGludCBubWlycm9ycyA9IDM7CiAK
LSAgZm9yIChib2w9bWlycm9yczsgKmJvbDsgYm9sKyspCisgIGZvciAoYm9s
ID0gbWlycm9yczsgKmJvbDsgYm9sKyspCiAgICAgaWYgKCpib2wgPT0gJ1xu
JykKICAgICAgIG5taXJyb3JzKys7CiAKQEAgLTIwNCw5ICsyMDIsOSBAQCBn
ZXRfc2l0ZV9saXN0IChISU5TVEFOQ0UgaCkKICAgd2hpbGUgKCpubCkKICAg
ICB7CiAgICAgICBib2wgPSBubDsKLSAgICAgIGZvciAoZW9sID0gYm9sOyAq
ZW9sICYmICplb2wgIT0gJ1xuJzsgZW9sKyspIDsKKyAgICAgIGZvciAoZW9s
ID0gYm9sOyAqZW9sICYmICplb2wgIT0gJ1xuJzsgZW9sKyspOwogICAgICAg
aWYgKCplb2wpCi0JbmwgPSBlb2wrMTsKKwlubCA9IGVvbCArIDE7CiAgICAg
ICBlbHNlCiAJbmwgPSBlb2w7CiAgICAgICB3aGlsZSAoZW9sID4gYm9sICYm
IGVvbFstMV0gPT0gJ1xyJykKQEAgLTIyNiw3ICsyMjQsOCBAQCBnZXRfc2l0
ZV9saXN0IChISU5TVEFOQ0UgaCkKIAkgICAgICBpZiAoZG90KQogCQkqZG90
ID0gMDsKIAkgICAgfQotCSAgc2l0ZV9saXN0W25taXJyb3JzXS5zb3J0X2tl
eSA9IChjaGFyICopIG1hbGxvYyAoMipzdHJsZW4gKGJvbCkgKyAzKTsKKwkg
IHNpdGVfbGlzdFtubWlycm9yc10uc29ydF9rZXkgPQorCSAgICAoY2hhciAq
KSBtYWxsb2MgKDIgKiBzdHJsZW4gKGJvbCkgKyAzKTsKIAogCSAgZG90ID0g
c2l0ZV9saXN0W25taXJyb3JzXS5kaXNwbGF5ZWRfdXJsOwogCSAgZG90ICs9
IHN0cmxlbiAoZG90KTsKQEAgLTIzNyw4ICsyMzYsOCBAQCBnZXRfc2l0ZV9s
aXN0IChISU5TVEFOQ0UgaCkKIAkJewogCQkgIGNoYXIgKnNwOwogCQkgIGlm
IChkb3RbM10gPT0gMCkKLQkJICAgICpkcCsrID0gJ34nOyAvKiBzb3J0IC5j
b20vLmVkdS8ub3JnIHRvZ2V0aGVyICovCi0JCSAgZm9yIChzcD1kb3QrMTsg
KnNwICYmICpzcCAhPSAnLicgJiYgKnNwICE9ICcvJzspCisJCSAgICAqZHAr
KyA9ICd+JzsJLyogc29ydCAuY29tLy5lZHUvLm9yZyB0b2dldGhlciAqLwor
CQkgIGZvciAoc3AgPSBkb3QgKyAxOyAqc3AgJiYgKnNwICE9ICcuJyAmJiAq
c3AgIT0gJy8nOykKIAkJICAgICpkcCsrID0gKnNwKys7CiAJCSAgKmRwKysg
PSAnICc7CiAJCX0KQEAgLTI2OSwxOSArMjY4LDE0IEBAIGdldF9zaXRlX2xp
c3QgKEhJTlNUQU5DRSBoKQogc3RhdGljIHZvaWQKIGdldF9pbml0aWFsX2xp
c3RfaWR4ICgpCiB7Ci0gIGdldF9yb290X2Rpcl9ub3cgKCk7Ci0gIGlmICgh
Z2V0X3Jvb3RfZGlyICgpKQotICAgIHJldHVybjsKLQotICBGSUxFICpmID0g
Zm9wZW4gKGN5Z3BhdGggKCIvZXRjL3NldHVwL2xhc3QtbWlycm9yIiwgMCks
ICJydCIpOworICBpb19zdHJlYW0gKmYgPSBpb19zdHJlYW06Om9wZW4gKCJj
eWdmaWxlOi8vL2V0Yy9zZXR1cC9sYXN0LW1pcnJvciIsICJydCIpOwogICBp
ZiAoIWYpCiAgICAgcmV0dXJuOwogCiAgIGNoYXIgc2l0ZVsxMDAwXTsKLSAg
c2l0ZVswXT0nXDAnOwotICBjaGFyICogZmdfcmV0ID0gZmdldHMgKHNpdGUs
IDEwMDAsIGYpOwotICBmY2xvc2UgKGYpOwotICBpZiAoISBmZ19yZXQpCisg
IGNoYXIgKmZnX3JldCA9IGYtPmdldHMgKHNpdGUsIDEwMDApOworICBkZWxl
dGUgZjsKKyAgaWYgKCFmZ19yZXQpCiAgICAgcmV0dXJuOwogCiAgIGNoYXIg
KmVvcyA9IHNpdGUgKyBzdHJsZW4gKHNpdGUpIC0gMTsKQEAgLTI5NiwxNyAr
MjkwLDE2IEBAIGdldF9pbml0aWFsX2xpc3RfaWR4ICgpCiAgICAgaWYgKHN0
cmNtcCAoc2l0ZV9saXN0W2ldLnVybCwgc2l0ZSkgPT0gMCkKICAgICAgIGJy
ZWFrOwogCi0gIGlmICghIHNpdGVfbGlzdFtpXS51cmwpCisgIGlmICghc2l0
ZV9saXN0W2ldLnVybCkKICAgICB7CiAgICAgICAvKiBEb24ndCBkZWZhdWx0
IHRvIGNlcnRhaW4gbWFjaGluZXMgZXZlciBzaW5jZSB0aGV5IHN1ZmZlcgot
CSBmcm9tIGJhbmR3aWR0aCBsaW1pdGF0aW9ucy4gKi8KKyAgICAgICAgIGZy
b20gYmFuZHdpZHRoIGxpbWl0YXRpb25zLiAqLwogICAgICAgaWYgKHN0cm5p
Y21wIChzaXRlLCBOT1NBVkUxLCBOT1NBVkUxX0xFTikgPT0gMAogCSAgfHwg
c3RybmljbXAgKHNpdGUsIE5PU0FWRTIsIE5PU0FWRTJfTEVOKSA9PSAwCiAJ
ICB8fCBzdHJuaWNtcCAoc2l0ZSwgTk9TQVZFMywgTk9TQVZFM19MRU4pID09
IDApCiAJcmV0dXJuOwotICAgICAgc2l0ZV9saXN0W2ldLmRpc3BsYXllZF91
cmwgPQotICAgICAgc2l0ZV9saXN0W2ldLnVybCA9IF9zdHJkdXAgKHNpdGUp
OwotICAgICAgc2l0ZV9saXN0W2krMV0udXJsID0gMDsKKyAgICAgIHNpdGVf
bGlzdFtpXS5kaXNwbGF5ZWRfdXJsID0gc2l0ZV9saXN0W2ldLnVybCA9IF9z
dHJkdXAgKHNpdGUpOworICAgICAgc2l0ZV9saXN0W2kgKyAxXS51cmwgPSAw
OwogICAgIH0KIAogICBtaXJyb3JfaWR4ID0gbGlzdF9pZHggPSBpOwpAQCAt
MzMzLDQgKzMyNiwzIEBAIGRvX3NpdGUgKEhJTlNUQU5DRSBoKQogICBpZiAo
bWlycm9yX2lkeCAhPSBPVEhFUl9JRFgpCiAgICAgbG9nICgwLCAic2l0ZTog
JXMiLCBtaXJyb3Jfc2l0ZSk7CiB9Ci0KSW5kZXg6IHNvdXJjZS5jYwo9PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09ClJDUyBmaWxlOiAvY3ZzL3NyYy9zcmMvd2lu
c3VwL2NpbnN0YWxsL3NvdXJjZS5jYyx2CnJldHJpZXZpbmcgcmV2aXNpb24g
Mi42CmRpZmYgLXUgLXAgLXIyLjYgc291cmNlLmNjCi0tLSBzb3VyY2UuY2MJ
MjAwMS8xMS8wNiAwMzo0MTowMAkyLjYKKysrIHNvdXJjZS5jYwkyMDAxLzEx
LzExIDA2OjU0OjU4CkBAIC0xNyw3ICsxNywxMCBAQAogICAgdXNlciBjaG9v
c2UgdGhlIHNvdXJjZSBvZiB0aGUgaW5zdGFsbCAtIGZyb20gdGhlIG5ldCwg
ZnJvbSB0aGUKICAgIGN1cnJlbnQgZGlyZWN0b3J5LCBvciB0byBqdXN0IGRv
d25sb2FkIGZpbGVzLiAqLwogCi1zdGF0aWMgY2hhciAqY3ZzaWQgPSAiXG4l
JSUgJElkOiBzb3VyY2UuY2MsdiAyLjYgMjAwMS8xMS8wNiAwMzo0MTowMCBy
YmNvbGxpbnMgRXhwICRcbiI7CisjaWYgMAorc3RhdGljIGNvbnN0IGNoYXIg
KmN2c2lkID0KKyAgIlxuJSUlICRJZDogc291cmNlLmNjLHYgMi41IDIwMDEv
MTEvMDEgMTM6MjI6NDYgcmJjb2xsaW5zIEV4cCAkXG4iOworI2VuZGlmCiAK
ICNpbmNsdWRlICJ3aW4zMi5oIgogI2luY2x1ZGUgPHN0ZGlvLmg+CkBAIC0y
NywyNSArMzAsMTggQEAgc3RhdGljIGNoYXIgKmN2c2lkID0gIlxuJSUlICRJ
ZDogc291cmNlLgogI2luY2x1ZGUgIm1zZy5oIgogI2luY2x1ZGUgImxvZy5o
IgogCi1zdGF0aWMgaW50IHJiW10gPSB7IElEQ19TT1VSQ0VfTkVUSU5TVCwg
SURDX1NPVVJDRV9ET1dOTE9BRCwgSURDX1NPVVJDRV9DV0QsIDAgfTsKK3N0
YXRpYyBpbnQgcmJbXSA9CisgIHsgSURDX1NPVVJDRV9ORVRJTlNULCBJRENf
U09VUkNFX0RPV05MT0FELCBJRENfU09VUkNFX0NXRCwgMCB9OwogCiBzdGF0
aWMgdm9pZAotY2hlY2tfaWZfZW5hYmxlX25leHQgKEhXTkQgaCkKLXsKLSAg
RW5hYmxlV2luZG93IChHZXREbGdJdGVtIChoLCBJRE9LKSwgc291cmNlID8g
MSA6IDApOwotfQotCi1zdGF0aWMgdm9pZAogbG9hZF9kaWFsb2cgKEhXTkQg
aCkKIHsKLSAgaW50IGk7CiAgIHJic2V0IChoLCByYiwgc291cmNlKTsKIH0K
IAogc3RhdGljIHZvaWQKIHNhdmVfZGlhbG9nIChIV05EIGgpCiB7Ci0gIGlu
dCBpOwogICBzb3VyY2UgPSByYmdldCAoaCwgcmIpOwogfQogCkBAIC03OCw2
ICs3NCw3IEBAIGRpYWxvZ19jbWQgKEhXTkQgaCwgaW50IGlkLCBIV05EIGh3
bmRjdGwKICAgICBkZWZhdWx0OgogICAgICAgYnJlYWs7CiAgICAgfQorICBy
ZXR1cm4gMDsKIH0KIAogc3RhdGljIEJPT0wgQ0FMTEJBQ0sKQEAgLTg4LDEx
ICs4NSwxNiBAQCBkaWFsb2dfcHJvYyAoSFdORCBoLCBVSU5UIG1lc3NhZ2Us
IFdQQVJBCiAgICAgY2FzZSBXTV9JTklURElBTE9HOgogICAgICAgbG9hZF9k
aWFsb2cgKGgpOwogICAgICAgLy8gQ2hlY2sgdG8gc2VlIGlmIGFueSByYWRp
byBidXR0b25zIGFyZSBzZWxlY3RlZC4gSWYgbm90LCBzZWxlY3QgYSBkZWZh
dWx0LgotICAgICAgaWYgKCghU2VuZE1lc3NhZ2UoR2V0RGxnSXRlbSAoaCwg
SURDX1NPVVJDRV9ET1dOTE9BRCksIEJNX0dFVENIRUNLLCAwLCAwKSA9PSBC
U1RfQ0hFQ0tFRCkKLSAgICAgICAgJiYgKCFTZW5kTWVzc2FnZShHZXREbGdJ
dGVtIChoLCBJRENfU09VUkNFX0NXRCksIEJNX0dFVENIRUNLLCAwLCAwKSA9
PSBCU1RfQ0hFQ0tFRCkpCi0gICAgICAgIHsKLSAgICAgICAgICBTZW5kTWVz
c2FnZShHZXREbGdJdGVtIChoLCBJRENfU09VUkNFX05FVElOU1QpLCBCTV9T
RVRDSEVDSywgQlNUX0NIRUNLRUQsIDApOwotICAgICAgICB9CisgICAgICBp
ZiAoCisJICAoIVNlbmRNZXNzYWdlCisJICAgKEdldERsZ0l0ZW0gKGgsIElE
Q19TT1VSQ0VfRE9XTkxPQUQpLCBCTV9HRVRDSEVDSywgMCwKKwkgICAgMCkg
PT0gQlNUX0NIRUNLRUQpCisJICAmJiAoIVNlbmRNZXNzYWdlIChHZXREbGdJ
dGVtIChoLCBJRENfU09VUkNFX0NXRCksIEJNX0dFVENIRUNLLCAwLCAwKQor
CSAgICAgID09IEJTVF9DSEVDS0VEKSkKKwl7CisJICBTZW5kTWVzc2FnZSAo
R2V0RGxnSXRlbSAoaCwgSURDX1NPVVJDRV9ORVRJTlNUKSwgQk1fU0VUQ0hF
Q0ssCisJCSAgICAgICBCU1RfQ0hFQ0tFRCwgMCk7CisJfQogICAgICAgcmV0
dXJuIEZBTFNFOwogICAgIGNhc2UgV01fQ09NTUFORDoKICAgICAgIHJldHVy
biBIQU5ETEVfV01fQ09NTUFORCAoaCwgd1BhcmFtLCBsUGFyYW0sIGRpYWxv
Z19jbWQpOwpAQCAtMTA0LDcgKzEwNiw3IEBAIHZvaWQKIGRvX3NvdXJjZSAo
SElOU1RBTkNFIGgpCiB7CiAgIGludCBydiA9IDA7Ci0gIC8qIHNvdXJjZSA9
IElEQ19TT1VSQ0VfQ1dEOyovCisgIC8qIHNvdXJjZSA9IElEQ19TT1VSQ0Vf
Q1dEOyAqLwogICBzb3VyY2UgPSBJRENfU09VUkNFX05FVElOU1Q7CiAgIHJ2
ID0gRGlhbG9nQm94IChoLCBNQUtFSU5UUkVTT1VSQ0UgKElERF9TT1VSQ0Up
LCAwLCBkaWFsb2dfcHJvYyk7CiAgIGlmIChydiA9PSAtMSkKQEAgLTExNCw0
ICsxMTYsMyBAQCBkb19zb3VyY2UgKEhJTlNUQU5DRSBoKQogICAgICAgIChz
b3VyY2UgPT0gSURDX1NPVVJDRV9ET1dOTE9BRCkgPyAiZG93bmxvYWQiIDoK
ICAgICAgICAoc291cmNlID09IElEQ19TT1VSQ0VfTkVUSU5TVCkgPyAibmV0
d29yayBpbnN0YWxsIiA6ICJmcm9tIGN3ZCIpOwogfQotCkluZGV4OiBzcGxh
c2guY2MKPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PQpSQ1MgZmlsZTogL2N2cy9z
cmMvc3JjL3dpbnN1cC9jaW5zdGFsbC9zcGxhc2guY2MsdgpyZXRyaWV2aW5n
IHJldmlzaW9uIDIuNQpkaWZmIC11IC1wIC1yMi41IHNwbGFzaC5jYwotLS0g
c3BsYXNoLmNjCTIwMDEvMTEvMDIgMDA6NTI6MDYJMi41CisrKyBzcGxhc2gu
Y2MJMjAwMS8xMS8xMSAwNjo1NDo1OApAQCAtMTYsNyArMTYsMTAgQEAKIC8q
IFRoZSBwdXJwb3NlIG9mIHRoaXMgZmlsZSBpcyB0byBkaXNwbGF5IHRoZSBw
cm9ncmFtIG5hbWUsIHZlcnNpb24sCiAgICBjb3B5cmlnaHQgbm90aWNlLCBh
bmQgcHJvamVjdCBVUkwuICovCiAKLXN0YXRpYyBjaGFyICpjdnNpZCA9ICJc
biUlJSAkSWQ6IHNwbGFzaC5jYyx2IDIuNSAyMDAxLzExLzAyIDAwOjUyOjA2
IHJiY29sbGlucyBFeHAgJFxuIjsKKyNpZiAwCitzdGF0aWMgY29uc3QgY2hh
ciAqY3ZzaWQgPQorICAiXG4lJSUgJElkOiBzcGxhc2guY2MsdiAyLjUgMjAw
MS8xMS8wMiAwMDo1MjowNiByYmNvbGxpbnMgRXhwICRcbiI7CisjZW5kaWYK
IAogI2luY2x1ZGUgIndpbjMyLmgiCiAjaW5jbHVkZSA8c3RkaW8uaD4KQEAg
LTQ5LDYgKzUyLDcgQEAgZGlhbG9nX2NtZCAoSFdORCBoLCBpbnQgaWQsIEhX
TkQgaHduZGN0bAogICAgICAgTkVYVCAoMCk7CiAgICAgICBicmVhazsKICAg
ICB9CisgIHJldHVybiAwOwogfQogCiBzdGF0aWMgQk9PTCBDQUxMQkFDSwpA
QCAtNzMsNCArNzcsMyBAQCBkb19zcGxhc2ggKEhJTlNUQU5DRSBoKQogICBp
ZiAocnYgPT0gLTEpCiAgICAgZmF0YWwgKElEU19ESUFMT0dfRkFJTEVEKTsK
IH0KLQpJbmRleDogc3RhdGUuY2MKPT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQpS
Q1MgZmlsZTogL2N2cy9zcmMvc3JjL3dpbnN1cC9jaW5zdGFsbC9zdGF0ZS5j
Yyx2CnJldHJpZXZpbmcgcmV2aXNpb24gMi4wCmRpZmYgLXUgLXAgLXIyLjAg
c3RhdGUuY2MKLS0tIHN0YXRlLmNjCTIwMDAvMDgvMDggMDA6NTk6MDgJMi4w
CisrKyBzdGF0ZS5jYwkyMDAxLzExLzExIDA2OjU0OjU4CkBAIC0xNSw3ICsx
NSwxMCBAQAogCiAvKiBBbGwgd2UgZG8gaGVyZSBpcyBpbnN0YW50aWF0ZSB0
aGUgZXh0ZXJuJ2QgdmFyaWFibGVzIGZyb20gc3RhdGUuaCAqLwogCi1zdGF0
aWMgY2hhciAqY3ZzaWQgPSAiXG4lJSUgJElkOiBzdGF0ZS5jYyx2IDIuMCAy
MDAwLzA4LzA4IDAwOjU5OjA4IGRqIEV4cCAkXG4iOworI2lmIDAKK3N0YXRp
YyBjb25zdCBjaGFyICpjdnNpZCA9CisgICJcbiUlJSAkSWQ6IHN0YXRlLmNj
LHYgMi4wIDIwMDAvMDgvMDggMDA6NTk6MDggZGogRXhwICRcbiI7CisjZW5k
aWYKIAogI2RlZmluZSBleHRlcm4KICNpbmNsdWRlICJzdGF0ZS5oIgpJbmRl
eDogc3RhdGUuaAo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09ClJDUyBmaWxlOiAv
Y3ZzL3NyYy9zcmMvd2luc3VwL2NpbnN0YWxsL3N0YXRlLmgsdgpyZXRyaWV2
aW5nIHJldmlzaW9uIDIuNApkaWZmIC11IC1wIC1yMi40IHN0YXRlLmgKLS0t
IHN0YXRlLmgJMjAwMS8wNS8yOCAwODozMTowMgkyLjQKKysrIHN0YXRlLmgJ
MjAwMS8xMS8xMSAwNjo1NDo1OApAQCAtMTgsMjkgKzE4LDI5IEBACiAgICBp
bmZvcm1hdGlvbiB0aGF0IHRoZSB1c2VyIGhhcyBwcm92aWRlZCBzbyBmYXIu
ICBUaGVzZSBhcmUgc2V0IGJ5CiAgICB0aGUgdmFyaW91cyBkaWFsb2dzIGFu
ZCB1c2VkIGJ5IHRoZSB2YXJpb3VzIGFjdGlvbnMuICovCiAKLWV4dGVybiBp
bnQJc291cmNlOworZXh0ZXJuIGludCBzb3VyY2U7CiAKLWV4dGVybiBjaGFy
ICoJbG9jYWxfZGlyOworZXh0ZXJuIGNoYXIgKmxvY2FsX2RpcjsKIAotZXh0
ZXJuIGludAlyb290X3RleHQ7Ci1leHRlcm4gaW50CXJvb3Rfc2NvcGU7Ci1l
eHRlcm4gaW50ICAgcm9vdF9tZW51OwotZXh0ZXJuIGludCAgIHJvb3RfZGVz
a3RvcDsKLQotZXh0ZXJuIGludAluZXRfbWV0aG9kOwotZXh0ZXJuIGNoYXIg
KgluZXRfcHJveHlfaG9zdDsKLWV4dGVybiBpbnQJbmV0X3Byb3h5X3BvcnQ7
Ci0KLWV4dGVybiBjaGFyICoJbmV0X3VzZXI7Ci1leHRlcm4gY2hhciAqCW5l
dF9wYXNzd2Q7Ci1leHRlcm4gY2hhciAqCW5ldF9wcm94eV91c2VyOwotZXh0
ZXJuIGNoYXIgKgluZXRfcHJveHlfcGFzc3dkOwotZXh0ZXJuIGNoYXIgKglu
ZXRfZnRwX3VzZXI7Ci1leHRlcm4gY2hhciAqCW5ldF9mdHBfcGFzc3dkOwor
ZXh0ZXJuIGludCByb290X3RleHQ7CitleHRlcm4gaW50IHJvb3Rfc2NvcGU7
CitleHRlcm4gaW50IHJvb3RfbWVudTsKK2V4dGVybiBpbnQgcm9vdF9kZXNr
dG9wOworCitleHRlcm4gaW50IG5ldF9tZXRob2Q7CitleHRlcm4gY2hhciAq
bmV0X3Byb3h5X2hvc3Q7CitleHRlcm4gaW50IG5ldF9wcm94eV9wb3J0Owor
CitleHRlcm4gY2hhciAqbmV0X3VzZXI7CitleHRlcm4gY2hhciAqbmV0X3Bh
c3N3ZDsKK2V4dGVybiBjaGFyICpuZXRfcHJveHlfdXNlcjsKK2V4dGVybiBj
aGFyICpuZXRfcHJveHlfcGFzc3dkOworZXh0ZXJuIGNoYXIgKm5ldF9mdHBf
dXNlcjsKK2V4dGVybiBjaGFyICpuZXRfZnRwX3Bhc3N3ZDsKIAotZXh0ZXJu
IGNoYXIgKgltaXJyb3Jfc2l0ZTsKLWV4dGVybiBjaGFyICoJb3RoZXJfdXJs
OworZXh0ZXJuIGNoYXIgKm1pcnJvcl9zaXRlOworZXh0ZXJuIGNoYXIgKm90
aGVyX3VybDsKIAotZXh0ZXJuIGludAl0cnVzdF9sZXZlbDsKK2V4dGVybiBp
bnQgdHJ1c3RfbGV2ZWw7CiAKICNkZWZpbmUgTUlSUk9SX1NJVEUgKG1pcnJv
cl9zaXRlID8gbWlycm9yX3NpdGUgOiBvdGhlcl91cmwpCkluZGV4OiB0YXIu
Y2MKPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PQpSQ1MgZmlsZTogL2N2cy9zcmMv
c3JjL3dpbnN1cC9jaW5zdGFsbC90YXIuY2MsdgpyZXRyaWV2aW5nIHJldmlz
aW9uIDIuNQpkaWZmIC11IC1wIC1yMi41IHRhci5jYwotLS0gdGFyLmNjCTIw
MDEvMDYvMTMgMTY6MTE6MDEJMi41CisrKyB0YXIuY2MJMjAwMS8xMS8xMSAw
Njo1NDo1OApAQCAtMTUsMjY4ICsxNSwyMjkgQEAKIAogLyogQnVpbHQtaW4g
dGFyIGZ1bmN0aW9uYWxpdHkuICBTZWUgdGFyLmggZm9yIHVzYWdlLiAqLwog
Ci1zdGF0aWMgY2hhciAqY3ZzaWQgPSAiXG4lJSUgJElkOiB0YXIuY2MsdiAy
LjUgMjAwMS8wNi8xMyAxNjoxMTowMSBjZ2YgRXhwICRcbiI7CisjaWYgMAor
c3RhdGljIGNvbnN0IGNoYXIgKmN2c2lkID0KKyAgIlxuJSUlICRJZDogdGFy
LmNjLHYgMi41IDIwMDEvMDYvMTMgMTY6MTE6MDEgY2dmIEV4cCAkXG4iOwor
I2VuZGlmCiAKICNpbmNsdWRlICJ3aW4zMi5oIgogI2luY2x1ZGUgPHN0ZGlv
Lmg+CiAjaW5jbHVkZSA8c3RkbGliLmg+CiAjaW5jbHVkZSA8c3lzL3R5cGVz
Lmg+CiAjaW5jbHVkZSA8c3lzL2ZjbnRsLmg+CisjaW5jbHVkZSA8ZXJybm8u
aD4KIAotI2luY2x1ZGUgInpsaWIvemxpYi5oIgorLy8jaW5jbHVkZSAiemxp
Yi96bGliLmgiCisjaW5jbHVkZSAiaW9fc3RyZWFtLmgiCisvLyNpbmNsdWRl
ICJjb21wcmVzcy5oIgorI2luY2x1ZGUgImFyY2hpdmUuaCIKICNpbmNsdWRl
ICJ0YXIuaCIKICNpbmNsdWRlICJta2Rpci5oIgogI2luY2x1ZGUgImxvZy5o
IgogI2luY2x1ZGUgImZpbGVtYW5pcC5oIgorI2luY2x1ZGUgImNvbmNhdC5o
IgogCiAjaW5jbHVkZSAicG9ydC5oIgorI2lmIDAKICN1bmRlZiBfV0lOMzIK
ICNpbmNsdWRlICJiemxpYi5oIgogCiAjZGVmaW5lIEZBQ1RPUiAoMHgxOWRi
MWRlZDUzZWE3MTBMTCkKICNkZWZpbmUgTlNQRVJTRUMgMTAwMDAwMDBMTAog
I2RlZmluZSBTWU1MSU5LX0NPT0tJRSAiITxzeW1saW5rPiIKLQotdHlwZWRl
ZiBzdHJ1Y3QgewotICBjaGFyIG5hbWVbMTAwXTsgICAgICAgICAgICAgICAv
KiAgIDAgKi8KLSAgY2hhciBtb2RlWzhdOyAgICAgICAgICAgICAgICAgLyog
MTAwICovCi0gIGNoYXIgdWlkWzhdOyAgICAgICAgICAgICAgICAgIC8qIDEw
OCAqLwotICBjaGFyIGdpZFs4XTsgICAgICAgICAgICAgICAgICAvKiAxMTYg
Ki8KLSAgY2hhciBzaXplWzEyXTsgICAgICAgICAgICAgICAgLyogMTI0ICov
Ci0gIGNoYXIgbXRpbWVbMTJdOyAgICAgICAgICAgICAgIC8qIDEzNiAqLwot
ICBjaGFyIGNoa3N1bVs4XTsgICAgICAgICAgICAgICAvKiAxNDggKi8KLSAg
Y2hhciB0eXBlZmxhZzsgICAgICAgICAgICAgICAgLyogMTU2ICovCi0gIGNo
YXIgbGlua25hbWVbMTAwXTsgICAgICAgICAgIC8qIDE1NyAqLwotICBjaGFy
IG1hZ2ljWzZdOyAgICAgICAgICAgICAgICAvKiAyNTcgKi8KLSAgY2hhciB2
ZXJzaW9uWzJdOyAgICAgICAgICAgICAgLyogMjYzICovCi0gIGNoYXIgdW5h
bWVbMzJdOyAgICAgICAgICAgICAgIC8qIDI2NSAqLwotICBjaGFyIGduYW1l
WzMyXTsgICAgICAgICAgICAgICAvKiAyOTcgKi8KLSAgY2hhciBkZXZtYWpv
cls4XTsgICAgICAgICAgICAgLyogMzI5ICovCi0gIGNoYXIgZGV2bWlub3Jb
OF07ICAgICAgICAgICAgIC8qIDMzNyAqLwotICBjaGFyIHByZWZpeFsxNTVd
OyAgICAgICAgICAgICAvKiAzNDUgKi8KLSAgY2hhciBqdW5rWzEyXTsJCS8q
IDUwMCAqLwotfSB0YXJfaGVhZGVyX3R5cGU7Ci0KLXR5cGVkZWYgc3RydWN0
IHRhcl9tYXBfcmVzdWx0X3R5cGVfcyB7Ci0gIHN0cnVjdCB0YXJfbWFwX3Jl
c3VsdF90eXBlX3MgKm5leHQ7Ci0gIGNoYXIgKnN0b3JlZF9uYW1lOwotICBj
aGFyICptYXBwZWRfbmFtZTsKLX0gdGFyX21hcF9yZXN1bHRfdHlwZTsKLQot
c3RhdGljIHRhcl9tYXBfcmVzdWx0X3R5cGUgKnRhcl9tYXBfcmVzdWx0ID0g
MDsKLQorI2VuZGlmCiBzdGF0aWMgaW50IGVycjsKIAotc3RhdGljIGNoYXIg
ZmlsZV9uYW1lW19NQVhfUEFUSCs1MTJdOwotc3RhdGljIGNoYXIgaGF2ZV9s
b25nbmFtZSA9IDA7Ci1zdGF0aWMgaW50ICBmaWxlX2xlbmd0aDsKKy8vc3Rh
dGljIGNoYXIgZmlsZV9uYW1lW19NQVhfUEFUSCs1MTJdOworLy9zdGF0aWMg
Y2hhciBoYXZlX2xvbmduYW1lID0gMDsKKy8vc3RhdGljIGludCAgZmlsZV9s
ZW5ndGg7CiAKLXN0YXRpYyB0YXJfaGVhZGVyX3R5cGUgdGFyX2hlYWRlcjsK
IHN0YXRpYyBjaGFyIGJ1Zls1MTJdOwogCi1zdGF0aWMgaW50IF90YXJfZmls
ZV9zaXplID0gMDsKIGludCBfdGFyX3ZlcmJvc2UgPSAwOwotRklMRSAqIF90
YXJfdmZpbGUgPSAwOworRklMRSAqX3Rhcl92ZmlsZSA9IDA7CiAjZGVmaW5l
IHZwIGlmIChfdGFyX3ZlcmJvc2UpIGZwcmludGYKICNkZWZpbmUgdnAyIGlm
IChfdGFyX3ZlcmJvc2U+MSkgZnByaW50ZgotCi1jbGFzcyBnemJ6Ci17Ci0g
cHJvdGVjdGVkOgotICB1bmlvbgotICB7Ci0gICAgZ3pGaWxlIGc7Ci0gICAg
QlpGSUxFICpiOwotICB9OwotICBpbnQgZmQ7Ci1wdWJsaWM6Ci0gIHZpcnR1
YWwgaW50IHJlYWQgKHZvaWQgKmJ1ZiwgaW50IGxlbikge307Ci0gIHZpcnR1
YWwgaW50IGNsb3NlICgpIHt9OwotICB2aXJ0dWFsIG9mZl90IHRlbGwgKCkg
e307Ci0gIG9wZXJhdG9yIGludCAoKSB7cmV0dXJuIChpbnQpIGc7fQotfTsK
LQotY2xhc3MgZ3o6IHB1YmxpYyBnemJ6Ci17Ci0gcHVibGljOgotICBneiAo
Y29uc3QgY2hhciAqcGF0aG5hbWUpCi0gIHsKLSAgICBnID0gZ3pvcGVuIChw
YXRobmFtZSwgInJiIik7Ci0gIH0KLSAgaW50IHJlYWQgKHZvaWQgKmJ1Ziwg
aW50IGxlbikKLSAgewotICAgIHJldHVybiBnenJlYWQgKGcsIGJ1ZiwgbGVu
KTsKLSAgfQotICBpbnQgY2xvc2UgKCkKLSAgewotICAgIHJldHVybiBnemNs
b3NlIChnKTsKLSAgfQotICBvZmZfdCB0ZWxsICgpIHtyZXR1cm4gZ3pjdGVs
bCAoZyk7fQotICB+Z3ogKCkge2Nsb3NlICgpO30KLX07Ci0KLWNsYXNzIGJ6
OiBwdWJsaWMgZ3piegotewotIHB1YmxpYzoKLSAgYnogKGNvbnN0IGNoYXIg
KnBhdGhuYW1lKQotICB7Ci0gICAgZmQgPSBvcGVuIChwYXRobmFtZSwgT19S
RE9OTFkgfCBPX0JJTkFSWSk7Ci0gICAgaWYgKGZkKQotICAgICAgYiA9IEJa
Ml9iemRvcGVuIChmZCwgInJiIik7Ci0gICAgZWxzZQotICAgICAgYiA9IE5V
TEw7Ci0gIH0KLSAgaW50IHJlYWQgKHZvaWQgKmJ1ZiwgaW50IGxlbikKLSAg
ewotICAgIHJldHVybiBCWjJfYnpyZWFkIChiLCBidWYsIGxlbik7Ci0gIH0K
LSAgaW50IGNsb3NlICgpCi0gIHsKLSAgICBCWjJfYnpjbG9zZSAoYik7Ci0g
ICAgcmV0dXJuIDA7Ci0gIH0KLSAgb2ZmX3QgdGVsbCAoKSB7cmV0dXJuIDo6
dGVsbCAoZmQpO30KLSAgfmJ6ICgpIHtjbG9zZSAoKTt9Ci19OwogCi1nemJ6
ICp6ID0gTlVMTDsKLQotc3RhdGljIGNoYXIgKgoteHN0cmR1cCAoY2hhciAq
YykKK2FyY2hpdmVfdGFyOjphcmNoaXZlX3RhciAoaW9fc3RyZWFtICogb3Jp
Z2luYWwpCiB7Ci0gIGNoYXIgKnIgPSAoY2hhciAqKSBtYWxsb2MgKHN0cmxl
biAoYykgKyAxKTsKLSAgaWYgKCFyKQotICAgIGV4aXRfc2V0dXAgKDEpOwot
ICBzdHJjcHkgKHIsIGMpOwotICByZXR1cm4gcjsKLX0KLQotaW50Ci10YXJf
b3BlbiAoY29uc3QgY2hhciAqcGF0aG5hbWUpCi17CisgIGFyY2hpdmVfY2hp
bGRyZW4gPSAwOwogICBpZiAoX3Rhcl92ZmlsZSA9PSAwKQogICAgIF90YXJf
dmZpbGUgPSBzdGRlcnI7CiAKLSAgdnAyIChfdGFyX3ZmaWxlLCAidGFyOiBv
cGVuIGAlcydcbiIsIHBhdGhuYW1lKTsKLSAgRFdPUkQgc2l6ZTsKLSAgaWYg
KChzaXplID0gZ2V0X2ZpbGVfc2l6ZSAocGF0aG5hbWUpKSA9PSAwKQotICAg
IHJldHVybiAxOwotICBfdGFyX2ZpbGVfc2l6ZSA9IHNpemU7Ci0KLSAgaWYg
KHN0cnN0ciAocGF0aG5hbWUsICIuYnoyIikpCi0gICAgeiA9IG5ldyBieiAo
cGF0aG5hbWUpOwotICBlbHNlCi0gICAgeiA9IG5ldyBneiAocGF0aG5hbWUp
OwotICBpZiAoc2l6ZW9mICh0YXJfaGVhZGVyKSAhPSA1MTIpCisgIHZwMiAo
X3Rhcl92ZmlsZSwgInRhcjogb3BlbiBgJXAnXG4iLCBvcmlnaW5hbCk7CisK
KyAgaWYgKCFvcmlnaW5hbCkKICAgICB7CisgICAgICBzdGF0ZS5sYXN0ZXJy
ID0gRUJBREY7CisgICAgICByZXR1cm47CisgICAgfQorICBzdGF0ZS5wYXJl
bnQgPSBvcmlnaW5hbDsKKworICBpZiAoc2l6ZW9mIChzdGF0ZS50YXJfaGVh
ZGVyKSAhPSA1MTIpCisgICAgewogICAgICAgLyogZHJhc3RpYywgYnV0IGlt
cG9ydGFudCAqLwogICAgICAgZnByaW50ZiAoc3RkZXJyLCAiY29tcGlsYXRp
b24gZXJyb3I6IHRhciBoZWFkZXIgc3RydWN0IG5vdCA1MTIiCi0JICAgICAg
ICIgYnl0ZXMgKGl0J3MgJWQpXG4iLCBzaXplb2YgKHRhcl9oZWFkZXIpKTsK
KwkgICAgICAgIiBieXRlcyAoaXQncyAlZClcbiIsIHNpemVvZiAoc3RhdGUu
dGFyX2hlYWRlcikpOwogICAgICAgZXhpdF9zZXR1cCAoMSk7CiAgICAgfQot
ICBlcnIgPSAwOwotICByZXR1cm4gKnogPyAwIDogMTsKIH0KIAorc3NpemVf
dAorYXJjaGl2ZV90YXI6OnJlYWQgKHZvaWQgKmJ1ZmZlciwgc2l6ZV90IGxl
bikKK3sKKyAgcmV0dXJuIC0xOworfQorCitzc2l6ZV90CithcmNoaXZlX3Rh
cjo6d3JpdGUgKHZvaWQgKmJ1ZmZlciwgc2l6ZV90IGxlbikKK3sKKyAgcmV0
dXJuIDA7Cit9CisKK3NzaXplX3QKK2FyY2hpdmVfdGFyOjpwZWVrICh2b2lk
ICpidWZmZXIsIHNpemVfdCBsZW4pCit7CisgIHJldHVybiAwOworfQorCiBp
bnQKLXRhcl9mdGVsbCAoKQorYXJjaGl2ZV90YXI6OmVycm9yICgpCiB7Ci0g
IHJldHVybiB6LT50ZWxsICgpOworICByZXR1cm4gc3RhdGUubGFzdGVycjsK
IH0KIAotc3RhdGljIHZvaWQKLXNraXBfZmlsZSAoKQorbG9uZworYXJjaGl2
ZV90YXI6OnRlbGwgKCkKIHsKLSAgd2hpbGUgKGZpbGVfbGVuZ3RoID4gMCkK
KyAgcmV0dXJuIHN0YXRlLmZpbGVfb2Zmc2V0OworfQorCitpbnQKK2FyY2hp
dmVfdGFyOjpza2lwX2ZpbGUgKCkKK3sKKyAgd2hpbGUgKHN0YXRlLmZpbGVf
bGVuZ3RoID4gc3RhdGUuZmlsZV9vZmZzZXQpCiAgICAgewotICAgICAgei0+
cmVhZCAoYnVmLCA1MTIpOwotICAgICAgZmlsZV9sZW5ndGggLT0gNTEyOwor
ICAgICAgaW50IGxlbiA9IHN0YXRlLnBhcmVudC0+cmVhZCAoYnVmLCA1MTIp
OworICAgICAgc3RhdGUuZmlsZV9vZmZzZXQgKz0gNTEyOworICAgICAgaWYg
KGxlbiAhPSA1MTIpCisJcmV0dXJuIDE7CiAgICAgfQorICBzdGF0ZS5maWxl
X2xlbmd0aCA9IDA7CisgIHN0YXRlLmZpbGVfb2Zmc2V0ID0gMDsKKyAgc3Rh
dGUuaGVhZGVyX3JlYWQgPSAwOworICByZXR1cm4gMDsKIH0KIAotY2hhciAq
Ci10YXJfbmV4dF9maWxlICgpCitjb25zdCBjaGFyICoKK2FyY2hpdmVfdGFy
OjpuZXh0X2ZpbGVfbmFtZSAoKQogewotICBpbnQgciwgbjsKICAgY2hhciAq
YzsKLSAgciA9IHotPnJlYWQgKCZ0YXJfaGVhZGVyLCA1MTIpOwogCisgIGlm
IChzdGF0ZS5oZWFkZXJfcmVhZCkKKyAgICBpZiAoc3RybGVuIChzdGF0ZS5m
aWxlbmFtZSkpCisgICAgICByZXR1cm4gc3RhdGUuZmlsZW5hbWU7CisgICAg
ZWxzZQorICAgICAgLyogRW5kIG9mIHRhciAqLworICAgICAgcmV0dXJuIE5V
TEw7CisKKyAgaW50IHIgPSBzdGF0ZS5wYXJlbnQtPnJlYWQgKCZzdGF0ZS50
YXJfaGVhZGVyLCA1MTIpOworCiAgIC8qIFNlZSBpZiB3ZSdyZSBhdCBlbmQg
b2YgZmlsZSAqLwogICBpZiAociAhPSA1MTIpCi0gICAgcmV0dXJuIDA7Cisg
ICAgcmV0dXJuIE5VTEw7CiAKICAgLyogU2VlIGlmIHRoZSBoZWFkZXIgaXMg
YWxsIHplcm9zIChpLmUuIGxhc3QgYmxvY2spICovCi0gIG4gPSAwOwotICBm
b3IgKHIgPSA1MTIvc2l6ZW9mIChpbnQpOyByOyByLS0pCi0gICAgbiB8PSAo
KGludCAqKSZ0YXJfaGVhZGVyKVtyLTFdOworICBpbnQgbiA9IDA7CisgIGZv
ciAociA9IDUxMiAvIHNpemVvZiAoaW50KTsgcjsgci0tKQorICAgIG4gfD0g
KChpbnQgKikgJnN0YXRlLnRhcl9oZWFkZXIpW3IgLSAxXTsKICAgaWYgKG4g
PT0gMCkKLSAgICByZXR1cm4gMDsKKyAgICByZXR1cm4gTlVMTDsKIAotICBp
ZiAoIWhhdmVfbG9uZ25hbWUgJiYgdGFyX2hlYWRlci50eXBlZmxhZyAhPSAn
TCcpCisgIGlmICghc3RhdGUuaGF2ZV9sb25nbmFtZSAmJiBzdGF0ZS50YXJf
aGVhZGVyLnR5cGVmbGFnICE9ICdMJykKICAgICB7Ci0gICAgICBtZW1jcHkg
KGZpbGVfbmFtZSwgdGFyX2hlYWRlci5uYW1lLCAxMDApOwotICAgICAgZmls
ZV9uYW1lWzEwMF0gPSAwOworICAgICAgbWVtY3B5IChzdGF0ZS5maWxlbmFt
ZSwgc3RhdGUudGFyX2hlYWRlci5uYW1lLCAxMDApOworICAgICAgc3RhdGUu
ZmlsZW5hbWVbMTAwXSA9IDA7CiAgICAgfQogCi0gIHNzY2FuZiAodGFyX2hl
YWRlci5zaXplLCAiJW8iLCAmZmlsZV9sZW5ndGgpOworICBzc2NhbmYgKHN0
YXRlLnRhcl9oZWFkZXIuc2l6ZSwgIiVvIiwgJnN0YXRlLmZpbGVfbGVuZ3Ro
KTsKKyAgc3RhdGUuZmlsZV9vZmZzZXQgPSAwOwogCi0gIHZwMiAoX3Rhcl92
ZmlsZSwgIiVjICU5ZCAlc1xuIiwgdGFyX2hlYWRlci50eXBlZmxhZywgZmls
ZV9sZW5ndGgsIGZpbGVfbmFtZSk7CisvLyAgdnAyIChfdGFyX3ZmaWxlLCAi
JWMgJTlkICVzXG4iLCBzdGF0ZS50YXJfaGVhZGVyLnR5cGVmbGFnLAorLy8g
ICAgICBzdGF0ZS5maWxlX2xlbmd0aCwgc3RhdGUuZmlsZW5hbWUpOwogCi0g
IHN3aXRjaCAodGFyX2hlYWRlci50eXBlZmxhZykKKyAgc3dpdGNoIChzdGF0
ZS50YXJfaGVhZGVyLnR5cGVmbGFnKQogICAgIHsKLSAgICBjYXNlICdMJzog
LyogR05VIHRhciBsb25nIG5hbWUgZXh0ZW5zaW9uICovCi0gICAgICBpZiAo
ZmlsZV9sZW5ndGggPiBfTUFYX1BBVEgpCisgICAgY2FzZSAnTCc6CQkJLyog
R05VIHRhciBsb25nIG5hbWUgZXh0ZW5zaW9uICovCisgICAgICAvKiB3ZSBy
ZWFkIHRoZSAnZmlsZScgaW50byB0aGUgbG9uZyBmaWxlbmFtZSwgdGhlbiBj
YWxsIGJhY2sgaW50byBoZXJlCisgICAgICAgKiB0byBmaW5kIG91dCBpZiB0
aGUgYWN0dWFsIGZpbGUgaXMgYSByZWFsIGZpbGUsIG9yIGEgc3BlY2lhbCBm
aWxlLi4KKyAgICAgICAqLworICAgICAgaWYgKHN0YXRlLmZpbGVfbGVuZ3Ro
ID4gX01BWF9QQVRIKQogCXsKIAkgIHNraXBfZmlsZSAoKTsKIAkgIGZwcmlu
dGYgKHN0ZGVyciwgImVycm9yOiBsb25nIGZpbGUgbmFtZSBleGNlZWRzICVk
IGNoYXJhY3RlcnNcbiIsCiAJCSAgIF9NQVhfUEFUSCk7CiAJICBlcnIrKzsK
LQkgIHotPnJlYWQgKCZ0YXJfaGVhZGVyLCA1MTIpOwotCSAgc3NjYW5mICh0
YXJfaGVhZGVyLnNpemUsICIlbyIsICZmaWxlX2xlbmd0aCk7CisJICBzdGF0
ZS5wYXJlbnQtPnJlYWQgKCZzdGF0ZS50YXJfaGVhZGVyLCA1MTIpOworCSAg
c3NjYW5mIChzdGF0ZS50YXJfaGVhZGVyLnNpemUsICIlbyIsICZzdGF0ZS5m
aWxlX2xlbmd0aCk7CisJICBzdGF0ZS5maWxlX29mZnNldCA9IDA7CiAJICBz
a2lwX2ZpbGUgKCk7Ci0JICByZXR1cm4gdGFyX25leHRfZmlsZSAoKTsKKwkg
IHJldHVybiBuZXh0X2ZpbGVfbmFtZSAoKTsKIAl9Ci0gICAgICBjID0gZmls
ZV9uYW1lOwotICAgICAgd2hpbGUgKGZpbGVfbGVuZ3RoID4gMCkKKyAgICAg
IGMgPSBzdGF0ZS5maWxlbmFtZTsKKyAgICAgIC8qIEZJWE1FOiB0aGlzIHNo
b3VsZCBiZSBhIHNpbmdsZSByZWFkKCkgY2FsbCAqLworICAgICAgd2hpbGUg
KHN0YXRlLmZpbGVfbGVuZ3RoID4gc3RhdGUuZmlsZV9vZmZzZXQpCiAJewot
CSAgaW50IG5lZWQgPSBmaWxlX2xlbmd0aCA+IDUxMiA/IDUxMiA6IGZpbGVf
bGVuZ3RoOwotCSAgaWYgKHotPnJlYWQgKGJ1ZiwgNTEyKSA8IDUxMikKKwkg
IGludCBuZWVkID0KKwkgICAgc3RhdGUuZmlsZV9sZW5ndGggLSBzdGF0ZS5m
aWxlX29mZnNldCA+CisJICAgIDUxMiA/IDUxMiA6IHN0YXRlLmZpbGVfbGVu
Z3RoIC0gc3RhdGUuZmlsZV9vZmZzZXQ7CisJICBpZiAoc3RhdGUucGFyZW50
LT5yZWFkIChidWYsIDUxMikgPCA1MTIpCiAJICAgIHJldHVybiAwOwogCSAg
bWVtY3B5IChjLCBidWYsIG5lZWQpOwogCSAgYyArPSBuZWVkOwotCSAgZmls
ZV9sZW5ndGggLT0gbmVlZDsKKwkgIHN0YXRlLmZpbGVfb2Zmc2V0ICs9IG5l
ZWQ7CiAJfQogICAgICAgKmMgPSAwOwotICAgICAgaGF2ZV9sb25nbmFtZSA9
IDE7Ci0gICAgICByZXR1cm4gdGFyX25leHRfZmlsZSAoKTsKKyAgICAgIHN0
YXRlLmhhdmVfbG9uZ25hbWUgPSAxOworICAgICAgcmV0dXJuIG5leHRfZmls
ZV9uYW1lICgpOwogCi0gICAgY2FzZSAnMyc6IC8qIGNoYXIgKi8KLSAgICBj
YXNlICc0JzogLyogYmxvY2sgKi8KLSAgICBjYXNlICc2JzogLyogZmlmbyAq
LworICAgIGNhc2UgJzMnOgkJCS8qIGNoYXIgKi8KKyAgICBjYXNlICc0JzoJ
CQkvKiBibG9jayAqLworICAgIGNhc2UgJzYnOgkJCS8qIGZpZm8gKi8KICAg
ICAgIGZwcmludGYgKHN0ZGVyciwgIndhcm5pbmc6IG5vdCBleHRyYWN0aW5n
IHNwZWNpYWwgZmlsZSAlc1xuIiwKLQkgICAgICAgZmlsZV9uYW1lKTsKKwkg
ICAgICAgc3RhdGUuZmlsZW5hbWUpOwogICAgICAgZXJyKys7Ci0gICAgICBy
ZXR1cm4gdGFyX25leHRfZmlsZSAoKTsKKyAgICAgIHJldHVybiBuZXh0X2Zp
bGVfbmFtZSAoKTsKIAotICAgIGNhc2UgJzAnOiAvKiByZWd1bGFyIGZpbGUg
Ki8KLSAgICBjYXNlIDA6IC8qIHJlZ3VsYXIgZmlsZSBhbHNvICovCi0gICAg
Y2FzZSAnMic6IC8qIHN5bWJvbGljIGxpbmsgKi8KLSAgICBjYXNlICc1Jzog
LyogZGlyZWN0b3J5ICovCi0gICAgY2FzZSAnNyc6IC8qIGNvbnRpZ3VvdXMg
ZmlsZSAqLwotICAgICAgcmV0dXJuIGZpbGVfbmFtZTsKKyAgICBjYXNlICcw
JzoJCQkvKiByZWd1bGFyIGZpbGUgKi8KKyAgICBjYXNlIDA6CQkJLyogcmVn
dWxhciBmaWxlIGFsc28gKi8KKyAgICBjYXNlICcyJzoJCQkvKiBzeW1ib2xp
YyBsaW5rICovCisgICAgY2FzZSAnNSc6CQkJLyogZGlyZWN0b3J5ICovCisg
ICAgY2FzZSAnNyc6CQkJLyogY29udGlndW91cyBmaWxlICovCisgICAgICBz
dGF0ZS5oZWFkZXJfcmVhZCA9IDE7CisgICAgICByZXR1cm4gc3RhdGUuZmls
ZW5hbWU7CisKKyAgICBjYXNlICcxJzoJCQkvKiBoYXJkIGxpbmssIHdlIGp1
c3QgY29weSAqLworICAgICAgc3RhdGUuaGVhZGVyX3JlYWQgPSAxOworICAg
ICAgcmV0dXJuIHN0YXRlLmZpbGVuYW1lOwogCi0gICAgY2FzZSAnMSc6IC8q
IGhhcmQgbGluaywgd2UganVzdCBjb3B5ICovCi0gICAgICByZXR1cm4gZmls
ZV9uYW1lOwotCiAgICAgZGVmYXVsdDoKICAgICAgIGZwcmludGYgKHN0ZGVy
ciwgImVycm9yOiB1bmtub3duIChvciB1bnN1cHBvcnRlZCkgZmlsZSB0eXBl
IGAlYydcbiIsCi0JICAgICAgIHRhcl9oZWFkZXIudHlwZWZsYWcpOworCSAg
ICAgICBzdGF0ZS50YXJfaGVhZGVyLnR5cGVmbGFnKTsKICAgICAgIGVycisr
OwogICAgICAgc2tpcF9maWxlICgpOwotICAgICAgcmV0dXJuIHRhcl9uZXh0
X2ZpbGUgKCk7CisgICAgICByZXR1cm4gbmV4dF9maWxlX25hbWUgKCk7CiAg
ICAgfQorICByZXR1cm4gTlVMTDsKK30KKworYXJjaGl2ZV90YXI6On5hcmNo
aXZlX3RhciAoKQoreworICBpZiAoc3RhdGUucGFyZW50KQorICAgIGRlbGV0
ZSBzdGF0ZS5wYXJlbnQ7CiB9CiAKKyMgaWYgMAogc3RhdGljIHZvaWQKIGZp
eF90aW1lX3N0YW1wIChjaGFyICpwYXRoKQogewpAQCAtMjk4LDMyICsyNTks
OCBAQCBmaXhfdGltZV9zdGFtcCAoY2hhciAqcGF0aCkKICAgICAgIENsb3Nl
SGFuZGxlIChoKTsKICAgICB9CiB9Ci0KLXN0YXRpYyBGSUxFICoKLWNvbW1v
bl9mb3BlbiAoY2hhciAqcGF0aCkKLXsKLSAgRklMRSAqb3V0OwotICBvdXQg
PSBmb3BlbiAocGF0aCwgIndiIik7Ci0gIGlmICghb3V0KQotICAgIHsKLSAg
ICAgIC8qIG1heWJlIHdlIG5lZWQgdG8gY3JlYXRlIGEgZGlyZWN0b3J5ICov
Ci0gICAgICBpZiAobWtkaXJfcCAoMCwgcGF0aCkpCi0JewotCSAgc2tpcF9m
aWxlICgpOwotCSAgcmV0dXJuIDA7Ci0JfQotICAgICAgb3V0ID0gZm9wZW4g
KHBhdGgsICJ3YiIpOwotICAgIH0KLSAgaWYgKCFvdXQpCi0gICAgewotICAg
ICAgZnByaW50ZiAoc3RkZXJyLCAidW5hYmxlIHRvIHdyaXRlIHRvIGZpbGUg
JXNcbiIsIHBhdGgpOwotICAgICAgcGVycm9yICgiVGhlIGVycm9yIHdhcyIp
OwotICAgICAgc2tpcF9maWxlICgpOwotICAgICAgcmV0dXJuIDA7Ci0gICAg
fQotICByZXR1cm4gb3V0OwotfQotCisjZW5kaWYKKyNpZiAwCiBzdGF0aWMg
dm9pZAogcHJlcGFyZV9mb3JfZmlsZSAoY2hhciAqcGF0aCkKIHsKQEAgLTMz
NSwxMSArMjcyLDE0IEBAIHByZXBhcmVfZm9yX2ZpbGUgKGNoYXIgKnBhdGgp
CiAgICAgewogICAgICAgY2hhciAqdG1wID0gKGNoYXIgKikgbWFsbG9jIChz
dHJsZW4gKHBhdGgpICsgMTApOwogICAgICAgaW50IGkgPSAwOwotICAgICAg
ZG8gewotCWkrKzsKLQlzcHJpbnRmICh0bXAsICIlcy5vbGQtJWQiLCBwYXRo
LCBpKTsKLSAgICAgIH0gd2hpbGUgKEdldEZpbGVBdHRyaWJ1dGVzICh0bXAp
ICE9IDB4ZmZmZmZmZmYpOwotICAgICAgZnByaW50ZiAoc3RkZXJyLCAid2Fy
bmluZzogbW92aW5nIGRpcmVjdG9yeSBcIiVzXCIgb3V0IG9mIHRoZSB3YXku
XG4iLCBwYXRoKTsKKyAgICAgIGRvCisJeworCSAgaSsrOworCSAgc3ByaW50
ZiAodG1wLCAiJXMub2xkLSVkIiwgcGF0aCwgaSk7CisJfQorICAgICAgd2hp
bGUgKEdldEZpbGVBdHRyaWJ1dGVzICh0bXApICE9IDB4ZmZmZmZmZmYpOwor
ICAgICAgZnByaW50ZiAoc3RkZXJyLCAid2FybmluZzogbW92aW5nIGRpcmVj
dG9yeSBcIiVzXCIgb3V0IG9mIHRoZSB3YXkuXG4iLAorCSAgICAgICBwYXRo
KTsKICAgICAgIE1vdmVGaWxlIChwYXRoLCB0bXApOwogICAgICAgZnJlZSAo
dG1wKTsKICAgICB9CkBAIC0zNDcsMTggKzI4Nyw3MCBAQCBwcmVwYXJlX2Zv
cl9maWxlIChjaGFyICpwYXRoKQogICBEZWxldGVGaWxlQSAocGF0aCk7CiB9
CiAKK3N0YXRpYyBjaGFyICoKK3hzdHJkdXAgKGNoYXIgKmMpCit7CisgIGNo
YXIgKnIgPSAoY2hhciAqKSBtYWxsb2MgKHN0cmxlbiAoYykgKyAxKTsKKyAg
aWYgKCFyKQorICAgIGV4aXRfc2V0dXAgKDEpOworICBzdHJjcHkgKHIsIGMp
OworICByZXR1cm4gcjsKK30KKyNlbmRpZgorYXJjaGl2ZV9maWxlX3QKK2Fy
Y2hpdmVfdGFyOjpuZXh0X2ZpbGVfdHlwZSAoKQoreworICBzd2l0Y2ggKHN0
YXRlLnRhcl9oZWFkZXIudHlwZWZsYWcpCisgICAgeworICAgICAgLyogcmVn
dWxhciBmaWxlcyAqLworICAgIGNhc2UgJzAnOgorICAgIGNhc2UgMDoKKyAg
ICBjYXNlICc3JzoKKyAgICAgIHJldHVybiBBUkNISVZFX0ZJTEVfUkVHVUxB
UjsKKyAgICBjYXNlICcxJzoKKyAgICAgIHJldHVybiBBUkNISVZFX0ZJTEVf
SEFSRExJTks7CisgICAgY2FzZSAnNSc6CisgICAgICByZXR1cm4gQVJDSElW
RV9GSUxFX0RJUkVDVE9SWTsKKyAgICBjYXNlICcyJzoKKyAgICAgIHJldHVy
biBBUkNISVZFX0ZJTEVfU1lNTElOSzsKKyAgICBkZWZhdWx0OgorICAgICAg
cmV0dXJuIEFSQ0hJVkVfRklMRV9JTlZBTElEOworICAgIH0KK30KKworY29u
c3QgY2hhciAqCithcmNoaXZlX3Rhcjo6bGlua3RhcmdldCAoKQoreworICAv
KiBUT0RPOiBjb25zaWRlciAuLiBwYXRoIHRyYXZlcnNhbCBpc3N1ZXMgKi8K
KyAgaWYgKG5leHRfZmlsZV90eXBlICgpID09IEFSQ0hJVkVfRklMRV9TWU1M
SU5LIHx8CisgICAgICBuZXh0X2ZpbGVfdHlwZSAoKSA9PSBBUkNISVZFX0ZJ
TEVfSEFSRExJTkspCisgICAgcmV0dXJuIHN0YXRlLnRhcl9oZWFkZXIubGlu
a25hbWU7CisgIHJldHVybiBOVUxMOworfQorCitpb19zdHJlYW0gKgorYXJj
aGl2ZV90YXI6OmV4dHJhY3RfZmlsZSAoKQoreworICBpZiAoYXJjaGl2ZV9j
aGlsZHJlbikKKyAgICByZXR1cm4gTlVMTDsKKyAgYXJjaGl2ZV90YXJfZmls
ZSAqcnYgPSBuZXcgYXJjaGl2ZV90YXJfZmlsZSAoc3RhdGUpOworICByZXR1
cm4gcnY7Cit9CisKKworI2lmIDAKIGludAogdGFyX3JlYWRfZmlsZSAoY2hh
ciAqcGF0aCkKIHsKICAgRklMRSAqb3V0LCAqY29weTsKICAgSEFORExFIGg7
Ci0gIERXT1JEIHcsIHN0YXJ0dGlja3M7CisgIERXT1JEIHc7CiAgIGludCBn
b3Q7CiAgIHRhcl9tYXBfcmVzdWx0X3R5cGUgKnRtcjsKIAogICBzd2l0Y2gg
KHRhcl9oZWFkZXIudHlwZWZsYWcpCiAgICAgewotICAgIGNhc2UgJzAnOgkv
KiByZWd1bGFyIGZpbGVzICovCisgICAgY2FzZSAnMCc6CQkJLyogcmVndWxh
ciBmaWxlcyAqLwogICAgIGNhc2UgMDoKICAgICBjYXNlICc3JzoKICAgICAg
IHZwIChfdGFyX3ZmaWxlLCAiRiAlc1xuIiwgcGF0aCk7CkBAIC0zNzQsNyAr
MzY2LDggQEAgdGFyX3JlYWRfZmlsZSAoY2hhciAqcGF0aCkKIAkgIGdvdCA9
IHotPnJlYWQgKGJ1ZiwgNTEyKTsKIAkgIGlmIChnb3QgPCA1MTIpCiAJICAg
IHsKLQkgICAgICBmcHJpbnRmIChzdGRlcnIsICJ0YXI6IHVuZXhwZWN0ZWQg
ZW5kIG9mIGZpbGUgcmVhZGluZyAlc1xuIiwgcGF0aCk7CisJICAgICAgZnBy
aW50ZiAoc3RkZXJyLCAidGFyOiB1bmV4cGVjdGVkIGVuZCBvZiBmaWxlIHJl
YWRpbmcgJXNcbiIsCisJCSAgICAgICBwYXRoKTsKIAkgICAgICBmY2xvc2Ug
KG91dCk7CiAJICAgICAgcmVtb3ZlIChwYXRoKTsKIAkgICAgICByZXR1cm4g
MTsKQEAgLTQwMyw4ICszOTYsOCBAQCB0YXJfcmVhZF9maWxlIChjaGFyICpw
YXRoKQogCiAgICAgICByZXR1cm4gMDsKIAotICAgIGNhc2UgJzEnOgkvKiBo
YXJkIGxpbmtzOyB3ZSBqdXN0IGNvcHkgKi8KLSAgICAgIGZvciAodG1yID0g
dGFyX21hcF9yZXN1bHQ7IHRtcjsgdG1yPXRtci0+bmV4dCkKKyAgICBjYXNl
ICcxJzoJCQkvKiBoYXJkIGxpbmtzOyB3ZSBqdXN0IGNvcHkgKi8KKyAgICAg
IGZvciAodG1yID0gdGFyX21hcF9yZXN1bHQ7IHRtcjsgdG1yID0gdG1yLT5u
ZXh0KQogCWlmIChzdHJjbXAgKHRtci0+c3RvcmVkX25hbWUsIHRhcl9oZWFk
ZXIubGlua25hbWUpID09IDApCiAJICBicmVhazsKICAgICAgIGlmICghdG1y
KQpAQCAtNDQzLDIyICs0MzYsMjMgQEAgdGFyX3JlYWRfZmlsZSAoY2hhciAq
cGF0aCkKICAgICAgIGZpeF90aW1lX3N0YW1wIChwYXRoKTsKICAgICAgIHJl
dHVybiAwOwogCi0gICAgY2FzZSAnNSc6CS8qIGRpcmVjdG9yaWVzICovCisg
ICAgY2FzZSAnNSc6CQkJLyogZGlyZWN0b3JpZXMgKi8KICAgICAgIHZwIChf
dGFyX3ZmaWxlLCAiRCAlc1xuIiwgcGF0aCk7Ci0gICAgICB3aGlsZSAocGF0
aFswXSAmJiBwYXRoW3N0cmxlbiAocGF0aCktMV0gPT0gJy8nKQorICAgICAg
d2hpbGUgKHBhdGhbMF0gJiYgcGF0aFtzdHJsZW4gKHBhdGgpIC0gMV0gPT0g
Jy8nKQogCXBhdGhbc3RybGVuIChwYXRoKSAtIDFdID0gMDsKICAgICAgIHJl
dHVybiBta2Rpcl9wICgxLCBwYXRoKTsKIAogCi0gICAgY2FzZSAnMic6CS8q
IHN5bWJvbGljIGxpbmtzICovCisgICAgY2FzZSAnMic6CQkJLyogc3ltYm9s
aWMgbGlua3MgKi8KICAgICAgIHZwIChfdGFyX3ZmaWxlLCAiTCAlcyAtPiAl
c1xuIiwgcGF0aCwgdGFyX2hlYWRlci5saW5rbmFtZSk7CiAgICAgICBwcmVw
YXJlX2Zvcl9maWxlIChwYXRoKTsKICAgICAgIGggPSBDcmVhdGVGaWxlQSAo
cGF0aCwgR0VORVJJQ19XUklURSwgMCwgMCwgQ1JFQVRFX05FVywKLQkJICAg
ICAgRklMRV9BVFRSSUJVVEVfTk9STUFMLCAwKTsKKwkJICAgICAgIEZJTEVf
QVRUUklCVVRFX05PUk1BTCwgMCk7CiAgICAgICBpZiAoaCA9PSBJTlZBTElE
X0hBTkRMRV9WQUxVRSkKIAl7Ci0JICBmcHJpbnRmIChzdGRlcnIsICJlcnJv
cjogdW5hYmxlIHRvIGNyZWF0ZSBzeW1saW5rIFwiJXNcIiAtPiBcIiVzXCJc
biIsCi0JCSAgIHBhdGgsIHRhcl9oZWFkZXIubGlua25hbWUpOworCSAgZnBy
aW50ZiAoc3RkZXJyLAorCQkgICAiZXJyb3I6IHVuYWJsZSB0byBjcmVhdGUg
c3ltbGluayBcIiVzXCIgLT4gXCIlc1wiXG4iLCBwYXRoLAorCQkgICB0YXJf
aGVhZGVyLmxpbmtuYW1lKTsKIAkgIHJldHVybiAxOwogCX0KICAgICAgIHN0
cmNweSAoYnVmLCBTWU1MSU5LX0NPT0tJRSk7CkBAIC00NzMsOTUgKzQ2Nyw4
IEBAIHRhcl9yZWFkX2ZpbGUgKGNoYXIgKnBhdGgpCiAgICAgICBmcHJpbnRm
IChzdGRlcnIsICJlcnJvcjogdW5hYmxlIHRvIHdyaXRlIHN5bWxpbmsgXCIl
c1wiXG4iLCBwYXRoKTsKICAgICAgIERlbGV0ZUZpbGVBIChwYXRoKTsKICAg
ICAgIHJldHVybiAxOworICAgIGRlZmF1bHQ6CisgICAgICByZXR1cm4gMDsK
ICAgICB9CiB9Ci0KLWludAotdGFyX2Nsb3NlICgpCi17Ci0jaWYgMAotICB3
aGlsZSAodGFyX21hcF9yZXN1bHQpCi0gICAgewotICAgICAgdGFyX21hcF9y
ZXN1bHRfdHlwZSAqdCA9IHRhcl9tYXBfcmVzdWx0LT5uZXh0OwotICAgICAg
ZnJlZSAodGFyX21hcF9yZXN1bHQtPnN0b3JlZF9uYW1lKTsKLSAgICAgIGZy
ZWUgKHRhcl9tYXBfcmVzdWx0LT5tYXBwZWRfbmFtZSk7Ci0gICAgICBmcmVl
ICh0YXJfbWFwX3Jlc3VsdCk7Ci0gICAgICB0YXJfbWFwX3Jlc3VsdCA9IHQ7
Ci0gICAgfQogI2VuZGlmCi0gIHRhcl9tYXBfcmVzdWx0ID0gMDsKLQotICBp
ZiAoei0+Y2xvc2UgKCkpCi0gICAgZXJyKys7Ci0gIHJldHVybiBlcnI7IC8q
IGluY2x1ZGVzIGVycm9ycyBmb3Igc2tpcHBlZCBmaWxlcywgZXRjICovCi19
Ci0KLXR5cGVkZWYgc3RydWN0IHsKLSAgY2hhciAqZnJvbTsKLSAgaW50IGZy
b21fbGVuOwotICBjaGFyICp0bzsKLSAgaW50IHRvX2xlbjsKLX0gbWFwX3R5
cGU7Ci0KLXN0YXRpYyBtYXBfdHlwZSAqbWFwOwotc3RhdGljIGludCBubWFw
czsKLQotaW50Ci10YXJfYXV0byAoY2hhciAqcGF0aG5hbWUsIGNoYXIgKipt
YXBsaXN0KQotewotICBjaGFyICpjOwotICBpbnQgZXJyID0gMDsKLSAgaW50
IGksIGo7Ci0gIG1hcF90eXBlIG10ZW1wOwotICBjaGFyIG5ld25hbWVbX01B
WF9QQVRIKzUxMl07Ci0gIHN0YXRpYyBjaGFyIHR3aWRkbGVzW10gPSAifFxi
L1xiLVxiXFxcYiI7Ci0gIGludCB0ID0gMDsKLQotICBmb3IgKG5tYXBzPTA7
IG1hcGxpc3Rbbm1hcHMqMl07IG5tYXBzKyspIDsKLSAgbWFwID0gKG1hcF90
eXBlICopIG1hbGxvYyAoKG5tYXBzKzEpICogc2l6ZW9mIChtYXBfdHlwZSkp
OwotICBmb3IgKG5tYXBzPTA7IG1hcGxpc3Rbbm1hcHMqMl07IG5tYXBzKysp
Ci0gICAgewotICAgICAgbWFwW25tYXBzXS5mcm9tID0gbWFwbGlzdFtubWFw
cyoyXTsKLSAgICAgIG1hcFtubWFwc10uZnJvbV9sZW4gPSBzdHJsZW4gKG1h
cGxpc3Rbbm1hcHMqMl0pOwotICAgICAgbWFwW25tYXBzXS50byA9IG1hcGxp
c3Rbbm1hcHMqMisxXTsKLSAgICAgIG1hcFtubWFwc10udG9fbGVuID0gc3Ry
bGVuIChtYXBsaXN0W25tYXBzKjIrMV0pOwotICAgIH0KLSAgLyogYnViYmxl
IHNvcnQgLSBleHBlY3QgdGhlIG1hcHMgdG8gYmUgc2hvcnQgKi8KLSAgZm9y
IChpPTA7IGk8bm1hcHMtMTsgaSsrKQotICAgIGZvciAoaj1pKzE7IGo8bm1h
cHM7IGorKykKLSAgICAgIGlmIChtYXBbaV0uZnJvbV9sZW4gPCBtYXBbal0u
ZnJvbV9sZW4pCi0JewotCSAgbXRlbXAgPSBtYXBbaV07Ci0JICBtYXBbaV0g
PSBtYXBbal07Ci0JICBtYXBbal0gPSBtdGVtcDsKLQl9Ci0KLSAgaWYgKHRh
cl9vcGVuIChwYXRobmFtZSkpCi0gICAgcmV0dXJuIDE7Ci0gIHdoaWxlIChj
ID0gdGFyX25leHRfZmlsZSAoKSkKLSAgICB7Ci0gICAgICBpbnQgbCA9IHN0
cmxlbiAoYyk7Ci0gICAgICBmb3IgKGk9MDsgaTxubWFwczsgaSsrKQotCWlm
IChsID49IG1hcFtpXS5mcm9tX2xlbgotCSAgICAmJiBzdHJuY21wIChjLCBt
YXBbaV0uZnJvbSwgbWFwW2ldLmZyb21fbGVuKSA9PSAwKQotCSAgewotCSAg
ICBzdHJjcHkgKG5ld25hbWUsIG1hcFtpXS50byk7Ci0JICAgIHN0cmNweSAo
bmV3bmFtZSttYXBbaV0udG9fbGVuLCBjICsgbWFwW2ldLmZyb21fbGVuKTsK
LQkgICAgYyA9IG5ld25hbWU7Ci0JICAgIGJyZWFrOwotCSAgfQotCi0gICAg
ICB0ID0gKHQrMikgJSA4OwotICAgICAgZndyaXRlICh0d2lkZGxlcyt0LCAx
LCAyLCBzdGRlcnIpOwotCi0gICAgICBpZiAodGFyX3JlYWRfZmlsZSAoYykp
Ci0JZXJyKys7Ci0gICAgfQotICBpZiAodGFyX2Nsb3NlICgpKQotICAgIGVy
cisrOwotCi0gIGZ3cml0ZSAoIiBcYiIsIDEsIDIsIHN0ZGVycik7Ci0KLSAg
dnAyIChfdGFyX3ZmaWxlLCAidGFyX2F1dG8gcmV0dXJucyAlZFxuIiwgZXJy
KTsKLSAgcmV0dXJuIGVycjsKLX0KSW5kZXg6IHRhci5oCj09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT0KUkNTIGZpbGU6IC9jdnMvc3JjL3NyYy93aW5zdXAvY2lu
c3RhbGwvdGFyLmgsdgpyZXRyaWV2aW5nIHJldmlzaW9uIDIuMQpkaWZmIC11
IC1wIC1yMi4xIHRhci5oCi0tLSB0YXIuaAkyMDAxLzA2LzEzIDE2OjExOjAx
CTIuMQorKysgdGFyLmgJMjAwMS8xMS8xMSAwNjo1NDo1OApAQCAtMTAsMzYg
KzEwLDE0OCBAQAogICogICAgIGh0dHA6Ly93d3cuZ251Lm9yZy8KICAqCiAg
KiBXcml0dGVuIGJ5IERKIERlbG9yaWUgPGRqQGN5Z251cy5jb20+CisgKiBN
YWRlIE9PUCBieSBSIENvbGxpbnMgPHJidGNvbGxpbnNAaG90bWFpbC5jb20+
CiAgKgogICovCiAKICNpZm5kZWYgX19UQVJfSF8KICNkZWZpbmUgX19UQVJf
SF8KIAordHlwZWRlZiBzdHJ1Y3QKK3sKKyAgY2hhciBuYW1lWzEwMF07CQkv
KiAgIDAgKi8KKyAgY2hhciBtb2RlWzhdOwkJCS8qIDEwMCAqLworICBjaGFy
IHVpZFs4XTsJCQkvKiAxMDggKi8KKyAgY2hhciBnaWRbOF07CQkJLyogMTE2
ICovCisgIGNoYXIgc2l6ZVsxMl07CQkvKiAxMjQgKi8KKyAgY2hhciBtdGlt
ZVsxMl07CQkvKiAxMzYgKi8KKyAgY2hhciBjaGtzdW1bOF07CQkvKiAxNDgg
Ki8KKyAgY2hhciB0eXBlZmxhZzsJCS8qIDE1NiAqLworICBjaGFyIGxpbmtu
YW1lWzEwMF07CQkvKiAxNTcgKi8KKyAgY2hhciBtYWdpY1s2XTsJCS8qIDI1
NyAqLworICBjaGFyIHZlcnNpb25bMl07CQkvKiAyNjMgKi8KKyAgY2hhciB1
bmFtZVszMl07CQkvKiAyNjUgKi8KKyAgY2hhciBnbmFtZVszMl07CQkvKiAy
OTcgKi8KKyAgY2hhciBkZXZtYWpvcls4XTsJCS8qIDMyOSAqLworICBjaGFy
IGRldm1pbm9yWzhdOwkJLyogMzM3ICovCisgIGNoYXIgcHJlZml4WzE1NV07
CQkvKiAzNDUgKi8KKyAgY2hhciBqdW5rWzEyXTsJCS8qIDUwMCAqLworfQor
dGFyX2hlYWRlcl90eXBlOworCit0eXBlZGVmIHN0cnVjdCB0YXJfbWFwX3Jl
c3VsdF90eXBlX3MKK3sKKyAgc3RydWN0IHRhcl9tYXBfcmVzdWx0X3R5cGVf
cyAqbmV4dDsKKyAgY2hhciAqc3RvcmVkX25hbWU7CisgIGNoYXIgKm1hcHBl
ZF9uYW1lOworfQordGFyX21hcF9yZXN1bHRfdHlwZTsKKworY2xhc3MgdGFy
X3N0YXRlCit7CitwdWJsaWM6CisgIHRhcl9zdGF0ZSAoKTpsYXN0ZXJyICgw
KSwgZW9jZiAoMCksIGhhdmVfbG9uZ25hbWUgKCdcMCcpLCBmaWxlX29mZnNl
dCAoMCksCisgICAgZmlsZV9sZW5ndGggKDApLCBoZWFkZXJfcmVhZCAoMCkK
KyAgeworICAgIHBhcmVudCA9IE5VTEw7CisgICAgZmlsZW5hbWVbMF0gPSAn
XDAnOworICAgIHRhcl9tYXBfcmVzdWx0ID0gTlVMTDsKKyAgfTsKKyAgaW9f
c3RyZWFtICpwYXJlbnQ7CisgIGludCBsYXN0ZXJyOworICBpbnQgZW9jZjsK
KyAgY2hhciBoYXZlX2xvbmduYW1lOworICAvKiB3aGVyZSBpbiB0aGUgY3Vy
cmVudCBmaWxlIGFyZSB3ZT8gKi8KKyAgc2l6ZV90IGZpbGVfb2Zmc2V0Owor
ICBzaXplX3QgZmlsZV9sZW5ndGg7CisgIGludCBoZWFkZXJfcmVhZDsKKyAg
dGFyX2hlYWRlcl90eXBlIHRhcl9oZWFkZXI7CisgIGNoYXIgZmlsZW5hbWVb
X01BWF9QQVRIICsgNTEyXTsKKyAgdGFyX21hcF9yZXN1bHRfdHlwZSAqdGFy
X21hcF9yZXN1bHQ7Cit9OworCitjbGFzcyBhcmNoaXZlX3Rhcl9maWxlOnB1
YmxpYyBpb19zdHJlYW0KK3sKK3B1YmxpYzoKKyAgYXJjaGl2ZV90YXJfZmls
ZSAodGFyX3N0YXRlICYpOworICB2aXJ0dWFsIHNzaXplX3QgcmVhZCAodm9p
ZCAqYnVmZmVyLCBzaXplX3QgbGVuKTsKKyAgLyogcHJvdmlkZSBkYXRhIHRv
IChkb3VibGUgZHVoISkgKi8KKyAgdmlydHVhbCBzc2l6ZV90IHdyaXRlICh2
b2lkICpidWZmZXIsIHNpemVfdCBsZW4pOworICAvKiByZWFkIGRhdGEgd2l0
aG91dCByZW1vdmluZyBpdCBmcm9tIHRoZSBjbGFzcydzIGludGVybmFsIGJ1
ZmZlciAqLworICB2aXJ0dWFsIHNzaXplX3QgcGVlayAodm9pZCAqYnVmZmVy
LCBzaXplX3QgbGVuKTsKKyAgdmlydHVhbCBsb25nIHRlbGwgKCk7CisgIC8q
IHRyeSBndWVzc2luZyB0aGlzIG9uZSAqLworICB2aXJ0dWFsIGludCBlcnJv
ciAoKTsKKyAgdmlydHVhbCBjaGFyICpuZXh0X2ZpbGVfbmFtZSAoKQorICB7
CisgICAgcmV0dXJuIE5VTEw7CisgIH07CisgIHZpcnR1YWwgaW50IHNldF9t
dGltZSAoaW50KQorICB7CisgICAgcmV0dXJuIDE7CisgIH07CisgICAgdmly
dHVhbCB+IGFyY2hpdmVfdGFyX2ZpbGUgKCk7Citwcml2YXRlOgorICAgIHRh
cl9zdGF0ZSAmIHN0YXRlOworfTsKKworY2xhc3MgYXJjaGl2ZV90YXI6cHVi
bGljIGFyY2hpdmUKK3sKK3B1YmxpYzoKKyAgYXJjaGl2ZV90YXIgKGlvX3N0
cmVhbSAqIG9yaWdpbmFsKTsKKyAgdmlydHVhbCBpb19zdHJlYW0gKmV4dHJh
Y3RfZmlsZSAoKTsKKyAgLyogcmVhZCBkYXRhIChkdWghKSAqLworICB2aXJ0
dWFsIHNzaXplX3QgcmVhZCAodm9pZCAqYnVmZmVyLCBzaXplX3QgbGVuKTsK
KyAgLyogcHJvdmlkZSBkYXRhIHRvIChkb3VibGUgZHVoISkgKi8KKyAgdmly
dHVhbCBzc2l6ZV90IHdyaXRlICh2b2lkICpidWZmZXIsIHNpemVfdCBsZW4p
OworICAvKiByZWFkIGRhdGEgd2l0aG91dCByZW1vdmluZyBpdCBmcm9tIHRo
ZSBjbGFzcydzIGludGVybmFsIGJ1ZmZlciAqLworICB2aXJ0dWFsIHNzaXpl
X3QgcGVlayAodm9pZCAqYnVmZmVyLCBzaXplX3QgbGVuKTsKKyAgdmlydHVh
bCBsb25nIHRlbGwgKCk7CisgIC8qIHRyeSBndWVzc2luZyB0aGlzIG9uZSAq
LworICB2aXJ0dWFsIGludCBlcnJvciAoKTsKKyAgLyogRmluZCBvdXQgdGhl
IG5leHQgc3RyZWFtIG5hbWUgLQorICAgKiBpZSBmb3IgZm9vLnRhci5neiwg
YXQgb2Zmc2V0IDAsIG5leHRfZmlsZV9uYW1lID0gZm9vLnRhcgorICAgKiBm
b3IgZm9vYmFyIHRoYXQgaXMgYW4gY29tcHJlc3MsIG5leHRfZmlsZV9uYW1l
IGlzIHRoZSBuZXh0CisgICAqIGV4dHJhY3RhYmxlIGZpbGVuYW1lLgorICAg
Ki8KKyAgdmlydHVhbCBjb25zdCBjaGFyICpuZXh0X2ZpbGVfbmFtZSAoKTsK
KyAgdmlydHVhbCBhcmNoaXZlX2ZpbGVfdCBuZXh0X2ZpbGVfdHlwZSAoKTsK
KyAgLyogb25seSBvZiB1c2Ugd2hlbiB3ZSBzdXBwb3J0IHdyaXRpbmcgdG8g
dGFyICovCisgIHZpcnR1YWwgaW50IHNldF9tdGltZSAoaW50KQorICB7Cisg
ICAgcmV0dXJuIDE7CisgIH07CisgIHZpcnR1YWwgY29uc3QgY2hhciAqbGlu
a3RhcmdldCAoKTsKKyAgdmlydHVhbCBpbnQgc2tpcF9maWxlICgpOworICAv
KiBpZiB5b3UgYXJlIHN0aWxsIG5lZWRpbmcgdGhlc2UgaGludHMuLi4gZ2l2
ZSB1cCBub3chICovCisgICAgdmlydHVhbCB+IGFyY2hpdmVfdGFyICgpOwor
cHJpdmF0ZToKKyAgICBhcmNoaXZlX3RhciAoKQorICB7CisgIH07CisgIHRh
cl9zdGF0ZSBzdGF0ZTsKKyAgdW5zaWduZWQgaW50IGFyY2hpdmVfY2hpbGRy
ZW47Cit9OworCiAvKiBPbmx5IG9uZSB0YXJmaWxlIG1heSBiZSBvcGVuIGF0
IGEgdGltZS4gIGd6aXBwZWQgZmlsZXMgaGFuZGxlZAogICAgYXV0b21hdGlj
YWxseSAqLwogCiAvKiByZXR1cm5zIHplcm8gb24gc3VjY2Vzcywgbm9uemVy
byBvbiBmYWlsdXJlICovCi1pbnQJdGFyX29wZW4gKGNvbnN0IGNoYXIgKnBh
dGhuYW1lKTsKLQotLyogcmV0dXJucyBwb2ludGVyIHRvIHN0YXRpYyBidWYg
Y29udGFpbmluZyBuYW1lIG9mIG5leHQgZmlsZSAqLwotY2hhciAqCXRhcl9u
ZXh0X2ZpbGUgKCk7CisvL2ludCAgIHRhcl9vcGVuIChjb25zdCBjaGFyICpw
YXRobmFtZSk7CiAKLS8qIGJ5dGUgcG9zaXRpb24gaW4gW2NvbXByZXNzZWRd
IGZpbGUgKi8KLWludAl0YXJfZnRlbGwgKCk7Ci0KIC8qIHBhc3MgYWRqdXN0
ZWQgcGF0aCwgcmV0dXJucyB6ZXJvIG9uIHN1Y2Nlc3MsIG5vbnplcm8gb24g
ZmFpbHVyZSAqLwotaW50CXRhcl9yZWFkX2ZpbGUgKGNoYXIgKnBhdGgpOwor
Ly9pbnQgICB0YXJfcmVhZF9maWxlIChjaGFyICpwYXRoKTsKIAotLyogY2xv
c2VzIHRoZSBmaWxlICovCi1pbnQJdGFyX2Nsb3NlICgpOwogCisjaWYgMAog
LyogcGFzcyBwYXRoIHRvIHRhciBmaWxlIGFuZCBmcm9tL3RvIHBhaXJzIGZv
ciBwYXRoIHByZWZpeCAoTlVMTHMgYXQKICAgIGVuZCAsIHJldHVybnMgemVy
byBpZiBjb21wbGV0ZWx5IHN1Y2Nlc3NmdWwsIG5vbnplcm8gKGNvdW50cwog
ICAgZXJyb3JzKSBvbiBmYWlsdXJlICovCi1pbnQJdGFyX2F1dG8gKGNoYXIg
KnBhdGhuYW1lLCBjaGFyICoqbWFwKTsKK2ludCB0YXJfYXV0byAoY2hhciAq
cGF0aG5hbWUsIGNoYXIgKiptYXApOworI2VuZGlmCisKIAotaW50CXRhcl9t
a2Rpcl9wIChpbnQgaXNhZGlyLCBjaGFyICpwYXRoKTsKKy8vaW50ICAgdGFy
X21rZGlyX3AgKGludCBpc2FkaXIsIGNoYXIgKnBhdGgpOwogCiAvKgogZXh0
ZXJuIGludCBfdGFyX3ZlcmJvc2U7Cg==

------------=_1583532850-65438-114--
