Return-Path: <cygwin-patches-return-3145-listarch-cygwin-patches=sourceware.cygnus.com@cygwin.com>
Received: (qmail 21838 invoked by alias); 9 Nov 2002 19:28:46 -0000
Mailing-List: contact cygwin-patches-help@cygwin.com; run by ezmlm
Precedence: bulk
List-Subscribe: <mailto:cygwin-patches-subscribe@cygwin.com>
List-Post: <mailto:cygwin-patches@cygwin.com>
List-Archive: <http://sources.redhat.com/ml/cygwin-patches/>
List-Help: <mailto:cygwin-patches-help@cygwin.com>, <http://sources.redhat.com/ml/#faqs>
Sender: cygwin-patches-owner@cygwin.com
Received: (qmail 21829 invoked from network); 9 Nov 2002 19:28:45 -0000
Date: Sat, 09 Nov 2002 11:28:00 -0000
From: Alexander Gottwald <Alexander.Gottwald@s1999.tu-chemnitz.de>
To: cygwin-patches@cygwin.com
Subject: SIOCGIFCONF patch
Message-ID: <Pine.LNX.4.44.0211092028130.23266-200000@lupus.ago.vpn>
MIME-Version: 1.0
Content-Type: MULTIPART/Mixed; BOUNDARY="-1463760102-51089904-1036869446=:23266"
Content-ID: <Pine.LNX.4.44.0211092028170.23266@lupus.ago.vpn>
X-Spam-Score: 0.4 (/)
X-Scanner: exiscan for exim4 (http://duncanthrax.net/exiscan/) *18AbHg-0005eB-00*7y2loX/Q1UU*
X-SW-Source: 2002-q4/txt/msg00096.txt.bz2

  This message is in MIME format.  The first part should be readable text,
  while the remaining parts are likely unreadable without MIME-aware tools.
  Send mail to mime@docserver.cac.washington.edu for more info.

---1463760102-51089904-1036869446=:23266
Content-Type: TEXT/PLAIN; CHARSET=US-ASCII
Content-ID: <Pine.LNX.4.44.0211092028171.23266@lupus.ago.vpn>
Content-length: 1090

Hi,

A user of Cygwin/Xfree86 reported that cygwin did not report an interface
for his wireless network adapter. It seems that the GetIfTable function
did not return all network adapters on his computer. As a workaround to
this problem i changed the code to use GetIfEntry for each configured
address. 

I also had to change the algorithm for finding all addresses configured
for one network adapter and changed the previous code which could only
enumerate 10 addresses per adapter to use sprintf and raised that limit too.

I also added code for getting the device metric for an interface. I'm 
not sure if this is correctly solved and I have no problems with removing 
this part again. 

2002-11-09  Alexander Gottwald <Alexander.Gottwald@s1999.tu-chemnitz.de>

    * net.cc (get_2k_ifconf): Get the interface entries with the GetIfEntry 
    call intead of the GetIfTable call. Query the interface metric from the 
    IpForwardTable. Clean-up multiple IP address naming.
    
bye
    ago
-- 
 Alexander.Gottwald@informatik.tu-chemnitz.de 
 http://www.gotti.org           ICQ: 126018723

---1463760102-51089904-1036869446=:23266
Content-Type: TEXT/PLAIN; CHARSET=US-ASCII; NAME="cygwin-net2-1.3.15.diff"
Content-Transfer-Encoding: BASE64
Content-ID: <Pine.LNX.4.44.0211092017260.23266@lupus.ago.vpn>
Content-Description: 
Content-Disposition: ATTACHMENT; FILENAME="cygwin-net2-1.3.15.diff"
Content-length: 14311

LS0tIHdpbnN1cC9jeWd3aW4vbmV0LmNjLm9yaWcJU2F0IE5vdiAgOSAxODoz
Njo1MiAyMDAyDQorKysgd2luc3VwL2N5Z3dpbi9uZXQuY2MJU2F0IE5vdiAg
OSAxODozODoyMyAyMDAyDQpAQCAtMTIxNiwxMjUgKzEyMTYsMTg5IEBAIHN0
YXRpYyB2b2lkDQogZ2V0XzJrX2lmY29uZiAoc3RydWN0IGlmY29uZiAqaWZj
LCBpbnQgd2hhdCkNCiB7DQogICBpbnQgY250ID0gMDsNCi0gIGNoYXIgZXRo
WzJdID0gIi8iLCBwcHBbMl0gPSAiLyIsIHNscFsyXSA9ICIvIiwgc3ViWzJd
ID0gIjAiLCB0b2tbMl0gPSAiLyI7DQorICBpbnQgZXRoSWQgPSAwLCBwcHBJ
ZCA9IDAsIHNscElkID0gMCwgdG9rSWQgPSAwOyANCiANCiAgIC8qIFVuaW9u
IG1hcHMgYnVmZmVyIHRvIGNvcnJlY3Qgc3RydWN0ICovDQogICBzdHJ1Y3Qg
aWZyZXEgKmlmciA9IGlmYy0+aWZjX3JlcTsNCiANCi0gIERXT1JEIGlmX2Nu
dCwgaXBfY250LCBsaXAsIGxucDsNCi0gIERXT1JEIHNpel9pZl90YWJsZSA9
IDA7DQorICBEV09SRCBpcF9jbnQsIGlwZl9jbnQsIGxpcCwgbG5wOw0KICAg
RFdPUkQgc2l6X2lwX3RhYmxlID0gMDsNCi0gIFBNSUJfSUZUQUJMRSBpZnQ7
DQorICBEV09SRCBzaXpfaXBmd2RfdGFibGUgPSAwOw0KICAgUE1JQl9JUEFE
RFJUQUJMRSBpcHQ7DQorICBQTUlCX0lGUk9XIGlmcm93Ow0KKyAgUE1JQl9J
UEZPUldBUkRUQUJMRSBpcGZ3ZHQ7DQogICBzdHJ1Y3Qgc29ja2FkZHJfaW4g
KnNhID0gTlVMTDsNCiAgIHN0cnVjdCBzb2NrYWRkciAqc28gPSBOVUxMOw0K
IA0KLSAgaWYgKEdldElmVGFibGUgKE5VTEwsICZzaXpfaWZfdGFibGUsIFRS
VUUpID09IEVSUk9SX0lOU1VGRklDSUVOVF9CVUZGRVIgJiYNCi0gICAgICBH
ZXRJcEFkZHJUYWJsZSAoTlVMTCwgJnNpel9pcF90YWJsZSwgVFJVRSkgPT0g
RVJST1JfSU5TVUZGSUNJRU5UX0JVRkZFUiAmJg0KLSAgICAgIChpZnQgPSAo
UE1JQl9JRlRBQkxFKSBhbGxvY2EgKHNpel9pZl90YWJsZSkpICYmDQotICAg
ICAgKGlwdCA9IChQTUlCX0lQQUREUlRBQkxFKSBhbGxvY2EgKHNpel9pcF90
YWJsZSkpICYmDQotICAgICAgIUdldElmVGFibGUgKGlmdCwgJnNpel9pZl90
YWJsZSwgVFJVRSkgJiYNCi0gICAgICAhR2V0SXBBZGRyVGFibGUgKGlwdCwg
JnNpel9pcF90YWJsZSwgVFJVRSkpDQorICB0eXBlZGVmIHN0cnVjdCBpZmNv
dW50X3Qgew0KKyAgICAgIERXT1JEIGlmSW5kZXg7DQorICAgICAgRFdPUkQg
cm91dGVJbmRleDsNCisgICAgICBEV09SRCBtZXRyaWM7DQorICAgICAgc2l6
ZV90IGNvdW50Ow0KKyAgICAgIHVuc2lnbmVkIGludCBlbnVtZXJhdGVkOyAg
Ly8gZm9yIGV0aDA6MQ0KKyAgICAgIHVuc2lnbmVkIGludCBjbGFzc0lkOyAg
ICAgLy8gZm9yIGV0aDAsIHRvazAgLi4uDQorICAgICAgDQorICB9Ow0KKyAg
aWZjb3VudF90ICppZmxpc3QsICppZkVudHJ5Ow0KKw0KKyAgaWYgKEdldElw
QWRkclRhYmxlIChOVUxMLCAmc2l6X2lwX3RhYmxlLCBUUlVFKSA9PSBFUlJP
Ul9JTlNVRkZJQ0lFTlRfQlVGRkVSDQorICAgICAgJiYgR2V0SXBGb3J3YXJk
VGFibGUoTlVMTCwgJnNpel9pcGZ3ZF90YWJsZSwgRkFMU0UpID09IEVSUk9S
X0lOU1VGRklDSUVOVF9CVUZGRVIgICAgDQorICAgICAgJiYgKGlmcm93ID0g
KFBNSUJfSUZST1cpIGFsbG9jYSAoc2l6ZW9mIChNSUJfSUZST1cpKSkNCisg
ICAgICAmJiAoaXB0ID0gKFBNSUJfSVBBRERSVEFCTEUpIGFsbG9jYSAoc2l6
X2lwX3RhYmxlKSkNCisgICAgICAmJiAoaXBmd2R0ID0gKFBNSUJfSVBGT1JX
QVJEVEFCTEUpIGFsbG9jYSAoc2l6X2lwZndkX3RhYmxlKSkNCisgICAgICAm
JiAhR2V0SXBBZGRyVGFibGUgKGlwdCwgJnNpel9pcF90YWJsZSwgVFJVRSkN
CisgICAgICAmJiAhR2V0SXBGb3J3YXJkVGFibGUoaXBmd2R0LCAmc2l6X2lw
ZndkX3RhYmxlLCBGQUxTRSkpDQogICAgIHsNCi0gICAgICAvKiBJdGVyYXRl
IG92ZXIgYWxsIGtub3duIGludGVyZmFjZXMgKi8NCi0gICAgICBmb3IgKGlm
X2NudCA9IDA7IGlmX2NudCA8IGlmdC0+ZHdOdW1FbnRyaWVzOyArK2lmX2Nu
dCkNCisgICAgICBpZmxpc3QgPSAoaWZjb3VudF90ICopYWxsb2NhKHNpemVv
ZihpZmNvdW50X3QpICogKGlwdC0+ZHdOdW1FbnRyaWVzICsgMSkpOw0KKyAg
ICAgIG1lbXNldChpZmxpc3QsIDAsICBzaXplb2YoaWZjb3VudF90KSAqIChp
cHQtPmR3TnVtRW50cmllcyArIDEpKTsNCisgICAgICBmb3IgKGlwX2NudCA9
IDA7IGlwX2NudCA8IGlwdC0+ZHdOdW1FbnRyaWVzOyArK2lwX2NudCkNCisg
ICAgICAgIHsNCisgICAgICAgICAgaWZFbnRyeSA9IGlmbGlzdDsgDQorICAg
ICAgICAgIC8qIHNlYXJjaCBmb3IgbWF0Y2hpbmcgZW50cnkgKGFuZCBzdG9w
IGF0IGZpcnN0IGZyZWUgZW50cnkpICovDQorICAgICAgICAgIHdoaWxlIChp
ZkVudHJ5LT5jb3VudCAhPSAwKSB7DQorICAgICAgICAgICAgaWYgKGlmRW50
cnktPmlmSW5kZXggPT0gaXB0LT50YWJsZVtpcF9jbnRdLmR3SW5kZXgpIA0K
KyAgICAgICAgICAgICAgYnJlYWs7ICANCisgICAgICAgICAgICBpZkVudHJ5
Kys7DQorICAgICAgICAgIH0NCisgICAgICAgICAgaWYgKGlmRW50cnktPmNv
dW50ID09IDApIHsNCisgICAgICAgICAgICAgIGlmRW50cnktPmNvdW50ID0g
MTsNCisgICAgICAgICAgICAgIGlmRW50cnktPm1ldHJpYyA9IDE7DQorICAg
ICAgICAgICAgICBpZkVudHJ5LT5pZkluZGV4ID0gaXB0LT50YWJsZVtpcF9j
bnRdLmR3SW5kZXg7IA0KKyAgICAgICAgICB9IGVsc2Ugew0KKyAgICAgICAg
ICAgICAgaWZFbnRyeS0+Y291bnQrKzsNCisgICAgICAgICAgfSAgICANCisg
ICAgICAgIH0NCisgICAgICAvLyByZXNldCB0aGUgbGFzdCBlbGVtZW50LiBU
aGlzIGlzIGp1c3QgdGhlIHN0b3BwZXIgZm9yIHRoZSBsb29wLg0KKyAgICAg
IGlmbGlzdFtpcHQtPmR3TnVtRW50cmllc10uY291bnQgPSAwOw0KKyAgICAg
IA0KKyAgICAgIGlmRW50cnkgPSBpZmxpc3Q7DQorICAgICAgd2hpbGUgKGlm
RW50cnktPmNvdW50ID4gMCkgew0KKyAgICAgICAgZm9yIChpcGZfY250ID0g
MDsgaXBmX2NudCA8IGlwZndkdC0+ZHdOdW1FbnRyaWVzOyArK2lwZl9jbnQp
IA0KKyAgICAgICAgICBpZiAoaXBmd2R0LT50YWJsZVtpcGZfY250XS5kd0Zv
cndhcmRJZkluZGV4ICA9PSBpZkVudHJ5LT5pZkluZGV4KSB7DQorICAgICAg
ICAgICAgaWZFbnRyeS0+cm91dGVJbmRleCA9IGlwZl9jbnQ7DQorICAgICAg
ICAgICAgaWZFbnRyeS0+bWV0cmljID0gaXBmd2R0LT50YWJsZVtpcGZfY250
XS5kd0ZvcndhcmRNZXRyaWMxOw0KKyAgICAgICAgICAgIGJyZWFrOyAgICAg
ICAgDQorICAgICAgICAgIH0gICAgDQorICAgICAgICBpZkVudHJ5Kys7DQor
ICAgICAgfSAgDQorICAgICAgDQorICAgICAgLyogSXRlcmF0ZSBvdmVyIGFs
bCBjb25maWd1cmVkIElQLWFkZHJlc3NlcyAqLw0KKyAgICAgIGZvciAoaXBf
Y250ID0gMDsgaXBfY250IDwgaXB0LT5kd051bUVudHJpZXM7ICsraXBfY250
KQ0KIAl7DQotCSAgKnN1YiA9ICcwJzsNCi0JICAvKiBJdGVyYXRlIG92ZXIg
YWxsIGNvbmZpZ3VyZWQgSVAtYWRkcmVzc2VzICovDQotCSAgZm9yIChpcF9j
bnQgPSAwOyBpcF9jbnQgPCBpcHQtPmR3TnVtRW50cmllczsgKytpcF9jbnQp
DQorCSAgbWVtc2V0IChpZnJvdywgMCwgc2l6ZW9mIChNSUJfSUZST1cpKTsN
CisJICBpZnJvdy0+ZHdJbmRleCA9IGlwdC0+dGFibGVbaXBfY250XS5kd0lu
ZGV4Ow0KKwkgIGlmIChHZXRJZkVudHJ5IChpZnJvdykgIT0gTk9fRVJST1Ip
DQorCSAgICBjb250aW51ZTsNCisgICAgICAgICAgDQorICAgICAgICAgIGlm
Y291bnRfdCAqaWZFbnRyeSA9IGlmbGlzdDsgDQorICAgICAgICAgIC8qIHNl
YXJjaCBmb3IgbWF0Y2hpbmcgZW50cnkgKGFuZCBzdG9wIGF0IGZpcnN0IGZy
ZWUgZW50cnkpICovDQorICAgICAgICAgIHdoaWxlIChpZkVudHJ5LT5jb3Vu
dCAhPSAwKSB7DQorICAgICAgICAgICAgaWYgKGlmRW50cnktPmlmSW5kZXgg
PT0gaXB0LT50YWJsZVtpcF9jbnRdLmR3SW5kZXgpIA0KKyAgICAgICAgICAg
ICAgYnJlYWs7ICANCisgICAgICAgICAgICBpZkVudHJ5Kys7DQorICAgICAg
ICAgIH0NCisNCisJICAvKiBTZXR1cCB0aGUgaW50ZXJmYWNlIG5hbWUgKi8N
CisJICBzd2l0Y2ggKGlmcm93LT5kd1R5cGUpDQogCSAgICB7DQotCSAgICAg
IC8qIERvZXMgdGhlIElQIGFkZHJlc3MgYmVsb25nIHRvIHRoZSBpbnRlcmZh
Y2U/ICovDQotCSAgICAgIGlmIChpcHQtPnRhYmxlW2lwX2NudF0uZHdJbmRl
eCA9PSBpZnQtPnRhYmxlW2lmX2NudF0uZHdJbmRleCkNCi0JCXsNCi0JCSAg
LyogU2V0dXAgdGhlIGludGVyZmFjZSBuYW1lICovDQotCQkgIHN3aXRjaCAo
aWZ0LT50YWJsZVtpZl9jbnRdLmR3VHlwZSkNCi0JCSAgICB7DQotCQkgICAg
ICBjYXNlIE1JQl9JRl9UWVBFX1RPS0VOUklORzoNCi0JCQkrKyp0b2s7DQot
CQkJc3RyY3B5IChpZnItPmlmcl9uYW1lLCAidG9rIik7DQotCQkJc3RyY2F0
IChpZnItPmlmcl9uYW1lLCB0b2spOw0KLQkJCWJyZWFrOw0KLQkJICAgICAg
Y2FzZSBNSUJfSUZfVFlQRV9FVEhFUk5FVDoNCi0JCQlpZiAoKnN1YiA9PSAn
MCcpDQotCQkJICArKypldGg7DQotCQkJc3RyY3B5IChpZnItPmlmcl9uYW1l
LCAiZXRoIik7DQotCQkJc3RyY2F0IChpZnItPmlmcl9uYW1lLCBldGgpOw0K
LQkJCWJyZWFrOw0KLQkJICAgICAgY2FzZSBNSUJfSUZfVFlQRV9QUFA6DQot
CQkJKysqcHBwOw0KLQkJCXN0cmNweSAoaWZyLT5pZnJfbmFtZSwgInBwcCIp
Ow0KLQkJCXN0cmNhdCAoaWZyLT5pZnJfbmFtZSwgcHBwKTsNCi0JCQlicmVh
azsNCi0JCSAgICAgIGNhc2UgTUlCX0lGX1RZUEVfU0xJUDoNCi0JCQkrKypz
bHA7DQotCQkJc3RyY3B5IChpZnItPmlmcl9uYW1lLCAic2xwIik7DQotCQkJ
c3RyY2F0IChpZnItPmlmcl9uYW1lLCBzbHApOw0KLQkJCWJyZWFrOw0KLQkJ
ICAgICAgY2FzZSBNSUJfSUZfVFlQRV9MT09QQkFDSzoNCi0JCQlzdHJjcHkg
KGlmci0+aWZyX25hbWUsICJsbyIpOw0KLQkJCWJyZWFrOw0KLQkJICAgICAg
ZGVmYXVsdDoNCi0JCQljb250aW51ZTsNCi0JCSAgICB9DQotCQkgIGlmICgq
c3ViID4gJzAnKQ0KLQkJICAgIHsNCi0JCSAgICAgIHN0cmNhdCAoaWZyLT5p
ZnJfbmFtZSwgIjoiKTsNCi0JCSAgICAgIHN0cmNhdCAoaWZyLT5pZnJfbmFt
ZSwgc3ViKTsNCi0JCSAgICB9DQotCQkgICsrKnN1YjsNCi0JCSAgLyogc2V0
dXAgc29ja2FkZHIgc3RydWN0ICovDQotCQkgIHN3aXRjaCAod2hhdCkNCi0J
CSAgICB7DQotCQkgICAgICBjYXNlIFNJT0NHSUZDT05GOg0KLQkJICAgICAg
Y2FzZSBTSU9DR0lGQUREUjoNCi0JCQlzYSA9IChzdHJ1Y3Qgc29ja2FkZHJf
aW4gKikgJmlmci0+aWZyX2FkZHI7DQotCQkJc2EtPnNpbl9hZGRyLnNfYWRk
ciA9IGlwdC0+dGFibGVbaXBfY250XS5kd0FkZHI7DQotCQkJc2EtPnNpbl9m
YW1pbHkgPSBBRl9JTkVUOw0KLQkJCXNhLT5zaW5fcG9ydCA9IDA7DQotCQkJ
YnJlYWs7DQotCQkgICAgICBjYXNlIFNJT0NHSUZCUkRBRERSOg0KLQkJCXNh
ID0gKHN0cnVjdCBzb2NrYWRkcl9pbiAqKSAmaWZyLT5pZnJfYnJvYWRhZGRy
Ow0KKwkgICAgY2FzZSBNSUJfSUZfVFlQRV9UT0tFTlJJTkc6DQorICAgICAg
ICAgICAgICBpZiAoaWZFbnRyeS0+ZW51bWVyYXRlZCA9PSAwKSB7DQorICAg
ICAgICAgICAgICAgIGlmRW50cnktPmNsYXNzSWQgPSB0b2tJZCsrOw0KKwkg
ICAgICAgIF9fc21hbGxfc3ByaW50ZihpZnItPmlmcl9uYW1lLCAidG9rJXUi
LCBpZkVudHJ5LT5jbGFzc0lkKTsNCisgICAgICAgICAgICAgIH0gZWxzZSB7
DQorCSAgICAgICAgX19zbWFsbF9zcHJpbnRmKGlmci0+aWZyX25hbWUsICJ0
b2sldToldSIsIGlmRW50cnktPmNsYXNzSWQsIA0KKyAgICAgICAgICAgICAg
ICAgIGlmRW50cnktPmVudW1lcmF0ZWQtMSk7DQorICAgICAgICAgICAgICB9
DQorICAgICAgICAgICAgICBpZkVudHJ5LT5lbnVtZXJhdGVkKys7DQorCSAg
ICAgIGJyZWFrOw0KKwkgICAgY2FzZSBNSUJfSUZfVFlQRV9FVEhFUk5FVDoN
CisgICAgICAgICAgICAgIGlmIChpZkVudHJ5LT5lbnVtZXJhdGVkID09IDAp
IHsNCisgICAgICAgICAgICAgICAgaWZFbnRyeS0+Y2xhc3NJZCA9IGV0aElk
Kys7DQorCSAgICAgICAgX19zbWFsbF9zcHJpbnRmKGlmci0+aWZyX25hbWUs
ICJldGgldSIsIGlmRW50cnktPmNsYXNzSWQpOw0KKyAgICAgICAgICAgICAg
fSBlbHNlIHsNCisJICAgICAgICBfX3NtYWxsX3NwcmludGYoaWZyLT5pZnJf
bmFtZSwgImV0aCV1OiV1IiwgaWZFbnRyeS0+Y2xhc3NJZCwgDQorICAgICAg
ICAgICAgICAgICAgaWZFbnRyeS0+ZW51bWVyYXRlZC0xKTsNCisgICAgICAg
ICAgICAgIH0NCisgICAgICAgICAgICAgIGlmRW50cnktPmVudW1lcmF0ZWQr
KzsNCisJICAgICAgYnJlYWs7DQorCSAgICBjYXNlIE1JQl9JRl9UWVBFX1BQ
UDoNCisgICAgICAgICAgICAgIGlmIChpZkVudHJ5LT5lbnVtZXJhdGVkID09
IDApIHsNCisgICAgICAgICAgICAgICAgaWZFbnRyeS0+Y2xhc3NJZCA9IHBw
cElkKys7DQorCSAgICAgICAgX19zbWFsbF9zcHJpbnRmKGlmci0+aWZyX25h
bWUsICJwcHAldSIsIGlmRW50cnktPmNsYXNzSWQpOw0KKyAgICAgICAgICAg
ICAgfSBlbHNlIHsNCisJICAgICAgICBfX3NtYWxsX3NwcmludGYoaWZyLT5p
ZnJfbmFtZSwgInBwcCV1OiV1IiwgaWZFbnRyeS0+Y2xhc3NJZCwgDQorICAg
ICAgICAgICAgICAgICAgaWZFbnRyeS0+ZW51bWVyYXRlZC0xKTsNCisgICAg
ICAgICAgICAgIH0NCisgICAgICAgICAgICAgIGlmRW50cnktPmVudW1lcmF0
ZWQrKzsNCisJICAgICAgYnJlYWs7DQorCSAgICBjYXNlIE1JQl9JRl9UWVBF
X1NMSVA6DQorICAgICAgICAgICAgICBpZiAoaWZFbnRyeS0+ZW51bWVyYXRl
ZCA9PSAwKSB7DQorICAgICAgICAgICAgICAgIGlmRW50cnktPmNsYXNzSWQg
PSBzbHBJZCsrOw0KKwkgICAgICAgIF9fc21hbGxfc3ByaW50ZihpZnItPmlm
cl9uYW1lLCAic2xwJXUiLCBpZkVudHJ5LT5jbGFzc0lkKTsNCisgICAgICAg
ICAgICAgIH0gZWxzZSB7DQorCSAgICAgICAgX19zbWFsbF9zcHJpbnRmKGlm
ci0+aWZyX25hbWUsICJzbHAldToldSIsIGlmRW50cnktPmNsYXNzSWQsIA0K
KyAgICAgICAgICAgICAgICAgIGlmRW50cnktPmVudW1lcmF0ZWQtMSk7DQor
ICAgICAgICAgICAgICB9DQorICAgICAgICAgICAgICBpZkVudHJ5LT5lbnVt
ZXJhdGVkKys7DQorCSAgICAgIGJyZWFrOw0KKwkgICAgY2FzZSBNSUJfSUZf
VFlQRV9MT09QQkFDSzoNCisJICAgICAgc3RyY3B5IChpZnItPmlmcl9uYW1l
LCAibG8iKTsNCisJICAgICAgYnJlYWs7DQorCSAgICBkZWZhdWx0Og0KKwkg
ICAgICBjb250aW51ZTsNCisJICAgIH0NCisJICAvKiBzZXR1cCBzb2NrYWRk
ciBzdHJ1Y3QgKi8NCisJICBzd2l0Y2ggKHdoYXQpDQorCSAgICB7DQorCSAg
ICBjYXNlIFNJT0NHSUZDT05GOg0KKwkgICAgY2FzZSBTSU9DR0lGQUREUjoN
CisJICAgICAgc2EgPSAoc3RydWN0IHNvY2thZGRyX2luICopICZpZnItPmlm
cl9hZGRyOw0KKwkgICAgICBzYS0+c2luX2FkZHIuc19hZGRyID0gaXB0LT50
YWJsZVtpcF9jbnRdLmR3QWRkcjsNCisJICAgICAgc2EtPnNpbl9mYW1pbHkg
PSBBRl9JTkVUOw0KKwkgICAgICBzYS0+c2luX3BvcnQgPSAwOw0KKwkgICAg
ICBicmVhazsNCisJICAgIGNhc2UgU0lPQ0dJRkJSREFERFI6DQorCSAgICAg
IHNhID0gKHN0cnVjdCBzb2NrYWRkcl9pbiAqKSAmaWZyLT5pZnJfYnJvYWRh
ZGRyOw0KICNpZiAwDQotCQkJLyogVW5mb3J0dW5hdGVseSwgdGhlIGZpZWxk
IHJldHVybnMgb25seSBjcmFwLiAqLw0KLQkJCXNhLT5zaW5fYWRkci5zX2Fk
ZHIgPSBpcHQtPnRhYmxlW2lwX2NudF0uZHdCQ2FzdEFkZHI7DQorCSAgICAg
IC8qIFVuZm9ydHVuYXRlbHksIHRoZSBmaWVsZCByZXR1cm5zIG9ubHkgY3Jh
cC4gKi8NCisJICAgICAgc2EtPnNpbl9hZGRyLnNfYWRkciA9IGlwdC0+dGFi
bGVbaXBfY250XS5kd0JDYXN0QWRkcjsNCiAjZWxzZQ0KLQkJCWxpcCA9IGlw
dC0+dGFibGVbaXBfY250XS5kd0FkZHI7DQotCQkJbG5wID0gaXB0LT50YWJs
ZVtpcF9jbnRdLmR3TWFzazsNCi0JCQlzYS0+c2luX2FkZHIuc19hZGRyID0g
bGlwICYgbG5wIHwgfmxucDsNCi0JCQlzYS0+c2luX2ZhbWlseSA9IEFGX0lO
RVQ7DQotCQkJc2EtPnNpbl9wb3J0ID0gMDsNCisJICAgICAgbGlwID0gaXB0
LT50YWJsZVtpcF9jbnRdLmR3QWRkcjsNCisJICAgICAgbG5wID0gaXB0LT50
YWJsZVtpcF9jbnRdLmR3TWFzazsNCisJICAgICAgc2EtPnNpbl9hZGRyLnNf
YWRkciA9IGxpcCAmIGxucCB8IH5sbnA7DQorCSAgICAgIHNhLT5zaW5fZmFt
aWx5ID0gQUZfSU5FVDsNCisJICAgICAgc2EtPnNpbl9wb3J0ID0gMDsNCiAj
ZW5kaWYNCi0JCQlicmVhazsNCi0JCSAgICAgIGNhc2UgU0lPQ0dJRk5FVE1B
U0s6DQotCQkJc2EgPSAoc3RydWN0IHNvY2thZGRyX2luICopICZpZnItPmlm
cl9uZXRtYXNrOw0KLQkJCXNhLT5zaW5fYWRkci5zX2FkZHIgPSBpcHQtPnRh
YmxlW2lwX2NudF0uZHdNYXNrOw0KLQkJCXNhLT5zaW5fZmFtaWx5ID0gQUZf
SU5FVDsNCi0JCQlzYS0+c2luX3BvcnQgPSAwOw0KLQkJCWJyZWFrOw0KLQkJ
ICAgICAgY2FzZSBTSU9DR0lGSFdBRERSOg0KLQkJCXNvID0gJmlmci0+aWZy
X2h3YWRkcjsNCi0JCQlmb3IgKFVJTlQgaSA9IDA7IGkgPCBJRkhXQUREUkxF
TjsgKytpKQ0KLQkJCSAgaWYgKGkgPj0gaWZ0LT50YWJsZVtpZl9jbnRdLmR3
UGh5c0FkZHJMZW4pDQotCQkJICAgIHNvLT5zYV9kYXRhW2ldID0gJ1wwJzsN
Ci0JCQkgIGVsc2UNCi0JCQkgICAgc28tPnNhX2RhdGFbaV0gPSBpZnQtPnRh
YmxlW2lmX2NudF0uYlBoeXNBZGRyW2ldOw0KLQkJCXNvLT5zYV9mYW1pbHkg
PSBBRl9JTkVUOw0KLQkJCWJyZWFrOw0KLQkJICAgICAgY2FzZSBTSU9DR0lG
TUVUUklDOg0KLQkJCWlmci0+aWZyX21ldHJpYyA9IDE7DQotCQkJYnJlYWs7
DQotCQkgICAgICBjYXNlIFNJT0NHSUZNVFU6DQotCQkJaWZyLT5pZnJfbXR1
ID0gaWZ0LT50YWJsZVtpZl9jbnRdLmR3TXR1Ow0KLQkJCWJyZWFrOw0KLQkJ
ICAgIH0NCi0JCSAgKytjbnQ7DQotCQkgIGlmICgoY2FkZHJfdCkgKytpZnIg
Pg0KLQkJICAgICAgaWZjLT5pZmNfYnVmICsgaWZjLT5pZmNfbGVuIC0gc2l6
ZW9mIChzdHJ1Y3QgaWZyZXEpKQ0KLQkJICAgIGdvdG8gZG9uZTsNCi0JCX0N
CisJICAgICAgYnJlYWs7DQorCSAgICBjYXNlIFNJT0NHSUZORVRNQVNLOg0K
KwkgICAgICBzYSA9IChzdHJ1Y3Qgc29ja2FkZHJfaW4gKikgJmlmci0+aWZy
X25ldG1hc2s7DQorCSAgICAgIHNhLT5zaW5fYWRkci5zX2FkZHIgPSBpcHQt
PnRhYmxlW2lwX2NudF0uZHdNYXNrOw0KKwkgICAgICBzYS0+c2luX2ZhbWls
eSA9IEFGX0lORVQ7DQorCSAgICAgIHNhLT5zaW5fcG9ydCA9IDA7DQorCSAg
ICAgIGJyZWFrOw0KKwkgICAgY2FzZSBTSU9DR0lGSFdBRERSOg0KKwkgICAg
ICBzbyA9ICZpZnItPmlmcl9od2FkZHI7DQorCSAgICAgIGZvciAoVUlOVCBp
ID0gMDsgaSA8IElGSFdBRERSTEVOOyArK2kpDQorCQlpZiAoaSA+PSBpZnJv
dy0+ZHdQaHlzQWRkckxlbikNCisJCSAgc28tPnNhX2RhdGFbaV0gPSAnXDAn
Ow0KKwkJZWxzZQ0KKwkJICBzby0+c2FfZGF0YVtpXSA9IGlmcm93LT5iUGh5
c0FkZHJbaV07DQorCSAgICAgIHNvLT5zYV9mYW1pbHkgPSBBRl9JTkVUOw0K
KwkgICAgICBicmVhazsNCisJICAgIGNhc2UgU0lPQ0dJRk1FVFJJQzoNCisJ
ICAgICAgaWZyLT5pZnJfbWV0cmljID0gaWZFbnRyeS0+bWV0cmljOw0KKwkg
ICAgICBicmVhazsNCisJICAgIGNhc2UgU0lPQ0dJRk1UVToNCisJICAgICAg
aWZyLT5pZnJfbXR1ID0gaWZyb3ctPmR3TXR1Ow0KKwkgICAgICBicmVhazsN
CiAJICAgIH0NCisJICArK2NudDsNCisJICBpZiAoKGNhZGRyX3QpKysgaWZy
ID4NCisJICAgICAgaWZjLT5pZmNfYnVmICsgaWZjLT5pZmNfbGVuIC0gc2l6
ZW9mIChzdHJ1Y3QgaWZyZXEpKQ0KKwkgICAgZ290byBkb25lOw0KIAl9DQog
ICAgIH0NCisNCiBkb25lOg0KICAgLyogU2V0IHRoZSBjb3JyZWN0IGxlbmd0
aCAqLw0KICAgaWZjLT5pZmNfbGVuID0gY250ICogc2l6ZW9mIChzdHJ1Y3Qg
aWZyZXEpOw0KLS0tIHdpbnN1cC9jeWd3aW4vYXV0b2xvYWQuY2Mub3JpZwlT
YXQgTm92ICA5IDE4OjM2OjUyIDIwMDINCisrKyB3aW5zdXAvY3lnd2luL2F1
dG9sb2FkLmNjCVNhdCBOb3YgIDkgMTg6NDI6MTcgMjAwMg0KQEAgLTQ4NSw3
ICs0ODUsOSBAQCBMb2FkRExMZnVuY0V4IChXU0FFdmVudFNlbGVjdCwgMTIs
IHdzMl8zDQogTG9hZERMTGZ1bmNFeCAoV1NBRW51bU5ldHdvcmtFdmVudHMs
IDEyLCB3czJfMzIsIDEpDQogDQogTG9hZERMTGZ1bmNFeCAoR2V0SWZUYWJs
ZSwgMTIsIGlwaGxwYXBpLCAxKQ0KK0xvYWRETExmdW5jRXggKEdldElmRW50
cnksIDQsIGlwaGxwYXBpLCAxKQ0KIExvYWRETExmdW5jRXggKEdldElwQWRk
clRhYmxlLCAxMiwgaXBobHBhcGksIDEpDQorTG9hZERMTGZ1bmNFeCAoR2V0
SXBGb3J3YXJkVGFibGUsIDEyLCBpcGhscGFwaSwgMSkNCiANCiBMb2FkRExM
ZnVuYyAoQ29Jbml0aWFsaXplLCA0LCBvbGUzMikNCiBMb2FkRExMZnVuYyAo
Q29VbmluaXRpYWxpemUsIDAsIG9sZTMyKQ0K

---1463760102-51089904-1036869446=:23266--
