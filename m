Return-Path: <cygwin-patches-return-9341-listarch-cygwin-patches=sources.redhat.com@cygwin.com>
Received: (qmail 129409 invoked by alias); 14 Apr 2019 19:16:04 -0000
Mailing-List: contact cygwin-patches-help@cygwin.com; run by ezmlm
Precedence: bulk
List-Id: <cygwin-patches.cygwin.com>
List-Subscribe: <mailto:cygwin-patches-subscribe@cygwin.com>
List-Post: <mailto:cygwin-patches@cygwin.com>
List-Archive: <http://sourceware.org/ml/cygwin-patches/>
List-Help: <mailto:cygwin-patches-help@cygwin.com>, <http://sourceware.org/ml/#faqs>
Sender: cygwin-patches-owner@cygwin.com
Mail-Followup-To: cygwin-patches@cygwin.com
Received: (qmail 129292 invoked by uid 89); 14 Apr 2019 19:16:04 -0000
Authentication-Results: sourceware.org; auth=none
X-Spam-SWARE-Status: No, score=-17.8 required=5.0 tests=AWL,BAYES_00,GIT_PATCH_0,GIT_PATCH_1,GIT_PATCH_2,GIT_PATCH_3,MIME_BASE64_BLANKS,RCVD_IN_DNSWL_NONE,SPF_HELO_PASS,SPF_PASS autolearn=ham version=3.3.1 spammy=1989, holds, Client, connect
X-HELO: NAM05-DM3-obe.outbound.protection.outlook.com
Received: from mail-eopbgr730117.outbound.protection.outlook.com (HELO NAM05-DM3-obe.outbound.protection.outlook.com) (40.107.73.117) by sourceware.org (qpsmtpd/0.93/v0.84-503-g423c35a) with ESMTP; Sun, 14 Apr 2019 19:16:01 +0000
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=cornell.edu; s=selector1; h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck; bh=VO9lkrnyIR1XmCDSW/gL3fib34xijEamEiN3DjijoDA=; b=O7xIpGtNXLRZFKPxQN+I0sXefFhpMhK7aKs7Mwi1DuEdCPPINofO2LH/6kImZPFvcipUuiAYGNtHu11m5JK8eE3FmUhli21P+OW8tEQe9IkP//tcwu7e4RAxxyQzlJO45GThs9p97M0lQY+Y83QenMMn+U8ZNLw+ssEfM+mYhOw=
Received: from DM6PR04MB5211.namprd04.prod.outlook.com (20.178.24.208) by DM6PR04MB3963.namprd04.prod.outlook.com (20.176.87.20) with Microsoft SMTP Server (version=TLS1_2, cipher=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384) id 15.20.1792.19; Sun, 14 Apr 2019 19:15:56 +0000
Received: from DM6PR04MB5211.namprd04.prod.outlook.com ([fe80::21bb:c809:f459:845c]) by DM6PR04MB5211.namprd04.prod.outlook.com ([fe80::21bb:c809:f459:845c%2]) with mapi id 15.20.1792.018; Sun, 14 Apr 2019 19:15:56 +0000
From: Ken Brown <kbrown@cornell.edu>
To: "cygwin-patches@cygwin.com" <cygwin-patches@cygwin.com>
Subject: [PATCH 01/14] Cygwin: FIFO: rename client[] to fc_handler[]
Date: Sun, 14 Apr 2019 19:16:00 -0000
Message-ID: <20190414191543.3218-2-kbrown@cornell.edu>
References: <20190414191543.3218-1-kbrown@cornell.edu>
In-Reply-To: <20190414191543.3218-1-kbrown@cornell.edu>
authentication-results: spf=none (sender IP is ) smtp.mailfrom=kbrown@cornell.edu;
received-spf: None (protection.outlook.com: cornell.edu does not designate permitted sender hosts)
x-ms-exchange-senderadcheck: 1
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
MIME-Version: 1.0
X-MS-Exchange-CrossTenant-mailboxtype: HOSTED
X-IsSubscribed: yes
X-SW-Source: 2019-q2/txt/msg00055.txt.bz2

VGhlIHdvcmQgImNsaWVudCIgc3VnZ2VzdHMgc29tZXRoaW5nIHRoYXQgaG9s
ZHMgYSBoYW5kbGUgdG8gdGhlIGNsaWVudA0Kc2lkZSBvZiB0aGUgcGlwZSAo
aW4gV2luZG93cyB0ZXJtaW5vbG9neSkuICBCdXQgb3VyDQpmaWZvX2NsaWVu
dF9oYW5kbGVycyBob2xkIGEgaGFuZGxlIHRoZSBzZXJ2ZXIgc2lkZSBvZiB0
aGUgcGlwZSwgYW5kDQp0aGV5ICpjb25uZWN0KiB0byBjbGllbnRzLg0KLS0t
DQogd2luc3VwL2N5Z3dpbi9maGFuZGxlci5oICAgICAgIHwgMjAgKysrLS0t
LQ0KIHdpbnN1cC9jeWd3aW4vZmhhbmRsZXJfZmlmby5jYyB8IDk2ICsrKysr
KysrKysrKysrKysrLS0tLS0tLS0tLS0tLS0tLS0NCiB3aW5zdXAvY3lnd2lu
L3NlbGVjdC5jYyAgICAgICAgfCAgMiArLQ0KIDMgZmlsZXMgY2hhbmdlZCwg
NTkgaW5zZXJ0aW9ucygrKSwgNTkgZGVsZXRpb25zKC0pDQoNCmRpZmYgLS1n
aXQgYS93aW5zdXAvY3lnd2luL2ZoYW5kbGVyLmggYi93aW5zdXAvY3lnd2lu
L2ZoYW5kbGVyLmgNCmluZGV4IGJjNjYzNzdjZC4uMjg5OGRiNGRmIDEwMDY0
NA0KLS0tIGEvd2luc3VwL2N5Z3dpbi9maGFuZGxlci5oDQorKysgYi93aW5z
dXAvY3lnd2luL2ZoYW5kbGVyLmgNCkBAIC0xMjY5LDggKzEyNjksOCBAQCBj
bGFzcyBmaGFuZGxlcl9maWZvOiBwdWJsaWMgZmhhbmRsZXJfYmFzZQ0KICAg
SEFORExFIGxjdF90ZXJtaW5hdGlvbl9ldnQ7DQogICBVTklDT0RFX1NUUklO
RyBwaXBlX25hbWU7DQogICBXQ0hBUiBwaXBlX25hbWVfYnVmW0NZR1dJTl9G
SUZPX1BJUEVfTkFNRV9MRU4gKyAxXTsNCi0gIGZpZm9fY2xpZW50X2hhbmRs
ZXIgY2xpZW50W01BWF9DTElFTlRTXTsNCi0gIGludCBuY2xpZW50cywgbmNv
bm5lY3RlZDsNCisgIGZpZm9fY2xpZW50X2hhbmRsZXIgZmNfaGFuZGxlcltN
QVhfQ0xJRU5UU107DQorICBpbnQgbmhhbmRsZXJzLCBuY29ubmVjdGVkOw0K
ICAgYWZfdW5peF9zcGlubG9ja190IF9maWZvX2NsaWVudF9sb2NrOw0KICAg
Ym9vbCBfZHVwbGV4ZXI7DQogICBib29sIF9fcmVnMiB3YWl0IChIQU5ETEUp
Ow0KQEAgLTEyNzgsMTUgKzEyNzgsMTUgQEAgY2xhc3MgZmhhbmRsZXJfZmlm
bzogcHVibGljIGZoYW5kbGVyX2Jhc2UNCiAgIEhBTkRMRSBjcmVhdGVfcGlw
ZV9pbnN0YW5jZSAoYm9vbCk7DQogICBOVFNUQVRVUyBvcGVuX3BpcGUgKCk7
DQogICBpbnQgZGlzY29ubmVjdF9hbmRfcmVjb25uZWN0IChpbnQpOw0KLSAg
aW50IGFkZF9jbGllbnQgKCk7DQorICBpbnQgYWRkX2NsaWVudF9oYW5kbGVy
ICgpOw0KICAgYm9vbCBsaXN0ZW5fY2xpZW50ICgpOw0KIHB1YmxpYzoNCiAg
IGZoYW5kbGVyX2ZpZm8gKCk7DQogICBib29sIGhpdF9lb2YgKCk7DQotICBp
bnQgZ2V0X25jbGllbnRzICgpIGNvbnN0IHsgcmV0dXJuIG5jbGllbnRzOyB9
DQorICBpbnQgZ2V0X25oYW5kbGVycyAoKSBjb25zdCB7IHJldHVybiBuaGFu
ZGxlcnM7IH0NCiAgIEhBTkRMRSYgZ2V0X2hhbmRsZSAoKSB7IHJldHVybiBm
aGFuZGxlcl9iYXNlOjpnZXRfaGFuZGxlICgpOyB9DQotICBIQU5ETEUgZ2V0
X2hhbmRsZSAoaW50IGkpIGNvbnN0IHsgcmV0dXJuIGNsaWVudFtpXS5maC0+
Z2V0X2hhbmRsZSAoKTsgfQ0KLSAgYm9vbCBpc19jb25uZWN0ZWQgKGludCBp
KSBjb25zdCB7IHJldHVybiBjbGllbnRbaV0uc3RhdGUgPT0gZmNfY29ubmVj
dGVkOyB9DQorICBIQU5ETEUgZ2V0X2hhbmRsZSAoaW50IGkpIGNvbnN0IHsg
cmV0dXJuIGZjX2hhbmRsZXJbaV0uZmgtPmdldF9oYW5kbGUgKCk7IH0NCisg
IGJvb2wgaXNfY29ubmVjdGVkIChpbnQgaSkgY29uc3QgeyByZXR1cm4gZmNf
aGFuZGxlcltpXS5zdGF0ZSA9PSBmY19jb25uZWN0ZWQ7IH0NCiAgIFBVTklD
T0RFX1NUUklORyBnZXRfcGlwZV9uYW1lICgpOw0KICAgRFdPUkQgbGlzdGVu
X2NsaWVudF90aHJlYWQgKCk7DQogICB2b2lkIGZpZm9fY2xpZW50X2xvY2sg
KCkgeyBfZmlmb19jbGllbnRfbG9jay5sb2NrICgpOyB9DQpAQCAtMTMwNSw4
ICsxMzA1LDggQEAgcHVibGljOg0KICAgdm9pZCBjbGVhcl9yZWFkYWhlYWQg
KCkNCiAgIHsNCiAgICAgZmhhbmRsZXJfYmFzZTo6Y2xlYXJfcmVhZGFoZWFk
ICgpOw0KLSAgICBmb3IgKGludCBpID0gMDsgaSA8IG5jbGllbnRzOyBpKysp
DQotICAgICAgY2xpZW50W2ldLmZoLT5jbGVhcl9yZWFkYWhlYWQgKCk7DQor
ICAgIGZvciAoaW50IGkgPSAwOyBpIDwgbmhhbmRsZXJzOyBpKyspDQorICAg
ICAgZmNfaGFuZGxlcltpXS5maC0+Y2xlYXJfcmVhZGFoZWFkICgpOw0KICAg
fQ0KICAgc2VsZWN0X3JlY29yZCAqc2VsZWN0X3JlYWQgKHNlbGVjdF9zdHVm
ZiAqKTsNCiAgIHNlbGVjdF9yZWNvcmQgKnNlbGVjdF93cml0ZSAoc2VsZWN0
X3N0dWZmICopOw0KQEAgLTEzMjYsOCArMTMyNiw4IEBAIHB1YmxpYzoNCiAg
ICAgdm9pZCAqcHRyID0gKHZvaWQgKikgY2NhbGxvYyAobWFsbG9jX3R5cGUs
IDEsIHNpemVvZiAoZmhhbmRsZXJfZmlmbykpOw0KICAgICBmaGFuZGxlcl9m
aWZvICpmaGYgPSBuZXcgKHB0cikgZmhhbmRsZXJfZmlmbyAocHRyKTsNCiAg
ICAgY29weXRvIChmaGYpOw0KLSAgICBmb3IgKGludCBpID0gMDsgaSA8IG5j
bGllbnRzOyBpKyspDQotICAgICAgZmhmLT5jbGllbnRbaV0uZmggPSBjbGll
bnRbaV0uZmgtPmNsb25lICgpOw0KKyAgICBmb3IgKGludCBpID0gMDsgaSA8
IG5oYW5kbGVyczsgaSsrKQ0KKyAgICAgIGZoZi0+ZmNfaGFuZGxlcltpXS5m
aCA9IGZjX2hhbmRsZXJbaV0uZmgtPmNsb25lICgpOw0KICAgICByZXR1cm4g
ZmhmOw0KICAgfQ0KIH07DQpkaWZmIC0tZ2l0IGEvd2luc3VwL2N5Z3dpbi9m
aGFuZGxlcl9maWZvLmNjIGIvd2luc3VwL2N5Z3dpbi9maGFuZGxlcl9maWZv
LmNjDQppbmRleCA2OGI5ZTc3MTcuLjkwMTY5NjQ0NCAxMDA2NDQNCi0tLSBh
L3dpbnN1cC9jeWd3aW4vZmhhbmRsZXJfZmlmby5jYw0KKysrIGIvd2luc3Vw
L2N5Z3dpbi9maGFuZGxlcl9maWZvLmNjDQpAQCAtMzIsNyArMzIsNyBAQCBT
VEFUVVNfUElQRV9FTVBUWSBzaW1wbHkgbWVhbnMgdGhlcmUncyBubyBkYXRh
IHRvIGJlIHJlYWQuICovDQogDQogZmhhbmRsZXJfZmlmbzo6ZmhhbmRsZXJf
ZmlmbyAoKToNCiAgIGZoYW5kbGVyX2Jhc2UgKCksIHJlYWRfcmVhZHkgKE5V
TEwpLCB3cml0ZV9yZWFkeSAoTlVMTCksDQotICBsaXN0ZW5fY2xpZW50X3Ro
ciAoTlVMTCksIGxjdF90ZXJtaW5hdGlvbl9ldnQgKE5VTEwpLCBuY2xpZW50
cyAoMCksDQorICBsaXN0ZW5fY2xpZW50X3RociAoTlVMTCksIGxjdF90ZXJt
aW5hdGlvbl9ldnQgKE5VTEwpLCBuaGFuZGxlcnMgKDApLA0KICAgbmNvbm5l
Y3RlZCAoMCksIF9kdXBsZXhlciAoZmFsc2UpDQogew0KICAgcGlwZV9uYW1l
X2J1ZlswXSA9IEwnXDAnOw0KQEAgLTE0Niw3ICsxNDYsNyBAQCBmaGFuZGxl
cl9maWZvOjpkaXNjb25uZWN0X2FuZF9yZWNvbm5lY3QgKGludCBpKQ0KIHsN
CiAgIE5UU1RBVFVTIHN0YXR1czsNCiAgIElPX1NUQVRVU19CTE9DSyBpbzsN
Ci0gIEhBTkRMRSBwaCA9IGNsaWVudFtpXS5maC0+Z2V0X2hhbmRsZSAoKTsN
CisgIEhBTkRMRSBwaCA9IGZjX2hhbmRsZXJbaV0uZmgtPmdldF9oYW5kbGUg
KCk7DQogDQogICBzdGF0dXMgPSBOdEZzQ29udHJvbEZpbGUgKHBoLCBOVUxM
LCBOVUxMLCBOVUxMLCAmaW8sIEZTQ1RMX1BJUEVfRElTQ09OTkVDVCwNCiAJ
CQkgICAgTlVMTCwgMCwgTlVMTCwgMCk7DQpAQCAtMTU5LDEwICsxNTksMTAg
QEAgZmhhbmRsZXJfZmlmbzo6ZGlzY29ubmVjdF9hbmRfcmVjb25uZWN0IChp
bnQgaSkNCiAgICAgICBfX3NldGVycm5vX2Zyb21fbnRfc3RhdHVzIChzdGF0
dXMpOw0KICAgICAgIHJldHVybiAtMTsNCiAgICAgfQ0KLSAgc2V0X3BpcGVf
bm9uX2Jsb2NraW5nIChjbGllbnRbaV0uZmgtPmdldF9oYW5kbGUgKCksIGZh
bHNlKTsNCi0gIGlmIChjbGllbnRbaV0uY29ubmVjdCAoKSA8IDApDQorICBz
ZXRfcGlwZV9ub25fYmxvY2tpbmcgKGZjX2hhbmRsZXJbaV0uZmgtPmdldF9o
YW5kbGUgKCksIGZhbHNlKTsNCisgIGlmIChmY19oYW5kbGVyW2ldLmNvbm5l
Y3QgKCkgPCAwKQ0KICAgICByZXR1cm4gLTE7DQotICBpZiAoY2xpZW50W2ld
LnN0YXRlID09IGZjX2Nvbm5lY3RlZCkNCisgIGlmIChmY19oYW5kbGVyW2ld
LnN0YXRlID09IGZjX2Nvbm5lY3RlZCkNCiAgICAgbmNvbm5lY3RlZCsrOw0K
ICAgcmV0dXJuIDA7DQogfQ0KQEAgLTE5OCw5ICsxOTgsOSBAQCBmaGFuZGxl
cl9maWZvOjpucGZzX2hhbmRsZSAoSEFORExFICZucGgpDQogfQ0KIA0KIC8q
IENhbGxlZCB3aGVuIGEgRklGTyBpcyBmaXJzdCBvcGVuZWQgZm9yIHJlYWRp
bmcgYW5kIGFnYWluIGVhY2ggdGltZQ0KLSAgIGEgbmV3IGNsaWVudCBpcyBu
ZWVkZWQuICBFYWNoIHBpcGUgaW5zdGFuY2UgaXMgY3JlYXRlZCBpbiBibG9j
a2luZw0KLSAgIG1vZGUgc28gdGhhdCB3ZSBjYW4gZWFzaWx5IHdhaXQgZm9y
IGEgY29ubmVjdGlvbi4gIEFmdGVyIGl0IGlzDQotICAgY29ubmVjdGVkLCBp
dCBpcyBwdXQgaW4gbm9uYmxvY2tpbmcgbW9kZS4gKi8NCisgICBhIG5ldyBj
bGllbnQgaGFuZGxlciBpcyBuZWVkZWQuICBFYWNoIHBpcGUgaW5zdGFuY2Ug
aXMgY3JlYXRlZCBpbg0KKyAgIGJsb2NraW5nIG1vZGUgc28gdGhhdCB3ZSBj
YW4gZWFzaWx5IHdhaXQgZm9yIGEgY29ubmVjdGlvbi4gIEFmdGVyDQorICAg
aXQgaXMgY29ubmVjdGVkLCBpdCBpcyBwdXQgaW4gbm9uYmxvY2tpbmcgbW9k
ZS4gKi8NCiBIQU5ETEUNCiBmaGFuZGxlcl9maWZvOjpjcmVhdGVfcGlwZV9p
bnN0YW5jZSAoYm9vbCBmaXJzdCkNCiB7DQpAQCAtMjcxLDEzICsyNzEsMTMg
QEAgZmhhbmRsZXJfZmlmbzo6b3Blbl9waXBlICgpDQogfQ0KIA0KIGludA0K
LWZoYW5kbGVyX2ZpZm86OmFkZF9jbGllbnQgKCkNCitmaGFuZGxlcl9maWZv
OjphZGRfY2xpZW50X2hhbmRsZXIgKCkNCiB7DQogICBmaWZvX2NsaWVudF9o
YW5kbGVyIGZjOw0KICAgZmhhbmRsZXJfYmFzZSAqZmg7DQotICBib29sIGZp
cnN0ID0gKG5jbGllbnRzID09IDApOw0KKyAgYm9vbCBmaXJzdCA9IChuaGFu
ZGxlcnMgPT0gMCk7DQogDQotICBpZiAobmNsaWVudHMgPT0gTUFYX0NMSUVO
VFMpDQorICBpZiAobmhhbmRsZXJzID09IE1BWF9DTElFTlRTKQ0KICAgICB7
DQogICAgICAgc2V0X2Vycm5vIChFTUZJTEUpOw0KICAgICAgIHJldHVybiAt
MTsNCkBAIC0zMDIsNyArMzAyLDcgQEAgZmhhbmRsZXJfZmlmbzo6YWRkX2Ns
aWVudCAoKQ0KICAgICB9DQogICBpZiAoZmMuc3RhdGUgPT0gZmNfY29ubmVj
dGVkKQ0KICAgICBuY29ubmVjdGVkKys7DQotICBjbGllbnRbbmNsaWVudHMr
K10gPSBmYzsNCisgIGZjX2hhbmRsZXJbbmhhbmRsZXJzKytdID0gZmM7DQog
ICByZXR1cm4gMDsNCiBlcnJvdXQ6DQogICBkZWxldGUgZmg7DQpAQCAtMzUz
LDggKzM1Myw4IEBAIGZoYW5kbGVyX2ZpZm86Omxpc3Rlbl9jbGllbnRfdGhy
ZWFkICgpDQogDQogICAgICAgZmlmb19jbGllbnRfbG9jayAoKTsNCiAgICAg
ICBmb3VuZCA9IGZhbHNlOw0KLSAgICAgIGZvciAoaSA9IDA7IGkgPCBuY2xp
ZW50czsgaSsrKQ0KLQlzd2l0Y2ggKGNsaWVudFtpXS5zdGF0ZSkNCisgICAg
ICBmb3IgKGkgPSAwOyBpIDwgbmhhbmRsZXJzOyBpKyspDQorCXN3aXRjaCAo
ZmNfaGFuZGxlcltpXS5zdGF0ZSkNCiAJICB7DQogCSAgY2FzZSBmY19pbnZh
bGlkOg0KIAkgICAgaWYgKGRpc2Nvbm5lY3RfYW5kX3JlY29ubmVjdCAoaSkg
PCAwKQ0KQEAgLTM2NCwyMCArMzY0LDIwIEBAIGZoYW5kbGVyX2ZpZm86Omxp
c3Rlbl9jbGllbnRfdGhyZWFkICgpDQogCSAgICAgIH0NCiAJICAgIC8qIEZh
bGwgdGhyb3VnaC4gKi8NCiAJICBjYXNlIGZjX2Nvbm5lY3RlZDoNCi0JICAg
IHdbaV0gPSBjbGllbnRbaV0uZHVtbXlfZXZ0Ow0KKwkgICAgd1tpXSA9IGZj
X2hhbmRsZXJbaV0uZHVtbXlfZXZ0Ow0KIAkgICAgYnJlYWs7DQogCSAgY2Fz
ZSBmY19jb25uZWN0aW5nOg0KIAkgICAgZm91bmQgPSB0cnVlOw0KLQkgICAg
d1tpXSA9IGNsaWVudFtpXS5jb25uZWN0X2V2dDsNCisJICAgIHdbaV0gPSBm
Y19oYW5kbGVyW2ldLmNvbm5lY3RfZXZ0Ow0KIAkgICAgYnJlYWs7DQogCSAg
Y2FzZSBmY191bmtub3duOgkvKiBTaG91bGRuJ3QgaGFwcGVuLiAqLw0KIAkg
IGRlZmF1bHQ6DQogCSAgICBicmVhazsNCiAJICB9DQotICAgICAgd1tuY2xp
ZW50c10gPSBsY3RfdGVybWluYXRpb25fZXZ0Ow0KKyAgICAgIHdbbmhhbmRs
ZXJzXSA9IGxjdF90ZXJtaW5hdGlvbl9ldnQ7DQogICAgICAgaW50IHJlcyA9
IDA7DQogICAgICAgaWYgKCFmb3VuZCkNCi0JcmVzID0gYWRkX2NsaWVudCAo
KTsNCisJcmVzID0gYWRkX2NsaWVudF9oYW5kbGVyICgpOw0KICAgICAgIGZp
Zm9fY2xpZW50X3VubG9jayAoKTsNCiAgICAgICBpZiAocmVzIDwgMCkNCiAJ
Z290byBlcnJvdXQ7DQpAQCAtMzkxLDE4ICszOTEsMTggQEAgZmhhbmRsZXJf
Zmlmbzo6bGlzdGVuX2NsaWVudF90aHJlYWQgKCkNCiAJfQ0KIA0KICAgICAg
IC8qIFdhaXQgZm9yIGEgY2xpZW50IHRvIGNvbm5lY3QuICovDQotICAgICAg
d2FpdF9yZXQgPSBXYWl0Rm9yTXVsdGlwbGVPYmplY3RzIChuY2xpZW50cyAr
IDEsIHcsIGZhbHNlLCBJTkZJTklURSk7DQorICAgICAgd2FpdF9yZXQgPSBX
YWl0Rm9yTXVsdGlwbGVPYmplY3RzIChuaGFuZGxlcnMgKyAxLCB3LCBmYWxz
ZSwgSU5GSU5JVEUpOw0KICAgICAgIGkgPSB3YWl0X3JldCAtIFdBSVRfT0JK
RUNUXzA7DQotICAgICAgaWYgKGkgPCAwIHx8IGkgPiBuY2xpZW50cykNCisg
ICAgICBpZiAoaSA8IDAgfHwgaSA+IG5oYW5kbGVycykNCiAJZ290byBlcnJv
dXQ7DQotICAgICAgZWxzZSBpZiAoaSA9PSBuY2xpZW50cykJLyogUmVhZGVy
IGlzIGNsb3NpbmcuICovDQorICAgICAgZWxzZSBpZiAoaSA9PSBuaGFuZGxl
cnMpCS8qIFJlYWRlciBpcyBjbG9zaW5nLiAqLw0KIAlyZXR1cm4gMDsNCiAg
ICAgICBlbHNlDQogCXsNCiAJICBmaWZvX2NsaWVudF9sb2NrICgpOw0KLQkg
IGNsaWVudFtpXS5zdGF0ZSA9IGZjX2Nvbm5lY3RlZDsNCisJICBmY19oYW5k
bGVyW2ldLnN0YXRlID0gZmNfY29ubmVjdGVkOw0KIAkgIG5jb25uZWN0ZWQr
KzsNCi0JICBzZXRfcGlwZV9ub25fYmxvY2tpbmcgKGNsaWVudFtpXS5maC0+
Z2V0X2hhbmRsZSAoKSwgdHJ1ZSk7DQorCSAgc2V0X3BpcGVfbm9uX2Jsb2Nr
aW5nIChmY19oYW5kbGVyW2ldLmZoLT5nZXRfaGFuZGxlICgpLCB0cnVlKTsN
CiAJICBmaWZvX2NsaWVudF91bmxvY2sgKCk7DQogCSAgeWllbGQgKCk7DQog
CX0NCkBAIC00NzQsNyArNDc0LDcgQEAgZmhhbmRsZXJfZmlmbzo6b3BlbiAo
aW50IGZsYWdzLCBtb2RlX3QpDQogICAgICAgZ290byBvdXQ7DQogICAgIH0N
CiANCi0gIC8qIElmIHdlJ3JlIGEgZHVwbGV4ZXIsIGNyZWF0ZSB0aGUgcGlw
ZSBhbmQgdGhlIGZpcnN0IGNsaWVudC4gKi8NCisgIC8qIElmIHdlJ3JlIGEg
ZHVwbGV4ZXIsIGNyZWF0ZSB0aGUgcGlwZSBhbmQgdGhlIGZpcnN0IGNsaWVu
dCBoYW5kbGVyLiAqLw0KICAgaWYgKGR1cGxleGVyKQ0KICAgICB7DQogICAg
ICAgSEFORExFIHBoLCBjb25uZWN0X2V2dCwgZHVtbXlfZXZ0Ow0KQEAgLTUx
MSw5ICs1MTEsOSBAQCBmaGFuZGxlcl9maWZvOjpvcGVuIChpbnQgZmxhZ3Ms
IG1vZGVfdCkNCiAJICBDbG9zZUhhbmRsZSAoY29ubmVjdF9ldnQpOw0KIAkg
IGdvdG8gb3V0Ow0KIAl9DQotICAgICAgY2xpZW50WzBdID0gZmlmb19jbGll
bnRfaGFuZGxlciAoZmgsIGZjX2Nvbm5lY3RlZCwgY29ubmVjdF9ldnQsDQor
ICAgICAgZmNfaGFuZGxlclswXSA9IGZpZm9fY2xpZW50X2hhbmRsZXIgKGZo
LCBmY19jb25uZWN0ZWQsIGNvbm5lY3RfZXZ0LA0KIAkJCQkgICAgICAgZHVt
bXlfZXZ0KTsNCi0gICAgICBuY29ubmVjdGVkID0gbmNsaWVudHMgPSAxOw0K
KyAgICAgIG5jb25uZWN0ZWQgPSBuaGFuZGxlcnMgPSAxOw0KICAgICB9DQog
DQogICAvKiBJZiB3ZSdyZSByZWFkaW5nLCBzdGFydCB0aGUgbGlzdGVuX2Ns
aWVudCB0aHJlYWQgKHdoaWNoIHNob3VsZA0KQEAgLTczNiwxMSArNzM2LDEx
IEBAIGZoYW5kbGVyX2ZpZm86OnJhd19yZWFkICh2b2lkICppbl9wdHIsIHNp
emVfdCYgbGVuKQ0KIA0KICAgICAgIC8qIFBvbGwgdGhlIGNvbm5lY3RlZCBj
bGllbnRzIGZvciBpbnB1dC4gKi8NCiAgICAgICBmaWZvX2NsaWVudF9sb2Nr
ICgpOw0KLSAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgbmNsaWVudHM7IGkr
KykNCi0JaWYgKGNsaWVudFtpXS5zdGF0ZSA9PSBmY19jb25uZWN0ZWQpDQor
ICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBuaGFuZGxlcnM7IGkrKykNCisJ
aWYgKGZjX2hhbmRsZXJbaV0uc3RhdGUgPT0gZmNfY29ubmVjdGVkKQ0KIAkg
IHsNCiAJICAgIGxlbiA9IG9yaWdfbGVuOw0KLQkgICAgY2xpZW50W2ldLmZo
LT5maGFuZGxlcl9iYXNlOjpyYXdfcmVhZCAoaW5fcHRyLCBsZW4pOw0KKwkg
ICAgZmNfaGFuZGxlcltpXS5maC0+ZmhhbmRsZXJfYmFzZTo6cmF3X3JlYWQg
KGluX3B0ciwgbGVuKTsNCiAJICAgIHNzaXplX3QgbnJlYWQgPSAoc3NpemVf
dCkgbGVuOw0KIAkgICAgaWYgKG5yZWFkID4gMCkNCiAJICAgICAgew0KQEAg
LTc0OSw3ICs3NDksNyBAQCBmaGFuZGxlcl9maWZvOjpyYXdfcmVhZCAodm9p
ZCAqaW5fcHRyLCBzaXplX3QmIGxlbikNCiAJICAgICAgfQ0KIAkgICAgLyog
SW4gdGhlIGR1cGxleCBjYXNlIHdpdGggbm8gZGF0YSwgd2Ugc2VlbSB0byBn
ZXQgbnJlYWQNCiAJICAgICAgID09IC0xIHdpdGggRVJST1JfUElQRV9MSVNU
RU5JTkcgb24gdGhlIGZpcnN0IGF0dGVtcHQgdG8NCi0JICAgICAgIHJlYWQg
ZnJvbSB0aGUgZHVwbGV4IHBpcGUgKGNsaWVudFswXSksIGFuZCBucmVhZCA9
PSAwDQorCSAgICAgICByZWFkIGZyb20gdGhlIGR1cGxleCBwaXBlIChmY19o
YW5kbGVyWzBdKSwgYW5kIG5yZWFkID09IDANCiAJICAgICAgIG9uIHN1YnNl
cXVlbnQgYXR0ZW1wdHMuICovDQogCSAgICBlbHNlIGlmIChucmVhZCA8IDAp
DQogCSAgICAgIHN3aXRjaCAoR2V0TGFzdEVycm9yICgpKQ0KQEAgLTc2Nyw3
ICs3NjcsNyBAQCBmaGFuZGxlcl9maWZvOjpyYXdfcmVhZCAodm9pZCAqaW5f
cHRyLCBzaXplX3QmIGxlbikNCiAJICAgIGVsc2UgaWYgKG5yZWFkID09IDAg
JiYgKCFfZHVwbGV4ZXIgfHwgaSA+IDApKQ0KIAkgICAgICAvKiBDbGllbnQg
aGFzIGRpc2Nvbm5lY3RlZC4gKi8NCiAJICAgICAgew0KLQkJY2xpZW50W2ld
LnN0YXRlID0gZmNfaW52YWxpZDsNCisJCWZjX2hhbmRsZXJbaV0uc3RhdGUg
PSBmY19pbnZhbGlkOw0KIAkJbmNvbm5lY3RlZC0tOw0KIAkgICAgICB9DQog
CSAgfQ0KQEAgLTg0MSw4ICs4NDEsOCBAQCBmaGFuZGxlcl9maWZvOjpjbG9z
ZSAoKQ0KICAgICBDbG9zZUhhbmRsZSAocmVhZF9yZWFkeSk7DQogICBpZiAo
d3JpdGVfcmVhZHkpDQogICAgIENsb3NlSGFuZGxlICh3cml0ZV9yZWFkeSk7
DQotICBmb3IgKGludCBpID0gMDsgaSA8IG5jbGllbnRzOyBpKyspDQotICAg
IGlmIChjbGllbnRbaV0uY2xvc2UgKCkgPCAwKQ0KKyAgZm9yIChpbnQgaSA9
IDA7IGkgPCBuaGFuZGxlcnM7IGkrKykNCisgICAgaWYgKGZjX2hhbmRsZXJb
aV0uY2xvc2UgKCkgPCAwKQ0KICAgICAgIHJlcyA9IC0xOw0KICAgcmV0dXJu
IGZoYW5kbGVyX2Jhc2U6OmNsb3NlICgpIHx8IHJlczsNCiB9DQpAQCAtODcz
LDE5ICs4NzMsMTkgQEAgZmhhbmRsZXJfZmlmbzo6ZHVwIChmaGFuZGxlcl9i
YXNlICpjaGlsZCwgaW50IGZsYWdzKQ0KICAgICAgIF9fc2V0ZXJybm8gKCk7
DQogICAgICAgcmV0dXJuIC0xOw0KICAgICB9DQotICBmb3IgKGludCBpID0g
MDsgaSA8IG5jbGllbnRzOyBpKyspDQorICBmb3IgKGludCBpID0gMDsgaSA8
IG5oYW5kbGVyczsgaSsrKQ0KICAgICB7DQotICAgICAgaWYgKCFEdXBsaWNh
dGVIYW5kbGUgKEdldEN1cnJlbnRQcm9jZXNzICgpLCBjbGllbnRbaV0uZmgt
PmdldF9oYW5kbGUgKCksDQorICAgICAgaWYgKCFEdXBsaWNhdGVIYW5kbGUg
KEdldEN1cnJlbnRQcm9jZXNzICgpLCBmY19oYW5kbGVyW2ldLmZoLT5nZXRf
aGFuZGxlICgpLA0KIAkJCSAgICBHZXRDdXJyZW50UHJvY2VzcyAoKSwNCi0J
CQkgICAgJmZoZi0+Y2xpZW50W2ldLmZoLT5nZXRfaGFuZGxlICgpLA0KKwkJ
CSAgICAmZmhmLT5mY19oYW5kbGVyW2ldLmZoLT5nZXRfaGFuZGxlICgpLA0K
IAkJCSAgICAwLCB0cnVlLCBEVVBMSUNBVEVfU0FNRV9BQ0NFU1MpDQotCSAg
fHwgIUR1cGxpY2F0ZUhhbmRsZSAoR2V0Q3VycmVudFByb2Nlc3MgKCksIGNs
aWVudFtpXS5jb25uZWN0X2V2dCwNCisJICB8fCAhRHVwbGljYXRlSGFuZGxl
IChHZXRDdXJyZW50UHJvY2VzcyAoKSwgZmNfaGFuZGxlcltpXS5jb25uZWN0
X2V2dCwNCiAJCQkgICAgICAgR2V0Q3VycmVudFByb2Nlc3MgKCksDQotCQkJ
ICAgICAgICZmaGYtPmNsaWVudFtpXS5jb25uZWN0X2V2dCwNCisJCQkgICAg
ICAgJmZoZi0+ZmNfaGFuZGxlcltpXS5jb25uZWN0X2V2dCwNCiAJCQkgICAg
ICAgMCwgdHJ1ZSwgRFVQTElDQVRFX1NBTUVfQUNDRVNTKQ0KLQkgIHx8ICFE
dXBsaWNhdGVIYW5kbGUgKEdldEN1cnJlbnRQcm9jZXNzICgpLCBjbGllbnRb
aV0uZHVtbXlfZXZ0LA0KKwkgIHx8ICFEdXBsaWNhdGVIYW5kbGUgKEdldEN1
cnJlbnRQcm9jZXNzICgpLCBmY19oYW5kbGVyW2ldLmR1bW15X2V2dCwNCiAJ
CQkgICAgICAgR2V0Q3VycmVudFByb2Nlc3MgKCksDQotCQkJICAgICAgICZm
aGYtPmNsaWVudFtpXS5kdW1teV9ldnQsDQorCQkJICAgICAgICZmaGYtPmZj
X2hhbmRsZXJbaV0uZHVtbXlfZXZ0LA0KIAkJCSAgICAgICAwLCB0cnVlLCBE
VVBMSUNBVEVfU0FNRV9BQ0NFU1MpKQ0KIAl7DQogCSAgQ2xvc2VIYW5kbGUg
KGZoZi0+cmVhZF9yZWFkeSk7DQpAQCAtOTA3LDExICs5MDcsMTEgQEAgZmhh
bmRsZXJfZmlmbzo6Zml4dXBfYWZ0ZXJfZm9yayAoSEFORExFIHBhcmVudCkN
CiAgIGZoYW5kbGVyX2Jhc2U6OmZpeHVwX2FmdGVyX2ZvcmsgKHBhcmVudCk7
DQogICBmb3JrX2ZpeHVwIChwYXJlbnQsIHJlYWRfcmVhZHksICJyZWFkX3Jl
YWR5Iik7DQogICBmb3JrX2ZpeHVwIChwYXJlbnQsIHdyaXRlX3JlYWR5LCAi
d3JpdGVfcmVhZHkiKTsNCi0gIGZvciAoaW50IGkgPSAwOyBpIDwgbmNsaWVu
dHM7IGkrKykNCisgIGZvciAoaW50IGkgPSAwOyBpIDwgbmhhbmRsZXJzOyBp
KyspDQogICAgIHsNCi0gICAgICBjbGllbnRbaV0uZmgtPmZoYW5kbGVyX2Jh
c2U6OmZpeHVwX2FmdGVyX2ZvcmsgKHBhcmVudCk7DQotICAgICAgZm9ya19m
aXh1cCAocGFyZW50LCBjbGllbnRbaV0uY29ubmVjdF9ldnQsICJjb25uZWN0
X2V2dCIpOw0KLSAgICAgIGZvcmtfZml4dXAgKHBhcmVudCwgY2xpZW50W2ld
LmR1bW15X2V2dCwgImR1bW15X2V2dCIpOw0KKyAgICAgIGZjX2hhbmRsZXJb
aV0uZmgtPmZoYW5kbGVyX2Jhc2U6OmZpeHVwX2FmdGVyX2ZvcmsgKHBhcmVu
dCk7DQorICAgICAgZm9ya19maXh1cCAocGFyZW50LCBmY19oYW5kbGVyW2ld
LmNvbm5lY3RfZXZ0LCAiY29ubmVjdF9ldnQiKTsNCisgICAgICBmb3JrX2Zp
eHVwIChwYXJlbnQsIGZjX2hhbmRsZXJbaV0uZHVtbXlfZXZ0LCAiZHVtbXlf
ZXZ0Iik7DQogICAgIH0NCiAgIGxpc3Rlbl9jbGllbnRfdGhyID0gTlVMTDsN
CiAgIGxjdF90ZXJtaW5hdGlvbl9ldnQgPSBOVUxMOw0KQEAgLTkyNCwxMCAr
OTI0LDEwIEBAIGZoYW5kbGVyX2ZpZm86OnNldF9jbG9zZV9vbl9leGVjIChi
b29sIHZhbCkNCiAgIGZoYW5kbGVyX2Jhc2U6OnNldF9jbG9zZV9vbl9leGVj
ICh2YWwpOw0KICAgc2V0X25vX2luaGVyaXRhbmNlIChyZWFkX3JlYWR5LCB2
YWwpOw0KICAgc2V0X25vX2luaGVyaXRhbmNlICh3cml0ZV9yZWFkeSwgdmFs
KTsNCi0gIGZvciAoaW50IGkgPSAwOyBpIDwgbmNsaWVudHM7IGkrKykNCisg
IGZvciAoaW50IGkgPSAwOyBpIDwgbmhhbmRsZXJzOyBpKyspDQogICAgIHsN
Ci0gICAgICBjbGllbnRbaV0uZmgtPmZoYW5kbGVyX2Jhc2U6OnNldF9jbG9z
ZV9vbl9leGVjICh2YWwpOw0KLSAgICAgIHNldF9ub19pbmhlcml0YW5jZSAo
Y2xpZW50W2ldLmNvbm5lY3RfZXZ0LCB2YWwpOw0KLSAgICAgIHNldF9ub19p
bmhlcml0YW5jZSAoY2xpZW50W2ldLmR1bW15X2V2dCwgdmFsKTsNCisgICAg
ICBmY19oYW5kbGVyW2ldLmZoLT5maGFuZGxlcl9iYXNlOjpzZXRfY2xvc2Vf
b25fZXhlYyAodmFsKTsNCisgICAgICBzZXRfbm9faW5oZXJpdGFuY2UgKGZj
X2hhbmRsZXJbaV0uY29ubmVjdF9ldnQsIHZhbCk7DQorICAgICAgc2V0X25v
X2luaGVyaXRhbmNlIChmY19oYW5kbGVyW2ldLmR1bW15X2V2dCwgdmFsKTsN
CiAgICAgfQ0KIH0NCmRpZmYgLS1naXQgYS93aW5zdXAvY3lnd2luL3NlbGVj
dC5jYyBiL3dpbnN1cC9jeWd3aW4vc2VsZWN0LmNjDQppbmRleCA4NTI0MmVj
MDYuLmQyNTdjYzRlZCAxMDA2NDQNCi0tLSBhL3dpbnN1cC9jeWd3aW4vc2Vs
ZWN0LmNjDQorKysgYi93aW5zdXAvY3lnd2luL3NlbGVjdC5jYw0KQEAgLTg3
Miw3ICs4NzIsNyBAQCBwZWVrX2ZpZm8gKHNlbGVjdF9yZWNvcmQgKnMsIGJv
b2wgZnJvbV9zZWxlY3QpDQogCX0NCiANCiAgICAgICBmaC0+Zmlmb19jbGll
bnRfbG9jayAoKTsNCi0gICAgICBmb3IgKGludCBpID0gMDsgaSA8IGZoLT5n
ZXRfbmNsaWVudHMgKCk7IGkrKykNCisgICAgICBmb3IgKGludCBpID0gMDsg
aSA8IGZoLT5nZXRfbmhhbmRsZXJzICgpOyBpKyspDQogCWlmIChmaC0+aXNf
Y29ubmVjdGVkIChpKSkNCiAJICB7DQogCSAgICBpbnQgbiA9IHBpcGVfZGF0
YV9hdmFpbGFibGUgKHMtPmZkLCBmaCwgZmgtPmdldF9oYW5kbGUgKGkpLA0K
LS0gDQoyLjE3LjANCg0K
