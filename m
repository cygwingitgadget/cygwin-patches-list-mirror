From: "Robert Collins" <robert.collins@itdomain.com.au>
To: <cygwin-patches@cygwin.com>
Subject: pthread_cond*
Date: Fri, 16 Mar 2001 06:26:00 -0000
Message-id: <05e401c0ae24$e8194600$0200a8c0@lifelesswks>
X-SW-Source: 2001-q1/msg00186.html
Content-type: multipart/mixed; boundary="----------=_1583532846-65438-20"

This is a multi-part message in MIME format...

------------=_1583532846-65438-20
Content-length: 467

Changelog:

Saturday Mar 17 01:19 2001 Robert Collins rbtcollins@hotmail.com

    * cygwin/cygwin.din: Export the new functions
    * cygwin/pthread.cc: Wrapper functions that call __pthread_cond*
functions
    * cygwin/thread.cc: Implement the pthread_cond* functions
    * cygwin/thread.h: Add new class entries and prototypes for
__pthread_cond* functions
    * cygwin/include/pthread.h: user land header prototypes for
pthread_cond* functions and related defines

------------=_1583532846-65438-20
Content-Type: text/x-diff; charset=us-ascii; name="pthread_cond.patch"
Content-Disposition: inline; filename="pthread_cond.patch"
Content-Transfer-Encoding: base64
Content-Length: 19614

SW5kZXg6IGN5Z3dpbi9jeWd3aW4uZGluCj09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT0KUkNTIGZpbGU6IC9jdnMvc3JjL3NyYy93aW5zdXAvY3lnd2luL2N5Z3dp
bi5kaW4sdgpyZXRyaWV2aW5nIHJldmlzaW9uIDEuMjEKZGlmZiAtdSAtcCAt
cjEuMjEgY3lnd2luLmRpbgotLS0gY3lnd2luLmRpbgkyMDAxLzAzLzA1IDA2
OjI4OjIzCTEuMjEKKysrIGN5Z3dpbi5kaW4JMjAwMS8wMy8xNiAxNDoxOToz
NQpAQCAtMTA5OSw2ICsxMDk5LDE2IEBAIGN5Z3dpbjMyX2ludGVybmFsID0g
Y3lnd2luX2ludGVybmFsCiBAUFRIX0FMTE9XQHB0aHJlYWRfbXV0ZXhfdHJ5
bG9jawogQFBUSF9BTExPV0BwdGhyZWFkX211dGV4X3VubG9jawogQFBUSF9B
TExPV0BwdGhyZWFkX211dGV4X2Rlc3Ryb3kKK0BQVEhfQUxMT1dAcHRocmVh
ZF9jb25kX2luaXQKK0BQVEhfQUxMT1dAcHRocmVhZF9jb25kX2Rlc3Ryb3kK
K0BQVEhfQUxMT1dAcHRocmVhZF9jb25kX2Jyb2FkY2FzdAorQFBUSF9BTExP
V0BwdGhyZWFkX2NvbmRfc2lnbmFsCitAUFRIX0FMTE9XQHB0aHJlYWRfY29u
ZF93YWl0CitAUFRIX0FMTE9XQHB0aHJlYWRfY29uZF90aW1lZHdhaXQKK0BQ
VEhfQUxMT1dAcHRocmVhZF9jb25kYXR0cl9pbml0CitAUFRIX0FMTE9XQHB0
aHJlYWRfY29uZGF0dHJfZGVzdHJveQorQFBUSF9BTExPV0BwdGhyZWFkX2Nv
bmRhdHRyX2dldHBzaGFyZWQKK0BQVEhfQUxMT1dAcHRocmVhZF9jb25kYXR0
cl9zZXRwc2hhcmVkCiBAUFRIX0FMTE9XQHNlbV9pbml0CiBAUFRIX0FMTE9X
QHNlbV9kZXN0cm95CiBAUFRIX0FMTE9XQHNlbV93YWl0CkluZGV4OiBjeWd3
aW4vcHRocmVhZC5jYwo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09ClJDUyBmaWxl
OiAvY3ZzL3NyYy9zcmMvd2luc3VwL2N5Z3dpbi9wdGhyZWFkLmNjLHYKcmV0
cmlldmluZyByZXZpc2lvbiAxLjMKZGlmZiAtdSAtcCAtcjEuMyBwdGhyZWFk
LmNjCi0tLSBwdGhyZWFkLmNjCTIwMDAvMDkvMDQgMTc6NTI6NDIJMS4zCisr
KyBwdGhyZWFkLmNjCTIwMDEvMDMvMTYgMTQ6MTk6MzUKQEAgLTE3MSw2ICsx
NzEsNjcgQEAgcHRocmVhZF9tdXRleF9kZXN0cm95IChwdGhyZWFkX211dGV4
X3QgKgogICByZXR1cm4gX19wdGhyZWFkX211dGV4X2Rlc3Ryb3kgKG11dGV4
KTsKIH0KIAorLyogU3luY2hyb25pc2F0aW9uICovCisKK2ludAorcHRocmVh
ZF9jb25kX2Rlc3Ryb3kocHRocmVhZF9jb25kX3QgKmNvbmQpCit7CisgIHJl
dHVybiAgX19wdGhyZWFkX2NvbmRfZGVzdHJveSAoY29uZCk7Cit9CisKK2lu
dAorcHRocmVhZF9jb25kX2luaXQocHRocmVhZF9jb25kX3QgKmNvbmQsIGNv
bnN0IHB0aHJlYWRfY29uZGF0dHJfdCAqYXR0cikKK3sKKyAgcmV0dXJuIF9f
cHRocmVhZF9jb25kX2luaXQgKGNvbmQsIGF0dHIpOworfQorCitpbnQKK3B0
aHJlYWRfY29uZF9zaWduYWwocHRocmVhZF9jb25kX3QgKmNvbmQpCit7Cisg
IHJldHVybiBfX3B0aHJlYWRfY29uZF9zaWduYWwgKGNvbmQpOworfQorCitp
bnQgcHRocmVhZF9jb25kX2Jyb2FkY2FzdChwdGhyZWFkX2NvbmRfdCAqY29u
ZCkKK3sKKyAgcmV0dXJuIF9fcHRocmVhZF9jb25kX2Jyb2FkY2FzdCAoY29u
ZCk7Cit9CisKK2ludAorcHRocmVhZF9jb25kX3RpbWVkd2FpdChwdGhyZWFk
X2NvbmRfdCAqY29uZCwKKwkgcHRocmVhZF9tdXRleF90ICptdXRleCwgY29u
c3Qgc3RydWN0IHRpbWVzcGVjICphYnN0aW1lKQoreworICByZXR1cm4gX19w
dGhyZWFkX2NvbmRfdGltZWR3YWl0IChjb25kLCBtdXRleCwgYWJzdGltZSk7
Cit9CisKK2ludAorcHRocmVhZF9jb25kX3dhaXQocHRocmVhZF9jb25kX3Qg
KmNvbmQsIHB0aHJlYWRfbXV0ZXhfdCAqbXV0ZXgpCit7CisgIHJldHVybiBf
X3B0aHJlYWRfY29uZF93YWl0IChjb25kLCBtdXRleCk7Cit9CisKK2ludAor
cHRocmVhZF9jb25kYXR0cl9pbml0KHB0aHJlYWRfY29uZGF0dHJfdCAqY29u
ZGF0dHIpCit7CisgIHJldHVybiBfX3B0aHJlYWRfY29uZGF0dHJfaW5pdCAo
Y29uZGF0dHIpOworfQorCitpbnQKK3B0aHJlYWRfY29uZGF0dHJfZGVzdHJv
eShwdGhyZWFkX2NvbmRhdHRyX3QgKmNvbmRhdHRyKQoreworICByZXR1cm4g
X19wdGhyZWFkX2NvbmRhdHRyX2Rlc3Ryb3kgKGNvbmRhdHRyKTsKK30KKwor
aW50CitwdGhyZWFkX2NvbmRhdHRyX2dldHBzaGFyZWQgKGNvbnN0IHB0aHJl
YWRfY29uZGF0dHJfdCAqYXR0ciwgaW50ICpwc2hhcmVkKQoreworICByZXR1
cm4gX19wdGhyZWFkX2NvbmRhdHRyX2dldHBzaGFyZWQgKGF0dHIsIHBzaGFy
ZWQpOworfQorCitpbnQgcHRocmVhZF9jb25kYXR0cl9zZXRwc2hhcmVkIChw
dGhyZWFkX2NvbmRhdHRyX3QgKmF0dHIsIGludCBwc2hhcmVkKQoreworICBy
ZXR1cm4gX19wdGhyZWFkX2NvbmRhdHRyX3NldHBzaGFyZWQgKGF0dHIsIHBz
aGFyZWQpOworfQorCiAvKiBTZW1hcGhvcmVzICovCiBpbnQKIHNlbV9pbml0
IChzZW1fdCAqIHNlbSwgaW50IHBzaGFyZWQsIHVuc2lnbmVkIGludCB2YWx1
ZSkKSW5kZXg6IGN5Z3dpbi90aHJlYWQuY2MKPT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PQpSQ1MgZmlsZTogL2N2cy9zcmMvc3JjL3dpbnN1cC9jeWd3aW4vdGhy
ZWFkLmNjLHYKcmV0cmlldmluZyByZXZpc2lvbiAxLjE2CmRpZmYgLXUgLXAg
LXIxLjE2IHRocmVhZC5jYwotLS0gdGhyZWFkLmNjCTIwMDEvMDIvMjAgMDI6
NTM6NTUJMS4xNgorKysgdGhyZWFkLmNjCTIwMDEvMDMvMTYgMTQ6MTk6MzcK
QEAgLTYzLDYgKzYzLDEzIEBAIGV4dGVybiBpbnQgdGhyZWFkc2FmZTsKICAg
aWYgKCFpdGVtKSByZXR1cm4gRUlOVkFMOyBcCiAgIENIRUNLSEFORExFIChF
SU5WQUwsIDApOwogCisjZGVmaW5lIEdFVENPTkQobikgXAorICBTZXRSZXNv
dXJjZUxvY2sgKExPQ0tfQ09ORF9MSVNULCBSRUFEX0xPQ0ssIG4pOyBcCisg
IENvbmRJdGVtICppdGVtPXVzZXJfZGF0YS0+dGhyZWFkaW50ZXJmYWNlLT5H
ZXRDb25kIChjb25kKTsgXAorICBSZWxlYXNlUmVzb3VyY2VMb2NrIChMT0NL
X0NPTkRfTElTVCwgUkVBRF9MT0NLLCBuKTsgXAorICBpZiAoIWl0ZW0pIHJl
dHVybiBFSU5WQUw7IFwKKyAgQ0hFQ0tIQU5ETEUgKEVJTlZBTCwgMCk7CisK
ICNkZWZpbmUgQ0hFQ0tJVEVNKHJuLCBybSwgZm4pIFwKICAgaWYgKCFpdGVt
KSB7IFwKICAgICBSZWxlYXNlUmVzb3VyY2VMb2NrIChybiwgcm0sIGZuKTsg
XApAQCAtMzg3LDYgKzM5NCwxMyBAQCBNVGludGVyZmFjZTo6R2V0U2VtYXBo
b3JlIChzZW1fdCAqIHNwKQogICByZXR1cm4gKFNlbWFwaG9yZUl0ZW0gKikg
RmluZCAoc3AsICZDbXBQdGhyZWFkT2JqLCBpbmRleCwgJnNlbWFsaXN0KTsK
IH0KIAorQ29uZEl0ZW0gKgorTVRpbnRlcmZhY2U6OkdldENvbmQgKHB0aHJl
YWRfY29uZF90ICogbXApCit7CisgIEFzc2VydFJlc291cmNlT3duZXIgKExP
Q0tfQ09ORF9MSVNULCBSRUFEX0xPQ0spOworICBpbnQgaW5kZXggPSAwOwor
ICByZXR1cm4gKENvbmRJdGVtICopIEZpbmQgKG1wLCAmQ21wUHRocmVhZE9i
aiwgaW5kZXgsICZjb25kbGlzdCk7Cit9CiAKIHZvaWQKIE1UaXRlbTo6RGVz
dHJveSAoKQpAQCAtNDU1LDcgKzQ2OSw4MyBAQCBTZW1hcGhvcmVJdGVtOjpU
cnlXYWl0ICgpCiAgIHJldHVybiBXYWl0Rm9yU2luZ2xlT2JqZWN0ICh3aW4z
Ml9vYmpfaWQsIDApOwogfQogCisvKiBDb25kaXRpb24gSXRlbXMgKi8KK0Nv
bmRJdGVtICoKK01UaW50ZXJmYWNlOjpDcmVhdGVDb25kIChwdGhyZWFkX2Nv
bmRfdCAqIGNvbmQsIGNvbnN0IHB0aHJlYWRfY29uZGF0dHJfdCAqIGF0dHIp
Cit7CisgIEFzc2VydFJlc291cmNlT3duZXIgKExPQ0tfQ09ORF9MSVNULCBX
UklURV9MT0NLIHwgUkVBRF9MT0NLKTsKKworICBpbnQgaSA9IEZpbmROZXh0
VW51c2VkICgmY29uZGxpc3QpOworCisgIENvbmRJdGVtICppdGVtID0gKENv
bmRJdGVtICopIEdldEl0ZW0gKGksICZjb25kbGlzdCk7CisgIGlmICghaXRl
bSkKKyAgICBpdGVtID0gKENvbmRJdGVtICopIFNldEl0ZW0gKGksIG5ldyBD
b25kSXRlbSAoKSwgJmNvbmRsaXN0KTsKKyAgaWYgKCFpdGVtKQorICAgIHN5
c3RlbV9wcmludGYgKCJjb25kIGNyZWF0aW9uIGZhaWxlZCIpOworICBpdGVt
LT51c2VkID0gdHJ1ZTsKKyAgaXRlbS0+c2hhcmVkID0gYXR0ci0+c2hhcmVk
OworICBpdGVtLT5tdXRleGl0ZW09TlVMTDsKKyAgaXRlbS0+d2FpdGluZz0w
OworCisgIGl0ZW0tPndpbjMyX29ial9pZCA9IDo6Q3JlYXRlRXZlbnQgKCZz
ZWNfbm9uZV9uaWgsIAorCWZhbHNlLCAvKiBhdXRvIHNpZ25hbCByZXNldCAt
IHdoaWNoIEkgdGhpbmsgaXMgcHRocmVhZHMgbGlrZSA/ICovCisJZmFsc2Us
IC8qIHN0YXJ0IG5vbiBzaWduYWxlZCAqLworCU5VTEwgLyogbm8gbmFtZSAq
LyApOworCisKKyAgQ0hFQ0tIQU5ETEUgKE5VTEwsIDEpOworCisgICpjb25k
ID0gKHB0aHJlYWRfY29uZF90KSBpdGVtLT53aW4zMl9vYmpfaWQ7CisKKyAg
cmV0dXJuIGl0ZW07Cit9CisKKworaW50CitDb25kSXRlbTo6U2lnbmFsICgp
Cit7CisgIHJldHVybiAhUHVsc2VFdmVudCh3aW4zMl9vYmpfaWQpOworfQor
CitpbnQKK0NvbmRJdGVtOjpXYWl0ICgpCit7CisgIHJldHVybiBTaWduYWxP
YmplY3RBbmRXYWl0IChtdXRleGl0ZW0tPndpbjMyX29ial9pZCwgd2luMzJf
b2JqX2lkLCBJTkZJTklURSwgZmFsc2UpOworfQorCitpbnQKK0NvbmRJdGVt
OjpUaW1lZFdhaXQgKERXT1JEIGR3TWlsbGlzZWNvbmRzKQoreworICByZXR1
cm4gU2lnbmFsT2JqZWN0QW5kV2FpdCAobXV0ZXhpdGVtLT53aW4zMl9vYmpf
aWQsIHdpbjMyX29ial9pZCwgZHdNaWxsaXNlY29uZHMsIGZhbHNlKTsKK30K
KworaW50CitDb25kSXRlbTo6QnJvYWRDYXN0ICgpCit7CisgIGlmICghbXV0
ZXhpdGVtKQorICAgIHJldHVybiAwOworICBQdWxzZUV2ZW50KHdpbjMyX29i
al9pZCk7CisgIHdoaWxlIChJbnRlcmxvY2tlZERlY3JlbWVudCgmd2FpdGlu
ZykhPTApCisgICAgUHVsc2VFdmVudCh3aW4zMl9vYmpfaWQpOworICBtdXRl
eGl0ZW09TlVMTDsKKyAgcmV0dXJuIDA7Cit9CiAKKy8qCitpbnQKK011dGV4
SXRlbTo6VHJ5TG9jayAoKQoreworICByZXR1cm4gV2FpdEZvclNpbmdsZU9i
amVjdCAod2luMzJfb2JqX2lkLCAwKTsKK30KKworaW50CitNdXRleEl0ZW06
OlVuTG9jayAoKQoreworICByZXR1cm4gUmVsZWFzZU11dGV4ICh3aW4zMl9v
YmpfaWQpOworfQorCisqLworCiAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8v
LyAgUHRocmVhZHMKIAogdm9pZCAqCkBAIC02NzgsNiArNzY4LDE0NSBAQCBf
X3B0aHJlYWRfZ2V0c3BlY2lmaWMgKHB0aHJlYWRfa2V5X3QgKi8qCiAgIE5P
VF9JTVAgKCJfcF9rZXlfZ2V0c3BcbiIpOwogfQogCisvKiBUaHJlYWQgc3lu
Y2hyb25pc2F0aW9uICovCisKK2ludAorX19wdGhyZWFkX2NvbmRfZGVzdHJv
eShwdGhyZWFkX2NvbmRfdCAqY29uZCkKK3sKKyAgU2V0UmVzb3VyY2VMb2Nr
IChMT0NLX0NPTkRfTElTVCwgUkVBRF9MT0NLIHwgV1JJVEVfTE9DSywgIl9f
cHRocmVhZF9jb25kX2Rlc3Ryb3kiKTsKKworICBDb25kSXRlbSAqaXRlbSA9
IE1UX0lOVEVSRkFDRS0+R2V0Q29uZCAoY29uZCk7CisKKyAgQ0hFQ0tJVEVN
IChMT0NLX0NPTkRfTElTVCwgV1JJVEVfTE9DSyB8IFJFQURfTE9DSywgIl9f
cHRocmVhZF9jb25kX2luaXQiKTsKKworICBpdGVtLT5EZXN0cm95ICgpOwor
CisgIE1UX0lOVEVSRkFDRS0+UmVsZWFzZUl0ZW0gKGl0ZW0pOworCisgIFJl
bGVhc2VSZXNvdXJjZUxvY2sgKExPQ0tfQ09ORF9MSVNULCBSRUFEX0xPQ0sg
fCBXUklURV9MT0NLLCAiX19wdGhyZWFkX2NvbmRfZGVzdHJveSIpCis7Cisg
IHJldHVybiAwOworfQorCitpbnQKK19fcHRocmVhZF9jb25kX2luaXQocHRo
cmVhZF9jb25kX3QgKmNvbmQsIGNvbnN0IHB0aHJlYWRfY29uZGF0dHJfdCAq
YXR0cikKK3sKKyAgaWYgKGF0dHIgJiYgKGF0dHItPnZhbGlkICE9IDB4ZjM0
MSkpCisgICAgcmV0dXJuIEVJTlZBTDsKKyAgU2V0UmVzb3VyY2VMb2NrIChM
T0NLX0NPTkRfTElTVCwgV1JJVEVfTE9DSyB8IFJFQURfTE9DSywgIl9fcHRo
cmVhZF9jb25kX2luaXQiKTsKKworICBDb25kSXRlbSAqaXRlbSA9IE1UX0lO
VEVSRkFDRS0+Q3JlYXRlQ29uZCAoY29uZCwgYXR0cik7CisKKyAgQ0hFQ0tJ
VEVNIChMT0NLX0NPTkRfTElTVCwgV1JJVEVfTE9DSyB8IFJFQURfTE9DSywg
Il9fcHRocmVhZF9jb25kX2luaXQiKTsKKworICBSZWxlYXNlUmVzb3VyY2VM
b2NrIChMT0NLX0NPTkRfTElTVCwgV1JJVEVfTE9DSyB8IFJFQURfTE9DSywg
Il9fcHRocmVhZF9jb25kX2luaXQiKTsKKyAgcmV0dXJuIDA7CisKK30KKwor
aW50IF9fcHRocmVhZF9jb25kX2Jyb2FkY2FzdChwdGhyZWFkX2NvbmRfdCAq
Y29uZCkKK3sKKyAgR0VUQ09ORCgiX3B0aHJlYWRfY29uZF9sb2NrIik7Cisg
IAorICBpdGVtLT5Ccm9hZENhc3QoKTsKKworICByZXR1cm4gMDsKK30KKwor
aW50IF9fcHRocmVhZF9jb25kX3NpZ25hbChwdGhyZWFkX2NvbmRfdCAqY29u
ZCkKK3sKKyAgR0VUQ09ORCgiX3B0aHJlYWRfY29uZF9sb2NrIik7CisKKyAg
aXRlbS0+U2lnbmFsKCk7CisKKyAgcmV0dXJuIDA7Cit9CisKK2ludCBfX3B0
aHJlYWRfY29uZF90aW1lZHdhaXQocHRocmVhZF9jb25kX3QgKmNvbmQsIHB0
aHJlYWRfbXV0ZXhfdCAqbXV0ZXgsIGNvbnN0IHN0cnVjdCB0aW1lc3BlYyAq
YWJzdGltZSkKK3sKKyAgaWYgKCFhYnN0aW1lKQorICAgIHJldHVybiBFSU5W
QUw7CisgIFNldFJlc291cmNlTG9jayAoTE9DS19NVVRFWF9MSVNULCBSRUFE
X0xPQ0ssICJfcHRoZXJhZF9tdXRleF9sb2NrIik7CisgIE11dGV4SXRlbSog
bXV0ZXhpdGVtPXVzZXJfZGF0YS0+dGhyZWFkaW50ZXJmYWNlLT5HZXRNdXRl
eCAobXV0ZXgpOworICBSZWxlYXNlUmVzb3VyY2VMb2NrIChMT0NLX01VVEVY
X0xJU1QsIFJFQURfTE9DSywgIl9wdGhlcmFkX211dGV4X2xvY2siKTsKKyAg
aWYgKCFtdXRleGl0ZW0pIHJldHVybiBFSU5WQUw7CisgIGlmICghbXV0ZXhp
dGVtLT5IYW5kbGVPa2UgKCkpCisgIHsKKyAgICByZXR1cm4gRUlOVkFMOwor
ICB9CisgIEdFVENPTkQoIl9wdGhyZWFkX2NvbmRfbG9jayIpOworICBpZiAo
aXRlbS0+bXV0ZXhpdGVtICYmIChpdGVtLT5tdXRleGl0ZW0gIT0gbXV0ZXhp
dGVtKSkKKyAgICByZXR1cm4gRUlOVkFMOworCisgIGl0ZW0tPm11dGV4aXRl
bT1tdXRleGl0ZW07CisgIEludGVybG9ja2VkSW5jcmVtZW50KCZpdGVtLT53
YWl0aW5nKTsKKyAgaXRlbS0+VGltZWRXYWl0KGFic3RpbWUtPnR2X3NlYyox
MDAwKTsKKyAgbXV0ZXhpdGVtLT5Mb2NrKCk7CisgIGlmIChJbnRlcmxvY2tl
ZERlY3JlbWVudCgmaXRlbS0+d2FpdGluZyk9PTApCisgICAgaXRlbS0+bXV0
ZXhpdGVtPU5VTEw7CisKKyAgcmV0dXJuIDA7Cit9CisKK2ludCBfX3B0aHJl
YWRfY29uZF93YWl0KHB0aHJlYWRfY29uZF90ICpjb25kLCBwdGhyZWFkX211
dGV4X3QgKm11dGV4KQoreyAKKyAgU2V0UmVzb3VyY2VMb2NrIChMT0NLX01V
VEVYX0xJU1QsIFJFQURfTE9DSywgIl9wdGhlcmFkX211dGV4X2xvY2siKTsg
CisgIE11dGV4SXRlbSogbXV0ZXhpdGVtPXVzZXJfZGF0YS0+dGhyZWFkaW50
ZXJmYWNlLT5HZXRNdXRleCAobXV0ZXgpOyAKKyAgUmVsZWFzZVJlc291cmNl
TG9jayAoTE9DS19NVVRFWF9MSVNULCBSRUFEX0xPQ0ssICJfcHRoZXJhZF9t
dXRleF9sb2NrIik7IAorICBpZiAoIW11dGV4aXRlbSkgcmV0dXJuIEVJTlZB
TDsgIAorICBpZiAoIW11dGV4aXRlbS0+SGFuZGxlT2tlICgpKQorICB7IAor
ICAgIHJldHVybiBFSU5WQUw7IAorICB9CisgIEdFVENPTkQoIl9wdGhyZWFk
X2NvbmRfbG9jayIpOworICBpZiAoaXRlbS0+bXV0ZXhpdGVtICYmIChpdGVt
LT5tdXRleGl0ZW0gIT0gbXV0ZXhpdGVtKSkKKyAgICByZXR1cm4gRUlOVkFM
OworICAKKyAgaXRlbS0+bXV0ZXhpdGVtPW11dGV4aXRlbTsKKyAgSW50ZXJs
b2NrZWRJbmNyZW1lbnQoJml0ZW0tPndhaXRpbmcpOworICBpdGVtLT5XYWl0
KCk7ICAKKyAgbXV0ZXhpdGVtLT5Mb2NrKCk7CisgIGlmIChJbnRlcmxvY2tl
ZERlY3JlbWVudCgmaXRlbS0+d2FpdGluZyk9PTApCisgICAgaXRlbS0+bXV0
ZXhpdGVtPU5VTEw7CisgCisgIHJldHVybiAwOworfQorCitpbnQKK19fcHRo
cmVhZF9jb25kYXR0cl9pbml0IChwdGhyZWFkX2NvbmRhdHRyX3QgKiBjb25k
YXR0cikKK3sKKyAgY29uZGF0dHItPnNoYXJlZCA9IDA7CisgIGNvbmRhdHRy
LT52YWxpZCAgPSAweGYzNDE7IC8qIFJvYmVydHMgbWFnaWMgbnVtYmVyICov
CisgIHJldHVybiAwOworfQorCitpbnQKK19fcHRocmVhZF9jb25kYXR0cl9n
ZXRwc2hhcmVkIChjb25zdCBwdGhyZWFkX2NvbmRhdHRyX3QgKiBhdHRyLCBp
bnQgKnBzaGFyZWQpCit7CisgIGlmICghYXR0ciB8fCAoYXR0ci0+dmFsaWQg
IT0gMHhmMzQxKSkKKyAgICByZXR1cm4gRUlOVkFMOworICAqcHNoYXJlZCA9
IGF0dHItPnNoYXJlZDsKKyAgcmV0dXJuIDA7Cit9CisKK2ludAorX19wdGhy
ZWFkX2NvbmRhdHRyX3NldHBzaGFyZWQgKHB0aHJlYWRfY29uZGF0dHJfdCAq
IGF0dHIsIGludCBwc2hhcmVkKQoreworICBpZiAoIWF0dHIgfHwgKGF0dHIt
PnZhbGlkICE9IDB4ZjM0MSkgfHwgKHBzaGFyZWQgPDApIHx8IChwc2hhcmVk
ID4gMSApKQorICAgIHJldHVybiBFSU5WQUw7CisgIGF0dHItPnNoYXJlZCA9
IHBzaGFyZWQ7CisgIHJldHVybiAwOworfQorCitpbnQKK19fcHRocmVhZF9j
b25kYXR0cl9kZXN0cm95IChwdGhyZWFkX2NvbmRhdHRyX3QgKiBjb25kYXR0
cikKK3sKKyAgaWYgKCFjb25kYXR0ciB8fCAoY29uZGF0dHItPnZhbGlkICE9
IDB4ZjM0MSkpCisgICAgICByZXR1cm4gRUlOVkFMOworICBjb25kYXR0ci0+
dmFsaWQ9MDsKKyAgcmV0dXJuIDA7Cit9CisKIC8qIFRocmVhZCBzaWduYWwg
Ki8KIGludAogX19wdGhyZWFkX2tpbGwgKHB0aHJlYWRfdCAqIHRocmVhZCwg
aW50IHNpZykKQEAgLTY5Myw3ICs5MjIsNiBAQCBfX3B0aHJlYWRfa2lsbCAo
cHRocmVhZF90ICogdGhyZWFkLCBpbnQgCiAKIC8vIHVubG9jayBteXNlbGYK
ICAgcmV0dXJuIHJ2YWw7Ci0KIH0KIAogaW50CkBAIC05NTMsNiArMTE4MSw0
NiBAQCBleHRlcm4gIkMiCiAgICAgcmV0dXJuIC0xOwogICB9CiAgIGludCBf
X3B0aHJlYWRfbXV0ZXhfZGVzdHJveSAocHRocmVhZF9tdXRleF90ICopCisg
IHsKKyAgICByZXR1cm4gLTE7CisgIH0KKyAgaW50IF9fcHRocmVhZF9jb25k
X2Rlc3Ryb3kocHRocmVhZF9jb25kX3QgKikKKyAgeworICAgIHJldHVybiAt
MTsKKyAgfQorICBpbnQgX19wdGhyZWFkX2NvbmRfaW5pdChwdGhyZWFkX2Nv
bmRfdCAqLCBjb25zdCBwdGhyZWFkX2NvbmRhdHRyX3QgKikKKyAgeworICAg
IHJldHVybiAtMTsKKyAgfQorICBpbnQgX19wdGhyZWFkX2NvbmRfc2lnbmFs
KHB0aHJlYWRfY29uZF90ICopCisgIHsKKyAgICByZXR1cm4gLTE7CisgIH0K
KyAgaW50IF9fcHRocmVhZF9jb25kX2Jyb2FkY2FzdChwdGhyZWFkX2NvbmRf
dCAqKQorICB7CisgICAgcmV0dXJuIC0xOworICB9CisgIGludCBfX3B0aHJl
YWRfY29uZF90aW1lZHdhaXQocHRocmVhZF9jb25kX3QgKiwgcHRocmVhZF9t
dXRleF90ICosIGNvbnN0IHN0cnVjdCB0aW1lc3BlYyAqKQorICB7CisgICAg
cmV0dXJuIC0xOworICB9CisgIGludCBfX3B0aHJlYWRfY29uZF93YWl0KHB0
aHJlYWRfY29uZF90ICosIHB0aHJlYWRfbXV0ZXhfdCAqKQorICB7CisgICAg
cmV0dXJuIC0xOworICB9CisgIGludCBfX3B0aHJlYWRfY29uZGF0dHJfaW5p
dCAocHRocmVhZF9jb25kYXR0cl90ICopCisgIHsKKyAgICByZXR1cm4gLTE7
CisgIH0KKyAgaW50IF9fcHRocmVhZF9jb25kYXR0cl9kZXN0cm95IChwdGhy
ZWFkX2NvbmRhdHRyX3QgKikKKyAgeworICAgIHJldHVybiAtMTsKKyAgfQor
ICBpbnQgX19wdGhyZWFkX2NvbmRhdHRyX2dldHBzaGFyZWQgKHB0aHJlYWRf
Y29uZGF0dHJfdCAqLCBpbnQgKikKKyAgeworICAgIHJldHVybiAtMTsKKyAg
fQorICBpbnQgX19wdGhyZWFkX2NvbmRhdHRyX3NldHBzaGFyZWQgKHB0aHJl
YWRfY29uZGF0dHJfdCAqLCBpbnQpCiAgIHsKICAgICByZXR1cm4gLTE7CiAg
IH0KSW5kZXg6IGN5Z3dpbi90aHJlYWQuaAo9PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09ClJDUyBmaWxlOiAvY3ZzL3NyYy9zcmMvd2luc3VwL2N5Z3dpbi90aHJl
YWQuaCx2CnJldHJpZXZpbmcgcmV2aXNpb24gMS44CmRpZmYgLXUgLXAgLXIx
LjggdGhyZWFkLmgKLS0tIHRocmVhZC5oCTIwMDAvMTAvMTYgMjM6NTU6NTcJ
MS44CisrKyB0aHJlYWQuaAkyMDAxLzAzLzE2IDE0OjE5OjM3CkBAIC0yMCw2
ICsyMCw3IEBAIGRldGFpbHMuICovCiAjZGVmaW5lIExPQ0tfVEhSRUFEX0xJ
U1QgNQogI2RlZmluZSBMT0NLX01VVEVYX0xJU1QgIDYKICNkZWZpbmUgTE9D
S19TRU1fTElTVCAgICA3CisjZGVmaW5lIExPQ0tfQ09ORF9MSVNUICAgOAog
CiAjZGVmaW5lIFdSSVRFX0xPQ0sgMQogI2RlZmluZSBSRUFEX0xPQ0sgIDIK
QEAgLTE5MCw2ICsxOTEsMTcgQEAgcHVibGljOgogICBpbnQgVHJ5V2FpdCAo
KTsKIH07CiAKK2NsYXNzIENvbmRJdGVtOiBwdWJsaWMgTVRpdGVtCit7Citw
dWJsaWM6CisgIGludCBzaGFyZWQ7CisgIExPTkcgd2FpdGluZzsKKyAgTXV0
ZXhJdGVtICptdXRleGl0ZW07CisgIGludCBXYWl0ICgpOworICBpbnQgVGlt
ZWRXYWl0IChEV09SRCBkd01pbGxpc2Vjb25kcyk7CisgIGludCBCcm9hZENh
c3QgKCk7CisgIGludCBTaWduYWwgKCk7Cit9OwogCiB0eXBlZGVmIHN0cnVj
dAogewpAQCAtMjI2LDYgKzIzOCwxMCBAQCBwdWJsaWM6CiAgIFNlbWFwaG9y
ZUl0ZW0gKkNyZWF0ZVNlbWFwaG9yZSAoc2VtX3QgKiwgaW50LCBpbnQpOwog
ICBTZW1hcGhvcmVJdGVtICpHZXRTZW1hcGhvcmUgKHNlbV90ICogdCk7CiAK
KyAgLy8gQ29uZGl0aW9uIGZ1bmN0aW9ucworICBDb25kSXRlbSAqQ3JlYXRl
Q29uZCAocHRocmVhZF9jb25kX3QgKiwgY29uc3QgcHRocmVhZF9jb25kYXR0
cl90ICopOyAKKyAgQ29uZEl0ZW0gKkdldENvbmQgKHB0aHJlYWRfY29uZF90
ICopOworCiBwcml2YXRlOgogICAvLyBHZW5lcmFsIEFkbWluaXN0cmF0aW9u
CiAgIE1UaXRlbSAqIEZpbmQgKHZvaWQgKiwgaW50ICgqY29tcGFyZSkgKHZv
aWQgKiwgdm9pZCAqKSwgaW50ICYsIE1UTGlzdCAqKTsKQEAgLTIzNyw2ICsy
NTMsNyBAQCBwcml2YXRlOgogICBNVExpc3QgdGhyZWFkbGlzdDsKICAgTVRM
aXN0IG11dGV4bGlzdDsKICAgTVRMaXN0IHNlbWFsaXN0OworICBNVExpc3Qg
Y29uZGxpc3Q7CiB9OwogCiAKQEAgLTI3NCw2ICsyOTEsMTcgQEAgaW50IF9f
cHRocmVhZF9rZXlfZGVsZXRlIChwdGhyZWFkX2tleV90IAogaW50IF9fcHRo
cmVhZF9zZXRzcGVjaWZpYyAocHRocmVhZF9rZXlfdCAqIGtleSwgY29uc3Qg
dm9pZCAqdmFsdWUpOwogdm9pZCAqX19wdGhyZWFkX2dldHNwZWNpZmljIChw
dGhyZWFkX2tleV90ICoga2V5KTsKIAorLyogVGhlYWQgc3luY2hyb25pYXRp
b24gKi8KK2ludCBfX3B0aHJlYWRfY29uZF9kZXN0cm95KHB0aHJlYWRfY29u
ZF90ICpjb25kKTsKK2ludCBfX3B0aHJlYWRfY29uZF9pbml0KHB0aHJlYWRf
Y29uZF90ICpjb25kLCBjb25zdCBwdGhyZWFkX2NvbmRhdHRyX3QgKmF0dHIp
OworaW50IF9fcHRocmVhZF9jb25kX3NpZ25hbChwdGhyZWFkX2NvbmRfdCAq
Y29uZCk7CitpbnQgX19wdGhyZWFkX2NvbmRfYnJvYWRjYXN0KHB0aHJlYWRf
Y29uZF90ICpjb25kKTsKK2ludCBfX3B0aHJlYWRfY29uZF90aW1lZHdhaXQo
cHRocmVhZF9jb25kX3QgKmNvbmQsIHB0aHJlYWRfbXV0ZXhfdCAqbXV0ZXgs
IGNvbnN0IHN0cnVjdCB0aW1lc3BlYyAqYWJzdGltZSk7CitpbnQgX19wdGhy
ZWFkX2NvbmRfd2FpdChwdGhyZWFkX2NvbmRfdCAqY29uZCwgcHRocmVhZF9t
dXRleF90ICptdXRleCk7CitpbnQgX19wdGhyZWFkX2NvbmRhdHRyX2luaXQg
KHB0aHJlYWRfY29uZGF0dHJfdCAqIGNvbmRhdHRyKTsKK2ludCBfX3B0aHJl
YWRfY29uZGF0dHJfZGVzdHJveSAocHRocmVhZF9jb25kYXR0cl90ICogY29u
ZGF0dHIpOworaW50IF9fcHRocmVhZF9jb25kYXR0cl9nZXRwc2hhcmVkIChj
b25zdCBwdGhyZWFkX2NvbmRhdHRyX3QgKmF0dHIsIGludCAqcHNoYXJlZCk7
CitpbnQgX19wdGhyZWFkX2NvbmRhdHRyX3NldHBzaGFyZWQgKHB0aHJlYWRf
Y29uZGF0dHJfdCAqYXR0ciwgaW50IHBzaGFyZWQpOwogCiAvKiBUaHJlYWQg
c2lnbmFsICovCiBpbnQgX19wdGhyZWFkX2tpbGwgKHB0aHJlYWRfdCAqIHRo
cmVhZCwgaW50IHNpZyk7CkluZGV4OiBjeWd3aW4vaW5jbHVkZS9wdGhyZWFk
LmgKPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PQpSQ1MgZmlsZTogL2N2cy9zcmMv
c3JjL3dpbnN1cC9jeWd3aW4vaW5jbHVkZS9wdGhyZWFkLmgsdgpyZXRyaWV2
aW5nIHJldmlzaW9uIDEuMgpkaWZmIC11IC1wIC1yMS4yIHB0aHJlYWQuaAot
LS0gcHRocmVhZC5oCTIwMDAvMDUvMDggMjI6Mzg6MDcJMS4yCisrKyBwdGhy
ZWFkLmgJMjAwMS8wMy8xNiAxNDoxOTozOApAQCAtMjMsNiArMjMsMTYgQEAg
ZXh0ZXJuICJDIgogCiAjZGVmaW5lIFRGRChuKSB2b2lkKigqbikodm9pZCop
CiAKKy8qIERlZmluZXMuIChUaGVzZSBhcmUgY29ycmVjdGx5IGRlZmluZWQg
aGVyZSBhcyBwZXIKKyAgIGh0dHA6Ly93d3cub3Blbmdyb3VwLm9yZy9vbmxp
bmVwdWJzLzc5MDg3OTkveHNoL3B0aHJlYWQuaC5odG1sICovCisKKy8qIEZJ
WE1FOiB0aGlzIHNob3VsZCBhbGxvY2F0ZSBhIG5ldyBjb25kIHZhcmlhYmxl
LCBhbmQgcmV0dXJuIHRoZSB2YWx1ZSAgdGhhdAorIHdvdWxkIG5vcm1hbGx5
IGJlIHdyaXR0ZW4gdG8gdGhlIHBhc3NlZCBwYXJhbWV0ZXIgb2YgcHRocmVh
ZF9jb25kX2luaXQobHZhbHVlLCBOVUxMKTsgKi8KKy8vICNkZWZpbmUgUFRI
UkVBRF9DT05EX0lOSVRJQUxJWkVSIDAKKworI2RlZmluZSBQVEhSRUFEX1BS
T0NFU1NfUFJJVkFURSAwCisjZGVmaW5lIFBUSFJFQURfUFJPQ0VTU19TSEFS
RUQgIDEKKwogdHlwZWRlZiBpbnQgcHRocmVhZF90OwogdHlwZWRlZiBpbnQg
cHRocmVhZF9tdXRleF90OwogdHlwZWRlZiBpbnQgc2VtX3Q7CkBAIC00Mywx
MiArNTMsMzUgQEAgdHlwZWRlZiBzdHJ1Y3QgcHRocmVhZF9tdXRleGF0dHIK
ICAgfQogcHRocmVhZF9tdXRleGF0dHJfdDsKIAordHlwZWRlZiBzdHJ1Y3Qg
cHRocmVhZF9jb25kYXR0cgorICB7CisgICAgaW50IHNoYXJlZDsKKyAgICBp
bnQgdmFsaWQ7CisgIH0KK3B0aHJlYWRfY29uZGF0dHJfdDsKKwordHlwZWRl
ZiBpbnQgcHRocmVhZF9jb25kX3Q7CisKIC8qICBUaHJlYWRDcmVhdGlvbiAq
LwogaW50IHB0aHJlYWRfY3JlYXRlIChwdGhyZWFkX3QgKiB0aHJlYWQsIGNv
bnN0IHB0aHJlYWRfYXR0cl90ICogYXR0ciwgVEZEIChmdW5jdGlvbiksIHZv
aWQgKmFyZyk7CiBpbnQgcHRocmVhZF9hdHRyX2luaXQgKHB0aHJlYWRfYXR0
cl90ICogYXR0cik7CiBpbnQgcHRocmVhZF9hdHRyX2Rlc3Ryb3kgKHB0aHJl
YWRfYXR0cl90ICogYXR0cik7CiBpbnQgcHRocmVhZF9hdHRyX3NldHN0YWNr
c2l6ZSAocHRocmVhZF9hdHRyX3QgKiBhdHRyLCBzaXplX3Qgc2l6ZSk7CiBp
bnQgcHRocmVhZF9hdHRyX2dldHN0YWNrc2l6ZSAocHRocmVhZF9hdHRyX3Qg
KiBhdHRyLCBzaXplX3QgKiBzaXplKTsKKworLyogQ29uZGl0aW9uIHZhcmlh
YmxlcyAqLworaW50ICAgcHRocmVhZF9jb25kX2Jyb2FkY2FzdChwdGhyZWFk
X2NvbmRfdCAqKTsKK2ludCAgIHB0aHJlYWRfY29uZF9kZXN0cm95KHB0aHJl
YWRfY29uZF90ICopOworaW50ICAgcHRocmVhZF9jb25kX2luaXQocHRocmVh
ZF9jb25kX3QgKiwgY29uc3QgcHRocmVhZF9jb25kYXR0cl90ICopOworaW50
ICAgcHRocmVhZF9jb25kX3NpZ25hbChwdGhyZWFkX2NvbmRfdCAqKTsKK2lu
dCAgIHB0aHJlYWRfY29uZF90aW1lZHdhaXQocHRocmVhZF9jb25kX3QgKiwg
CisgICAgICAgICAgcHRocmVhZF9tdXRleF90ICosIGNvbnN0IHN0cnVjdCB0
aW1lc3BlYyAqKTsKK2ludCAgIHB0aHJlYWRfY29uZF93YWl0KHB0aHJlYWRf
Y29uZF90ICosIHB0aHJlYWRfbXV0ZXhfdCAqKTsKK2ludCAgIHB0aHJlYWRf
Y29uZGF0dHJfZGVzdHJveShwdGhyZWFkX2NvbmRhdHRyX3QgKik7CitpbnQg
ICBwdGhyZWFkX2NvbmRhdHRyX2dldHBzaGFyZWQoY29uc3QgcHRocmVhZF9j
b25kYXR0cl90ICosIGludCAqKTsKK2ludCAgIHB0aHJlYWRfY29uZGF0dHJf
aW5pdChwdGhyZWFkX2NvbmRhdHRyX3QgKik7CitpbnQgICBwdGhyZWFkX2Nv
bmRhdHRyX3NldHBzaGFyZWQocHRocmVhZF9jb25kYXR0cl90ICosIGludCk7
CisKIAogLyogVGhyZWFkIENvbnRyb2wgKi8KIGludCBwdGhyZWFkX2RldGFj
aCAocHRocmVhZF90IHRocmVhZCk7Cg==

------------=_1583532846-65438-20--
