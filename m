Return-Path: <cygwin-patches-return-6734-listarch-cygwin-patches=sources.redhat.com@cygwin.com>
Received: (qmail 20459 invoked by alias); 6 Oct 2009 23:54:10 -0000
Received: (qmail 20449 invoked by uid 22791); 6 Oct 2009 23:54:09 -0000
X-SWARE-Spam-Status: No, hits=-3.5 required=5.0 	tests=AWL,BAYES_00,RCVD_IN_DNSWL_LOW,SPF_PASS
X-Spam-Check-By: sourceware.org
Received: from out2.smtp.messagingengine.com (HELO out2.smtp.messagingengine.com) (66.111.4.26)     by sourceware.org (qpsmtpd/0.43rc1) with ESMTP; Tue, 06 Oct 2009 23:54:04 +0000
Received: from compute1.internal (compute1.internal [10.202.2.41]) 	by gateway1.messagingengine.com (Postfix) with ESMTP id D68C287C13 	for <cygwin-patches@cygwin.com>; Tue,  6 Oct 2009 19:54:02 -0400 (EDT)
Received: from heartbeat2.messagingengine.com ([10.202.2.161])   by compute1.internal (MEProxy); Tue, 06 Oct 2009 19:54:02 -0400
Received: from [192.168.1.3] (user-0c6sbc4.cable.mindspring.com [24.110.45.132]) 	by mail.messagingengine.com (Postfix) with ESMTPSA id 752F84554; 	Tue,  6 Oct 2009 19:54:01 -0400 (EDT)
Message-ID: <4ACBD892.5040508@cwilson.fastmail.fm>
Date: Tue, 06 Oct 2009 23:54:00 -0000
From: Charles Wilson <cygwin@cwilson.fastmail.fm>
User-Agent: Mozilla/5.0 (Windows; U; Windows NT 6.0; en-US; rv:1.8.1.23) Gecko/20090812 Thunderbird/2.0.0.23 Mnenhy/0.7.6.666
MIME-Version: 1.0
To: cygwin-patches@cygwin.com
Subject: Merge pseudo-reloc-v2 support from mingw/pseudo-reloc.c
Content-Type: multipart/mixed;  boundary="------------040905080404010106020308"
Mailing-List: contact cygwin-patches-help@cygwin.com; run by ezmlm
Precedence: bulk
List-Id: <cygwin-patches.cygwin.com>
List-Subscribe: <mailto:cygwin-patches-subscribe@cygwin.com>
List-Post: <mailto:cygwin-patches@cygwin.com>
List-Archive: <http://sourceware.org/ml/cygwin-patches/>
List-Help: <mailto:cygwin-patches-help@cygwin.com>, <http://sourceware.org/ml/#faqs>
Sender: cygwin-patches-owner@cygwin.com
Mail-Followup-To: cygwin-patches@cygwin.com
X-SW-Source: 2009-q4/txt/msg00065.txt.bz2

This is a multi-part message in MIME format.
--------------040905080404010106020308
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-length: 4318

As discussed on cygwin-developers...
http://cygwin.com/ml/cygwin-developers/2009-10/msg00052.html
and thread. Please refer to that thread for the justification of this
patch, and some of the details of its evolution.

The changelog entry below is somewhat odd (multiple sections) because of
the licensing differences in the various files. Kai's only contribution
was to the pseudo-reloc.c code, which is entirely public domain (and he
placed his contributions to that file into the public domain, as well).
Similarly, my contributions to pseudo-reloc.c are also public domain.

Bowever, the changes to the other cygwin files are mine and are covered
by assignment to Red Hat.

Hence, three separate "entries". One question: when it comes time to
commit this to CVS, should it be done all in one lump, or 1-2-3 very
quick separate commits (even though the tree would be broken between,
say, #1 and #2)?

2009-10-06  Charles Wilson  <...>

	Additional pseudo-reloc-v2 support
	* ntdll.h: Add custom NTSTATUS value for pseudo-reloc
	errors STATUS_ILLEGAL_DLL_PSEUDO_RELOCATION.
	* pinfo.cc (status_exit): Map custom pseudo-reloc
	error value STATUS_ILLEGAL_DLL_PSEUDO_RELOCATION to 127.
	* sigproc.cc (child_info::proc_retry): Return exit code when
        STATUS_ILLEGAL_DLL_PSEUDO_RELOCATION.

2009-10-06  Charles Wilson  <...>

	Cygwin modifications to pseudo-reloc.c
	* lib/pseudo-reloc.c: Added comments throughout and various
	whitespace fixes. Exploit cygwin_internal(CW_EXIT_PROCESS,...)
	for fatal error handling that is consistent with cygwin process
	life-cycle. Ensure state variable (in _pei386_runtime_relocator)
	is unique to each address space, across fork().
	(__print_reloc_error): New function for reporting errors in a
	manner supported by cygwin at this early stage of the process
	life-cycle.
[*]	(_pei386_runtime_relocator): Ensure relocations performed
	only once for each address space, but are repeated after fork()
	in the new address space.
	(__write_memory) [MINGW]: Ensure that b is always initialized
	by call to VirtualQuery, even if -DNDEBUG.

2009-10-06  Kai Tietz  <...>

	Rewrite (copied from winsup/mingw/pseudo-reloc.c)
	* lib/pseudo-reloc.c: Rewritten to support v2 pseudo-relocs.
	(struct runtime_pseudo_reloc): Renamed to...
	(struct runtime_pseudo_reloc_item_v1): this.
	(struct runtime_pseudo_reloc_item_v2): New typedef.
	(struct runtime_pseudo_reloc_v2): New typedef.
	(__write_memory): New function (no longer need writable .text
	section, nor need to fold .rdata into .data).
	(do_pseudo_reloc): Rewritten entirely, to support both
	v1 and v2 relocations.
	(_pei386_runtime_relocator): Ensure relocations performed
	only once for each address space.


There are three attachments:

1) The full patch (04-pseudo-reloc-v2-support.patch)
2) The diff between winsup/mingw/pseudo-reloc.c and
winsup/cygwin/lib/pseudo-reloc.c -- that is, the diff between
pseudo-commit #1 and pseudo-commit #2.
(04-pseudo-reloc-cygwin-changes.patch)
3) A tarball containing a number of (standalone) test cases
(pseudo-reloc-tests-v3.tar.bz2).

After building and installing the new DLL (and libcygwin.a), the test
cases should be fairly explanatory. There are individual READMEs and
expected output is documented. To build, simply do 'make' in the
appropriate subdirectory.  You will need binutils-2.19.51-1 (or CVS
binutils newer than 2008-11-24) to test the v2 relocation, but the v1
tests will work with any cygwin binutils newer than 2003.

BTW: applications compiled to use v2 relocs will still work if you
execute those apps under an older cygwin DLL -- *unless* an error
condition occurs and the cygwin_internal(CW_EXIT_PROCESS, ...) is
triggered. Older cygwins don't support that particular cygwin_internal flag.

[*] by using NO_COPY on the was_init state variable in
_pei386_runtime_relocator, we ensure that the relocation is repeated in
the forkee. However, if at some point ld is changed so that .text (and
.rdata) are marked non-writable (unlike now, where .text is explicitly
writable and .rdata is folded in to the writable .data section), it's
not clear to me what effect that might have on the cygwin's (and
win32's) behavior when setting up the forkee's memory contents.

But...we can cross that bridge when we come to it. It may be that
nothing would need to change.

--
Chuck

--------------040905080404010106020308
Content-Type: application/x-patch;
 name="04-pseudo-reloc-v2-support.patch"
Content-Transfer-Encoding: base64
Content-Disposition: inline;
 filename="04-pseudo-reloc-v2-support.patch"
Content-length: 19866

PyBuZXdsaWIvbGliYy9saWJjLmluZm8KPyBuZXdsaWIvbGlibS9saWJtLmlu
Zm8KSW5kZXg6IHdpbnN1cC9jeWd3aW4vbnRkbGwuaAo9PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09ClJDUyBmaWxlOiAvY3ZzL3NyYy9zcmMvd2luc3VwL2N5Z3dp
bi9udGRsbC5oLHYKcmV0cmlldmluZyByZXZpc2lvbiAxLjk0CmRpZmYgLXUg
LXAgLXUgLXIxLjk0IG50ZGxsLmgKLS0tIHdpbnN1cC9jeWd3aW4vbnRkbGwu
aAkxNCBKdWwgMjAwOSAxNzozNzo0MiAtMDAwMAkxLjk0CisrKyB3aW5zdXAv
Y3lnd2luL250ZGxsLmgJNiBPY3QgMjAwOSAyMjoyNjozNyAtMDAwMApAQCAt
NDYsNiArNDYsOCBAQAogI2RlZmluZSBTVEFUVVNfRU5UUllQT0lOVF9OT1Rf
Rk9VTkQgICAoKE5UU1RBVFVTKSAweGMwMDAwMTM5KQogI2RlZmluZSBTVEFU
VVNfQkFEX0RMTF9FTlRSWVBPSU5UICAgICAoKE5UU1RBVFVTKSAweGMwMDAw
MjUxKQogI2RlZmluZSBTVEFUVVNfSUxMRUdBTF9ETExfUkVMT0NBVElPTiAo
KE5UU1RBVFVTKSAweGMwMDAwMjY5KQorLyogY3VzdG9tIHN0YXR1cyBjb2Rl
OiAqLworI2RlZmluZSBTVEFUVVNfSUxMRUdBTF9ETExfUFNFVURPX1JFTE9D
QVRJT04gKChOVFNUQVRVUykgMHhlMDAwMDI2OSkKIAogI2RlZmluZSBQRElf
TU9EVUxFUyAweDAxCiAjZGVmaW5lIFBESV9IRUFQUyAweDA0CkluZGV4OiB3
aW5zdXAvY3lnd2luL3BpbmZvLmNjCj09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0K
UkNTIGZpbGU6IC9jdnMvc3JjL3NyYy93aW5zdXAvY3lnd2luL3BpbmZvLmNj
LHYKcmV0cmlldmluZyByZXZpc2lvbiAxLjI1NQpkaWZmIC11IC1wIC11IC1y
MS4yNTUgcGluZm8uY2MKLS0tIHdpbnN1cC9jeWd3aW4vcGluZm8uY2MJNiBP
Y3QgMjAwOSAyMTo1MToxNyAtMDAwMAkxLjI1NQorKysgd2luc3VwL2N5Z3dp
bi9waW5mby5jYwk2IE9jdCAyMDA5IDIyOjI2OjM3IC0wMDAwCkBAIC0xMjgs
NiArMTI4LDEwIEBAIHN0YXR1c19leGl0IChEV09SRCB4KQogCXggPSAxMjc7
CiAgICAgICB9CiAgICAgICBicmVhazsKKyAgICBjYXNlIFNUQVRVU19JTExF
R0FMX0RMTF9QU0VVRE9fUkVMT0NBVElPTjogLyogY3VzdG9tIGVycm9yIHZh
bHVlICovCisgICAgICAvKiBXZSd2ZSBhbHJlYWR5IHByaW50ZWQgdGhlIGVy
cm9yIG1lc3NhZ2UgaW4gcHNldWRvLXJlbG9jLmMgKi8KKyAgICAgIHggPSAx
Mjc7CisgICAgICBicmVhazsKICAgICBkZWZhdWx0OgogICAgICAgeCA9IDEy
NzsKICAgICB9CkluZGV4OiB3aW5zdXAvY3lnd2luL3NpZ3Byb2MuY2MKPT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PQpSQ1MgZmlsZTogL2N2cy9zcmMvc3JjL3dp
bnN1cC9jeWd3aW4vc2lncHJvYy5jYyx2CnJldHJpZXZpbmcgcmV2aXNpb24g
MS4zMTcKZGlmZiAtdSAtcCAtdSAtcjEuMzE3IHNpZ3Byb2MuY2MKLS0tIHdp
bnN1cC9jeWd3aW4vc2lncHJvYy5jYwkyIEF1ZyAyMDA5IDIxOjM4OjQwIC0w
MDAwCTEuMzE3CisrKyB3aW5zdXAvY3lnd2luL3NpZ3Byb2MuY2MJNiBPY3Qg
MjAwOSAyMjoyNjozNyAtMDAwMApAQCAtOTIzLDYgKzkyMyw4IEBAIGNoaWxk
X2luZm86OnByb2NfcmV0cnkgKEhBTkRMRSBoKQogICAgICAgYnJlYWs7CiAg
ICAgY2FzZSBTVEFUVVNfRExMX05PVF9GT1VORDoKICAgICAgIHJldHVybiBl
eGl0X2NvZGU7CisgICAgY2FzZSBTVEFUVVNfSUxMRUdBTF9ETExfUFNFVURP
X1JFTE9DQVRJT046IC8qIHBzZXVkby1yZWxvYy5jIHNwZWNpZmljICovCisg
ICAgICByZXR1cm4gZXhpdF9jb2RlOwogICAgIGNhc2UgU1RBVFVTX0NPTlRS
T0xfQ19FWElUOgogICAgICAgaWYgKHNhd19jdHJsX2MgKCkpCiAJcmV0dXJu
IEVYSVRDT0RFX09LOwpJbmRleDogd2luc3VwL2N5Z3dpbi9saWIvcHNldWRv
LXJlbG9jLmMKPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQpSQ1MgZmlsZTogL2N2
cy9zcmMvc3JjL3dpbnN1cC9jeWd3aW4vbGliL3BzZXVkby1yZWxvYy5jLHYK
cmV0cmlldmluZyByZXZpc2lvbiAxLjEKZGlmZiAtdSAtcCAtdSAtcjEuMSBw
c2V1ZG8tcmVsb2MuYwotLS0gd2luc3VwL2N5Z3dpbi9saWIvcHNldWRvLXJl
bG9jLmMJOSBEZWMgMjAwMiAyMjo0OToxMiAtMDAwMAkxLjEKKysrIHdpbnN1
cC9jeWd3aW4vbGliL3BzZXVkby1yZWxvYy5jCTYgT2N0IDIwMDkgMjI6MjY6
MzggLTAwMDAKQEAgLTEsNiArMSw5IEBACiAvKiBwc2V1ZG8tcmVsb2MuYwog
Ci0gICBXcml0dGVuIGJ5IEVnb3IgRHVkYSA8ZGVvQGxvZ29zLW0ucnU+Cisg
ICBDb250cmlidXRlZCBieSBFZ29yIER1ZGEgIDxkZW9AbG9nb3MtbS5ydT4K
KyAgIE1vZGlmaWVkIGJ5IGFkZGl0aW9uIG9mIHJ1bnRpbWVfcHNldWRvX3Jl
bG9jIHZlcnNpb24gMgorICAgYnkgS2FpIFRpZXR6ICA8a2FpLnRpZXR6QG9u
ZXZpc2lvbi5jb20+CisJCiAgICBUSElTIFNPRlRXQVJFIElTIE5PVCBDT1BZ
UklHSFRFRAogCiAgICBUaGlzIHNvdXJjZSBjb2RlIGlzIG9mZmVyZWQgZm9y
IHVzZSBpbiB0aGUgcHVibGljIGRvbWFpbi4gWW91IG1heQpAQCAtMTMsMzMg
KzE2LDM1NiBAQAogKi8KIAogI2luY2x1ZGUgPHdpbmRvd3MuaD4KKyNpbmNs
dWRlIDxzdGRpby5oPgorI2luY2x1ZGUgPHN0ZGxpYi5oPgorI2luY2x1ZGUg
PHN0cmluZy5oPgorI2luY2x1ZGUgPGFzc2VydC5oPgorCisjaWYgZGVmaW5l
ZChfX0NZR1dJTl9fKQorI2luY2x1ZGUgPHdjaGFyLmg+CisjaW5jbHVkZSA8
bnRkZWYuaD4KKyNpbmNsdWRlIDxzdGRhcmcuaD4KKyNpbmNsdWRlIDxzeXMv
Y3lnd2luLmg+CisvKiBjb3BpZWQgZnJvbSB3aW5zdXAuaCAqLworIyBkZWZp
bmUgTk9fQ09QWSBfX2F0dHJpYnV0ZV9fKChub2NvbW1vbikpIF9fYXR0cmli
dXRlX18oKHNlY3Rpb24oIi5kYXRhX2N5Z3dpbl9ub2NvcHkiKSkpCisvKiBj
dXN0b20gc3RhdHVzIGNvZGU6ICovCisjZGVmaW5lIFNUQVRVU19JTExFR0FM
X0RMTF9QU0VVRE9fUkVMT0NBVElPTiAoKE5UU1RBVFVTKSAweGUwMDAwMjY5
KQorI2Vsc2UKKyMgZGVmaW5lIE5PX0NPUFkKKyNlbmRpZgogCiBleHRlcm4g
Y2hhciBfX1JVTlRJTUVfUFNFVURPX1JFTE9DX0xJU1RfXzsKIGV4dGVybiBj
aGFyIF9fUlVOVElNRV9QU0VVRE9fUkVMT0NfTElTVF9FTkRfXzsKIGV4dGVy
biBjaGFyIF9pbWFnZV9iYXNlX187CiAKLXR5cGVkZWYgc3RydWN0Ci0gIHsK
LSAgICBEV09SRCBhZGRlbmQ7Ci0gICAgRFdPUkQgdGFyZ2V0OwotICB9Ci1y
dW50aW1lX3BzZXVkb19yZWxvYzsKKy8qIHYxIHJlbG9jYXRpb24gaXMgYmFz
aWNhbGx5OgorICogICAqKGJhc2UgKyAudGFyZ2V0KSArPSAuYWRkZW5kCisg
KiB3aGVyZSAoYmFzZSArIC50YXJnZXQpIGlzIGFsd2F5cyBhc3N1bWVkIHRv
IHBvaW50CisgKiB0byBhIERXT1JEICg0IGJ5dGVzKS4KKyAqLwordHlwZWRl
ZiBzdHJ1Y3QgeworICBEV09SRCBhZGRlbmQ7CisgIERXT1JEIHRhcmdldDsK
K30gcnVudGltZV9wc2V1ZG9fcmVsb2NfaXRlbV92MTsKIAotdm9pZAotZG9f
cHNldWRvX3JlbG9jICh2b2lkKiBzdGFydCwgdm9pZCogZW5kLCB2b2lkKiBi
YXNlKQorLyogdjIgcmVsb2NhdGlvbiBpcyBtb3JlIGNvbXBsZXguIEluIGVm
ZmVjdCwgaXQgaXMKKyAqICAgICooYmFzZSArIC50YXJnZXQpICs9ICooYmFz
ZSArIC5zeW0pIC0gKGJhc2UgKyAuc3ltKQorICogd2l0aCBjYXJlIHRha2Vu
IGluIGJvdGggcmVhZGluZywgc2lnbiBleHRlbnNpb24sIGFuZCB3cml0aW5n
CisgKiBiZWNhdXNlIC5mbGFncyBtYXkgaW5kaWNhdGUgdGhhdCAoYmFzZSAr
IC50YXJnZXQpIG1heSBwb2ludAorICogdG8gYSBCWVRFLCBXT1JELCBEV09S
RCwgb3IgUVdPUkQgKHc2NCkuCisgKi8KK3R5cGVkZWYgc3RydWN0IHsKKyAg
RFdPUkQgc3ltOworICBEV09SRCB0YXJnZXQ7CisgIERXT1JEIGZsYWdzOwor
fSBydW50aW1lX3BzZXVkb19yZWxvY19pdGVtX3YyOworCit0eXBlZGVmIHN0
cnVjdCB7CisgIERXT1JEIG1hZ2ljMTsKKyAgRFdPUkQgbWFnaWMyOworICBE
V09SRCB2ZXJzaW9uOworfSBydW50aW1lX3BzZXVkb19yZWxvY192MjsKKwor
I2lmIGRlZmluZWQoX19DWUdXSU5fXykKKyNkZWZpbmUgU0hPUlRfTVNHX0JV
Rl9TWiAxMjgKKy8qIFRoaXMgZnVuY3Rpb24gaXMgdXNlZCB0byBwcmludCBz
aG9ydCBlcnJvciBtZXNzYWdlcworICogdG8gc3RkZXJyLCB3aGljaCBtYXkg
b2NjdXIgZHVyaW5nIERMTCBpbml0aWFsaXphdGlvbgorICogd2hpbGUgZml4
aW5nIHVwICdwc2V1ZG8nIHJlbG9jYXRpb25zLiBUaGlzIGVhcmx5LCB3ZQor
ICogbWF5IG5vdCBiZSBhYmxlIHRvIHVzZSBjeWd3aW4gc3RkaW8gZnVuY3Rp
b25zLCBzbyB3ZQorICogdXNlIHRoZSB3aW4zMiBXcml0ZUZpbGUgYXBpLiBU
aGlzIHNob3VsZCB3b3JrIHdpdGggYm90aAorICogbm9ybWFsIHdpbjMyIGNv
bnNvbGUgSU8gaGFuZGxlcywgcmVkaXJlY3RlZCBvbmVzLCBhbmQKKyAqIGN5
Z3dpbiBwdHlzLgorICovCitzdGF0aWMgQk9PTAorX19wcmludF9yZWxvY19l
cnJvciAoY29uc3QgY2hhciAqZm10LCAuLi4pCiB7Ci0gIERXT1JEIHJlbG9j
X3RhcmdldDsKLSAgcnVudGltZV9wc2V1ZG9fcmVsb2MqIHI7Ci0gIGZvciAo
ciA9IChydW50aW1lX3BzZXVkb19yZWxvYyopIHN0YXJ0OyByIDwgKHJ1bnRp
bWVfcHNldWRvX3JlbG9jKikgZW5kOyByKyspCisgIGNoYXIgYnVmW1NIT1JU
X01TR19CVUZfU1pdOworICB3Y2hhcl90IG1vZHVsZVtNQVhfUEFUSF07Cisg
IGNoYXIgKiBwb3NpeF9tb2R1bGUgPSBOVUxMOworICBCT09MIHJWYWwgPSBG
QUxTRTsKKyAgc3RhdGljIGNvbnN0IGNoYXIgKiBVTktOT1dOX01PRFVMRSA9
ICI8dW5rbm93biBtb2R1bGU+OiAiOworICBEV09SRCBsZW47CisgIERXT1JE
IGRvbmU7CisgIHZhX2xpc3QgYXJnczsKKyAgSEFORExFIGVycmggPSBHZXRT
dGRIYW5kbGUgKFNURF9FUlJPUl9IQU5ETEUpOworICBzc2l6ZV90IG1vZHVs
ZWxlbiA9IEdldE1vZHVsZUZpbGVOYW1lVyAoTlVMTCwgbW9kdWxlLCBzaXpl
b2YgKG1vZHVsZSkpOworCisgIGlmIChlcnJoID09IElOVkFMSURfSEFORExF
X1ZBTFVFKQorICAgIHJldHVybiBGQUxTRTsKKworICBpZiAobW9kdWxlbGVu
ID4gMCkKKyAgICBwb3NpeF9tb2R1bGUgPSBjeWd3aW5fY3JlYXRlX3BhdGgg
KENDUF9XSU5fV19UT19QT1NJWCwgbW9kdWxlKTsKKworICB2YV9zdGFydCAo
YXJncywgZm10KTsKKyAgbGVuID0gKERXT1JEKSB2c25wcmludGYgKGJ1Ziwg
U0hPUlRfTVNHX0JVRl9TWiwgZm10LCBhcmdzKTsKKyAgdmFfZW5kIChhcmdz
KTsKKyAgYnVmW1NIT1JUX01TR19CVUZfU1otMV0gPSAnXDAnOyAvKiBwYXJh
bm9pYSAqLworCisgIGlmIChwb3NpeF9tb2R1bGUpCiAgICAgewotICAgICAg
cmVsb2NfdGFyZ2V0ID0gKERXT1JEKSBiYXNlICsgci0+dGFyZ2V0OwotICAg
ICAgKigoRFdPUkQqKSByZWxvY190YXJnZXQpICs9IHItPmFkZGVuZDsKKyAg
ICAgIHJWYWwgPSBXcml0ZUZpbGUgKGVycmgsIChQQ1ZPSUQpcG9zaXhfbW9k
dWxlLAorICAgICAgICAgICAgICAgICAgICAgICAgc3RybGVuKHBvc2l4X21v
ZHVsZSksICZkb25lLCBOVUxMKSAmJgorICAgICAgICAgICAgIFdyaXRlRmls
ZSAoZXJyaCwgKFBDVk9JRCkiOiAiLCAyLCAmZG9uZSwgTlVMTCkgJiYKKyAg
ICAgICAgICAgICBXcml0ZUZpbGUgKGVycmgsIChQQ1ZPSUQpYnVmLCBsZW4s
ICZkb25lLCBOVUxMKTsKKyAgICAgIGZyZWUgKHBvc2l4X21vZHVsZSk7CiAg
ICAgfQorICBlbHNlCisgICAgeworICAgICAgclZhbCA9IFdyaXRlRmlsZSAo
ZXJyaCwgKFBDVk9JRClVTktOT1dOX01PRFVMRSwKKyAgICAgICAgICAgICAg
ICAgICAgICAgIHNpemVvZihVTktOT1dOX01PRFVMRSksICZkb25lLCBOVUxM
KSAmJgorICAgICAgICAgICAgIFdyaXRlRmlsZSAoZXJyaCwgKFBDVk9JRCli
dWYsIGxlbiwgJmRvbmUsIE5VTEwpOworICAgIH0KKyAgcmV0dXJuIHJWYWw7
CiB9CisjZW5kaWYgLyogX19DWUdXSU5fXyAqLworCisvKiBUaGlzIGZ1bmN0
aW9uIHRlbXBvcmFyaWx5IG1hcmtzIHRoZSBwYWdlIGNvbnRhaW5pbmcgYWRk
cgorICogd3JpdGFibGUsIGJlZm9yZSBjb3B5aW5nIGxlbiBieXRlcyBmcm9t
ICpzcmMgdG8gKmFkZHIsIGFuZAorICogdGhlbiByZXN0b3JlcyB0aGUgb3Jp
Z2luYWwgcHJvdGVjdGlvbiBzZXR0aW5ncyB0byB0aGUgcGFnZS4KKyAqCisg
KiBVc2luZyB0aGlzIGZ1bmN0aW9uIGVsaW1pbmF0ZXMgdGhlIHJlcXVpcmVt
ZW50IHdpdGggb2xkZXIKKyAqIHBzZXVkby1yZWxvYyBpbXBsZW1lbnRhdGlv
bnMsIHRoYXQgc2VjdGlvbnMgY29udGFpbmluZworICogcHNldWRvLXJlbG9j
cyAoc3VjaCBhcyAudGV4dCBhbmQgLnJkYXRhKSBiZSBwZXJtYW5lbnRseQor
ICogbWFya2VkIHdyaXRhYmxlLiBUaGlzIG9sZGVyIGJlaGF2aW9yIHNhYm90
YWdlZCBhbnkgbWVtb3J5CisgKiBzYXZpbmdzIGFjaGlldmVkIGJ5IHNoYXJl
ZCBsaWJyYXJpZXMgb24gd2luMzIgLS0gYW5kIHdhcworICogc2xvd2VyLCB0
b28uICBIb3dldmVyLCBvbiBjeWd3aW4gYXMgb2YgYmludXRpbHMgMi4yMCB0
aGUKKyAqIC50ZXh0IHNlY3Rpb24gaXMgc3RpbGwgbWFya2VkIHdyaXRhYmxl
LCBhbmQgdGhlIC5yZGF0YSBzZWN0aW9uCisgKiBpcyBmb2xkZWQgaW50byB0
aGUgKHdyaXRhYmxlKSAuZGF0YSB3aGVuIC0tZW5hYmxlLWF1dG8taW1wb3J0
LgorICovCitzdGF0aWMgdm9pZAorX193cml0ZV9tZW1vcnkgKHZvaWQgKmFk
ZHIsY29uc3Qgdm9pZCAqc3JjLHNpemVfdCBsZW4pCit7CisgIE1FTU9SWV9C
QVNJQ19JTkZPUk1BVElPTiBiOworICBEV09SRCBvbGRwcm90OworICBTSVpF
X1QgbWVtc3o7CisKKyAgaWYgKCFsZW4pCisgICAgcmV0dXJuOworCisgIG1l
bXN6ID0gVmlydHVhbFF1ZXJ5IChhZGRyLCAmYiwgc2l6ZW9mKGIpKTsKKwor
I2lmIGRlZmluZWQoX19DWUdXSU5fXykKKyAgLyogQ1lHV0lOOiBJZiBlcnJv
ciwgcHJpbnQgZXJyb3IgbWVzc2FnZSBhbmQgZGllLiAqLworICBpZiAobWVt
c3ogPT0gMCkKKyAgICB7CisgICAgICBfX3ByaW50X3JlbG9jX2Vycm9yICgK
KyAgICAgICAgImVycm9yIHdoaWxlIGxvYWRpbmcgc2hhcmVkIGxpYnJhcmll
czogYmFkIGFkZHJlc3Mgc3BlY2lmaWVkIDB4JTA4eC5cbiIsCisgICAgICAg
IGFkZHIpOworICAgICAgY3lnd2luX2ludGVybmFsIChDV19FWElUX1BST0NF
U1MsCisgICAgICAgICAgICAgICAgICAgICAgIFNUQVRVU19JTExFR0FMX0RM
TF9QU0VVRE9fUkVMT0NBVElPTiwKKyAgICAgICAgICAgICAgICAgICAgICAg
MSk7CisgICAgfQorI2Vsc2UKKyAgLyogTUlOR1c6IElmIGVycm9yLCBkaWUu
IGFzc2VydCgpIG1heSBwcmludCBlcnJvciBtZXNzYWdlIHdoZW4gIU5ERUJV
RyAqLworICBhc3NlcnQgKG1lbXN6KTsKKyNlbmRpZgorCisgIC8qIFRlbXBv
cmFyaWx5IGFsbG93IHdyaXRlIGFjY2VzcyB0byByZWFkLW9ubHkgcHJvdGVj
dGVkIG1lbW9yeS4gICovCisgIGlmIChiLlByb3RlY3QgIT0gUEFHRV9FWEVD
VVRFX1JFQURXUklURSAmJiBiLlByb3RlY3QgIT0gUEFHRV9SRUFEV1JJVEUp
CisgICAgVmlydHVhbFByb3RlY3QgKGIuQmFzZUFkZHJlc3MsIGIuUmVnaW9u
U2l6ZSwgUEFHRV9FWEVDVVRFX1JFQURXUklURSwKKwkJICAmb2xkcHJvdCk7
CisgIC8qIHdyaXRlIHRoZSBkYXRhLiAqLworICBtZW1jcHkgKGFkZHIsIHNy
YywgbGVuKTsKKyAgLyogUmVzdG9yZSBvcmlnaW5hbCBwcm90ZWN0aW9uLiAq
LworICBpZiAoYi5Qcm90ZWN0ICE9IFBBR0VfRVhFQ1VURV9SRUFEV1JJVEUg
JiYgYi5Qcm90ZWN0ICE9IFBBR0VfUkVBRFdSSVRFKQorICAgIFZpcnR1YWxQ
cm90ZWN0IChiLkJhc2VBZGRyZXNzLCBiLlJlZ2lvblNpemUsIG9sZHByb3Qs
ICZvbGRwcm90KTsKK30KKworI2RlZmluZSBSUF9WRVJTSU9OX1YxIDAKKyNk
ZWZpbmUgUlBfVkVSU0lPTl9WMiAxCisKK3N0YXRpYyB2b2lkCitkb19wc2V1
ZG9fcmVsb2MgKHZvaWQgKiBzdGFydCwgdm9pZCAqIGVuZCwgdm9pZCAqIGJh
c2UpCit7CisgIHB0cmRpZmZfdCBhZGRyX2ltcCwgcmVsZGF0YTsKKyAgcHRy
ZGlmZl90IHJlbG9jX3RhcmdldCA9IChwdHJkaWZmX3QpICgoY2hhciAqKWVu
ZCAtIChjaGFyKilzdGFydCk7CisgIHJ1bnRpbWVfcHNldWRvX3JlbG9jX3Yy
ICp2Ml9oZHIgPSAocnVudGltZV9wc2V1ZG9fcmVsb2NfdjIgKikgc3RhcnQ7
CisgIHJ1bnRpbWVfcHNldWRvX3JlbG9jX2l0ZW1fdjIgKnI7CisKKyAgLyog
QSB2YWxpZCByZWxvY2F0aW9uIGxpc3Qgd2lsbCBjb250YWluIGF0IGxlYXN0
IG9uZSBlbnRyeSwgYW5kCisgICAqIG9uZSB2MSBkYXRhIHN0cnVjdHVyZSAo
dGhlIHNtYWxsZXN0IG9uZSkgcmVxdWlyZXMgdHdvIERXT1JEcy4KKyAgICog
U28sIGlmIHRoZSByZWxvY2F0aW9uIGxpc3QgaXMgc21hbGxlciB0aGFuIDgg
Ynl0ZXMsIGJhaWwuCisgICAqLworICBpZiAocmVsb2NfdGFyZ2V0IDwgOCkK
KyAgICByZXR1cm47CisKKyAgLyogQ2hlY2sgaWYgdGhpcyBpcyB0aGUgb2xk
IHBzZXVkbyByZWxvY2F0aW9uIHZlcnNpb24uICAqLworICAvKiBUaGVyZSBh
cmUgdHdvIGtpbmRzIG9mIHYxIHJlbG9jYXRpb24gbGlzdHM6CisgICAqICAg
MSkgV2l0aCBhICh2Mi1zdHlsZSkgdmVyc2lvbiBoZWFkZXIuIEluIHRoaXMg
Y2FzZSwgdGhlCisgICAqICAgICAgZmlyc3QgZW50cnkgaW4gdGhlIGxpc3Qg
aXMgYSAzLURXT1JEIHN0cnVjdHVyZSwgd2l0aAorICAgKiAgICAgIHZhbHVl
OgorICAgKiAgICAgICAgIHsgMCwgMCwgUlBfVkVSU0lPTl9WMSB9CisgICAq
ICAgICAgSW4gdGhpcyBjYXNlLCB3ZSBza2lwIHRvIHRoZSBuZXh0IGVudHJ5
IGluIHRoZSBsaXN0LAorICAgKiAgICAgIGtub3dpbmcgdGhhdCBhbGwgZWxl
bWVudHMgYWZ0ZXIgdGhlIGhlYWQgaXRlbSBjYW4KKyAgICogICAgICBiZSBj
YXN0IHRvIHJ1bnRpbWVfcHNldWRvX3JlbG9jX2l0ZW1fdjEuCisgICAqICAg
MikgV2l0aG91dCBhICh2Mi1zdHlsZSkgdmVyc2lvbiBoZWFkZXIuIEluIHRo
aXMgY2FzZSwgdGhlCisgICAqICAgICAgZmlyc3QgZWxlbWVudCBpbiB0aGUg
bGlzdCBJUyBhbiBhY3R1YWwgdjEgcmVsb2NhdGlvbgorICAgKiAgICAgIHJl
Y29yZCwgd2hpY2ggaXMgdHdvIERXT1JEcy4gIEJlY2F1c2UgdGhlcmUgd2ls
bCBuZXZlcgorICAgKiAgICAgIGJlIGEgY2FzZSB3aGVyZSBhIHYxIHJlbG9j
YXRpb24gcmVjb3JkIGhhcyBib3RoCisgICAqICAgICAgYWRkZW5kID09IDAg
YW5kIHRhcmdldCA9PSAwLCB0aGlzIGNhc2Ugd2lsbCBub3QgYmUKKyAgICog
ICAgICBjb25mdXNlZCB3aXRoIHRoZSBwcmlvciBvbmUuCisgICAqIEFsbCBj
dXJyZW50IGJpbnV0aWxzLCB3aGVuIGdlbmVyYXRpbmcgYSB2MSByZWxvY2F0
aW9uIGxpc3QsCisgICAqIHVzZSB0aGUgc2Vjb25kIChlLmcuIG9yaWdpbmFs
KSBmb3JtIC0tIHRoYXQgaXMsIHdpdGhvdXQgdGhlCisgICAqIHYyLXN0eWxl
IHZlcnNpb24gaGVhZGVyLgorICAgKi8KKyAgaWYgKHJlbG9jX3RhcmdldCA+
PSAxMgorICAgICAgJiYgdjJfaGRyLT5tYWdpYzEgPT0gMCAmJiB2Ml9oZHIt
Pm1hZ2ljMiA9PSAwCisgICAgICAmJiB2Ml9oZHItPnZlcnNpb24gPT0gUlBf
VkVSU0lPTl9WMSkKKyAgICB7CisgICAgICAvKiBXZSBoYXZlIGEgbGlzdCBo
ZWFkZXIgaXRlbSBpbmRpY2F0aW5nIHRoYXQgdGhlIHJlc3QKKyAgICAgICAq
IG9mIHRoZSBsaXN0IGNvbnRhaW5zIHYxIGVudHJpZXMuICBNb3ZlIHRoZSBw
b2ludGVyIHRvCisgICAgICAgKiB0aGUgZmlyc3QgdHJ1ZSB2MSByZWxvY2F0
aW9uIHJlY29yZC4gIEJ5IGRlZmluaXRpb24sCisgICAgICAgKiB0aGF0IHYx
IGVsZW1lbnQgd2lsbCBub3QgaGF2ZSBib3RoIGFkZGVuZCA9PSAwIGFuZAor
ICAgICAgICogdGFyZ2V0ID09IDAgKGFuZCB0aHVzLCB3aGVuIGludGVycHJl
dGVkIGFzIGEKKyAgICAgICAqIHJ1bnRpbWVfcHNldWRvX3JlbG9jX3YyLCBp
dCB3aWxsIG5vdCBoYXZlIGJvdGgKKyAgICAgICAqIG1hZ2ljMSA9PSAwIGFu
ZCBtYWdpYzIgPT0gMCkuCisgICAgICAgKi8KKyAgICAgIHYyX2hkcisrOwor
ICAgIH0KKworICBpZiAodjJfaGRyLT5tYWdpYzEgIT0gMCB8fCB2Ml9oZHIt
Pm1hZ2ljMiAhPSAwKQorICAgIHsKKyAgICAgIC8qKioqKioqKioqKioqKioq
KioqKioqKioqCisgICAgICAgKiBIYW5kbGUgdjEgcmVsb2NhdGlvbnMgKgor
ICAgICAgICoqKioqKioqKioqKioqKioqKioqKioqKiovCisgICAgICBydW50
aW1lX3BzZXVkb19yZWxvY19pdGVtX3YxICogbzsKKyAgICAgIGZvciAobyA9
IChydW50aW1lX3BzZXVkb19yZWxvY19pdGVtX3YxICopIHYyX2hkcjsKKwkg
ICBvIDwgKHJ1bnRpbWVfcHNldWRvX3JlbG9jX2l0ZW1fdjEgKillbmQ7Cisg
ICAgICAgICAgIG8rKykKKwl7CisJICBEV09SRCBuZXd2YWw7CisJICByZWxv
Y190YXJnZXQgPSAocHRyZGlmZl90KSBiYXNlICsgby0+dGFyZ2V0OworCSAg
bmV3dmFsID0gKCooKERXT1JEKikgcmVsb2NfdGFyZ2V0KSkgKyBvLT5hZGRl
bmQ7CisJICBfX3dyaXRlX21lbW9yeSAoKHZvaWQgKikgcmVsb2NfdGFyZ2V0
LCAmbmV3dmFsLCBzaXplb2YoRFdPUkQpKTsKKwl9CisgICAgICByZXR1cm47
CisgICAgfQorCisgIC8qIElmIHdlIGdvdCB0aGlzIGZhciwgdGhlbiB3ZSBo
YXZlIHJlbG9jYXRpb25zIG9mIHZlcnNpb24gMiBvciBuZXdlciAqLworCisg
IC8qIENoZWNrIGlmIHRoaXMgaXMgYSBrbm93biB2ZXJzaW9uLiAgKi8KKyAg
aWYgKHYyX2hkci0+dmVyc2lvbiAhPSBSUF9WRVJTSU9OX1YyKQorICAgIHsK
KyNpZiBkZWZpbmVkKF9fQ1lHV0lOX18pCisgICAgICAvKiBDWUdXSU46IFBy
aW50IGVycm9yIG1lc3NhZ2UgYW5kIGRpZSwgZXZlbiB3aGVuICFERUJVR0dJ
TkcgKi8KKyAgICAgIF9fcHJpbnRfcmVsb2NfZXJyb3IgKAorICAgICAgICAi
ZXJyb3Igd2hpbGUgbG9hZGluZyBzaGFyZWQgbGlicmFyaWVzOiBpbnZhbGlk
IHBzZXVkb19yZWxvYyB2ZXJzaW9uICVkLlxuIiwKKyAgICAgICAgKGludCkg
djJfaGRyLT52ZXJzaW9uKTsKKyAgICAgIGN5Z3dpbl9pbnRlcm5hbCAoQ1df
RVhJVF9QUk9DRVNTLAorICAgICAgICAgICAgICAgICAgICAgICBTVEFUVVNf
SUxMRUdBTF9ETExfUFNFVURPX1JFTE9DQVRJT04sCisgICAgICAgICAgICAg
ICAgICAgICAgIDEpOworI2Vsc2UKKyMgaWYgZGVmaW5lZChERUJVRykKKyAg
ICAgIC8qIE1JTkdXOiBEb24ndCBkaWU7IGp1c3QgcmV0dXJuIHRvIGNhbGxl
ci4gSWYgREVCVUcsIHByaW50IGVycm9yIG1lc3NhZ2UuICovCisgICAgICBm
cHJpbnRmIChzdGRlcnIsICJpbnRlcm5hbCBtaW5ndyBydW50aW1lIGVycm9y
OiIKKwkgICAgICAgInBzdWVkb19yZWxvYyB2ZXJzaW9uICVkIGlzIHVua25v
d24gdG8gdGhpcyBydW50aW1lLlxuIiwKKwkgICAgICAgKGludCkgdjJfaGRy
LT52ZXJzaW9uKTsKKyMgZW5kaWYKKyNlbmRpZgorICAgICAgcmV0dXJuOwor
ICAgIH0KKworICAvKioqKioqKioqKioqKioqKioqKioqKioqKgorICAgKiBI
YW5kbGUgdjIgcmVsb2NhdGlvbnMgKgorICAgKioqKioqKioqKioqKioqKioq
KioqKioqKi8KKworICAvKiBXYWxrIG92ZXIgaGVhZGVyLiAqLworICByID0g
KHJ1bnRpbWVfcHNldWRvX3JlbG9jX2l0ZW1fdjIgKikgJnYyX2hkclsxXTsK
KworICBmb3IgKDsgciA8IChydW50aW1lX3BzZXVkb19yZWxvY19pdGVtX3Yy
ICopIGVuZDsgcisrKQorICAgIHsKKyAgICAgIC8qIGxvY2F0aW9uIHdoZXJl
IG5ldyBhZGRyZXNzIHdpbGwgYmUgd3JpdHRlbiAqLworICAgICAgcmVsb2Nf
dGFyZ2V0ID0gKHB0cmRpZmZfdCkgYmFzZSArIHItPnRhcmdldDsKKworICAg
ICAgLyogZ2V0IHN5bSBwb2ludGVyLiBJdCBwb2ludHMgZWl0aGVyIHRvIHRo
ZSBpYXQgZW50cnkKKyAgICAgICAqIG9mIHRoZSByZWZlcmVuY2VkIGVsZW1l
bnQsIG9yIHRvIHRoZSBzdHViIGZ1bmN0aW9uLgorICAgICAgICovCisgICAg
ICBhZGRyX2ltcCA9IChwdHJkaWZmX3QpIGJhc2UgKyByLT5zeW07CisgICAg
ICBhZGRyX2ltcCA9ICooKHB0cmRpZmZfdCAqKSBhZGRyX2ltcCk7CisKKyAg
ICAgIC8qIHJlYWQgZXhpc3RpbmcgcmVsb2NhdGlvbiB2YWx1ZSBmcm9tIGlt
YWdlLCBjYXN0aW5nIHRvIHRoZQorICAgICAgICogYml0c2l6ZSBpbmRpY2F0
ZWQgYnkgdGhlIDggTFNCcyBvZiBmbGFncy4gSWYgdGhlIHZhbHVlIGlzCisg
ICAgICAgKiBuZWdhdGl2ZSwgbWFudWFsbHkgc2lnbi1leHRlbmQgdG8gcHRy
ZGlmZl90IHdpZHRoLiBSYWlzZSBhbgorICAgICAgICogZXJyb3IgaWYgdGhl
IGJpdHNpemUgaW5kaWNhdGVkIGJ5IHRoZSA4IExTQnMgb2YgZmxhZ3MgaXMg
bm90CisgICAgICAgKiBzdXBwb3J0ZWQuCisgICAgICAgKi8KKyAgICAgIHN3
aXRjaCAoKHItPmZsYWdzICYgMHhmZikpCisgICAgICAgIHsKKyAgICAgICAg
ICBjYXNlIDg6CisJICAgIHJlbGRhdGEgPSAocHRyZGlmZl90KSAoKigodW5z
aWduZWQgY2hhciAqKXJlbG9jX3RhcmdldCkpOworCSAgICBpZiAoKHJlbGRh
dGEgJiAweDgwKSAhPSAwKQorCSAgICAgIHJlbGRhdGEgfD0gfigocHRyZGlm
Zl90KSAweGZmKTsKKwkgICAgYnJlYWs7CisJICBjYXNlIDE2OgorCSAgICBy
ZWxkYXRhID0gKHB0cmRpZmZfdCkgKCooKHVuc2lnbmVkIHNob3J0ICopcmVs
b2NfdGFyZ2V0KSk7CisJICAgIGlmICgocmVsZGF0YSAmIDB4ODAwMCkgIT0g
MCkKKwkgICAgICByZWxkYXRhIHw9IH4oKHB0cmRpZmZfdCkgMHhmZmZmKTsK
KwkgICAgYnJlYWs7CisJICBjYXNlIDMyOgorCSAgICByZWxkYXRhID0gKHB0
cmRpZmZfdCkgKCooKHVuc2lnbmVkIGludCAqKXJlbG9jX3RhcmdldCkpOwor
I2lmZGVmIF9XSU42NAorCSAgICBpZiAoKHJlbGRhdGEgJiAweDgwMDAwMDAw
KSAhPSAwKQorCSAgICAgIHJlbGRhdGEgfD0gfigocHRyZGlmZl90KSAweGZm
ZmZmZmZmKTsKKyNlbmRpZgorCSAgICBicmVhazsKKyNpZmRlZiBfV0lONjQK
KwkgIGNhc2UgNjQ6CisJICAgIHJlbGRhdGEgPSAocHRyZGlmZl90KSAoKigo
dW5zaWduZWQgbG9uZyBsb25nICopcmVsb2NfdGFyZ2V0KSk7CisJICAgIGJy
ZWFrOworI2VuZGlmCisJICBkZWZhdWx0OgorCSAgICByZWxkYXRhPTA7Cisj
aWYgZGVmaW5lZChfX0NZR1dJTl9fKQorICAgICAgICAgICAgLyogUHJpbnQg
ZXJyb3IgbWVzc2FnZSBhbmQgZGllLCBldmVuIHdoZW4gIURFQlVHR0lORyAq
LworICAgICAgICAgICAgX19wcmludF9yZWxvY19lcnJvciAoCisgICAgICAg
ICAgICAgICJlcnJvciB3aGlsZSBsb2FkaW5nIHNoYXJlZCBsaWJyYXJpZXM6
IHVua25vd24gcHNldWRvX3JlbG9jIGJpdCBzaXplICVkLlxuIiwKKyAgICAg
ICAgICAgICAgKGludCkgKHItPmZsYWdzICYgMHhmZikpOworICAgICAgICAg
ICAgY3lnd2luX2ludGVybmFsIChDV19FWElUX1BST0NFU1MsCisgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIFNUQVRVU19JTExFR0FMX0RMTF9QU0VV
RE9fUkVMT0NBVElPTiwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
MSk7CisjZWxzZQorIyBpZmRlZiBERUJVRworICAgICAgICAgICAgLyogTUlO
R1c6IElmIGVycm9yLCBkb24ndCBkaWU7IGp1c3QgcHJpbnQgbWVzc2FnZSBp
ZiBERUJVRyAqLworCSAgICBmcHJpbnRmKHN0ZGVyciwgImludGVybmFsIG1p
bmd3IHJ1bnRpbWUgZXJyb3I6ICIKKwkJICAgICJ1bmtub3duIHBzZXVkb19y
ZWxvYyBiaXQgc2l6ZSAlZFxuIiwKKwkJICAgIChpbnQpIChyLT5mbGFncyAm
IDB4ZmYpKTsKKyMgZW5kaWYKKyNlbmRpZgorCSAgICBicmVhazsKKyAgICAg
ICAgfQorCisgICAgICAvKiBBZGp1c3QgdGhlIHJlbG9jYXRpb24gdmFsdWUg
Ki8KKyAgICAgIHJlbGRhdGEgLT0gKChwdHJkaWZmX3QpIGJhc2UgKyByLT5z
eW0pOworICAgICAgcmVsZGF0YSArPSBhZGRyX2ltcDsKKworICAgICAgLyog
V3JpdGUgdGhlIG5ldyByZWxvY2F0aW9uIHZhbHVlIGJhY2sgdG8gKnJlbG9j
X3RhcmdldCAqLworICAgICAgc3dpdGNoICgoci0+ZmxhZ3MgJiAweGZmKSkK
KyAgICAgICAgeworICAgICAgICAgY2FzZSA4OgorICAgICAgICAgICBfX3dy
aXRlX21lbW9yeSAoKHZvaWQgKikgcmVsb2NfdGFyZ2V0LCAmcmVsZGF0YSwg
MSk7CisJICAgYnJlYWs7CisJIGNhc2UgMTY6CisgICAgICAgICAgIF9fd3Jp
dGVfbWVtb3J5ICgodm9pZCAqKSByZWxvY190YXJnZXQsICZyZWxkYXRhLCAy
KTsKKwkgICBicmVhazsKKwkgY2FzZSAzMjoKKyAgICAgICAgICAgX193cml0
ZV9tZW1vcnkgKCh2b2lkICopIHJlbG9jX3RhcmdldCwgJnJlbGRhdGEsIDQp
OworCSAgIGJyZWFrOworI2lmZGVmIF9XSU42NAorCSBjYXNlIDY0OgorICAg
ICAgICAgICBfX3dyaXRlX21lbW9yeSAoKHZvaWQgKikgcmVsb2NfdGFyZ2V0
LCAmcmVsZGF0YSwgOCk7CisJICAgYnJlYWs7CisjZW5kaWYKKyAgICAgICAg
fQorICAgICB9CisgfQogCiB2b2lkCiBfcGVpMzg2X3J1bnRpbWVfcmVsb2Nh
dG9yICgpCiB7CisgIHN0YXRpYyBOT19DT1BZIGludCB3YXNfaW5pdCA9IDA7
CisgIGlmICh3YXNfaW5pdCkKKyAgICByZXR1cm47CisgICsrd2FzX2luaXQ7
CiAgIGRvX3BzZXVkb19yZWxvYyAoJl9fUlVOVElNRV9QU0VVRE9fUkVMT0Nf
TElTVF9fLAogCQkgICAmX19SVU5USU1FX1BTRVVET19SRUxPQ19MSVNUX0VO
RF9fLAogCQkgICAmX2ltYWdlX2Jhc2VfXyk7Cg==

--------------040905080404010106020308
Content-Type: application/x-patch;
 name="04-pseudo-reloc-cygwin-changes.patch"
Content-Transfer-Encoding: base64
Content-Disposition: inline;
 filename="04-pseudo-reloc-cygwin-changes.patch"
Content-length: 14567

LS0tIHdpbnN1cC9taW5ndy9wc2V1ZG8tcmVsb2MuYwkyMDA5LTAzLTE3IDA5
OjE4OjA4LjQ2MzMwMDAwMCAtMDQwMAorKysgd2luc3VwL2N5Z3dpbi9saWIv
cHNldWRvLXJlbG9jLmMJMjAwOS0xMC0wNiAxODoyNjowNy4xNjYxMDAwMDAg
LTA0MDAKQEAgLTIwLDE2ICsyMCw0MCBAQAogI2luY2x1ZGUgPHN0ZGxpYi5o
PgogI2luY2x1ZGUgPHN0cmluZy5oPgogI2luY2x1ZGUgPGFzc2VydC5oPgot
IAotIGV4dGVybiBjaGFyIF9fUlVOVElNRV9QU0VVRE9fUkVMT0NfTElTVF9f
OwotIGV4dGVybiBjaGFyIF9fUlVOVElNRV9QU0VVRE9fUkVMT0NfTElTVF9F
TkRfXzsKLSBleHRlcm4gY2hhciBfaW1hZ2VfYmFzZV9fOwotIAorCisjaWYg
ZGVmaW5lZChfX0NZR1dJTl9fKQorI2luY2x1ZGUgPHdjaGFyLmg+CisjaW5j
bHVkZSA8bnRkZWYuaD4KKyNpbmNsdWRlIDxzdGRhcmcuaD4KKyNpbmNsdWRl
IDxzeXMvY3lnd2luLmg+CisvKiBjb3BpZWQgZnJvbSB3aW5zdXAuaCAqLwor
IyBkZWZpbmUgTk9fQ09QWSBfX2F0dHJpYnV0ZV9fKChub2NvbW1vbikpIF9f
YXR0cmlidXRlX18oKHNlY3Rpb24oIi5kYXRhX2N5Z3dpbl9ub2NvcHkiKSkp
CisvKiBjdXN0b20gc3RhdHVzIGNvZGU6ICovCisjZGVmaW5lIFNUQVRVU19J
TExFR0FMX0RMTF9QU0VVRE9fUkVMT0NBVElPTiAoKE5UU1RBVFVTKSAweGUw
MDAwMjY5KQorI2Vsc2UKKyMgZGVmaW5lIE5PX0NPUFkKKyNlbmRpZgorCitl
eHRlcm4gY2hhciBfX1JVTlRJTUVfUFNFVURPX1JFTE9DX0xJU1RfXzsKK2V4
dGVybiBjaGFyIF9fUlVOVElNRV9QU0VVRE9fUkVMT0NfTElTVF9FTkRfXzsK
K2V4dGVybiBjaGFyIF9pbWFnZV9iYXNlX187CisKKy8qIHYxIHJlbG9jYXRp
b24gaXMgYmFzaWNhbGx5OgorICogICAqKGJhc2UgKyAudGFyZ2V0KSArPSAu
YWRkZW5kCisgKiB3aGVyZSAoYmFzZSArIC50YXJnZXQpIGlzIGFsd2F5cyBh
c3N1bWVkIHRvIHBvaW50CisgKiB0byBhIERXT1JEICg0IGJ5dGVzKS4KKyAq
LwogdHlwZWRlZiBzdHJ1Y3QgewogICBEV09SRCBhZGRlbmQ7CiAgIERXT1JE
IHRhcmdldDsKIH0gcnVudGltZV9wc2V1ZG9fcmVsb2NfaXRlbV92MTsKIAor
LyogdjIgcmVsb2NhdGlvbiBpcyBtb3JlIGNvbXBsZXguIEluIGVmZmVjdCwg
aXQgaXMKKyAqICAgICooYmFzZSArIC50YXJnZXQpICs9ICooYmFzZSArIC5z
eW0pIC0gKGJhc2UgKyAuc3ltKQorICogd2l0aCBjYXJlIHRha2VuIGluIGJv
dGggcmVhZGluZywgc2lnbiBleHRlbnNpb24sIGFuZCB3cml0aW5nCisgKiBi
ZWNhdXNlIC5mbGFncyBtYXkgaW5kaWNhdGUgdGhhdCAoYmFzZSArIC50YXJn
ZXQpIG1heSBwb2ludAorICogdG8gYSBCWVRFLCBXT1JELCBEV09SRCwgb3Ig
UVdPUkQgKHc2NCkuCisgKi8KIHR5cGVkZWYgc3RydWN0IHsKICAgRFdPUkQg
c3ltOwogICBEV09SRCB0YXJnZXQ7CkBAIC00MiwyNiArNjYsMTE0IEBACiAg
IERXT1JEIHZlcnNpb247CiB9IHJ1bnRpbWVfcHNldWRvX3JlbG9jX3YyOwog
CisjaWYgZGVmaW5lZChfX0NZR1dJTl9fKQorI2RlZmluZSBTSE9SVF9NU0df
QlVGX1NaIDEyOAorLyogVGhpcyBmdW5jdGlvbiBpcyB1c2VkIHRvIHByaW50
IHNob3J0IGVycm9yIG1lc3NhZ2VzCisgKiB0byBzdGRlcnIsIHdoaWNoIG1h
eSBvY2N1ciBkdXJpbmcgRExMIGluaXRpYWxpemF0aW9uCisgKiB3aGlsZSBm
aXhpbmcgdXAgJ3BzZXVkbycgcmVsb2NhdGlvbnMuIFRoaXMgZWFybHksIHdl
CisgKiBtYXkgbm90IGJlIGFibGUgdG8gdXNlIGN5Z3dpbiBzdGRpbyBmdW5j
dGlvbnMsIHNvIHdlCisgKiB1c2UgdGhlIHdpbjMyIFdyaXRlRmlsZSBhcGku
IFRoaXMgc2hvdWxkIHdvcmsgd2l0aCBib3RoCisgKiBub3JtYWwgd2luMzIg
Y29uc29sZSBJTyBoYW5kbGVzLCByZWRpcmVjdGVkIG9uZXMsIGFuZAorICog
Y3lnd2luIHB0eXMuCisgKi8KK3N0YXRpYyBCT09MCitfX3ByaW50X3JlbG9j
X2Vycm9yIChjb25zdCBjaGFyICpmbXQsIC4uLikKK3sKKyAgY2hhciBidWZb
U0hPUlRfTVNHX0JVRl9TWl07CisgIHdjaGFyX3QgbW9kdWxlW01BWF9QQVRI
XTsKKyAgY2hhciAqIHBvc2l4X21vZHVsZSA9IE5VTEw7CisgIEJPT0wgclZh
bCA9IEZBTFNFOworICBzdGF0aWMgY29uc3QgY2hhciAqIFVOS05PV05fTU9E
VUxFID0gIjx1bmtub3duIG1vZHVsZT46ICI7CisgIERXT1JEIGxlbjsKKyAg
RFdPUkQgZG9uZTsKKyAgdmFfbGlzdCBhcmdzOworICBIQU5ETEUgZXJyaCA9
IEdldFN0ZEhhbmRsZSAoU1REX0VSUk9SX0hBTkRMRSk7CisgIHNzaXplX3Qg
bW9kdWxlbGVuID0gR2V0TW9kdWxlRmlsZU5hbWVXIChOVUxMLCBtb2R1bGUs
IHNpemVvZiAobW9kdWxlKSk7CisKKyAgaWYgKGVycmggPT0gSU5WQUxJRF9I
QU5ETEVfVkFMVUUpCisgICAgcmV0dXJuIEZBTFNFOworCisgIGlmIChtb2R1
bGVsZW4gPiAwKQorICAgIHBvc2l4X21vZHVsZSA9IGN5Z3dpbl9jcmVhdGVf
cGF0aCAoQ0NQX1dJTl9XX1RPX1BPU0lYLCBtb2R1bGUpOworCisgIHZhX3N0
YXJ0IChhcmdzLCBmbXQpOworICBsZW4gPSAoRFdPUkQpIHZzbnByaW50ZiAo
YnVmLCBTSE9SVF9NU0dfQlVGX1NaLCBmbXQsIGFyZ3MpOworICB2YV9lbmQg
KGFyZ3MpOworICBidWZbU0hPUlRfTVNHX0JVRl9TWi0xXSA9ICdcMCc7IC8q
IHBhcmFub2lhICovCisKKyAgaWYgKHBvc2l4X21vZHVsZSkKKyAgICB7Cisg
ICAgICByVmFsID0gV3JpdGVGaWxlIChlcnJoLCAoUENWT0lEKXBvc2l4X21v
ZHVsZSwKKyAgICAgICAgICAgICAgICAgICAgICAgIHN0cmxlbihwb3NpeF9t
b2R1bGUpLCAmZG9uZSwgTlVMTCkgJiYKKyAgICAgICAgICAgICBXcml0ZUZp
bGUgKGVycmgsIChQQ1ZPSUQpIjogIiwgMiwgJmRvbmUsIE5VTEwpICYmCisg
ICAgICAgICAgICAgV3JpdGVGaWxlIChlcnJoLCAoUENWT0lEKWJ1ZiwgbGVu
LCAmZG9uZSwgTlVMTCk7CisgICAgICBmcmVlIChwb3NpeF9tb2R1bGUpOwor
ICAgIH0KKyAgZWxzZQorICAgIHsKKyAgICAgIHJWYWwgPSBXcml0ZUZpbGUg
KGVycmgsIChQQ1ZPSUQpVU5LTk9XTl9NT0RVTEUsCisgICAgICAgICAgICAg
ICAgICAgICAgICBzaXplb2YoVU5LTk9XTl9NT0RVTEUpLCAmZG9uZSwgTlVM
TCkgJiYKKyAgICAgICAgICAgICBXcml0ZUZpbGUgKGVycmgsIChQQ1ZPSUQp
YnVmLCBsZW4sICZkb25lLCBOVUxMKTsKKyAgICB9CisgIHJldHVybiByVmFs
OworfQorI2VuZGlmIC8qIF9fQ1lHV0lOX18gKi8KKworLyogVGhpcyBmdW5j
dGlvbiB0ZW1wb3JhcmlseSBtYXJrcyB0aGUgcGFnZSBjb250YWluaW5nIGFk
ZHIKKyAqIHdyaXRhYmxlLCBiZWZvcmUgY29weWluZyBsZW4gYnl0ZXMgZnJv
bSAqc3JjIHRvICphZGRyLCBhbmQKKyAqIHRoZW4gcmVzdG9yZXMgdGhlIG9y
aWdpbmFsIHByb3RlY3Rpb24gc2V0dGluZ3MgdG8gdGhlIHBhZ2UuCisgKgor
ICogVXNpbmcgdGhpcyBmdW5jdGlvbiBlbGltaW5hdGVzIHRoZSByZXF1aXJl
bWVudCB3aXRoIG9sZGVyCisgKiBwc2V1ZG8tcmVsb2MgaW1wbGVtZW50YXRp
b25zLCB0aGF0IHNlY3Rpb25zIGNvbnRhaW5pbmcKKyAqIHBzZXVkby1yZWxv
Y3MgKHN1Y2ggYXMgLnRleHQgYW5kIC5yZGF0YSkgYmUgcGVybWFuZW50bHkK
KyAqIG1hcmtlZCB3cml0YWJsZS4gVGhpcyBvbGRlciBiZWhhdmlvciBzYWJv
dGFnZWQgYW55IG1lbW9yeQorICogc2F2aW5ncyBhY2hpZXZlZCBieSBzaGFy
ZWQgbGlicmFyaWVzIG9uIHdpbjMyIC0tIGFuZCB3YXMKKyAqIHNsb3dlciwg
dG9vLiAgSG93ZXZlciwgb24gY3lnd2luIGFzIG9mIGJpbnV0aWxzIDIuMjAg
dGhlCisgKiAudGV4dCBzZWN0aW9uIGlzIHN0aWxsIG1hcmtlZCB3cml0YWJs
ZSwgYW5kIHRoZSAucmRhdGEgc2VjdGlvbgorICogaXMgZm9sZGVkIGludG8g
dGhlICh3cml0YWJsZSkgLmRhdGEgd2hlbiAtLWVuYWJsZS1hdXRvLWltcG9y
dC4KKyAqLwogc3RhdGljIHZvaWQKIF9fd3JpdGVfbWVtb3J5ICh2b2lkICph
ZGRyLGNvbnN0IHZvaWQgKnNyYyxzaXplX3QgbGVuKQogewogICBNRU1PUllf
QkFTSUNfSU5GT1JNQVRJT04gYjsKICAgRFdPUkQgb2xkcHJvdDsKKyAgU0la
RV9UIG1lbXN6OworCiAgIGlmICghbGVuKQogICAgIHJldHVybjsKLSAgYXNz
ZXJ0IChWaXJ0dWFsUXVlcnkgKGFkZHIsICZiLCBzaXplb2YoYikpKTsKKwor
ICBtZW1zeiA9IFZpcnR1YWxRdWVyeSAoYWRkciwgJmIsIHNpemVvZihiKSk7
CisKKyNpZiBkZWZpbmVkKF9fQ1lHV0lOX18pCisgIC8qIENZR1dJTjogSWYg
ZXJyb3IsIHByaW50IGVycm9yIG1lc3NhZ2UgYW5kIGRpZS4gKi8KKyAgaWYg
KG1lbXN6ID09IDApCisgICAgeworICAgICAgX19wcmludF9yZWxvY19lcnJv
ciAoCisgICAgICAgICJlcnJvciB3aGlsZSBsb2FkaW5nIHNoYXJlZCBsaWJy
YXJpZXM6IGJhZCBhZGRyZXNzIHNwZWNpZmllZCAweCUwOHguXG4iLAorICAg
ICAgICBhZGRyKTsKKyAgICAgIGN5Z3dpbl9pbnRlcm5hbCAoQ1dfRVhJVF9Q
Uk9DRVNTLAorICAgICAgICAgICAgICAgICAgICAgICBTVEFUVVNfSUxMRUdB
TF9ETExfUFNFVURPX1JFTE9DQVRJT04sCisgICAgICAgICAgICAgICAgICAg
ICAgIDEpOworICAgIH0KKyNlbHNlCisgIC8qIE1JTkdXOiBJZiBlcnJvciwg
ZGllLiBhc3NlcnQoKSBtYXkgcHJpbnQgZXJyb3IgbWVzc2FnZSB3aGVuICFO
REVCVUcgKi8KKyAgYXNzZXJ0IChtZW1zeik7CisjZW5kaWYKKwogICAvKiBU
ZW1wb3JhcmlseSBhbGxvdyB3cml0ZSBhY2Nlc3MgdG8gcmVhZC1vbmx5IHBy
b3RlY3RlZCBtZW1vcnkuICAqLwogICBpZiAoYi5Qcm90ZWN0ICE9IFBBR0Vf
RVhFQ1VURV9SRUFEV1JJVEUgJiYgYi5Qcm90ZWN0ICE9IFBBR0VfUkVBRFdS
SVRFKQogICAgIFZpcnR1YWxQcm90ZWN0IChiLkJhc2VBZGRyZXNzLCBiLlJl
Z2lvblNpemUsIFBBR0VfRVhFQ1VURV9SRUFEV1JJVEUsCiAJCSAgJm9sZHBy
b3QpOworICAvKiB3cml0ZSB0aGUgZGF0YS4gKi8KICAgbWVtY3B5IChhZGRy
LCBzcmMsIGxlbik7CisgIC8qIFJlc3RvcmUgb3JpZ2luYWwgcHJvdGVjdGlv
bi4gKi8KICAgaWYgKGIuUHJvdGVjdCAhPSBQQUdFX0VYRUNVVEVfUkVBRFdS
SVRFICYmIGIuUHJvdGVjdCAhPSBQQUdFX1JFQURXUklURSkKICAgICBWaXJ0
dWFsUHJvdGVjdCAoYi5CYXNlQWRkcmVzcywgYi5SZWdpb25TaXplLCBvbGRw
cm90LCAmb2xkcHJvdCk7CiB9CiAKICNkZWZpbmUgUlBfVkVSU0lPTl9WMSAw
CiAjZGVmaW5lIFJQX1ZFUlNJT05fVjIgMQotIAorCiBzdGF0aWMgdm9pZAog
ZG9fcHNldWRvX3JlbG9jICh2b2lkICogc3RhcnQsIHZvaWQgKiBlbmQsIHZv
aWQgKiBiYXNlKQogewpAQCAtNzAsMTUgKzE4Miw1MiBAQAogICBydW50aW1l
X3BzZXVkb19yZWxvY192MiAqdjJfaGRyID0gKHJ1bnRpbWVfcHNldWRvX3Jl
bG9jX3YyICopIHN0YXJ0OwogICBydW50aW1lX3BzZXVkb19yZWxvY19pdGVt
X3YyICpyOwogCisgIC8qIEEgdmFsaWQgcmVsb2NhdGlvbiBsaXN0IHdpbGwg
Y29udGFpbiBhdCBsZWFzdCBvbmUgZW50cnksIGFuZAorICAgKiBvbmUgdjEg
ZGF0YSBzdHJ1Y3R1cmUgKHRoZSBzbWFsbGVzdCBvbmUpIHJlcXVpcmVzIHR3
byBEV09SRHMuCisgICAqIFNvLCBpZiB0aGUgcmVsb2NhdGlvbiBsaXN0IGlz
IHNtYWxsZXIgdGhhbiA4IGJ5dGVzLCBiYWlsLgorICAgKi8KICAgaWYgKHJl
bG9jX3RhcmdldCA8IDgpCiAgICAgcmV0dXJuOwotICAvKiBDaGVjayBpZiB0
aGlzIGlzIG9sZCB2ZXJzaW9uIHBzZXVkbyByZWxvY2F0aW9uIHZlcnNpb24u
ICAqLworCisgIC8qIENoZWNrIGlmIHRoaXMgaXMgdGhlIG9sZCBwc2V1ZG8g
cmVsb2NhdGlvbiB2ZXJzaW9uLiAgKi8KKyAgLyogVGhlcmUgYXJlIHR3byBr
aW5kcyBvZiB2MSByZWxvY2F0aW9uIGxpc3RzOgorICAgKiAgIDEpIFdpdGgg
YSAodjItc3R5bGUpIHZlcnNpb24gaGVhZGVyLiBJbiB0aGlzIGNhc2UsIHRo
ZQorICAgKiAgICAgIGZpcnN0IGVudHJ5IGluIHRoZSBsaXN0IGlzIGEgMy1E
V09SRCBzdHJ1Y3R1cmUsIHdpdGgKKyAgICogICAgICB2YWx1ZToKKyAgICog
ICAgICAgICB7IDAsIDAsIFJQX1ZFUlNJT05fVjEgfQorICAgKiAgICAgIElu
IHRoaXMgY2FzZSwgd2Ugc2tpcCB0byB0aGUgbmV4dCBlbnRyeSBpbiB0aGUg
bGlzdCwKKyAgICogICAgICBrbm93aW5nIHRoYXQgYWxsIGVsZW1lbnRzIGFm
dGVyIHRoZSBoZWFkIGl0ZW0gY2FuCisgICAqICAgICAgYmUgY2FzdCB0byBy
dW50aW1lX3BzZXVkb19yZWxvY19pdGVtX3YxLgorICAgKiAgIDIpIFdpdGhv
dXQgYSAodjItc3R5bGUpIHZlcnNpb24gaGVhZGVyLiBJbiB0aGlzIGNhc2Us
IHRoZQorICAgKiAgICAgIGZpcnN0IGVsZW1lbnQgaW4gdGhlIGxpc3QgSVMg
YW4gYWN0dWFsIHYxIHJlbG9jYXRpb24KKyAgICogICAgICByZWNvcmQsIHdo
aWNoIGlzIHR3byBEV09SRHMuICBCZWNhdXNlIHRoZXJlIHdpbGwgbmV2ZXIK
KyAgICogICAgICBiZSBhIGNhc2Ugd2hlcmUgYSB2MSByZWxvY2F0aW9uIHJl
Y29yZCBoYXMgYm90aAorICAgKiAgICAgIGFkZGVuZCA9PSAwIGFuZCB0YXJn
ZXQgPT0gMCwgdGhpcyBjYXNlIHdpbGwgbm90IGJlCisgICAqICAgICAgY29u
ZnVzZWQgd2l0aCB0aGUgcHJpb3Igb25lLgorICAgKiBBbGwgY3VycmVudCBi
aW51dGlscywgd2hlbiBnZW5lcmF0aW5nIGEgdjEgcmVsb2NhdGlvbiBsaXN0
LAorICAgKiB1c2UgdGhlIHNlY29uZCAoZS5nLiBvcmlnaW5hbCkgZm9ybSAt
LSB0aGF0IGlzLCB3aXRob3V0IHRoZQorICAgKiB2Mi1zdHlsZSB2ZXJzaW9u
IGhlYWRlci4KKyAgICovCiAgIGlmIChyZWxvY190YXJnZXQgPj0gMTIKICAg
ICAgICYmIHYyX2hkci0+bWFnaWMxID09IDAgJiYgdjJfaGRyLT5tYWdpYzIg
PT0gMAogICAgICAgJiYgdjJfaGRyLT52ZXJzaW9uID09IFJQX1ZFUlNJT05f
VjEpCi0gICAgdjJfaGRyKys7CisgICAgeworICAgICAgLyogV2UgaGF2ZSBh
IGxpc3QgaGVhZGVyIGl0ZW0gaW5kaWNhdGluZyB0aGF0IHRoZSByZXN0Cisg
ICAgICAgKiBvZiB0aGUgbGlzdCBjb250YWlucyB2MSBlbnRyaWVzLiAgTW92
ZSB0aGUgcG9pbnRlciB0bworICAgICAgICogdGhlIGZpcnN0IHRydWUgdjEg
cmVsb2NhdGlvbiByZWNvcmQuICBCeSBkZWZpbml0aW9uLAorICAgICAgICog
dGhhdCB2MSBlbGVtZW50IHdpbGwgbm90IGhhdmUgYm90aCBhZGRlbmQgPT0g
MCBhbmQKKyAgICAgICAqIHRhcmdldCA9PSAwIChhbmQgdGh1cywgd2hlbiBp
bnRlcnByZXRlZCBhcyBhCisgICAgICAgKiBydW50aW1lX3BzZXVkb19yZWxv
Y192MiwgaXQgd2lsbCBub3QgaGF2ZSBib3RoCisgICAgICAgKiBtYWdpYzEg
PT0gMCBhbmQgbWFnaWMyID09IDApLgorICAgICAgICovCisgICAgICB2Ml9o
ZHIrKzsKKyAgICB9CisKICAgaWYgKHYyX2hkci0+bWFnaWMxICE9IDAgfHwg
djJfaGRyLT5tYWdpYzIgIT0gMCkKICAgICB7CisgICAgICAvKioqKioqKioq
KioqKioqKioqKioqKioqKgorICAgICAgICogSGFuZGxlIHYxIHJlbG9jYXRp
b25zICoKKyAgICAgICAqKioqKioqKioqKioqKioqKioqKioqKioqLwogICAg
ICAgcnVudGltZV9wc2V1ZG9fcmVsb2NfaXRlbV92MSAqIG87CiAgICAgICBm
b3IgKG8gPSAocnVudGltZV9wc2V1ZG9fcmVsb2NfaXRlbV92MSAqKSB2Ml9o
ZHI7CiAJICAgbyA8IChydW50aW1lX3BzZXVkb19yZWxvY19pdGVtX3YxICop
ZW5kOwpAQCAtOTIsMjYgKzI0MSw1NCBAQAogICAgICAgcmV0dXJuOwogICAg
IH0KIAorICAvKiBJZiB3ZSBnb3QgdGhpcyBmYXIsIHRoZW4gd2UgaGF2ZSBy
ZWxvY2F0aW9ucyBvZiB2ZXJzaW9uIDIgb3IgbmV3ZXIgKi8KKwogICAvKiBD
aGVjayBpZiB0aGlzIGlzIGEga25vd24gdmVyc2lvbi4gICovCiAgIGlmICh2
Ml9oZHItPnZlcnNpb24gIT0gUlBfVkVSU0lPTl9WMikKICAgICB7Ci0jaWZk
ZWYgREVCVUcKKyNpZiBkZWZpbmVkKF9fQ1lHV0lOX18pCisgICAgICAvKiBD
WUdXSU46IFByaW50IGVycm9yIG1lc3NhZ2UgYW5kIGRpZSwgZXZlbiB3aGVu
ICFERUJVR0dJTkcgKi8KKyAgICAgIF9fcHJpbnRfcmVsb2NfZXJyb3IgKAor
ICAgICAgICAiZXJyb3Igd2hpbGUgbG9hZGluZyBzaGFyZWQgbGlicmFyaWVz
OiBpbnZhbGlkIHBzZXVkb19yZWxvYyB2ZXJzaW9uICVkLlxuIiwKKyAgICAg
ICAgKGludCkgdjJfaGRyLT52ZXJzaW9uKTsKKyAgICAgIGN5Z3dpbl9pbnRl
cm5hbCAoQ1dfRVhJVF9QUk9DRVNTLAorICAgICAgICAgICAgICAgICAgICAg
ICBTVEFUVVNfSUxMRUdBTF9ETExfUFNFVURPX1JFTE9DQVRJT04sCisgICAg
ICAgICAgICAgICAgICAgICAgIDEpOworI2Vsc2UKKyMgaWYgZGVmaW5lZChE
RUJVRykKKyAgICAgIC8qIE1JTkdXOiBEb24ndCBkaWU7IGp1c3QgcmV0dXJu
IHRvIGNhbGxlci4gSWYgREVCVUcsIHByaW50IGVycm9yIG1lc3NhZ2UuICov
CiAgICAgICBmcHJpbnRmIChzdGRlcnIsICJpbnRlcm5hbCBtaW5ndyBydW50
aW1lIGVycm9yOiIKIAkgICAgICAgInBzdWVkb19yZWxvYyB2ZXJzaW9uICVk
IGlzIHVua25vd24gdG8gdGhpcyBydW50aW1lLlxuIiwKIAkgICAgICAgKGlu
dCkgdjJfaGRyLT52ZXJzaW9uKTsKKyMgZW5kaWYKICNlbmRpZgogICAgICAg
cmV0dXJuOwogICAgIH0KIAotICAvKiBXYWxrIG92ZXIgaGVhZGVyLiAgKi8K
KyAgLyoqKioqKioqKioqKioqKioqKioqKioqKioKKyAgICogSGFuZGxlIHYy
IHJlbG9jYXRpb25zICoKKyAgICoqKioqKioqKioqKioqKioqKioqKioqKiov
CisKKyAgLyogV2FsayBvdmVyIGhlYWRlci4gKi8KICAgciA9IChydW50aW1l
X3BzZXVkb19yZWxvY19pdGVtX3YyICopICZ2Ml9oZHJbMV07CiAKICAgZm9y
ICg7IHIgPCAocnVudGltZV9wc2V1ZG9fcmVsb2NfaXRlbV92MiAqKSBlbmQ7
IHIrKykKICAgICB7CisgICAgICAvKiBsb2NhdGlvbiB3aGVyZSBuZXcgYWRk
cmVzcyB3aWxsIGJlIHdyaXR0ZW4gKi8KICAgICAgIHJlbG9jX3RhcmdldCA9
IChwdHJkaWZmX3QpIGJhc2UgKyByLT50YXJnZXQ7CisKKyAgICAgIC8qIGdl
dCBzeW0gcG9pbnRlci4gSXQgcG9pbnRzIGVpdGhlciB0byB0aGUgaWF0IGVu
dHJ5CisgICAgICAgKiBvZiB0aGUgcmVmZXJlbmNlZCBlbGVtZW50LCBvciB0
byB0aGUgc3R1YiBmdW5jdGlvbi4KKyAgICAgICAqLwogICAgICAgYWRkcl9p
bXAgPSAocHRyZGlmZl90KSBiYXNlICsgci0+c3ltOwogICAgICAgYWRkcl9p
bXAgPSAqKChwdHJkaWZmX3QgKikgYWRkcl9pbXApOwogCisgICAgICAvKiBy
ZWFkIGV4aXN0aW5nIHJlbG9jYXRpb24gdmFsdWUgZnJvbSBpbWFnZSwgY2Fz
dGluZyB0byB0aGUKKyAgICAgICAqIGJpdHNpemUgaW5kaWNhdGVkIGJ5IHRo
ZSA4IExTQnMgb2YgZmxhZ3MuIElmIHRoZSB2YWx1ZSBpcworICAgICAgICog
bmVnYXRpdmUsIG1hbnVhbGx5IHNpZ24tZXh0ZW5kIHRvIHB0cmRpZmZfdCB3
aWR0aC4gUmFpc2UgYW4KKyAgICAgICAqIGVycm9yIGlmIHRoZSBiaXRzaXpl
IGluZGljYXRlZCBieSB0aGUgOCBMU0JzIG9mIGZsYWdzIGlzIG5vdAorICAg
ICAgICogc3VwcG9ydGVkLgorICAgICAgICovCiAgICAgICBzd2l0Y2ggKChy
LT5mbGFncyAmIDB4ZmYpKQogICAgICAgICB7CiAgICAgICAgICAgY2FzZSA4
OgpAQCAtMTM4LDE1ICszMTUsMzAgQEAKICNlbmRpZgogCSAgZGVmYXVsdDoK
IAkgICAgcmVsZGF0YT0wOwotI2lmZGVmIERFQlVHCi0gICAgCSAgICBmcHJp
bnRmKHN0ZGVyciwgImludGVybmFsIG1pbmd3IHJ1bnRpbWUgZXJyb3I6ICIK
KyNpZiBkZWZpbmVkKF9fQ1lHV0lOX18pCisgICAgICAgICAgICAvKiBQcmlu
dCBlcnJvciBtZXNzYWdlIGFuZCBkaWUsIGV2ZW4gd2hlbiAhREVCVUdHSU5H
ICovCisgICAgICAgICAgICBfX3ByaW50X3JlbG9jX2Vycm9yICgKKyAgICAg
ICAgICAgICAgImVycm9yIHdoaWxlIGxvYWRpbmcgc2hhcmVkIGxpYnJhcmll
czogdW5rbm93biBwc2V1ZG9fcmVsb2MgYml0IHNpemUgJWQuXG4iLAorICAg
ICAgICAgICAgICAoaW50KSAoci0+ZmxhZ3MgJiAweGZmKSk7CisgICAgICAg
ICAgICBjeWd3aW5faW50ZXJuYWwgKENXX0VYSVRfUFJPQ0VTUywKKyAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgU1RBVFVTX0lMTEVHQUxfRExMX1BT
RVVET19SRUxPQ0FUSU9OLAorICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAxKTsKKyNlbHNlCisjIGlmZGVmIERFQlVHCisgICAgICAgICAgICAvKiBN
SU5HVzogSWYgZXJyb3IsIGRvbid0IGRpZTsganVzdCBwcmludCBtZXNzYWdl
IGlmIERFQlVHICovCisJICAgIGZwcmludGYoc3RkZXJyLCAiaW50ZXJuYWwg
bWluZ3cgcnVudGltZSBlcnJvcjogIgogCQkgICAgInVua25vd24gcHNldWRv
X3JlbG9jIGJpdCBzaXplICVkXG4iLAogCQkgICAgKGludCkgKHItPmZsYWdz
ICYgMHhmZikpOworIyBlbmRpZgogI2VuZGlmCiAJICAgIGJyZWFrOwogICAg
ICAgICB9CisKKyAgICAgIC8qIEFkanVzdCB0aGUgcmVsb2NhdGlvbiB2YWx1
ZSAqLwogICAgICAgcmVsZGF0YSAtPSAoKHB0cmRpZmZfdCkgYmFzZSArIHIt
PnN5bSk7CiAgICAgICByZWxkYXRhICs9IGFkZHJfaW1wOworCisgICAgICAv
KiBXcml0ZSB0aGUgbmV3IHJlbG9jYXRpb24gdmFsdWUgYmFjayB0byAqcmVs
b2NfdGFyZ2V0ICovCiAgICAgICBzd2l0Y2ggKChyLT5mbGFncyAmIDB4ZmYp
KQogICAgICAgICB7CiAgICAgICAgICBjYXNlIDg6CkBAIC0xNjYsMTEgKzM1
OCwxMSBAQAogICAgICAgICB9CiAgICAgIH0KICB9Ci0gCisKIHZvaWQKLSBf
cGVpMzg2X3J1bnRpbWVfcmVsb2NhdG9yICgpCitfcGVpMzg2X3J1bnRpbWVf
cmVsb2NhdG9yICgpCiB7Ci0gIHN0YXRpYyBpbnQgd2FzX2luaXQgPSAwOwor
ICBzdGF0aWMgTk9fQ09QWSBpbnQgd2FzX2luaXQgPSAwOwogICBpZiAod2Fz
X2luaXQpCiAgICAgcmV0dXJuOwogICArK3dhc19pbml0Owo=

--------------040905080404010106020308
Content-Type: application/octet-stream;
 name="pseudo-reloc-tests-v3.tar.bz2"
Content-Transfer-Encoding: base64
Content-Disposition: attachment;
 filename="pseudo-reloc-tests-v3.tar.bz2"
Content-length: 4856

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
RxDIhUQh2DwAyrdAoZAEv/F3JFOFCQVkUq/Q

--------------040905080404010106020308--
