Return-Path: <SRS0=vrZ3=TJ=t-online.de=Christian.Franke@sourceware.org>
Received: from mailout04.t-online.de (mailout04.t-online.de [194.25.134.18])
	by sourceware.org (Postfix) with ESMTPS id A048B385840D
	for <cygwin-patches@cygwin.com>; Mon, 16 Dec 2024 07:48:50 +0000 (GMT)
DMARC-Filter: OpenDMARC Filter v1.4.2 sourceware.org A048B385840D
Authentication-Results: sourceware.org; dmarc=none (p=none dis=none) header.from=t-online.de
Authentication-Results: sourceware.org; spf=pass smtp.mailfrom=t-online.de
ARC-Filter: OpenARC Filter v1.0.0 sourceware.org A048B385840D
Authentication-Results: server2.sourceware.org; arc=none smtp.remote-ip=194.25.134.18
ARC-Seal: i=1; a=rsa-sha256; d=sourceware.org; s=key; t=1734335331; cv=none;
	b=CoRufp1nDM1u7DWzyttGooBxLD2a4ITKv5Y7g/nJIGqIZ3VRQ4+HBuTeuI4QtILndpaVJ6A/NTGg2xusHE/yOR+KyA/xXO7p23lS9Fzn+nQ5C/p4+7PzvWjARmVqTSp+VPnWxCA8IZODbW9IYyC8bSn8tyEtD+JjuVmexAOJ+KY=
ARC-Message-Signature: i=1; a=rsa-sha256; d=sourceware.org; s=key;
	t=1734335331; c=relaxed/simple;
	bh=okIsdDMZVNMwMRYDC4yQ1ghH8/in0Br7Jel6noh71a4=;
	h=Subject:From:To:Message-ID:Date:MIME-Version; b=pyI/zXfUkkGXQ4BVVUu7I3mBQAGEc96TEPcV94RJbA3mYSKhIC2HZt4dn/TVxrsCKvV1Ew6AHx9TyVallTSB04n1dmvf3lYGYyfUYKliuRJC+HaEofK8TD7P2yaL99nC1ImuRdk7yTqYQP0pbjyOuGYz2kjxwxoqgPZ4G2KYbs4=
ARC-Authentication-Results: i=1; server2.sourceware.org
DKIM-Filter: OpenDKIM Filter v2.11.0 sourceware.org A048B385840D
Received: from fwd71.aul.t-online.de (fwd71.aul.t-online.de [10.223.144.97])
	by mailout04.t-online.de (Postfix) with SMTP id 567B674F
	for <cygwin-patches@cygwin.com>; Mon, 16 Dec 2024 08:48:47 +0100 (CET)
Received: from [192.168.2.103] ([91.57.250.70]) by fwd71.t-online.de
	with (TLSv1.3:TLS_AES_256_GCM_SHA384 encrypted)
	esmtp id 1tN5qP-1l4dmK0; Mon, 16 Dec 2024 08:48:45 +0100
Subject: Re: [PATCH] Cygwin: /proc/<PID>/stat: set field (18) according to
 scheduling policy
From: Christian Franke <Christian.Franke@t-online.de>
To: cygwin-patches@cygwin.com
Reply-To: cygwin-patches@cygwin.com
References: <e121cfcb-8e37-7100-76fd-75ee4ca50776@t-online.de>
Message-ID: <a7d173a9-00d9-9355-a784-6061ad282aa0@t-online.de>
Date: Mon, 16 Dec 2024 08:48:43 +0100
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:91.0) Gecko/20100101
 SeaMonkey/2.53.19
MIME-Version: 1.0
In-Reply-To: <e121cfcb-8e37-7100-76fd-75ee4ca50776@t-online.de>
Content-Type: multipart/mixed;
 boundary="------------FDA43DC55B7E052EA3925624"
X-TOI-EXPURGATEID: 150726::1734335325-73FFC9CD-D00B9003/0/0 CLEAN NORMAL
X-TOI-MSGID: 30aa42d2-6d60-47d8-abef-05aea4926960
X-Spam-Status: No, score=-11.9 required=5.0 tests=BAYES_00,FREEMAIL_FROM,GIT_PATCH_0,KAM_DMARC_STATUS,NICE_REPLY_A,RCVD_IN_DNSWL_LOW,RCVD_IN_MSPIKE_H3,RCVD_IN_MSPIKE_WL,SPF_HELO_NONE,SPF_PASS,TXREP autolearn=ham autolearn_force=no version=3.4.6
X-Spam-Checker-Version: SpamAssassin 3.4.6 (2021-04-09) on server2.sourceware.org
List-Id: <cygwin-patches.cygwin.com>

This is a multi-part message in MIME format.
--------------FDA43DC55B7E052EA3925624
Content-Type: text/plain; charset=UTF-8; format=flowed
Content-Transfer-Encoding: 7bit

Christian Franke wrote:
> The possibly last enhancement regarding SCHED_* emulation.

A slighty changed version is attached. SCHED_IDLE now sets the lowest 
prioritity.


>
> Linux also provides (40) rt_priority and (41) policy. Adding these 
> would require to determine (or fake) fields (26) to (39) first :-)
>

This would also require to decide whether the values of (41) policy 
should be Cygwin (SCHED_OTHER=3) or Linux (...=0) compatible...


--------------FDA43DC55B7E052EA3925624
Content-Type: text/plain; charset=UTF-8;
 name="0001-Cygwin-proc-PID-stat-set-field-18-according-to-sched.patch"
Content-Transfer-Encoding: base64
Content-Disposition: attachment;
 filename*0="0001-Cygwin-proc-PID-stat-set-field-18-according-to-sched.pa";
 filename*1="tch"

RnJvbSBmYzljZjgzNTViZGU1NWVlMTBkYzZiMzRkZmZmMjI2YjMxNGVkZjVkIE1vbiBTZXAg
MTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBDaHJpc3RpYW4gRnJhbmtlIDxjaHJpc3RpYW4uZnJh
bmtlQHQtb25saW5lLmRlPgpEYXRlOiBNb24sIDE2IERlYyAyMDI0IDA4OjM5OjE5ICswMTAw
ClN1YmplY3Q6IFtQQVRDSF0gQ3lnd2luOiAvcHJvYy88UElEPi9zdGF0OiBzZXQgZmllbGQg
KDE4KSBhY2NvcmRpbmcgdG8KIHNjaGVkdWxpbmcgcG9saWN5CgpJZiBhIHJlYWx0aW1lIHBv
bGljeSBpcyBzZWxlY3RlZCwgc2V0IHRoZSAnKDE4KSBwcmlvcml0eScgZmllbGQgdG8gdGhl
Cm5lZ2F0ZWQgc2NoZWRfcHJpb3JpdHkgbWludXMgb25lLiAgSWYgU0NIRURfSURMRSBpcyBz
ZWxlY3RlZCwgc2V0IGl0IHRvCnRoZSBsb3dlc3QgcHJpb3JpdHkgMzkuICBBbHNvIHNldCAn
KDE5KSBuaWNlJyB0byB0aGUgb3JpZ2luYWxseSByZXF1ZXN0ZWQKbmljZSB2YWx1ZS4gIEVu
c3VyZSBjb25zaXN0ZW5jZSB3aXRoIHRoZSBjdXJyZW50IFdpbmRvd3MgcHJpb3JpdHkgaW4g
YWxsCmNhc2VzLiAgTW92ZSB0aGUgc2NoZWRfcHJpb3JpdHkgZnJvbS90byBXaW5kb3dzIHBy
aW9yaXR5IG1hcHBpbmcgZnJvbQpzY2hlZF9nZXQvc2V0cGFyYW0oKSB0byBuZXcgZnVuY3Rp
b25zIGluIG1pc2NmdW5jcy5jYy4KClNpZ25lZC1vZmYtYnk6IENocmlzdGlhbiBGcmFua2Ug
PGNocmlzdGlhbi5mcmFua2VAdC1vbmxpbmUuZGU+Ci0tLQogd2luc3VwL2N5Z3dpbi9maGFu
ZGxlci9wcm9jZXNzLmNjICAgICAgICB8IDI2ICsrKysrKysrKy0tCiB3aW5zdXAvY3lnd2lu
L2xvY2FsX2luY2x1ZGVzL21pc2NmdW5jcy5oIHwgIDIgKwogd2luc3VwL2N5Z3dpbi9taXNj
ZnVuY3MuY2MgICAgICAgICAgICAgICB8IDU2ICsrKysrKysrKysrKysrKysrKysrKystLQog
d2luc3VwL2N5Z3dpbi9yZWxlYXNlLzMuNi4wICAgICAgICAgICAgICB8ICA1ICsrKwogd2lu
c3VwL2N5Z3dpbi9zY2hlZC5jYyAgICAgICAgICAgICAgICAgICB8IDQwICsrKy0tLS0tLS0t
LS0tLS0tCiB3aW5zdXAvY3lnd2luL3NpZ3Byb2MuY2MgICAgICAgICAgICAgICAgIHwgIDQg
Ky0KIDYgZmlsZXMgY2hhbmdlZCwgOTAgaW5zZXJ0aW9ucygrKSwgNDMgZGVsZXRpb25zKC0p
CgpkaWZmIC0tZ2l0IGEvd2luc3VwL2N5Z3dpbi9maGFuZGxlci9wcm9jZXNzLmNjIGIvd2lu
c3VwL2N5Z3dpbi9maGFuZGxlci9wcm9jZXNzLmNjCmluZGV4IDM3YmRmZjg0ZS4uZTBhZWJi
NjQ4IDEwMDY0NAotLS0gYS93aW5zdXAvY3lnd2luL2ZoYW5kbGVyL3Byb2Nlc3MuY2MKKysr
IGIvd2luc3VwL2N5Z3dpbi9maGFuZGxlci9wcm9jZXNzLmNjCkBAIC0xMDk4LDcgKzEwOTgs
NiBAQCBmb3JtYXRfcHJvY2Vzc19zdGF0ICh2b2lkICpkYXRhLCBjaGFyIComZGVzdGJ1ZikK
ICAgdW5zaWduZWQgbG9uZyBmYXVsdF9jb3VudCA9IDBVTCwKIAkJdm1zaXplID0gMFVMLCB2
bXJzcyA9IDBVTCwgdm1tYXhyc3MgPSAwVUw7CiAgIHVpbnQ2NF90IHV0aW1lID0gMFVMTCwg
c3RpbWUgPSAwVUxMLCBzdGFydF90aW1lID0gMFVMTDsKLSAgaW50IG5pY2UgPSAwOwogLyog
Y3R0eSBtYWogaXMgMzE6MTYsIG1pbiBpcyAxNTowOyB0dHlfbnIgcy9iIG1haiAxNTo4LCBt
aW4gMzE6MjAsIDc6MDsKICAgIG1haiBpcyAzMToxNiA+PiAxNiAmIGZmZiA8PCA4OyBtaW4g
aXMgMTU6MCA+PiA4ICYgZmYgPDwgMjAgfCAmIGZmICovCiAgIGludCB0dHlfbnIgPSAwOwpA
QCAtMTEzMSw2ICsxMTMwLDggQEAgZm9ybWF0X3Byb2Nlc3Nfc3RhdCAodm9pZCAqZGF0YSwg
Y2hhciAqJmRlc3RidWYpCiAgIGVsc2UKICAgICBzdGF0ZSA9IGdldF9wcm9jZXNzX3N0YXRl
IChwLT5kd1Byb2Nlc3NJZCk7CiAKKyAgaW50IG5pY2UgPSAwLCBwcmlvID0gMDsKKwogICBO
VFNUQVRVUyBzdGF0dXM7CiAgIEhBTkRMRSBoUHJvY2VzczsKICAgVk1fQ09VTlRFUlMgdm1j
ID0geyAwIH07CkBAIC0xMTY4LDcgKzExNjksMjYgQEAgZm9ybWF0X3Byb2Nlc3Nfc3RhdCAo
dm9pZCAqZGF0YSwgY2hhciAqJmRlc3RidWYpCiAgICAgICBpZiAoIU5UX1NVQ0NFU1MgKHN0
YXR1cykpCiAJZGVidWdfcHJpbnRmICgiTnRRdWVyeUluZm9ybWF0aW9uUHJvY2VzcyhQcm9j
ZXNzUXVvdGFMaW1pdHMpOiAiCiAJCSAgICAgICJzdGF0dXMgJXkiLCBzdGF0dXMpOwotICAg
ICAgbmljZSA9IHdpbnByaW9fdG9fbmljZSAoR2V0UHJpb3JpdHlDbGFzcyAoaFByb2Nlc3Mp
KTsKKworICAgICAgbmljZSA9IHAtPm5pY2U7CisgICAgICBEV09SRCB3aW5wcmlvID0gR2V0
UHJpb3JpdHlDbGFzcyAoaFByb2Nlc3MpOworICAgICAgaWYgKHAtPnNjaGVkX3BvbGljeSA9
PSBTQ0hFRF9GSUZPIHx8IHAtPnNjaGVkX3BvbGljeSA9PSBTQ0hFRF9SUikKKwkvKiBMaW51
eCBwcm9jX3BpZF9zdGF0KDUpOiAoMTgpIHByaW9yaXR5IC0gRm9yIHByb2Nlc3NlcyBydW5u
aW5nIGEKKwkgICByZWFsLXRpbWUgc2NoZWR1bGluZyBwb2xpY3kgLi4uLCB0aGlzIGlzIHRo
ZSBuZWdhdGVkIHNjaGVkdWxpbmcKKwkgICBwcmlvcml0eSwgbWludXMgb25lLiAqLworCXBy
aW8gPSAtIHdpbnByaW9fdG9fc2NoZWRwcmlvICh3aW5wcmlvKSAtIDE7IC8qIC0zMyhoaWdo
KS4uLi0yKGxvdykgKi8KKyAgICAgIGVsc2UgaWYgKHAtPnNjaGVkX3BvbGljeSA9PSBTQ0hF
RF9JRExFKQorCS8qIFJldHVybiB0aGUgbG93ZXN0IHByaW9yaXR5IHVubGVzcyBubyBsb25n
ZXIgY29uc2lzdGVudC4gKi8KKwlwcmlvID0gTlpFUk8gKyAod2lucHJpbyA9PSBJRExFX1BS
SU9SSVRZX0NMQVNTID8gTlpFUk8gLSAxIDoKKwkJCXdpbnByaW9fdG9fbmljZSAod2lucHJp
bykpOworICAgICAgZWxzZQorCXsKKwkgIC8qIFVzZSBvcmlnaW5hbGx5IHJlcXVlc3RlZCBu
aWNlIHZhbHVlIHVubGVzcyBubyBsb25nZXIgY29uc2lzdGVudC4gKi8KKwkgIGJvb2wgYmF0
Y2ggPSAocC0+c2NoZWRfcG9saWN5ID09IFNDSEVEX0JBVENIKTsKKwkgIGlmICh3aW5wcmlv
ICE9IG5pY2VfdG9fd2lucHJpbyAobmljZSwgYmF0Y2gpKQorCSAgICBuaWNlID0gd2lucHJp
b190b19uaWNlICh3aW5wcmlvLCBiYXRjaCk7CisJICBwcmlvID0gTlpFUk8gKyBuaWNlOyAv
KiAwKGhpZ2gpLi4uMzkobG93KSAqLworCX0KICAgICAgIENsb3NlSGFuZGxlIChoUHJvY2Vz
cyk7CiAgICAgfQogICBzdGF0dXMgPSBOdFF1ZXJ5U3lzdGVtSW5mb3JtYXRpb24gKFN5c3Rl
bVRpbWVPZkRheUluZm9ybWF0aW9uLApAQCAtMTIwMSw3ICsxMjIxLDcgQEAgZm9ybWF0X3By
b2Nlc3Nfc3RhdCAodm9pZCAqZGF0YSwgY2hhciAqJmRlc3RidWYpCiAJCQkgIHAtPnBwaWQs
IHAtPnBnaWQsIHAtPnNpZCwgdHR5X25yLAogCQkJICAtMSwgMCwgZmF1bHRfY291bnQsIGZh
dWx0X2NvdW50LCAwLCAwLAogCQkJICB1dGltZSwgc3RpbWUsIHV0aW1lLCBzdGltZSwKLQkJ
CSAgTlpFUk8gKyBuaWNlLCBuaWNlLCAwLCAwLAorCQkJICBwcmlvLCBuaWNlLCAwLCAwLAog
CQkJICBzdGFydF90aW1lLAogCQkJICB2bXNpemUsIHZtcnNzLCB2bW1heHJzcwogCQkJICAp
OwpkaWZmIC0tZ2l0IGEvd2luc3VwL2N5Z3dpbi9sb2NhbF9pbmNsdWRlcy9taXNjZnVuY3Mu
aCBiL3dpbnN1cC9jeWd3aW4vbG9jYWxfaW5jbHVkZXMvbWlzY2Z1bmNzLmgKaW5kZXggNjAw
MWExNjM2Li5mZDEwZTQwZjEgMTAwNjQ0Ci0tLSBhL3dpbnN1cC9jeWd3aW4vbG9jYWxfaW5j
bHVkZXMvbWlzY2Z1bmNzLmgKKysrIGIvd2luc3VwL2N5Z3dpbi9sb2NhbF9pbmNsdWRlcy9t
aXNjZnVuY3MuaApAQCAtNDYsNiArNDYsOCBAQCBpc19hbHRfbnVtcGFkX2V2ZW50IChQSU5Q
VVRfUkVDT1JEIHBpcmVjKQogCiBpbnQgd2lucHJpb190b19uaWNlIChEV09SRCBwcmlvLCBi
b29sIGJhdGNoID0gZmFsc2UpOwogRFdPUkQgbmljZV90b193aW5wcmlvIChpbnQgJm5pY2Us
IGJvb2wgYmF0Y2ggPSBmYWxzZSk7CitpbnQgd2lucHJpb190b19zY2hlZHByaW8gKERXT1JE
IHByaW8pOworRFdPUkQgc2NoZWRwcmlvX3RvX3dpbnByaW8gKGludCBzY2hlZHByaW8pOwog
Ym9vbCBzZXRfYW5kX2NoZWNrX3dpbnByaW8gKEhBTkRMRSBwcm9jLCBEV09SRCBwcmlvLCBi
b29sIHNldCA9IHRydWUpOwogCiBib29sIGNyZWF0ZV9waXBlIChQSEFORExFLCBQSEFORExF
LCBMUFNFQ1VSSVRZX0FUVFJJQlVURVMsIERXT1JEKTsKZGlmZiAtLWdpdCBhL3dpbnN1cC9j
eWd3aW4vbWlzY2Z1bmNzLmNjIGIvd2luc3VwL2N5Z3dpbi9taXNjZnVuY3MuY2MKaW5kZXgg
NmZhZjA0OTM3Li4zMTA4MGQwNDMgMTAwNjQ0Ci0tLSBhL3dpbnN1cC9jeWd3aW4vbWlzY2Z1
bmNzLmNjCisrKyBiL3dpbnN1cC9jeWd3aW4vbWlzY2Z1bmNzLmNjCkBAIC0xMDQsNyArMTA0
LDcgQEAgeWllbGQgKCkKIH0KIAogLyoKLSAgIE1hcHBpbmcgb2YgbmljZSB2YWx1ZSBmcm9t
L3RvIFdpbmRvd3MgcHJpb3JpdHkKKyAgIE1hcHBpbmcgb2YgbmljZSB2YWx1ZSBvciBzY2hl
ZF9wcmlvcml0eSBmcm9tL3RvIFdpbmRvd3MgcHJpb3JpdHkKICAgICgnYmF0Y2gnIGlzIHVz
ZWQgZm9yIFNDSEVEX0JBVENIIHBvbGljeSkuCiAKICAgICBuaWNlX3RvX3dpbnByaW8oKSAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpbnByaW9fdG9fbmljZSgp
CkBAIC0xMTUsNiArMTE1LDE0IEBAIHlpZWxkICgpCiAgIC0xMi4uLi01ICAgIC0xMy4uLTE5
ICAgIDMgICAgQUJPVkVfTk9STUFMX1BSSU9SSVRZX0NMQVNTICAgIC04ICAgICAgLTE2CiAg
IC0xMy4uLTE5ICAgICAgICAgLTIwICAgIDQgICAgSElHSF9QUklPUklUWV9DTEFTUyAgICAg
ICAgICAgLTE2ICAgICAgLTIwCiAgICAgICAgLTIwICAgICAgICAgICAtICAgIDUgICAgUkVB
TFRJTUVfUFJJT1JJVFlfQ0xBU1MgICAgICAgLTIwICAgICAgLTIwCisKKyAgIHNjaGVkcHJp
b190b193aW5wcmlvKCkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2lucHJpb190
b19zY2hlZHByaW8oKQorICAgIDEuLi4uNiAgICAgICAgICAgICAgICAwICAgIElETEVfUFJJ
T1JJVFlfQ0xBU1MgICAgICAgICAgICAgMworICAgIDcuLi4xMiAgICAgICAgICAgICAgICAx
ICAgIEJFTE9XX05PUk1BTF9QUklPUklUWV9DTEFTUyAgICAgOQorICAgMTMuLi4xOCAgICAg
ICAgICAgICAgICAyICAgIE5PUk1BTF9QUklPUklUWV9DTEFTUyAgICAgICAgICAxNQorICAg
MTkuLi4yNCAgICAgICAgICAgICAgICAzICAgIEFCT1ZFX05PUk1BTF9QUklPUklUWV9DTEFT
UyAgICAyMQorICAgMjUuLi4zMCAgICAgICAgICAgICAgICA0ICAgIEhJR0hfUFJJT1JJVFlf
Q0xBU1MgICAgICAgICAgICAyNworICAgMzEuLi4zMiAgICAgICAgICAgICAgICA1ICAgIFJF
QUxUSU1FX1BSSU9SSVRZX0NMQVNTICAgICAgICAzMgogKi8KIAogLyogKl9QUklPUklUWV9D
TEFTUyAtPiAwLi4uNSAqLwpAQCAtMTY3LDkgKzE3NSwyNSBAQCBuaWNlX3RvX3dpbnByaW9f
aW1wbCAoaW50IG5pY2UsIGJvb2wgYmF0Y2ggPSBmYWxzZSkKICAgcmV0dXJuIGxldmVsX3Rv
X3dpbnByaW8gKGxldmVsKTsKIH0KIAorLyogKl9QUklPUklUWV9DTEFTUyAtPiBzY2hlZF9w
cmlvcml0eSAqLworY29uc3RleHByIGludAord2lucHJpb190b19zY2hlZHByaW9faW1wbCAo
RFdPUkQgcHJpbykKK3sKKyAgaW50IGxldmVsID0gd2lucHJpb190b19sZXZlbCAocHJpbyk7
CisgIHJldHVybiAobGV2ZWwgPCA1ID8gMyArIGxldmVsICogNiA6IDMyKTsKK30KKworLyog
c2NoZWRfcHJpb3JpdHkgLT4gKl9QUklPUklUWV9DTEFTUyAqLworY29uc3RleHByIERXT1JE
CitzY2hlZHByaW9fdG9fd2lucHJpb19pbXBsIChpbnQgc2NoZWRwcmlvKQoreworICBpbnQg
bGV2ZWwgPSAoc2NoZWRwcmlvIDw9IDEgPyAwIDogKHNjaGVkcHJpbyA8IDMyID8gKHNjaGVk
cHJpbyAtIDEpIC8gNiA6IDUpKTsKKyAgcmV0dXJuIGxldmVsX3RvX3dpbnByaW8gKGxldmVs
KTsKK30KKwogLyogQ2hlY2sgY29uc2lzdGVuY3kgYXQgY29tcGlsZSB0aW1lLiAqLwogY29u
c3RleHByIGJvb2wKLWNoZWNrX25pY2Vfd2lucHJpb19tYXBwaW5nICgpCitjaGVja19uaWNl
X3NjaGVkcHJpb193aW5wcmlvX21hcHBpbmcgKCkKIHsKICAgZm9yIChpbnQgbmljZSA9IC1O
WkVSTzsgbmljZSA8IE5aRVJPOyBuaWNlKyspCiAgICAgZm9yIChpbnQgYmF0Y2ggPSAwOyBi
YXRjaCA8PSAxOyBiYXRjaCsrKSB7CkBAIC0xNzksMTYgKzIwMywyOCBAQCBjaGVja19uaWNl
X3dpbnByaW9fbWFwcGluZyAoKQogICAgICAgaWYgKHByaW8gIT0gcHJpbzIpCiAJcmV0dXJu
IGZhbHNlOwogICAgIH0KKyAgZm9yIChpbnQgc2NoZWRwcmlvID0gMTsgc2NoZWRwcmlvIDw9
IDMyOyBzY2hlZHByaW8rKykKKyAgICB7CisgICAgICBEV09SRCBwcmlvID0gc2NoZWRwcmlv
X3RvX3dpbnByaW9faW1wbCAoc2NoZWRwcmlvKTsKKyAgICAgIGludCBzY2hlZHByaW8yID0g
d2lucHJpb190b19zY2hlZHByaW9faW1wbCAocHJpbyk7CisgICAgICBEV09SRCBwcmlvMiA9
IHNjaGVkcHJpb190b193aW5wcmlvX2ltcGwgKHNjaGVkcHJpbzIpOworICAgICAgaWYgKHBy
aW8gIT0gcHJpbzIpCisJcmV0dXJuIGZhbHNlOworICAgIH0KICAgcmV0dXJuIHRydWU7CiB9
CiAKLXN0YXRpY19hc3NlcnQgKGNoZWNrX25pY2Vfd2lucHJpb19tYXBwaW5nKCkpOworc3Rh
dGljX2Fzc2VydCAoY2hlY2tfbmljZV9zY2hlZHByaW9fd2lucHJpb19tYXBwaW5nKCkpOwog
c3RhdGljX2Fzc2VydCAobmljZV90b193aW5wcmlvX2ltcGwoTlpFUk8tMSwgZmFsc2UpID09
IElETEVfUFJJT1JJVFlfQ0xBU1MpOwogc3RhdGljX2Fzc2VydCAobmljZV90b193aW5wcmlv
X2ltcGwoMCwgdHJ1ZSkgPT0gQkVMT1dfTk9STUFMX1BSSU9SSVRZX0NMQVNTKTsKIHN0YXRp
Y19hc3NlcnQgKHdpbnByaW9fdG9fbmljZV9pbXBsKEJFTE9XX05PUk1BTF9QUklPUklUWV9D
TEFTUywgdHJ1ZSkgPT0gMCk7CiBzdGF0aWNfYXNzZXJ0IChuaWNlX3RvX3dpbnByaW9faW1w
bCgwLCBmYWxzZSkgPT0gTk9STUFMX1BSSU9SSVRZX0NMQVNTKTsKIHN0YXRpY19hc3NlcnQg
KHdpbnByaW9fdG9fbmljZV9pbXBsKE5PUk1BTF9QUklPUklUWV9DTEFTUywgZmFsc2UpID09
IDApOwogc3RhdGljX2Fzc2VydCAobmljZV90b193aW5wcmlvX2ltcGwoLU5aRVJPLCBmYWxz
ZSkgPT0gUkVBTFRJTUVfUFJJT1JJVFlfQ0xBU1MpOworc3RhdGljX2Fzc2VydCAoc2NoZWRw
cmlvX3RvX3dpbnByaW9faW1wbCgxKSA9PSBJRExFX1BSSU9SSVRZX0NMQVNTKTsKK3N0YXRp
Y19hc3NlcnQgKHNjaGVkcHJpb190b193aW5wcmlvX2ltcGwoMTUpID09IE5PUk1BTF9QUklP
UklUWV9DTEFTUyk7CitzdGF0aWNfYXNzZXJ0ICh3aW5wcmlvX3RvX3NjaGVkcHJpb19pbXBs
KE5PUk1BTF9QUklPUklUWV9DTEFTUykgPT0gMTUpOworc3RhdGljX2Fzc2VydCAoc2NoZWRw
cmlvX3RvX3dpbnByaW9faW1wbCgzMikgPT0gUkVBTFRJTUVfUFJJT1JJVFlfQ0xBU1MpOwog
CiAvKiBHZXQgYSBkZWZhdWx0IHZhbHVlIGZvciB0aGUgbmljZSBmYWN0b3IuICovCiBpbnQK
QEAgLTIxMCw2ICsyNDYsMjAgQEAgbmljZV90b193aW5wcmlvIChpbnQgJm5pY2UsIGJvb2wg
YmF0Y2ggLyogPSBmYWxzZSAqLykKICAgcmV0dXJuIG5pY2VfdG9fd2lucHJpb19pbXBsIChu
aWNlLCBiYXRjaCk7CiB9CiAKKy8qIEdldCBhIGRlZmF1bHQgc2NoZWRfcHJpb3JpdHkgZnJv
bSBhIFdpbjMyIHByaW9yaXR5LiAqLworaW50Cit3aW5wcmlvX3RvX3NjaGVkcHJpbyAoRFdP
UkQgcHJpbykKK3sKKyAgcmV0dXJuIHdpbnByaW9fdG9fc2NoZWRwcmlvX2ltcGwgKHByaW8p
OworfQorCisvKiBHZXQgYSBXaW4zMiBwcmlvcml0eSBtYXRjaGluZyB0aGUgc2NoZWRfcHJp
b3JpdHkuICovCitEV09SRAorc2NoZWRwcmlvX3RvX3dpbnByaW8gKGludCBzY2hlZHByaW8p
Cit7CisgIHJldHVybiBzY2hlZHByaW9fdG9fd2lucHJpb19pbXBsIChzY2hlZHByaW8pOwor
fQorCiAvKiBTZXQgV2luMzIgcHJpb3JpdHkgb3IgcmV0dXJuIGZhbHNlIG9uIGZhaWx1cmUu
ICBBbHNvIHJldHVybgogICAgZmFsc2UgYW5kIHJldmVydCB0byB0aGUgb3JpZ2luYWwgcHJp
b3JpdHkgaWYgYSBkaWZmZXJlbnQgKGxvd2VyKQogICAgcHJpb3JpdHkgaXMgc2V0IGluc3Rl
YWQuICBBbHdheXMgcmV2ZXJ0IHRvIG9yaWdpbmFsIHByaW9yaXR5IGlmCmRpZmYgLS1naXQg
YS93aW5zdXAvY3lnd2luL3JlbGVhc2UvMy42LjAgYi93aW5zdXAvY3lnd2luL3JlbGVhc2Uv
My42LjAKaW5kZXggNGUwNzI2ZThmLi40N2MxOWE4NmIgMTAwNjQ0Ci0tLSBhL3dpbnN1cC9j
eWd3aW4vcmVsZWFzZS8zLjYuMAorKysgYi93aW5zdXAvY3lnd2luL3JlbGVhc2UvMy42LjAK
QEAgLTY5LDMgKzY5LDggQEAgV2hhdCBjaGFuZ2VkOgogICBlYWNoIGNoaWxkIHByb2Nlc3Mg
Y3JlYXRlZCB3aXRoIGZvcmsoMikuCiAgIE5vdGU6IFdpbmRvd3MgZG9lcyBub3Qgb2ZmZXIg
YWx0ZXJuYXRpdmUgc2NoZWR1bGluZyBwb2xpY2llcyBzbwogICB0aGlzIGNvdWxkIG9ubHkg
ZW11bGF0ZSBBUEkgYmVoYXZpb3IuCisKKy0gSWYgU0NIRURfRklGTyBvciBTQ0hFRF9SUiBp
cyBzZWxlY3RlZCwgdGhlIC9wcm9jLzxQSUQ+L3N0YXQgZmllbGQKKyAgJygxOCkgcHJpb3Jp
dHknIGlzIG5vdyBzZXQgdG8gdGhlIG5lZ2F0ZWQgc2NoZWRfcG9saWN5IG1pbnVzIG9uZS4K
KyAgSWYgU0NIRURfSURMRSBpcyBzZWxlY3RlZCwgdGhpcyBmaWVsZCBpcyBzZXQgdG8gMzku
ICBUaGUgJygxOSkgbmljZScKKyAgZmllbGQgaXMgbm93IHNldCB0byB0aGUgb3JpZ2luYWxs
eSByZXF1ZXN0ZWQgbmljZSB2YWx1ZS4KZGlmZiAtLWdpdCBhL3dpbnN1cC9jeWd3aW4vc2No
ZWQuY2MgYi93aW5zdXAvY3lnd2luL3NjaGVkLmNjCmluZGV4IGQ3NWEzNDA0Zi4uNDNiMTcz
NTdiIDEwMDY0NAotLS0gYS93aW5zdXAvY3lnd2luL3NjaGVkLmNjCisrKyBiL3dpbnN1cC9j
eWd3aW4vc2NoZWQuY2MKQEAgLTEyMCwyOSArMTIwLDcgQEAgc2NoZWRfZ2V0cGFyYW0gKHBp
ZF90IHBpZCwgc3RydWN0IHNjaGVkX3BhcmFtICpwYXJhbSkKICAgICAgIHJldHVybiAtMTsK
ICAgICB9CiAgIC8qIGNhbGN1bGF0ZSB0aGUgdW5peCBwcmlvcml0eS4gKi8KLSAgc3dpdGNo
IChwY2xhc3MpCi0gICAgewotICAgIGNhc2UgSURMRV9QUklPUklUWV9DTEFTUzoKLSAgICAg
IHBhcmFtLT5zY2hlZF9wcmlvcml0eSA9IDM7Ci0gICAgICBicmVhazsKLSAgICBjYXNlIEJF
TE9XX05PUk1BTF9QUklPUklUWV9DTEFTUzoKLSAgICAgIHBhcmFtLT5zY2hlZF9wcmlvcml0
eSA9IDk7Ci0gICAgICBicmVhazsKLSAgICBjYXNlIE5PUk1BTF9QUklPUklUWV9DTEFTUzoK
LSAgICBkZWZhdWx0OgotICAgICAgcGFyYW0tPnNjaGVkX3ByaW9yaXR5ID0gMTU7Ci0gICAg
ICBicmVhazsKLSAgICBjYXNlIEFCT1ZFX05PUk1BTF9QUklPUklUWV9DTEFTUzoKLSAgICAg
IHBhcmFtLT5zY2hlZF9wcmlvcml0eSA9IDIxOwotICAgICAgYnJlYWs7Ci0gICAgY2FzZSBI
SUdIX1BSSU9SSVRZX0NMQVNTOgotICAgICAgcGFyYW0tPnNjaGVkX3ByaW9yaXR5ID0gMjc7
Ci0gICAgICBicmVhazsKLSAgICBjYXNlIFJFQUxUSU1FX1BSSU9SSVRZX0NMQVNTOgotICAg
ICAgcGFyYW0tPnNjaGVkX3ByaW9yaXR5ID0gMzI7Ci0gICAgICBicmVhazsKLSAgICB9Ci0K
KyAgcGFyYW0tPnNjaGVkX3ByaW9yaXR5ID0gd2lucHJpb190b19zY2hlZHByaW8gKHBjbGFz
cyk7CiAgIHJldHVybiAwOwogfQogCkBAIC0yNDQsMTggKzIyMiwxMCBAQCBzY2hlZF9zZXRw
YXJhbV9waW5mbyAocGluZm8gJiBwLCBjb25zdCBzdHJ1Y3Qgc2NoZWRfcGFyYW0gKnBhcmFt
KQogICBlbHNlIGlmIChwLT5zY2hlZF9wb2xpY3kgPT0gU0NIRURfSURMRSAmJiBwcmkgPT0g
MCkKICAgICAvKiBJZGxlIHBvbGljeSwgaWdub3JlIHRoZSBuaWNlIHZhbHVlLiAqLwogICAg
IHBjbGFzcyA9IElETEVfUFJJT1JJVFlfQ0xBU1M7Ci0gIGVsc2UgaWYgKDEgPD0gcHJpICYm
IHByaSA8PSA2KQotICAgIHBjbGFzcyA9IElETEVfUFJJT1JJVFlfQ0xBU1M7Ci0gIGVsc2Ug
aWYgKHByaSA8PSAxMikKLSAgICBwY2xhc3MgPSBCRUxPV19OT1JNQUxfUFJJT1JJVFlfQ0xB
U1M7Ci0gIGVsc2UgaWYgKHByaSA8PSAxOCkKLSAgICBwY2xhc3MgPSBOT1JNQUxfUFJJT1JJ
VFlfQ0xBU1M7Ci0gIGVsc2UgaWYgKHByaSA8PSAyNCkKLSAgICBwY2xhc3MgPSBBQk9WRV9O
T1JNQUxfUFJJT1JJVFlfQ0xBU1M7Ci0gIGVsc2UgaWYgKHByaSA8PSAzMCkKLSAgICBwY2xh
c3MgPSBISUdIX1BSSU9SSVRZX0NMQVNTOwotICBlbHNlIGlmIChwcmkgPD0gMzIpCi0gICAg
cGNsYXNzID0gUkVBTFRJTUVfUFJJT1JJVFlfQ0xBU1M7CisgIGVsc2UgaWYgKChwLT5zY2hl
ZF9wb2xpY3kgPT0gU0NIRURfRklGTyB8fCBwLT5zY2hlZF9wb2xpY3kgPT0gU0NIRURfUlIp
CisgICAgICAgICAgICYmIHZhbGlkX3NjaGVkX3BhcmFtZXRlcnMgKHBhcmFtKSkKKyAgICAv
KiBSZWFsdGltZSBwb2xpY3ksIGFwcGx5IHJlcXVlc3RlZCBwcmlvcml0eS4gKi8KKyAgICBw
Y2xhc3MgPSBzY2hlZHByaW9fdG9fd2lucHJpbyAocGFyYW0tPnNjaGVkX3ByaW9yaXR5KTsK
ICAgZWxzZQogICAgIHsKICAgICAgIHNldF9lcnJubyAoRUlOVkFMKTsKZGlmZiAtLWdpdCBh
L3dpbnN1cC9jeWd3aW4vc2lncHJvYy5jYyBiL3dpbnN1cC9jeWd3aW4vc2lncHJvYy5jYwpp
bmRleCBiYTc4MThhNjguLjg2MWE4YzY0OSAxMDA2NDQKLS0tIGEvd2luc3VwL2N5Z3dpbi9z
aWdwcm9jLmNjCisrKyBiL3dpbnN1cC9jeWd3aW4vc2lncHJvYy5jYwpAQCAtMTM0OCw4ICsx
MzQ4LDggQEAgd2FpdF9zaWcgKFZPSUQgKikKICAgLyogR2V0VGlja0NvdW50KCkgaGVyZSBp
cyBlbm91Z2ggYmVjYXVzZSBHZXRUaWNrQ291bnQoKSAtIHQwIGRvZXMKICAgICAgbm90IG92
ZXJmbG93IHVudGlsIDQ5IGRheXMgcHNzcy4gRXZlbiBpZiBHZXRUaWNrQ291bnQoKSBvdmVy
Zmxvd3MsCiAgICAgIEdldFRpY2tDb3VudCgpIC0gdDAgcmV0dXJucyBjb3JyZWN0IHZhbHVl
LCBzaW5jZSB1bmRlcmZsb3cgaW4KLSAgICAgdW5zaWduZWQgd3JhcHMgY29ycmVjdGx5LiBQ
ZW5kaW5nIGEgc2lnbmFsIGZvciBtb3JlIHRoYW4gNDkKLSAgICAgZGF5cyBtYWtlcyBubyBz
ZW5zZS4gKi8KKyAgICAgdW5zaWduZWQgd3JhcHMgY29ycmVjdGx5LiBQZW5kaW5nIGEgc2ln
bmFsIGZvciBtb3JlIHRodG4gNDkKKyAgICAgZGF5cyB3b3VsZCBiZSBub25jZW5zZS4gKi8K
ICAgRFdPUkQgdDAgPSBHZXRUaWNrQ291bnQgKCk7CiAgIGZvciAoOzspCiAgICAgewotLSAK
Mi40NS4xCgo=
--------------FDA43DC55B7E052EA3925624--
