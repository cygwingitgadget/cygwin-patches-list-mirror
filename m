Return-Path: <SRS0=v9we=TG=t-online.de=Christian.Franke@sourceware.org>
Received: from mailout10.t-online.de (mailout10.t-online.de [194.25.134.21])
	by sourceware.org (Postfix) with ESMTPS id AFE98385842C
	for <cygwin-patches@cygwin.com>; Fri, 13 Dec 2024 15:17:05 +0000 (GMT)
DMARC-Filter: OpenDMARC Filter v1.4.2 sourceware.org AFE98385842C
Authentication-Results: sourceware.org; dmarc=none (p=none dis=none) header.from=t-online.de
Authentication-Results: sourceware.org; spf=pass smtp.mailfrom=t-online.de
ARC-Filter: OpenARC Filter v1.0.0 sourceware.org AFE98385842C
Authentication-Results: server2.sourceware.org; arc=none smtp.remote-ip=194.25.134.21
ARC-Seal: i=1; a=rsa-sha256; d=sourceware.org; s=key; t=1734103026; cv=none;
	b=Hy618G/WztDF7FkQ73up+QIAH840/X9uGqXzQnBq2tx7FzkvkEGjefyPkOXRsmQtSs3MiBwBstU0f1qMDarGmjs+WOv5LlPydilidTSJh2di2hGUZv0TM5BeFsbfIr6IyvMhFUuJZQOB7yMq7VMJfVKUYDSqpGphRATVpeUUmig=
ARC-Message-Signature: i=1; a=rsa-sha256; d=sourceware.org; s=key;
	t=1734103026; c=relaxed/simple;
	bh=NvWsS1LkTLuVhaN08F4EDIhi6VN6Ki2tSkqubhukuCY=;
	h=From:Subject:To:Message-ID:Date:MIME-Version; b=GOfi/3uKtslaC65oCyG6KNg7uw94eHYRM1ouyEue1EVbRTdK+jSghLtUBgzY3HQH2B5NC9k3eevxHB0lH2z35xFspLYK3jgPnYUGZLBj8XD1I1ob5AWBWizhj4z+SkgQsF8nd/lr/cqJcJar4bLANNHoGcBt74OBxOu62e8Jxjc=
ARC-Authentication-Results: i=1; server2.sourceware.org
DKIM-Filter: OpenDKIM Filter v2.11.0 sourceware.org AFE98385842C
Received: from fwd82.aul.t-online.de (fwd82.aul.t-online.de [10.223.144.108])
	by mailout10.t-online.de (Postfix) with SMTP id 0421D9C4
	for <cygwin-patches@cygwin.com>; Fri, 13 Dec 2024 16:17:04 +0100 (CET)
Received: from [192.168.2.103] ([91.57.250.70]) by fwd82.t-online.de
	with (TLSv1.3:TLS_AES_256_GCM_SHA384 encrypted)
	esmtp id 1tM7Pb-3uLJLc0; Fri, 13 Dec 2024 16:17:03 +0100
From: Christian Franke <Christian.Franke@t-online.de>
Subject: [PATCH] Cygwin: /proc/<PID>/stat: set field (18) according to
 scheduling policy
To: cygwin-patches@cygwin.com
Reply-To: cygwin-patches@cygwin.com
Message-ID: <e121cfcb-8e37-7100-76fd-75ee4ca50776@t-online.de>
Date: Fri, 13 Dec 2024 16:17:03 +0100
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:91.0) Gecko/20100101
 SeaMonkey/2.53.19
MIME-Version: 1.0
Content-Type: multipart/mixed;
 boundary="------------351A9CC20AFC629A763D4F90"
X-TOI-EXPURGATEID: 150726::1734103023-25FF89EF-28F33ECF/0/0 CLEAN NORMAL
X-TOI-MSGID: bf00d79b-3ad8-4ea9-aaa5-bdad0122c21c
X-Spam-Status: No, score=-11.4 required=5.0 tests=BAYES_00,FREEMAIL_FROM,GIT_PATCH_0,KAM_DMARC_STATUS,RCVD_IN_DNSWL_LOW,RCVD_IN_MSPIKE_H2,SPF_HELO_NONE,SPF_PASS,TXREP autolearn=ham autolearn_force=no version=3.4.6
X-Spam-Checker-Version: SpamAssassin 3.4.6 (2021-04-09) on server2.sourceware.org
List-Id: <cygwin-patches.cygwin.com>

This is a multi-part message in MIME format.
--------------351A9CC20AFC629A763D4F90
Content-Type: text/plain; charset=UTF-8; format=flowed
Content-Transfer-Encoding: 7bit

The possibly last enhancement regarding SCHED_* emulation.

Linux also provides (40) rt_priority and (41) policy. Adding these would 
require to determine (or fake) fields (26) to (39) first :-)

-- 
Regards,
Christian


--------------351A9CC20AFC629A763D4F90
Content-Type: text/plain; charset=UTF-8;
 name="0001-Cygwin-proc-PID-stat-set-field-18-according-to-sched.patch"
Content-Transfer-Encoding: base64
Content-Disposition: attachment;
 filename*0="0001-Cygwin-proc-PID-stat-set-field-18-according-to-sched.pa";
 filename*1="tch"

RnJvbSAwYmViOWNiZTkzZTk5ODRjNGY4MjM2NWEzMjhiODFkZjQ4MjljMmYyIE1vbiBTZXAg
MTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBDaHJpc3RpYW4gRnJhbmtlIDxjaHJpc3RpYW4uZnJh
bmtlQHQtb25saW5lLmRlPgpEYXRlOiBGcmksIDEzIERlYyAyMDI0IDE2OjEyOjM5ICswMTAw
ClN1YmplY3Q6IFtQQVRDSF0gQ3lnd2luOiAvcHJvYy88UElEPi9zdGF0OiBzZXQgZmllbGQg
KDE4KSBhY2NvcmRpbmcgdG8KIHNjaGVkdWxpbmcgcG9saWN5CgpJZiBhIHJlYWx0aW1lIHBv
bGljeSBpcyBzZWxlY3RlZCwgc2V0IHRoZSAnKDE4KSBwcmlvcml0eScgZmllbGQgdG8gdGhl
Cm5lZ2F0ZWQgc2NoZWRfcHJpb3JpdHkgbWludXMgb25lLiAgSWYgU0NIRURfSURMRSBpcyBz
ZWxlY3RlZCwgc2V0IGl0IHRvCih1c3VhbGx5KSAzNi4gIEluIGJvdGggY2FzZXMsIHRoZSB2
YWx1ZXMgYXJlIG1hcHBlZCBmcm9tIHRoZSBjdXJyZW50CldpbmRvd3MgcHJpb3JpdHkuICBB
bHNvIHNldCAnKDE5KSBuaWNlJyB0byB0aGUgb3JpZ2luYWxseSByZXF1ZXN0ZWQKbmljZSB2
YWx1ZSB1bmxlc3MgaXQgaXMgbm8gbG9uZ2VyIGNvbnNpc3RlbnQgd2l0aCB0aGUgV2luZG93
cyBwcmlvcml0eS4KTW92ZSB0aGUgc2NoZWRfcHJpb3JpdHkgZnJvbS90byBXaW5kb3dzIHBy
aW9yaXR5IG1hcHBpbmcgZnJvbQpzY2hlZF9nZXQvc2V0cGFyYW0oKSB0byBuZXcgZnVuY3Rp
b25zIGluIG1pc2NmdW5jcy5jYy4KClNpZ25lZC1vZmYtYnk6IENocmlzdGlhbiBGcmFua2Ug
PGNocmlzdGlhbi5mcmFua2VAdC1vbmxpbmUuZGU+Ci0tLQogd2luc3VwL2N5Z3dpbi9maGFu
ZGxlci9wcm9jZXNzLmNjICAgICAgICB8IDI1ICsrKysrKysrKy0tCiB3aW5zdXAvY3lnd2lu
L2xvY2FsX2luY2x1ZGVzL21pc2NmdW5jcy5oIHwgIDIgKwogd2luc3VwL2N5Z3dpbi9taXNj
ZnVuY3MuY2MgICAgICAgICAgICAgICB8IDU2ICsrKysrKysrKysrKysrKysrKysrKystLQog
d2luc3VwL2N5Z3dpbi9yZWxlYXNlLzMuNi4wICAgICAgICAgICAgICB8ICA2ICsrKwogd2lu
c3VwL2N5Z3dpbi9zY2hlZC5jYyAgICAgICAgICAgICAgICAgICB8IDQwICsrKy0tLS0tLS0t
LS0tLS0tCiA1IGZpbGVzIGNoYW5nZWQsIDg4IGluc2VydGlvbnMoKyksIDQxIGRlbGV0aW9u
cygtKQoKZGlmZiAtLWdpdCBhL3dpbnN1cC9jeWd3aW4vZmhhbmRsZXIvcHJvY2Vzcy5jYyBi
L3dpbnN1cC9jeWd3aW4vZmhhbmRsZXIvcHJvY2Vzcy5jYwppbmRleCAzN2JkZmY4NGUuLjNm
YmExODBhMCAxMDA2NDQKLS0tIGEvd2luc3VwL2N5Z3dpbi9maGFuZGxlci9wcm9jZXNzLmNj
CisrKyBiL3dpbnN1cC9jeWd3aW4vZmhhbmRsZXIvcHJvY2Vzcy5jYwpAQCAtMTA5OCw3ICsx
MDk4LDYgQEAgZm9ybWF0X3Byb2Nlc3Nfc3RhdCAodm9pZCAqZGF0YSwgY2hhciAqJmRlc3Ri
dWYpCiAgIHVuc2lnbmVkIGxvbmcgZmF1bHRfY291bnQgPSAwVUwsCiAJCXZtc2l6ZSA9IDBV
TCwgdm1yc3MgPSAwVUwsIHZtbWF4cnNzID0gMFVMOwogICB1aW50NjRfdCB1dGltZSA9IDBV
TEwsIHN0aW1lID0gMFVMTCwgc3RhcnRfdGltZSA9IDBVTEw7Ci0gIGludCBuaWNlID0gMDsK
IC8qIGN0dHkgbWFqIGlzIDMxOjE2LCBtaW4gaXMgMTU6MDsgdHR5X25yIHMvYiBtYWogMTU6
OCwgbWluIDMxOjIwLCA3OjA7CiAgICBtYWogaXMgMzE6MTYgPj4gMTYgJiBmZmYgPDwgODsg
bWluIGlzIDE1OjAgPj4gOCAmIGZmIDw8IDIwIHwgJiBmZiAqLwogICBpbnQgdHR5X25yID0g
MDsKQEAgLTExMzEsNiArMTEzMCw4IEBAIGZvcm1hdF9wcm9jZXNzX3N0YXQgKHZvaWQgKmRh
dGEsIGNoYXIgKiZkZXN0YnVmKQogICBlbHNlCiAgICAgc3RhdGUgPSBnZXRfcHJvY2Vzc19z
dGF0ZSAocC0+ZHdQcm9jZXNzSWQpOwogCisgIGludCBuaWNlID0gMCwgcHJpbyA9IDA7CisK
ICAgTlRTVEFUVVMgc3RhdHVzOwogICBIQU5ETEUgaFByb2Nlc3M7CiAgIFZNX0NPVU5URVJT
IHZtYyA9IHsgMCB9OwpAQCAtMTE2OCw3ICsxMTY5LDI1IEBAIGZvcm1hdF9wcm9jZXNzX3N0
YXQgKHZvaWQgKmRhdGEsIGNoYXIgKiZkZXN0YnVmKQogICAgICAgaWYgKCFOVF9TVUNDRVNT
IChzdGF0dXMpKQogCWRlYnVnX3ByaW50ZiAoIk50UXVlcnlJbmZvcm1hdGlvblByb2Nlc3Mo
UHJvY2Vzc1F1b3RhTGltaXRzKTogIgogCQkgICAgICAic3RhdHVzICV5Iiwgc3RhdHVzKTsK
LSAgICAgIG5pY2UgPSB3aW5wcmlvX3RvX25pY2UgKEdldFByaW9yaXR5Q2xhc3MgKGhQcm9j
ZXNzKSk7CisKKyAgICAgIG5pY2UgPSBwLT5uaWNlOworICAgICAgRFdPUkQgd2lucHJpbyA9
IEdldFByaW9yaXR5Q2xhc3MgKGhQcm9jZXNzKTsKKyAgICAgIGlmIChwLT5zY2hlZF9wb2xp
Y3kgPT0gU0NIRURfRklGTyB8fCBwLT5zY2hlZF9wb2xpY3kgPT0gU0NIRURfUlIpCisJLyog
TGludXggcHJvY19waWRfc3RhdCg1KTogKDE4KSBwcmlvcml0eSAtIEZvciBwcm9jZXNzZXMg
cnVubmluZyBhCisJICAgcmVhbC10aW1lIHNjaGVkdWxpbmcgcG9saWN5IC4uLiwgdGhpcyBp
cyB0aGUgbmVnYXRlZCBzY2hlZHVsaW5nCisJICAgcHJpb3JpdHksIG1pbnVzIG9uZS4gKi8K
KwlwcmlvID0gLSB3aW5wcmlvX3RvX3NjaGVkcHJpbyAod2lucHJpbykgLSAxOyAvKiAtMzMo
aGlnaCkuLi4tMihsb3cpICovCisgICAgICBlbHNlIGlmIChwLT5zY2hlZF9wb2xpY3kgPT0g
U0NIRURfSURMRSkKKwkvKiBFeHBlY3RlZDogd2lucHJpbyA9PSBJRExFX1BSSU9SSVRZX0NM
QVNTLiAqLworCXByaW8gPSBOWkVSTyArIHdpbnByaW9fdG9fbmljZSAod2lucHJpbyk7IC8q
IDM2ICovCisgICAgICBlbHNlCisJeworCSAgLyogVXNlIG9yaWdpbmFsbHkgcmVxdWVzdGVk
IG5pY2UgdmFsdWUgdW5sZXNzIG5vIGxvbmdlciBjb25zaXN0ZW50LiAqLworCSAgYm9vbCBi
YXRjaCA9IChwLT5zY2hlZF9wb2xpY3kgPT0gU0NIRURfQkFUQ0gpOworCSAgaWYgKHdpbnBy
aW8gIT0gbmljZV90b193aW5wcmlvIChuaWNlLCBiYXRjaCkpCisJICAgIG5pY2UgPSB3aW5w
cmlvX3RvX25pY2UgKHdpbnByaW8sIGJhdGNoKTsKKwkgIHByaW8gPSBOWkVSTyArIG5pY2U7
IC8qIDAoaGlnaCkuLi4zOShsb3cpICovCisJfQogICAgICAgQ2xvc2VIYW5kbGUgKGhQcm9j
ZXNzKTsKICAgICB9CiAgIHN0YXR1cyA9IE50UXVlcnlTeXN0ZW1JbmZvcm1hdGlvbiAoU3lz
dGVtVGltZU9mRGF5SW5mb3JtYXRpb24sCkBAIC0xMjAxLDcgKzEyMjAsNyBAQCBmb3JtYXRf
cHJvY2Vzc19zdGF0ICh2b2lkICpkYXRhLCBjaGFyIComZGVzdGJ1ZikKIAkJCSAgcC0+cHBp
ZCwgcC0+cGdpZCwgcC0+c2lkLCB0dHlfbnIsCiAJCQkgIC0xLCAwLCBmYXVsdF9jb3VudCwg
ZmF1bHRfY291bnQsIDAsIDAsCiAJCQkgIHV0aW1lLCBzdGltZSwgdXRpbWUsIHN0aW1lLAot
CQkJICBOWkVSTyArIG5pY2UsIG5pY2UsIDAsIDAsCisJCQkgIHByaW8sIG5pY2UsIDAsIDAs
CiAJCQkgIHN0YXJ0X3RpbWUsCiAJCQkgIHZtc2l6ZSwgdm1yc3MsIHZtbWF4cnNzCiAJCQkg
ICk7CmRpZmYgLS1naXQgYS93aW5zdXAvY3lnd2luL2xvY2FsX2luY2x1ZGVzL21pc2NmdW5j
cy5oIGIvd2luc3VwL2N5Z3dpbi9sb2NhbF9pbmNsdWRlcy9taXNjZnVuY3MuaAppbmRleCA2
MDAxYTE2MzYuLmZkMTBlNDBmMSAxMDA2NDQKLS0tIGEvd2luc3VwL2N5Z3dpbi9sb2NhbF9p
bmNsdWRlcy9taXNjZnVuY3MuaAorKysgYi93aW5zdXAvY3lnd2luL2xvY2FsX2luY2x1ZGVz
L21pc2NmdW5jcy5oCkBAIC00Niw2ICs0Niw4IEBAIGlzX2FsdF9udW1wYWRfZXZlbnQgKFBJ
TlBVVF9SRUNPUkQgcGlyZWMpCiAKIGludCB3aW5wcmlvX3RvX25pY2UgKERXT1JEIHByaW8s
IGJvb2wgYmF0Y2ggPSBmYWxzZSk7CiBEV09SRCBuaWNlX3RvX3dpbnByaW8gKGludCAmbmlj
ZSwgYm9vbCBiYXRjaCA9IGZhbHNlKTsKK2ludCB3aW5wcmlvX3RvX3NjaGVkcHJpbyAoRFdP
UkQgcHJpbyk7CitEV09SRCBzY2hlZHByaW9fdG9fd2lucHJpbyAoaW50IHNjaGVkcHJpbyk7
CiBib29sIHNldF9hbmRfY2hlY2tfd2lucHJpbyAoSEFORExFIHByb2MsIERXT1JEIHByaW8s
IGJvb2wgc2V0ID0gdHJ1ZSk7CiAKIGJvb2wgY3JlYXRlX3BpcGUgKFBIQU5ETEUsIFBIQU5E
TEUsIExQU0VDVVJJVFlfQVRUUklCVVRFUywgRFdPUkQpOwpkaWZmIC0tZ2l0IGEvd2luc3Vw
L2N5Z3dpbi9taXNjZnVuY3MuY2MgYi93aW5zdXAvY3lnd2luL21pc2NmdW5jcy5jYwppbmRl
eCA2ZmFmMDQ5MzcuLjMxMDgwZDA0MyAxMDA2NDQKLS0tIGEvd2luc3VwL2N5Z3dpbi9taXNj
ZnVuY3MuY2MKKysrIGIvd2luc3VwL2N5Z3dpbi9taXNjZnVuY3MuY2MKQEAgLTEwNCw3ICsx
MDQsNyBAQCB5aWVsZCAoKQogfQogCiAvKgotICAgTWFwcGluZyBvZiBuaWNlIHZhbHVlIGZy
b20vdG8gV2luZG93cyBwcmlvcml0eQorICAgTWFwcGluZyBvZiBuaWNlIHZhbHVlIG9yIHNj
aGVkX3ByaW9yaXR5IGZyb20vdG8gV2luZG93cyBwcmlvcml0eQogICAgKCdiYXRjaCcgaXMg
dXNlZCBmb3IgU0NIRURfQkFUQ0ggcG9saWN5KS4KIAogICAgIG5pY2VfdG9fd2lucHJpbygp
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2lucHJpb190b19uaWNl
KCkKQEAgLTExNSw2ICsxMTUsMTQgQEAgeWllbGQgKCkKICAgLTEyLi4uLTUgICAgLTEzLi4t
MTkgICAgMyAgICBBQk9WRV9OT1JNQUxfUFJJT1JJVFlfQ0xBU1MgICAgLTggICAgICAtMTYK
ICAgLTEzLi4tMTkgICAgICAgICAtMjAgICAgNCAgICBISUdIX1BSSU9SSVRZX0NMQVNTICAg
ICAgICAgICAtMTYgICAgICAtMjAKICAgICAgICAtMjAgICAgICAgICAgIC0gICAgNSAgICBS
RUFMVElNRV9QUklPUklUWV9DTEFTUyAgICAgICAtMjAgICAgICAtMjAKKworICAgc2NoZWRw
cmlvX3RvX3dpbnByaW8oKSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aW5wcmlv
X3RvX3NjaGVkcHJpbygpCisgICAgMS4uLi42ICAgICAgICAgICAgICAgIDAgICAgSURMRV9Q
UklPUklUWV9DTEFTUyAgICAgICAgICAgICAzCisgICAgNy4uLjEyICAgICAgICAgICAgICAg
IDEgICAgQkVMT1dfTk9STUFMX1BSSU9SSVRZX0NMQVNTICAgICA5CisgICAxMy4uLjE4ICAg
ICAgICAgICAgICAgIDIgICAgTk9STUFMX1BSSU9SSVRZX0NMQVNTICAgICAgICAgIDE1Cisg
ICAxOS4uLjI0ICAgICAgICAgICAgICAgIDMgICAgQUJPVkVfTk9STUFMX1BSSU9SSVRZX0NM
QVNTICAgIDIxCisgICAyNS4uLjMwICAgICAgICAgICAgICAgIDQgICAgSElHSF9QUklPUklU
WV9DTEFTUyAgICAgICAgICAgIDI3CisgICAzMS4uLjMyICAgICAgICAgICAgICAgIDUgICAg
UkVBTFRJTUVfUFJJT1JJVFlfQ0xBU1MgICAgICAgIDMyCiAqLwogCiAvKiAqX1BSSU9SSVRZ
X0NMQVNTIC0+IDAuLi41ICovCkBAIC0xNjcsOSArMTc1LDI1IEBAIG5pY2VfdG9fd2lucHJp
b19pbXBsIChpbnQgbmljZSwgYm9vbCBiYXRjaCA9IGZhbHNlKQogICByZXR1cm4gbGV2ZWxf
dG9fd2lucHJpbyAobGV2ZWwpOwogfQogCisvKiAqX1BSSU9SSVRZX0NMQVNTIC0+IHNjaGVk
X3ByaW9yaXR5ICovCitjb25zdGV4cHIgaW50Cit3aW5wcmlvX3RvX3NjaGVkcHJpb19pbXBs
IChEV09SRCBwcmlvKQoreworICBpbnQgbGV2ZWwgPSB3aW5wcmlvX3RvX2xldmVsIChwcmlv
KTsKKyAgcmV0dXJuIChsZXZlbCA8IDUgPyAzICsgbGV2ZWwgKiA2IDogMzIpOworfQorCisv
KiBzY2hlZF9wcmlvcml0eSAtPiAqX1BSSU9SSVRZX0NMQVNTICovCitjb25zdGV4cHIgRFdP
UkQKK3NjaGVkcHJpb190b193aW5wcmlvX2ltcGwgKGludCBzY2hlZHByaW8pCit7CisgIGlu
dCBsZXZlbCA9IChzY2hlZHByaW8gPD0gMSA/IDAgOiAoc2NoZWRwcmlvIDwgMzIgPyAoc2No
ZWRwcmlvIC0gMSkgLyA2IDogNSkpOworICByZXR1cm4gbGV2ZWxfdG9fd2lucHJpbyAobGV2
ZWwpOworfQorCiAvKiBDaGVjayBjb25zaXN0ZW5jeSBhdCBjb21waWxlIHRpbWUuICovCiBj
b25zdGV4cHIgYm9vbAotY2hlY2tfbmljZV93aW5wcmlvX21hcHBpbmcgKCkKK2NoZWNrX25p
Y2Vfc2NoZWRwcmlvX3dpbnByaW9fbWFwcGluZyAoKQogewogICBmb3IgKGludCBuaWNlID0g
LU5aRVJPOyBuaWNlIDwgTlpFUk87IG5pY2UrKykKICAgICBmb3IgKGludCBiYXRjaCA9IDA7
IGJhdGNoIDw9IDE7IGJhdGNoKyspIHsKQEAgLTE3OSwxNiArMjAzLDI4IEBAIGNoZWNrX25p
Y2Vfd2lucHJpb19tYXBwaW5nICgpCiAgICAgICBpZiAocHJpbyAhPSBwcmlvMikKIAlyZXR1
cm4gZmFsc2U7CiAgICAgfQorICBmb3IgKGludCBzY2hlZHByaW8gPSAxOyBzY2hlZHByaW8g
PD0gMzI7IHNjaGVkcHJpbysrKQorICAgIHsKKyAgICAgIERXT1JEIHByaW8gPSBzY2hlZHBy
aW9fdG9fd2lucHJpb19pbXBsIChzY2hlZHByaW8pOworICAgICAgaW50IHNjaGVkcHJpbzIg
PSB3aW5wcmlvX3RvX3NjaGVkcHJpb19pbXBsIChwcmlvKTsKKyAgICAgIERXT1JEIHByaW8y
ID0gc2NoZWRwcmlvX3RvX3dpbnByaW9faW1wbCAoc2NoZWRwcmlvMik7CisgICAgICBpZiAo
cHJpbyAhPSBwcmlvMikKKwlyZXR1cm4gZmFsc2U7CisgICAgfQogICByZXR1cm4gdHJ1ZTsK
IH0KIAotc3RhdGljX2Fzc2VydCAoY2hlY2tfbmljZV93aW5wcmlvX21hcHBpbmcoKSk7Citz
dGF0aWNfYXNzZXJ0IChjaGVja19uaWNlX3NjaGVkcHJpb193aW5wcmlvX21hcHBpbmcoKSk7
CiBzdGF0aWNfYXNzZXJ0IChuaWNlX3RvX3dpbnByaW9faW1wbChOWkVSTy0xLCBmYWxzZSkg
PT0gSURMRV9QUklPUklUWV9DTEFTUyk7CiBzdGF0aWNfYXNzZXJ0IChuaWNlX3RvX3dpbnBy
aW9faW1wbCgwLCB0cnVlKSA9PSBCRUxPV19OT1JNQUxfUFJJT1JJVFlfQ0xBU1MpOwogc3Rh
dGljX2Fzc2VydCAod2lucHJpb190b19uaWNlX2ltcGwoQkVMT1dfTk9STUFMX1BSSU9SSVRZ
X0NMQVNTLCB0cnVlKSA9PSAwKTsKIHN0YXRpY19hc3NlcnQgKG5pY2VfdG9fd2lucHJpb19p
bXBsKDAsIGZhbHNlKSA9PSBOT1JNQUxfUFJJT1JJVFlfQ0xBU1MpOwogc3RhdGljX2Fzc2Vy
dCAod2lucHJpb190b19uaWNlX2ltcGwoTk9STUFMX1BSSU9SSVRZX0NMQVNTLCBmYWxzZSkg
PT0gMCk7CiBzdGF0aWNfYXNzZXJ0IChuaWNlX3RvX3dpbnByaW9faW1wbCgtTlpFUk8sIGZh
bHNlKSA9PSBSRUFMVElNRV9QUklPUklUWV9DTEFTUyk7CitzdGF0aWNfYXNzZXJ0IChzY2hl
ZHByaW9fdG9fd2lucHJpb19pbXBsKDEpID09IElETEVfUFJJT1JJVFlfQ0xBU1MpOworc3Rh
dGljX2Fzc2VydCAoc2NoZWRwcmlvX3RvX3dpbnByaW9faW1wbCgxNSkgPT0gTk9STUFMX1BS
SU9SSVRZX0NMQVNTKTsKK3N0YXRpY19hc3NlcnQgKHdpbnByaW9fdG9fc2NoZWRwcmlvX2lt
cGwoTk9STUFMX1BSSU9SSVRZX0NMQVNTKSA9PSAxNSk7CitzdGF0aWNfYXNzZXJ0IChzY2hl
ZHByaW9fdG9fd2lucHJpb19pbXBsKDMyKSA9PSBSRUFMVElNRV9QUklPUklUWV9DTEFTUyk7
CiAKIC8qIEdldCBhIGRlZmF1bHQgdmFsdWUgZm9yIHRoZSBuaWNlIGZhY3Rvci4gKi8KIGlu
dApAQCAtMjEwLDYgKzI0NiwyMCBAQCBuaWNlX3RvX3dpbnByaW8gKGludCAmbmljZSwgYm9v
bCBiYXRjaCAvKiA9IGZhbHNlICovKQogICByZXR1cm4gbmljZV90b193aW5wcmlvX2ltcGwg
KG5pY2UsIGJhdGNoKTsKIH0KIAorLyogR2V0IGEgZGVmYXVsdCBzY2hlZF9wcmlvcml0eSBm
cm9tIGEgV2luMzIgcHJpb3JpdHkuICovCitpbnQKK3dpbnByaW9fdG9fc2NoZWRwcmlvIChE
V09SRCBwcmlvKQoreworICByZXR1cm4gd2lucHJpb190b19zY2hlZHByaW9faW1wbCAocHJp
byk7Cit9CisKKy8qIEdldCBhIFdpbjMyIHByaW9yaXR5IG1hdGNoaW5nIHRoZSBzY2hlZF9w
cmlvcml0eS4gKi8KK0RXT1JECitzY2hlZHByaW9fdG9fd2lucHJpbyAoaW50IHNjaGVkcHJp
bykKK3sKKyAgcmV0dXJuIHNjaGVkcHJpb190b193aW5wcmlvX2ltcGwgKHNjaGVkcHJpbyk7
Cit9CisKIC8qIFNldCBXaW4zMiBwcmlvcml0eSBvciByZXR1cm4gZmFsc2Ugb24gZmFpbHVy
ZS4gIEFsc28gcmV0dXJuCiAgICBmYWxzZSBhbmQgcmV2ZXJ0IHRvIHRoZSBvcmlnaW5hbCBw
cmlvcml0eSBpZiBhIGRpZmZlcmVudCAobG93ZXIpCiAgICBwcmlvcml0eSBpcyBzZXQgaW5z
dGVhZC4gIEFsd2F5cyByZXZlcnQgdG8gb3JpZ2luYWwgcHJpb3JpdHkgaWYKZGlmZiAtLWdp
dCBhL3dpbnN1cC9jeWd3aW4vcmVsZWFzZS8zLjYuMCBiL3dpbnN1cC9jeWd3aW4vcmVsZWFz
ZS8zLjYuMAppbmRleCA0ZTA3MjZlOGYuLjE3Mzk5ODBmZCAxMDA2NDQKLS0tIGEvd2luc3Vw
L2N5Z3dpbi9yZWxlYXNlLzMuNi4wCisrKyBiL3dpbnN1cC9jeWd3aW4vcmVsZWFzZS8zLjYu
MApAQCAtNjksMyArNjksOSBAQCBXaGF0IGNoYW5nZWQ6CiAgIGVhY2ggY2hpbGQgcHJvY2Vz
cyBjcmVhdGVkIHdpdGggZm9yaygyKS4KICAgTm90ZTogV2luZG93cyBkb2VzIG5vdCBvZmZl
ciBhbHRlcm5hdGl2ZSBzY2hlZHVsaW5nIHBvbGljaWVzIHNvCiAgIHRoaXMgY291bGQgb25s
eSBlbXVsYXRlIEFQSSBiZWhhdmlvci4KKworLSBJZiBTQ0hFRF9GSUZPIG9yIFNDSEVEX1JS
IGlzIHNlbGVjdGVkLCB0aGUgL3Byb2MvPFBJRD4vc3RhdCBmaWVsZAorICAnKDE4KSBwcmlv
cml0eScgaXMgbm93IHNldCB0byB0aGUgbmVnYXRlZCBzY2hlZF9wb2xpY3kgbWludXMgb25l
LgorICBJZiBTQ0hFRF9JRExFIGlzIHNlbGVjdGVkLCB0aGlzIGZpZWxkIGlzIHNldCB0byAz
Ni4KKyAgVGhlICcoMTkpIG5pY2UnIGZpZWxkIGlzIG5vdyBzZXQgdG8gdGhlIG9yaWdpbmFs
bHkgcmVxdWVzdGVkIG5pY2UKKyAgdmFsdWUgdW5sZXNzIGl0IGlzIG5vIGxvbmdlciBjb25z
aXN0ZW50IHdpdGggdGhlIFdpbmRvd3MgcHJpb3JpdHkuCmRpZmYgLS1naXQgYS93aW5zdXAv
Y3lnd2luL3NjaGVkLmNjIGIvd2luc3VwL2N5Z3dpbi9zY2hlZC5jYwppbmRleCBkNzVhMzQw
NGYuLjQzYjE3MzU3YiAxMDA2NDQKLS0tIGEvd2luc3VwL2N5Z3dpbi9zY2hlZC5jYworKysg
Yi93aW5zdXAvY3lnd2luL3NjaGVkLmNjCkBAIC0xMjAsMjkgKzEyMCw3IEBAIHNjaGVkX2dl
dHBhcmFtIChwaWRfdCBwaWQsIHN0cnVjdCBzY2hlZF9wYXJhbSAqcGFyYW0pCiAgICAgICBy
ZXR1cm4gLTE7CiAgICAgfQogICAvKiBjYWxjdWxhdGUgdGhlIHVuaXggcHJpb3JpdHkuICov
Ci0gIHN3aXRjaCAocGNsYXNzKQotICAgIHsKLSAgICBjYXNlIElETEVfUFJJT1JJVFlfQ0xB
U1M6Ci0gICAgICBwYXJhbS0+c2NoZWRfcHJpb3JpdHkgPSAzOwotICAgICAgYnJlYWs7Ci0g
ICAgY2FzZSBCRUxPV19OT1JNQUxfUFJJT1JJVFlfQ0xBU1M6Ci0gICAgICBwYXJhbS0+c2No
ZWRfcHJpb3JpdHkgPSA5OwotICAgICAgYnJlYWs7Ci0gICAgY2FzZSBOT1JNQUxfUFJJT1JJ
VFlfQ0xBU1M6Ci0gICAgZGVmYXVsdDoKLSAgICAgIHBhcmFtLT5zY2hlZF9wcmlvcml0eSA9
IDE1OwotICAgICAgYnJlYWs7Ci0gICAgY2FzZSBBQk9WRV9OT1JNQUxfUFJJT1JJVFlfQ0xB
U1M6Ci0gICAgICBwYXJhbS0+c2NoZWRfcHJpb3JpdHkgPSAyMTsKLSAgICAgIGJyZWFrOwot
ICAgIGNhc2UgSElHSF9QUklPUklUWV9DTEFTUzoKLSAgICAgIHBhcmFtLT5zY2hlZF9wcmlv
cml0eSA9IDI3OwotICAgICAgYnJlYWs7Ci0gICAgY2FzZSBSRUFMVElNRV9QUklPUklUWV9D
TEFTUzoKLSAgICAgIHBhcmFtLT5zY2hlZF9wcmlvcml0eSA9IDMyOwotICAgICAgYnJlYWs7
Ci0gICAgfQotCisgIHBhcmFtLT5zY2hlZF9wcmlvcml0eSA9IHdpbnByaW9fdG9fc2NoZWRw
cmlvIChwY2xhc3MpOwogICByZXR1cm4gMDsKIH0KIApAQCAtMjQ0LDE4ICsyMjIsMTAgQEAg
c2NoZWRfc2V0cGFyYW1fcGluZm8gKHBpbmZvICYgcCwgY29uc3Qgc3RydWN0IHNjaGVkX3Bh
cmFtICpwYXJhbSkKICAgZWxzZSBpZiAocC0+c2NoZWRfcG9saWN5ID09IFNDSEVEX0lETEUg
JiYgcHJpID09IDApCiAgICAgLyogSWRsZSBwb2xpY3ksIGlnbm9yZSB0aGUgbmljZSB2YWx1
ZS4gKi8KICAgICBwY2xhc3MgPSBJRExFX1BSSU9SSVRZX0NMQVNTOwotICBlbHNlIGlmICgx
IDw9IHByaSAmJiBwcmkgPD0gNikKLSAgICBwY2xhc3MgPSBJRExFX1BSSU9SSVRZX0NMQVNT
OwotICBlbHNlIGlmIChwcmkgPD0gMTIpCi0gICAgcGNsYXNzID0gQkVMT1dfTk9STUFMX1BS
SU9SSVRZX0NMQVNTOwotICBlbHNlIGlmIChwcmkgPD0gMTgpCi0gICAgcGNsYXNzID0gTk9S
TUFMX1BSSU9SSVRZX0NMQVNTOwotICBlbHNlIGlmIChwcmkgPD0gMjQpCi0gICAgcGNsYXNz
ID0gQUJPVkVfTk9STUFMX1BSSU9SSVRZX0NMQVNTOwotICBlbHNlIGlmIChwcmkgPD0gMzAp
Ci0gICAgcGNsYXNzID0gSElHSF9QUklPUklUWV9DTEFTUzsKLSAgZWxzZSBpZiAocHJpIDw9
IDMyKQotICAgIHBjbGFzcyA9IFJFQUxUSU1FX1BSSU9SSVRZX0NMQVNTOworICBlbHNlIGlm
ICgocC0+c2NoZWRfcG9saWN5ID09IFNDSEVEX0ZJRk8gfHwgcC0+c2NoZWRfcG9saWN5ID09
IFNDSEVEX1JSKQorICAgICAgICAgICAmJiB2YWxpZF9zY2hlZF9wYXJhbWV0ZXJzIChwYXJh
bSkpCisgICAgLyogUmVhbHRpbWUgcG9saWN5LCBhcHBseSByZXF1ZXN0ZWQgcHJpb3JpdHku
ICovCisgICAgcGNsYXNzID0gc2NoZWRwcmlvX3RvX3dpbnByaW8gKHBhcmFtLT5zY2hlZF9w
cmlvcml0eSk7CiAgIGVsc2UKICAgICB7CiAgICAgICBzZXRfZXJybm8gKEVJTlZBTCk7Ci0t
IAoyLjQ1LjEKCg==
--------------351A9CC20AFC629A763D4F90--
