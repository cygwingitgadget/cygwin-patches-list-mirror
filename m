Return-Path: <cygwin-patches-return-9438-listarch-cygwin-patches=sources.redhat.com@cygwin.com>
Received: (qmail 127888 invoked by alias); 7 Jun 2019 18:05:33 -0000
Mailing-List: contact cygwin-patches-help@cygwin.com; run by ezmlm
Precedence: bulk
List-Id: <cygwin-patches.cygwin.com>
List-Subscribe: <mailto:cygwin-patches-subscribe@cygwin.com>
List-Post: <mailto:cygwin-patches@cygwin.com>
List-Archive: <http://sourceware.org/ml/cygwin-patches/>
List-Help: <mailto:cygwin-patches-help@cygwin.com>, <http://sourceware.org/ml/#faqs>
Sender: cygwin-patches-owner@cygwin.com
Mail-Followup-To: cygwin-patches@cygwin.com
Received: (qmail 127820 invoked by uid 89); 7 Jun 2019 18:05:33 -0000
Authentication-Results: sourceware.org; auth=none
X-Spam-SWARE-Status: No, score=-21.5 required=5.0 tests=AWL,BAYES_00,GIT_PATCH_0,GIT_PATCH_1,GIT_PATCH_2,GIT_PATCH_3,MIME_BASE64_BLANKS,RCVD_IN_DNSWL_NONE,SPF_HELO_PASS,SPF_PASS autolearn=ham version=3.3.1 spammy=fpi
X-HELO: NAM01-BY2-obe.outbound.protection.outlook.com
Received: from mail-eopbgr810109.outbound.protection.outlook.com (HELO NAM01-BY2-obe.outbound.protection.outlook.com) (40.107.81.109) by sourceware.org (qpsmtpd/0.93/v0.84-503-g423c35a) with ESMTP; Fri, 07 Jun 2019 18:05:31 +0000
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=cornell.edu; s=selector2; h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck; bh=yltcxNydxXmrxGxUCWSx1j+7atBmk0FTp/+AycwTldY=; b=fWrMHtQIU47ifDY6/APLaqBlf93kgdxA9mAX3mHcWzkHq3wTyL5su3+jAVilSoECgCMgiV3LSAZ/nsod2HULVmK5jtQW953IZzF1yOS3HXvntpfAysjzQi37vtaab4FqpMdvmPoinlsjmaT2jfBVQpA3NcGdMFoupCmY1hx9EA0=
Received: from DM6PR04MB5211.namprd04.prod.outlook.com (20.178.24.208) by DM6PR04MB4779.namprd04.prod.outlook.com (20.176.107.208) with Microsoft SMTP Server (version=TLS1_2, cipher=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384) id 15.20.1965.14; Fri, 7 Jun 2019 18:05:29 +0000
Received: from DM6PR04MB5211.namprd04.prod.outlook.com ([fe80::510a:3a42:f346:a4d8]) by DM6PR04MB5211.namprd04.prod.outlook.com ([fe80::510a:3a42:f346:a4d8%7]) with mapi id 15.20.1965.011; Fri, 7 Jun 2019 18:05:29 +0000
From: Ken Brown <kbrown@cornell.edu>
To: "cygwin-patches@cygwin.com" <cygwin-patches@cygwin.com>
Subject: [PATCH draft v2 3/6] Cygwin: fhandler_pipe: control blocking mode of the Windows pipe
Date: Fri, 07 Jun 2019 18:05:00 -0000
Message-ID: <20190607180511.46369-4-kbrown@cornell.edu>
References: <20190607180511.46369-1-kbrown@cornell.edu>
In-Reply-To: <20190607180511.46369-1-kbrown@cornell.edu>
authentication-results: spf=none (sender IP is ) smtp.mailfrom=kbrown@cornell.edu;
x-ms-oob-tlc-oobclassifiers: OLM:6108;
received-spf: None (protection.outlook.com: cornell.edu does not designate permitted sender hosts)
x-ms-exchange-senderadcheck: 1
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
MIME-Version: 1.0
X-MS-Exchange-CrossTenant-mailboxtype: HOSTED
X-MS-Exchange-CrossTenant-userprincipalname: ksb2@cornell.edu
X-IsSubscribed: yes
X-SW-Source: 2019-q2/txt/msg00145.txt.bz2

QWRkIG1ldGhvZHMgJ3NldF9waXBlX25vbl9ibG9ja2luZycgYW5kICdmY250
bCcgdG8ga2VlcCB0aGUgYmxvY2tpbmcNCm1vZGUgb2YgdGhlIFdpbmRvd3Mg
cGlwZSBpbiBzeW5jIHdpdGggdGhhdCBvZiB0aGUgZmhhbmRsZXJfcGlwZQ0K
b2JqZWN0LiAgVGhpcyBhcHBsaWVzIHRvIHBpcGVzIGNyZWF0ZWQgd2l0aCB0
aGUgJ3BpcGUnIGFuZCAncGlwZTInDQpzeXN0ZW0gY2FsbHMuDQotLS0NCiB3
aW5zdXAvY3lnd2luL2ZoYW5kbGVyLmggICAgICAgfCAgMiArKw0KIHdpbnN1
cC9jeWd3aW4vZmhhbmRsZXJfcGlwZS5jYyB8IDM0ICsrKysrKysrKysrKysr
KysrKysrKysrKysrKysrKysrLS0NCiAyIGZpbGVzIGNoYW5nZWQsIDM0IGlu
c2VydGlvbnMoKyksIDIgZGVsZXRpb25zKC0pDQoNCmRpZmYgLS1naXQgYS93
aW5zdXAvY3lnd2luL2ZoYW5kbGVyLmggYi93aW5zdXAvY3lnd2luL2ZoYW5k
bGVyLmgNCmluZGV4IGI5Y2M3YjQ3MS4uNWFlMjYyYzVjIDEwMDY0NA0KLS0t
IGEvd2luc3VwL2N5Z3dpbi9maGFuZGxlci5oDQorKysgYi93aW5zdXAvY3ln
d2luL2ZoYW5kbGVyLmgNCkBAIC0xMTkyLDYgKzExOTIsNyBAQCBjbGFzcyBm
aGFuZGxlcl9waXBlOiBwdWJsaWMgZmhhbmRsZXJfYmFzZQ0KIHByaXZhdGU6
DQogICBwaWRfdCBwb3Blbl9waWQ7DQogICBzaXplX3QgbWF4X2F0b21pY193
cml0ZTsNCisgIHZvaWQgc2V0X3BpcGVfbm9uX2Jsb2NraW5nIChib29sIG5v
bmJsb2NraW5nKTsNCiBwdWJsaWM6DQogICBmaGFuZGxlcl9waXBlICgpOw0K
IA0KQEAgLTEyMDksNiArMTIxMCw3IEBAIHB1YmxpYzoNCiAgIHZvaWQgX19y
ZWczIHJhd19yZWFkICh2b2lkICpwdHIsIHNpemVfdCYgbGVuKTsNCiAgIHNz
aXplX3QgX19yZWczIHJhd193cml0ZSAoY29uc3Qgdm9pZCAqcHRyLCBzaXpl
X3QgbGVuKTsNCiAgIGludCBpb2N0bCAodW5zaWduZWQgaW50IGNtZCwgdm9p
ZCAqKTsNCisgIGludCBmY250bCAoaW50IGNtZCwgaW50cHRyX3QpOw0KICAg
aW50IF9fcmVnMiBmc3RhdCAoc3RydWN0IHN0YXQgKmJ1Zik7DQogICBpbnQg
X19yZWcyIGZzdGF0dmZzIChzdHJ1Y3Qgc3RhdHZmcyAqYnVmKTsNCiAgIGlu
dCBfX3JlZzMgZmFkdmlzZSAob2ZmX3QsIG9mZl90LCBpbnQpOw0KZGlmZiAt
LWdpdCBhL3dpbnN1cC9jeWd3aW4vZmhhbmRsZXJfcGlwZS5jYyBiL3dpbnN1
cC9jeWd3aW4vZmhhbmRsZXJfcGlwZS5jYw0KaW5kZXggZDEzODIyNmJhLi43
NjQwZmFlMzYgMTAwNjQ0DQotLS0gYS93aW5zdXAvY3lnd2luL2ZoYW5kbGVy
X3BpcGUuY2MNCisrKyBiL3dpbnN1cC9jeWd3aW4vZmhhbmRsZXJfcGlwZS5j
Yw0KQEAgLTM1LDYgKzM1LDIzIEBAIGZoYW5kbGVyX3BpcGU6OmZoYW5kbGVy
X3BpcGUgKCkNCiAgIG5lZWRfZm9ya19maXh1cCAodHJ1ZSk7DQogfQ0KIA0K
Ky8qIFRoaXMgYWxzbyBzZXRzIHRoZSBwaXBlJ3MgcmVhZCBtb2RlIHRvIGJ5
dGVfc3RyZWFtIHVuY29uZGl0aW9uYWxseS4gKi8NCit2b2lkDQorZmhhbmRs
ZXJfcGlwZTo6c2V0X3BpcGVfbm9uX2Jsb2NraW5nIChib29sIG5vbmJsb2Nr
aW5nKQ0KK3sNCisgIE5UU1RBVFVTIHN0YXR1czsNCisgIElPX1NUQVRVU19C
TE9DSyBpbzsNCisgIEZJTEVfUElQRV9JTkZPUk1BVElPTiBmcGk7DQorDQor
ICBmcGkuUmVhZE1vZGUgPSBGSUxFX1BJUEVfQllURV9TVFJFQU1fTU9ERTsN
CisgIGZwaS5Db21wbGV0aW9uTW9kZSA9IG5vbmJsb2NraW5nID8gRklMRV9Q
SVBFX0NPTVBMRVRFX09QRVJBVElPTg0KKyAgICA6IEZJTEVfUElQRV9RVUVV
RV9PUEVSQVRJT047DQorICBzdGF0dXMgPSBOdFNldEluZm9ybWF0aW9uRmls
ZSAoZ2V0X2hhbmRsZSAoKSwgJmlvLCAmZnBpLCBzaXplb2YgZnBpLA0KKwkJ
CQkgRmlsZVBpcGVJbmZvcm1hdGlvbik7DQorICBpZiAoIU5UX1NVQ0NFU1Mg
KHN0YXR1cykpDQorICAgIGRlYnVnX3ByaW50ZiAoIk50U2V0SW5mb3JtYXRp
b25GaWxlKEZpbGVQaXBlSW5mb3JtYXRpb24pOiAleSIsIHN0YXR1cyk7DQor
fQ0KKw0KIGludA0KIGZoYW5kbGVyX3BpcGU6OmluaXQgKEhBTkRMRSBmLCBE
V09SRCBhLCBtb2RlX3QgbW9kZSwgaW50NjRfdCB1bmlxX2lkKQ0KIHsNCkBA
IC02Miw4ICs3OSw3IEBAIGZoYW5kbGVyX3BpcGU6OmluaXQgKEhBTkRMRSBm
LCBEV09SRCBhLCBtb2RlX3QgbW9kZSwgaW50NjRfdCB1bmlxX2lkKQ0KICAg
c2V0X2lubyAodW5pcV9pZCk7DQogICBzZXRfdW5pcXVlX2lkICh1bmlxX2lk
IHwgISEobW9kZSAmIEdFTkVSSUNfV1JJVEUpKTsNCiAgIGlmIChvcGVuZWRf
cHJvcGVybHkpDQotICAgIC8qIC4uLiAqLw0KLSAgICA7DQorICAgIHNldF9w
aXBlX25vbl9ibG9ja2luZyAoaXNfbm9uYmxvY2tpbmcgKCkpOw0KICAgcmV0
dXJuIDE7DQogfQ0KIA0KQEAgLTYxMiw2ICs2MjgsMjAgQEAgZmhhbmRsZXJf
cGlwZTo6aW9jdGwgKHVuc2lnbmVkIGludCBjbWQsIHZvaWQgKnApDQogICBy
ZXR1cm4gMDsNCiB9DQogDQoraW50DQorZmhhbmRsZXJfcGlwZTo6ZmNudGwg
KGludCBjbWQsIGludHB0cl90IGFyZykNCit7DQorICBpZiAoY21kICE9IEZf
U0VURkwpDQorICAgIHJldHVybiBmaGFuZGxlcl9iYXNlOjpmY250bCAoY21k
LCBhcmcpOw0KKw0KKyAgY29uc3QgYm9vbCB3YXNfbm9uYmxvY2tpbmcgPSBp
c19ub25ibG9ja2luZyAoKTsNCisgIGludCByZXMgPSBmaGFuZGxlcl9iYXNl
OjpmY250bCAoY21kLCBhcmcpOw0KKyAgY29uc3QgYm9vbCBub3dfbm9uYmxv
Y2tpbmcgPSBpc19ub25ibG9ja2luZyAoKTsNCisgIGlmIChub3dfbm9uYmxv
Y2tpbmcgIT0gd2FzX25vbmJsb2NraW5nKQ0KKyAgICBzZXRfcGlwZV9ub25f
YmxvY2tpbmcgKG5vd19ub25ibG9ja2luZyk7DQorICByZXR1cm4gcmVzOw0K
K30NCisNCiBpbnQgX19yZWcyDQogZmhhbmRsZXJfcGlwZTo6ZnN0YXQgKHN0
cnVjdCBzdGF0ICpidWYpDQogew0KLS0gDQoyLjIxLjANCg0K
