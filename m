Return-Path: <cygwin-patches-return-7500-listarch-cygwin-patches=sources.redhat.com@cygwin.com>
Received: (qmail 25671 invoked by alias); 29 Aug 2011 21:12:21 -0000
Received: (qmail 25569 invoked by uid 22791); 29 Aug 2011 21:12:03 -0000
X-SWARE-Spam-Status: No, hits=1.2 required=5.0	tests=AWL,BAYES_50,DKIM_SIGNED,DKIM_VALID,DKIM_VALID_AU,FREEMAIL_FROM,RCVD_IN_DNSWL_LOW,SARE_OBFU_PROFILE,TW_CG,TW_CX,TW_DB,TW_DC,TW_DW,TW_LG,TW_XC,TW_XD,T_FRT_PROFILE1,T_FRT_PROFILE2,T_TO_NO_BRKTS_FREEMAIL
X-Spam-Check-By: sourceware.org
Received: from mail-pz0-f43.google.com (HELO mail-pz0-f43.google.com) (209.85.210.43)    by sourceware.org (qpsmtpd/0.43rc1) with ESMTP; Mon, 29 Aug 2011 21:11:44 +0000
Received: by pzk1 with SMTP id 1so10564843pzk.16        for <cygwin-patches@cygwin.com>; Mon, 29 Aug 2011 14:11:43 -0700 (PDT)
Received: by 10.142.52.4 with SMTP id z4mr2623366wfz.437.1314652303380;        Mon, 29 Aug 2011 14:11:43 -0700 (PDT)
Received: from [192.168.1.2] ([118.45.149.126])        by mx.google.com with ESMTPS id j15sm3013488wff.7.2011.08.29.14.11.37        (version=SSLv3 cipher=OTHER);        Mon, 29 Aug 2011 14:11:40 -0700 (PDT)
Message-ID: <4E5C0177.3090002@gmail.com>
Date: Mon, 29 Aug 2011 21:12:00 -0000
From: jojelino <jojelino@gmail.com>
User-Agent: Mozilla/5.0 (Windows NT 5.2; rv:8.0a2) Gecko/20110829 Thunderbird/8.0a2
MIME-Version: 1.0
To: cygwin-patches@cygwin.com
Subject: Re: [PATCH] profile support
References: <CADEiHqLZAuJkDJKh4pJ4AOJ1JwUwV06RSkq3GdNihSKhiUswGw@mail.gmail.com> <20110820084946.GA30978@calimero.vinschen.de> <4E533502.4060207@gmail.com> <20110823054003.GA10003@ednor.casa.cgf.cx> <4E5BF23F.8060806@gmail.com> <20110829202346.GA26708@ednor.casa.cgf.cx>
In-Reply-To: <20110829202346.GA26708@ednor.casa.cgf.cx>
Content-Type: multipart/mixed; boundary="------------010204030104010209060203"
Mailing-List: contact cygwin-patches-help@cygwin.com; run by ezmlm
Precedence: bulk
List-Id: <cygwin-patches.cygwin.com>
List-Subscribe: <mailto:cygwin-patches-subscribe@cygwin.com>
List-Post: <mailto:cygwin-patches@cygwin.com>
List-Archive: <http://sourceware.org/ml/cygwin-patches/>
List-Help: <mailto:cygwin-patches-help@cygwin.com>, <http://sourceware.org/ml/#faqs>
Sender: cygwin-patches-owner@cygwin.com
Mail-Followup-To: cygwin-patches@cygwin.com
X-SW-Source: 2011-q3/txt/msg00076.txt.bz2

This is a multi-part message in MIME format.
--------------010204030104010209060203
Content-Type: text/plain; charset=UTF-8; format=flowed
Content-Transfer-Encoding: 7bit
Content-length: 1014

On 2011-08-30 AM 5:23, Christopher Faylor wrote:
>
>>   endif
>> ...
>> ...
>> +endif
>>
>> +#if !defined(PROFILE)
>>       void *rv = malloc(size);
>> +#else
>> +    void *rv = LocalAlloc(LMEM_FIXED,size);
>> +#endif
>
> Since the code is in gmon.c then I don't see a reason to #ifdef it but I
> still don't understand the motivation for the change.  This is a major
> amount of code and it is desperately missing comments.
>
> Maybe Corinna will disagree but I think there is way too much code
> change here for me to be comfortable with including it.  It looks like
> it would be an ongoing maintenance issue, requiring constant vigilance
> to avoid code rot.  And, it would have to be very carefully studied to
> make sure there aren't more gotchas like 'if "" ""'.
>
> Sorry, but I don't see us including this.
>
> cgf
>
Yes, I see. but there would be months for the missing comments, and i 
have not enough time to test this patch for now.
and there were bugs in previous patch. so i attach the revised one.

--------------010204030104010209060203
Content-Type: text/plain;
 name="winsup-profile-support.diff"
Content-Transfer-Encoding: base64
Content-Disposition: attachment;
 filename="winsup-profile-support.diff"
Content-length: 41045

SW5kZXg6IHdpbnN1cC9jeWd3aW4vTWFrZWZpbGUuaW4KPT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PQpSQ1MgZmlsZTogL2N2cy9zcmMvc3JjL3dpbnN1cC9jeWd3
aW4vTWFrZWZpbGUuaW4sdgpyZXRyaWV2aW5nIHJldmlzaW9uIDEuMjQ4CmRp
ZmYgLXUgLXAgLXIxLjI0OCBNYWtlZmlsZS5pbgotLS0gd2luc3VwL2N5Z3dp
bi9NYWtlZmlsZS5pbgkyIE1heSAyMDExIDE5OjE0OjM5IC0wMDAwCTEuMjQ4
CisrKyB3aW5zdXAvY3lnd2luL01ha2VmaWxlLmluCTI5IEF1ZyAyMDExIDIx
OjAxOjU2IC0wMDAwCkBAIC01OSw3ICs1OSwxMSBAQCBNVF9TQUZFOj1ATVRf
U0FGRUAKIERFRlM6PUBERUZTQAogQ0NFWFRSQTo9CiBDRkxBR1M/PUBDRkxB
R1NACi1vdmVycmlkZSBDRkxBR1MrPS1NTUQgJHskKCpGKV9DRkxBR1N9IC1X
ZXJyb3IgLWZtZXJnZS1jb25zdGFudHMgLWZ0cmFjZXIgXAoraWZlcSAnJChw
cm9maWxlKScgJzEnCitDRkxBR1NfU0FWRTo9JChDRkxBR1MpCitDRkxBR1M9
CitlbmRpZgorb3ZlcnJpZGUgQ0ZMQUdTKz0tTU1EICR7JCgqRilfQ0ZMQUdT
fSAtZm1lcmdlLWNvbnN0YW50cyAtZnRyYWNlciBcCiAgIC1tbm8tdXNlLWxp
YnN0ZGMtd3JhcHBlcnMgJChDQ0VYVFJBKQogQ1hYPUBDWFhACiBvdmVycmlk
ZSBDWFhGTEFHUz1AQ1hYRkxBR1NACkBAIC0yMzQsNiArMjM4LDcgQEAgSU5T
VE9CSlM6PWF1dG9tb2RlLm8gYmlubW9kZS5vIHRleHRtb2RlLgogVEFSR0VU
X0xJQlM6PSQoTElCX05BTUUpICQoQ1lHV0lOX1NUQVJUKSAkKEdNT05fU1RB
UlQpICQoTElCR01PTl9BKSAkKFNVQkxJQlMpICQoSU5TVE9CSlMpICQoRVhU
UkFMSUJTKQogCiBpZm5lcSAiJHtmaWx0ZXIgLU8lLCQoQ0ZMQUdTKX0iICIi
CitpZm5lcSAnJChwcm9maWxlKScgJzEnCiBjeWdoZWFwX0NGTEFHUzo9LWZv
bWl0LWZyYW1lLXBvaW50ZXIKIGN5Z3RocmVhZF9DRkxBR1M6PS1mb21pdC1m
cmFtZS1wb2ludGVyCiBjeWd0bHNfQ0ZMQUdTOj0tZm9taXQtZnJhbWUtcG9p
bnRlcgpAQCAtMjg2LDYgKzI5MSwxNyBAQCBzeXNjYWxsc19DRkxBR1M6PS1m
b21pdC1mcmFtZS1wb2ludGVyCiBzeXNjb25mX0NGTEFHUzo9LWZvbWl0LWZy
YW1lLXBvaW50ZXIKIHVpbmZvX0NGTEFHUzo9LWZvbWl0LWZyYW1lLXBvaW50
ZXIKIGVuZGlmCitlbmRpZgorRVhUUkFfREVQRU5ERU5DSUVTXzE9Z2NydDEu
byBib3VuZGJ1ZmZlci5vIGluc3RydW1lbnQubyBnbW9uLm8gbWNvdW50Lm8g
cHJvZmlsLm8KK0VYVFJBX0xERkxBR1NfMT0uLi93MzJhcGkvbGliL2xpYmtl
cm5lbDMyLmEKK2lmZXEgJyQocHJvZmlsZSknICcxJworUFJPRklMRV9PUFRf
T1VUPSQoRVhUUkFfREVQRU5ERU5DSUVTXzE6Lm89KSBwdGhyZWFkIGtlcm5l
bDMyIG1hbGxvY193cmFwcGVyIHBzZXVkby1yZWxvYyBsaWJzdGRjeHhfd3Jh
cHBlciBjeHggc3luYworb3ZlcnJpZGUgQ0ZMQUdTKz0tRFBST0ZJTEUgJHtQ
Uk9GSUxFX0NGTEFHU18ke3NoZWxsIGVjaG8gJChQUk9GSUxFX09QVF9PVVQp
fGdyZXAgLXEgIiQoKkYpIjtyZXQ9JCQ/O2VjaG8gJCRyZXQ7fX0KK1BST0ZJ
TEVfQ0ZMQUdTXzE9JChzdWJzdCAtZm9taXQtZnJhbWUtcG9pbnRlciwsJChD
RkxBR1NfU0FWRSkpIC1nIC1wZyAtZmluc3RydW1lbnQtZnVuY3Rpb25zCitQ
Uk9GSUxFX0NGTEFHU18wPSQoc3Vic3QgLWZpbnN0cnVtZW50LWZ1bmN0aW9u
cywsJChzdWJzdCAtcGcsLCQoQ0ZMQUdTX1NBVkUpKSkgLWcgLWZvbWl0LWZy
YW1lLXBvaW50ZXIgLVduby1lcnJvcj11bnVzZWQtYnV0LXNldC12YXJpYWJs
ZQorZ2NydDEubzogJChzcmNkaXIpL2djcnQwLmMKKwkkKENPTVBJTEVfQ0Mp
IC1vICQoQEQpLyQoKkYpJG8gJDwKK2VuZGlmCiAKIGZoYW5kbGVyX3Byb2Nf
Q0ZMQUdTKz0tRFVTRVJOQU1FPSJcIiQoVVNFUilcIiIgLURIT1NUTkFNRT0i
XCIkKEhPU1ROQU1FKVwiIgogZmhhbmRsZXJfcHJvY19DRkxBR1MrPS1ER0ND
X1ZFUlNJT049IlwiYCQoQ0MpIC12IDI+JjEgfCB0YWlsIC1uIDFgXCIiCkBA
IC0zOTMsMTIgKzQwOSwxMiBAQCBtYWludGFpbmVyLWNsZWFuIHJlYWxjbGVh
bjogY2xlYW4KIAogCiAjIFJ1bGUgdG8gYnVpbGQgY3lnd2luLmRsbAotJChU
RVNUX0RMTF9OQU1FKTogJChMRFNDUklQVCkgZGxsZml4ZGJnICQoRExMX09G
SUxFUykgJChETExfSU1QT1JUUykgJChMSUJTRVJWRVIpICQoTElCQykgJChM
SUJNKSAkKEFQSV9WRVIpIE1ha2VmaWxlIHdpbnZlcl9zdGFtcAorJChURVNU
X0RMTF9OQU1FKTogJChMRFNDUklQVCkgZGxsZml4ZGJnICQoRVhUUkFfREVQ
RU5ERU5DSUVTXyQocHJvZmlsZSkpICQoRExMX09GSUxFUykgJChETExfSU1Q
T1JUUykgJChMSUJTRVJWRVIpICQoTElCQykgJChMSUJNKSAkKEFQSV9WRVIp
IE1ha2VmaWxlIHdpbnZlcl9zdGFtcAogCSQoQ1hYKSAkKENYWEZMQUdTKSAt
V2wsLS1nYy1zZWN0aW9ucyAkKG5vc3RkbGliKSAtV2wsLVQkKGZpcnN0d29y
ZCAkXikgXAogCS1XbCwtLWhlYXA9MCAtV2wsLS1vdXQtaW1wbGliLGN5Z2Rs
bC5hIC1zaGFyZWQgLW8gJEAgXAotCS1lICQoRExMX0VOVFJZKSAkKERFRl9G
SUxFKSAkKERMTF9PRklMRVMpIHZlcnNpb24ubyB3aW52ZXIubyBcCisJLWUg
JChETExfRU5UUlkpICQoREVGX0ZJTEUpICQoRVhUUkFfREVQRU5ERU5DSUVT
XyQocHJvZmlsZSkpICQoRExMX09GSUxFUykgdmVyc2lvbi5vIHdpbnZlci5v
IFwKIAkkKE1BTExPQ19PQkopICQoTElCU0VSVkVSKSAkKExJQk0pICQoTElC
QykgXAotCS1sZ2NjICQoRExMX0lNUE9SVFMpIC1XbCwtTWFwLGN5Z3dpbi5t
YXAKKwktbGdjYyAkKEVYVFJBX0xERkxBR1NfJChwcm9maWxlKSkgJChETExf
SU1QT1JUUykgLVdsLC1NYXAsY3lnd2luLm1hcAogCUAkKHdvcmQgMiwkXikg
JChPQkpEVU1QKSAkKE9CSkNPUFkpICRAICR7cGF0c3Vic3QgJTAuZGxsLCUx
LmRiZywkQH0KIAlAbG4gLWYgJEAgbmV3LSQoRExMX05BTUUpCiAKSW5kZXg6
IHdpbnN1cC9jeWd3aW4vZGNydDAuY2MKPT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PQpSQ1MgZmlsZTogL2N2cy9zcmMvc3JjL3dpbnN1cC9jeWd3aW4vZGNydDAu
Y2MsdgpyZXRyaWV2aW5nIHJldmlzaW9uIDEuNDA2CmRpZmYgLXUgLXAgLXIx
LjQwNiBkY3J0MC5jYwotLS0gd2luc3VwL2N5Z3dpbi9kY3J0MC5jYwkxOCBB
dWcgMjAxMSAxNTo1OToxNiAtMDAwMAkxLjQwNgorKysgd2luc3VwL2N5Z3dp
bi9kY3J0MC5jYwkyOSBBdWcgMjAxMSAyMTowMTo1NiAtMDAwMApAQCAtMzcs
NyArMzcsOSBAQCBkZXRhaWxzLiAqLwogI2luY2x1ZGUgImN5Z3hkci5oIgog
I2luY2x1ZGUgImZlbnYuaCIKICNpbmNsdWRlICJudGRsbC5oIgotCisjaWZk
ZWYgUFJPRklMRQorI2luY2x1ZGUgInByb2ZpbC5oIgorI2VuZGlmCiAjZGVm
aW5lIE1BWF9BVF9GSUxFX0xFVkVMIDEwCiAKICNkZWZpbmUgUFJFTUFJTl9M
RU4gKHNpemVvZiAodXNlcl9kYXRhLT5wcmVtYWluKSAvIHNpemVvZiAodXNl
cl9kYXRhLT5wcmVtYWluWzBdKSkKQEAgLTY0OCw3ICs2NTAsMTEgQEAgaW5p
dF93aW5kb3dzX3N5c3RlbV9kaXJlY3RvcnkgKCkKICAgd2luZG93c19zeXN0
ZW1fZGlyZWN0b3J5W3dpbmRvd3Nfc3lzdGVtX2RpcmVjdG9yeV9sZW5ndGgr
K10gPSBMJ1xcJzsKICAgd2luZG93c19zeXN0ZW1fZGlyZWN0b3J5W3dpbmRv
d3Nfc3lzdGVtX2RpcmVjdG9yeV9sZW5ndGhdID0gTCdcMCc7CiB9Ci0KKyNp
ZmRlZiBQUk9GSUxFCitleHRlcm4gIkMiIHsKKyAgdm9pZCBfbWNsZWFudXAg
KHZvaWQpOworfQorI2VuZGlmCiB2b2lkCiBkbGxfY3J0MF8wICgpCiB7CkBA
IC02OTUsNiArNzAxLDEwIEBAIGRsbF9jcnQwXzAgKCkKIAkgICAgYnJlYWs7
CiAJfQogICAgIH0KKyNpZmRlZiBQUk9GSUxFCisgIGlmICghaW5fZm9ya2Vl
KQorCWF0ZXhpdCgmX21jbGVhbnVwKTsKKyNlbmRpZgogCiAgIHVzZXJfZGF0
YS0+dGhyZWFkaW50ZXJmYWNlLT5Jbml0ICgpOwogCkluZGV4OiB3aW5zdXAv
Y3lnd2luL2V4Y2VwdGlvbnMuY2MKPT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQpS
Q1MgZmlsZTogL2N2cy9zcmMvc3JjL3dpbnN1cC9jeWd3aW4vZXhjZXB0aW9u
cy5jYyx2CnJldHJpZXZpbmcgcmV2aXNpb24gMS4zNjAKZGlmZiAtdSAtcCAt
cjEuMzYwIGV4Y2VwdGlvbnMuY2MKLS0tIHdpbnN1cC9jeWd3aW4vZXhjZXB0
aW9ucy5jYwkzIEF1ZyAyMDExIDE2OjQwOjQ3IC0wMDAwCTEuMzYwCisrKyB3
aW5zdXAvY3lnd2luL2V4Y2VwdGlvbnMuY2MJMjkgQXVnIDIwMTEgMjE6MDE6
NTYgLTAwMDAKQEAgLTMxLDcgKzMxLDkgQEAgZGV0YWlscy4gKi8KICNpbmNs
dWRlICJjaGlsZF9pbmZvLmgiCiAjaW5jbHVkZSAibnRkbGwuaCIKICNpbmNs
dWRlICJleGNlcHRpb24uaCIKLQorI2lmZGVmIFBST0ZJTEUKKyNpbmNsdWRl
ICJwcm9maWwuaCIKKyNlbmRpZgogI2RlZmluZSBDQUxMX0hBTkRMRVJfUkVU
UllfT1VURVIgMTAKICNkZWZpbmUgQ0FMTF9IQU5ETEVSX1JFVFJZX0lOTkVS
IDEwCiAKQEAgLTkzNyw2ICs5MzksOSBAQCBjdHJsX2NfaGFuZGxlciAoRFdP
UkQgdHlwZSkKICAgICAgIGlmIChteXNlbGYtPmN5Z3N0YXJ0ZWQpCS8qIFdh
cyB0aGlzIHByb2Nlc3MgY3JlYXRlZCBieSBhIGN5Z3dpbiBwcm9jZXNzPyAq
LwogCXJldHVybiBUUlVFOwkJLyogWWVzLiAgTGV0IHRoZSBwYXJlbnQgZXZl
bnR1YWxseSBoYW5kbGUgQ1RSTC1DIGlzc3Vlcy4gKi8KICAgICAgIGRlYnVn
X3ByaW50ZiAoImV4aXRpbmcgd2l0aCBzdGF0dXMgJXAiLCBTVEFUVVNfQ09O
VFJPTF9DX0VYSVQpOworI2lmZGVmIFBST0ZJTEUKKyAgICAgIHByb2ZpbGVf
dGhyZWFkX29mZigpOworI2VuZGlmCiAgICAgICBFeGl0UHJvY2VzcyAoU1RB
VFVTX0NPTlRST0xfQ19FWElUKTsKICAgICB9CiAKSW5kZXg6IHdpbnN1cC9j
eWd3aW4vZXh0ZXJuYWwuY2MKPT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQpSQ1Mg
ZmlsZTogL2N2cy9zcmMvc3JjL3dpbnN1cC9jeWd3aW4vZXh0ZXJuYWwuY2Ms
dgpyZXRyaWV2aW5nIHJldmlzaW9uIDEuMTIzCmRpZmYgLXUgLXAgLXIxLjEy
MyBleHRlcm5hbC5jYwotLS0gd2luc3VwL2N5Z3dpbi9leHRlcm5hbC5jYwkx
IEp1biAyMDExIDAxOjIwOjI3IC0wMDAwCTEuMTIzCisrKyB3aW5zdXAvY3ln
d2luL2V4dGVybmFsLmNjCTI5IEF1ZyAyMDExIDIxOjAxOjU2IC0wMDAwCkBA
IC0zMCw3ICszMCw5IEBAIGRldGFpbHMuICovCiAjaW5jbHVkZSA8c3RkbGli
Lmg+CiAjaW5jbHVkZSA8d2NoYXIuaD4KICNpbmNsdWRlIDxpcHR5cGVzLmg+
Ci0KKyNpZmRlZiBQUk9GSUxFCisjaW5jbHVkZSAicHJvZmlsLmgiCisjZW5k
aWYKIGNoaWxkX2luZm8gKmdldF9jeWd3aW5fc3RhcnR1cF9pbmZvICgpOwog
c3RhdGljIHZvaWQgZXhpdF9wcm9jZXNzIChVSU5ULCBib29sKSBfX2F0dHJp
YnV0ZV9fKChub3JldHVybikpOwogCkBAIC0xODAsNiArMTgyLDkgQEAgc3lu
Y193aW5lbnYgKCkKIHN0YXRpYyB2b2lkCiBleGl0X3Byb2Nlc3MgKFVJTlQg
c3RhdHVzLCBib29sIHVzZVRlcm1pbmF0ZVByb2Nlc3MpCiB7CisjaWZkZWYg
UFJPRklMRQorICBwcm9maWxlX3RocmVhZF9vZmYoKTsKKyNlbmRpZgogICBw
aWRfdCBwaWQgPSBnZXRwaWQgKCk7CiAgIGV4dGVybmFsX3BpbmZvICogZXAg
PSBmaWxsb3V0X3BpbmZvIChwaWQsIDEpOwogICBEV09SRCBkd3BpZCA9IGVw
ID8gZXAtPmR3UHJvY2Vzc0lkIDogcGlkOwpJbmRleDogd2luc3VwL2N5Z3dp
bi9nY3J0MC5jCj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KUkNTIGZpbGU6IC9j
dnMvc3JjL3NyYy93aW5zdXAvY3lnd2luL2djcnQwLmMsdgpyZXRyaWV2aW5n
IHJldmlzaW9uIDEuNQpkaWZmIC11IC1wIC1yMS41IGdjcnQwLmMKLS0tIHdp
bnN1cC9jeWd3aW4vZ2NydDAuYwkxMSBTZXAgMjAwMSAyMDowMTowMCAtMDAw
MAkxLjUKKysrIHdpbnN1cC9jeWd3aW4vZ2NydDAuYwkyOSBBdWcgMjAxMSAy
MTowMTo1OCAtMDAwMApAQCAtMzMsNyArMzMsOSBAQCBfbW9uc3RhcnR1cCAo
dm9pZCkKICAgICByZXR1cm47CiAKICAgbW9uc3RhcnR1cCAoKHVfbG9uZykg
JmVwcm9sLCAodV9sb25nKSAmZXRleHQpOworI2lmbmRlZiBQUk9GSUxFCiAg
IGF0ZXhpdCAoJl9tY2xlYW51cCk7CisjZW5kaWYKIH0KIAogYXNtICgiLnRl
eHQiKTsKSW5kZXg6IHdpbnN1cC9jeWd3aW4vZ21vbi5jCj09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT0KUkNTIGZpbGU6IC9jdnMvc3JjL3NyYy93aW5zdXAvY3ln
d2luL2dtb24uYyx2CnJldHJpZXZpbmcgcmV2aXNpb24gMS43CmRpZmYgLXUg
LXAgLXIxLjcgZ21vbi5jCi0tLSB3aW5zdXAvY3lnd2luL2dtb24uYwkzMCBB
dWcgMjAxMCAwMTo1NzozNiAtMDAwMAkxLjcKKysrIHdpbnN1cC9jeWd3aW4v
Z21vbi5jCTI5IEF1ZyAyMDExIDIxOjAxOjU4IC0wMDAwCkBAIC0zNCwxMSAr
MzQsMTcgQEAKICNpZiAhZGVmaW5lZChsaW50KSAmJiBkZWZpbmVkKExJQkNf
U0NDUykKIHN0YXRpYyBjaGFyIHJjc2lkW10gPSAiJE9wZW5CU0Q6IGdtb24u
Yyx2IDEuOCAxOTk3LzA3LzIzIDIxOjExOjI3IGtzdGFpbGV5IEV4cCAkIjsK
ICNlbmRpZgotCisjaWZkZWYgUFJPRklMRQorI2luY2x1ZGUgIndpbnN1cC5o
IgorI2VuZGlmCiAjaW5jbHVkZSAid2lubGVhbi5oIgogI2luY2x1ZGUgPGZj
bnRsLmg+CiAjaW5jbHVkZSA8c3RkaW8uaD4KICNpbmNsdWRlIDx1bmlzdGQu
aD4KKyNpZmRlZiBQUk9GSUxFCisjaW5jbHVkZSA8c3RyaW5nLmg+CisjaW5j
bHVkZSA8bWF0aC5oPgorI2VuZGlmCiAjaW5jbHVkZSA8Z21vbi5oPgogI2lu
Y2x1ZGUgPHN0ZGxpYi5oPgogCkBAIC00Nyw3ICs1MywxMSBAQCBzdGF0aWMg
Y2hhciByY3NpZFtdID0gIiRPcGVuQlNEOiBnbW9uLmMsCiAvKiBYWFggbmVl
ZGVkPyAqLwogLy9leHRlcm4gY2hhciAqbWluYnJrIF9fYXNtICgibWluYnJr
Iik7CiAKLXN0cnVjdCBnbW9ucGFyYW0gX2dtb25wYXJhbSA9IHsgR01PTl9Q
Uk9GX09GRiB9Oworc3RydWN0IGdtb25wYXJhbQorI2lmZGVmIFBST0ZJTEUK
K05PX0NPUFlfSU5JVAorI2VuZGlmCitfZ21vbnBhcmFtID0geyBHTU9OX1BS
T0ZfT0ZGIH07CiAKIHN0YXRpYyBpbnQJc19zY2FsZTsKIC8qIHNlZSBwcm9m
aWwoMikgd2hlcmUgdGhpcyBpcyBkZXNjcmliZSAoaW5jb3JyZWN0bHkpICov
CkBAIC02MCw3ICs3MCwxMSBAQCB2b2lkCW1vbmNvbnRyb2wgX19QKChpbnQp
KTsKIHN0YXRpYyB2b2lkICoKIGZha2Vfc2JyayhpbnQgc2l6ZSkKIHsKKyNp
ZiAhZGVmaW5lZChQUk9GSUxFKQogICAgIHZvaWQgKnJ2ID0gbWFsbG9jKHNp
emUpOworI2Vsc2UKKyAgICB2b2lkICpydiA9IExvY2FsQWxsb2MoTE1FTV9G
SVhFRCxzaXplKTsKKyNlbmRpZgogICAgIGlmIChydikKICAgICAgIHJldHVy
biBydjsKICAgICBlbHNlCkBAIC05Miw4ICsxMDYsMTEgQEAgbW9uc3RhcnR1
cChsb3dwYywgaGlnaHBjKQogCWVsc2UgaWYgKHAtPnRvbGltaXQgPiBNQVhB
UkNTKQogCQlwLT50b2xpbWl0ID0gTUFYQVJDUzsKIAlwLT50b3NzaXplID0g
cC0+dG9saW1pdCAqIHNpemVvZihzdHJ1Y3QgdG9zdHJ1Y3QpOwotCisjaWZk
ZWYgUFJPRklMRQorCWNwID0gZmFrZV9zYnJrKDUgKiBwLT5rY291bnRzaXpl
ICsgcC0+ZnJvbXNzaXplICsgcC0+dG9zc2l6ZSk7CisjZWxzZQogCWNwID0g
ZmFrZV9zYnJrKHAtPmtjb3VudHNpemUgKyBwLT5mcm9tc3NpemUgKyBwLT50
b3NzaXplKTsKKyNlbmRpZgogCWlmIChjcCA9PSAoY2hhciAqKS0xKSB7CiAJ
CUVSUigibW9uc3RhcnR1cDogb3V0IG9mIG1lbW9yeVxuIik7CiAJCXJldHVy
bjsKQEAgLTEwNSw2ICsxMjIsMTEgQEAgbW9uc3RhcnR1cChsb3dwYywgaGln
aHBjKQogCWNwICs9IHAtPnRvc3NpemU7CiAJcC0+a2NvdW50ID0gKHVfc2hv
cnQgKiljcDsKIAljcCArPSBwLT5rY291bnRzaXplOworI2lmZGVmIFBST0ZJ
TEUKKwlwLT5jb21tX2tjb3VudD0odV9pbnQ2NF90KiljcDsKKwljcCArPSA0
KnAtPmtjb3VudHNpemU7CisJbWVtc2V0KHAtPmNvbW1fa2NvdW50LDAsNCpw
LT5rY291bnRzaXplKTsKKyNlbmRpZgogCXAtPmZyb21zID0gKHVfc2hvcnQg
KiljcDsKIAogCS8qIFhYWCBtaW5icmsgbmVlZGVkPyAqLwpAQCAtMTM2LDYg
KzE1OCw5IEBAIG1vbnN0YXJ0dXAobG93cGMsIGhpZ2hwYykKIHZvaWQKIF9t
Y2xlYW51cCgpCiB7CisjaWZkZWYgUFJPRklMRQorCXVuc2lnbmVkIGk7Cisj
ZW5kaWYKIAlpbnQgZmQ7CiAJaW50IGh6OwogCWludCBmcm9taW5kZXg7CkBA
IC0yMDQsOCArMjI5LDE2IEBAIF9tY2xlYW51cCgpCiAJfQogI2Vsc2UKIAl7
CisjaWZkZWYgUFJPRklMRQorCSAgY2hhciBnbW9uX291dFsxMDI0XTsKKwkg
IGNoYXIgcHJvY19tb2R1bGVuYW1lWzEwMjRdOworCSAgR2V0TW9kdWxlRmls
ZU5hbWVBKDAsIHByb2NfbW9kdWxlbmFtZSwgMTAyNCk7CisJICBzcHJpbnRm
KGdtb25fb3V0LCAiZ21vbi4lcy4lZC5vdXQiLCBzdHJyY2hyKHByb2NfbW9k
dWxlbmFtZSwgJ1xcJykgKyAxLCAoaW50KSBHZXRDdXJyZW50UHJvY2Vzc0lk
KCkpOworCSAgcHJvZmZpbGUgPSBnbW9uX291dDsKKyNlbHNlCiAJICBjaGFy
IGdtb25fb3V0W10gPSAiZ21vbi5vdXQiOwogCSAgcHJvZmZpbGUgPSBnbW9u
X291dDsKKyNlbmRpZgogCX0KICNlbmRpZgogCkBAIC0yMjQsNiArMjU3LDU2
IEBAIF9tY2xlYW51cCgpCiAJICAgIHAtPmtjb3VudCwgcC0+a2NvdW50c2l6
ZSk7CiAJd3JpdGUobG9nLCBkYnVmLCBsZW4pOwogI2VuZGlmCisjaWZkZWYg
UFJPRklMRQorICB1X2ludDY0X3QgbWF4Y291bnQgPSAxOworICBmb3IgKGkg
PSAwOyBpIDwgcC0+a2NvdW50c2l6ZSAvIDI7IGkrKykKKwl7CisJICBpZiAo
cC0+Y29tbV9rY291bnRbaV0gPiBtYXhjb3VudCkKKwkJeworCQkgIG1heGNv
dW50ID0gcC0+Y29tbV9rY291bnRbaV07CisJCX0KKwl9CisgIHVfaW50NjRf
dCBwZXJmZnJlcTsKKyAgUXVlcnlQZXJmb3JtYW5jZUZyZXF1ZW5jeSgoUExB
UkdFX0lOVEVHRVIpICZwZXJmZnJlcSk7CisKKyAgZG91YmxlIGxvZ3BlcmZm
cmVxID0gbG9nMTAocGVyZmZyZXEpLCBsb2dtYXhjb3VudCA9IGxvZzEwKG1h
eGNvdW50KTsKKyAgZG91YmxlIGZsb29ybG9ncGVyZmZyZXEgPSBmbG9vcihs
b2dwZXJmZnJlcSk7CisgIGRvdWJsZSBjb2VmZl90b19tYXhpbWl6ZV9rY291
bnQgPSBsb2dtYXhjb3VudCAtIGxvZ3BlcmZmcmVxICsgZmxvb3Jsb2dwZXJm
ZnJlcTsKKyAgLyoKKyAgICogVG8gbWF4aW1pemUga2NvdW50LCB3ZSBjb3Zl
ciB0aGUgY2FzZSB3aGVyZSB1cHBlciBib3VuZCBpcyA5OTk5LgorICAgKi8K
KyAgaWYgKGNvZWZmX3RvX21heGltaXplX2tjb3VudCA8PSAzKQorCXsKKwkg
IGNvZWZmX3RvX21heGltaXplX2tjb3VudCA9IDA7CisJfQorICBlbHNlIGlm
IChjb2VmZl90b19tYXhpbWl6ZV9rY291bnQgPiAzKQorCXsKKwkgIC8qCisJ
ICAgKiBhbmQgY292ZXIgdGhlIGNhc2UgdXAgdG8gNjU1MzUuCisJICAgKi8K
KwkgIGNvZWZmX3RvX21heGltaXplX2tjb3VudCAtPSAzOworCSAgaWYgKChs
b2dwZXJmZnJlcSAtIGZsb29ybG9ncGVyZmZyZXEpIDwgbG9nMTAoNi41NSkp
CisJCWNvZWZmX3RvX21heGltaXplX2tjb3VudC0tOworCX0KKyAgZWxzZQor
CXsKKwkgIGNvZWZmX3RvX21heGltaXplX2tjb3VudCA9IDA7CisJfQorICBo
eiA9IChpbnQpIHBvdygxMCwgZmxvb3IoZmxvb3Jsb2dwZXJmZnJlcSAtIGNv
ZWZmX3RvX21heGltaXplX2tjb3VudCkpOworICBwZXJmZnJlcSAvPSBoejsK
KyNpZiAwCisgIHByaW50ZigiJWQgJWQgbWF4Y291bnQgJWxsZCBsb2dtYXhj
bnQgJWYgbWF4cHJlcSAlZiBoeiAlZCBwZXJmZnJlcSAlZFxuIiwgR2V0Q3Vy
cmVudFByb2Nlc3NJZCgpLCBHZXRDdXJyZW50VGhyZWFkSWQoKSwgbWF4Y291
bnQsIGxvZ21heGNvdW50LCBjb2VmZl90b19tYXhpbWl6ZV9rY291bnQsIGh6
LCBwZXJmZnJlcSk7CisjZW5kaWYKKyAgZm9yIChpID0gMDsgaSA8IHAtPmtj
b3VudHNpemUgLyAyOyBpKyspCisJeworCSAgaWYgKHAtPmNvbW1fa2NvdW50
W2ldIDwgcGVyZmZyZXEpCisJCWNvbnRpbnVlOworCSAgZWxzZQorCQl7CisJ
CSAgcC0+a2NvdW50W2ldID0gcC0+Y29tbV9rY291bnRbaV0gLyBwZXJmZnJl
cTsKKwkJfQorCX0KKyNlbmRpZgogCWhkciA9IChzdHJ1Y3QgZ21vbmhkciAq
KSZnbW9uaGRyOwogCWhkci0+bHBjID0gcC0+bG93cGM7CiAJaGRyLT5ocGMg
PSBwLT5oaWdocGM7CkluZGV4OiB3aW5zdXAvY3lnd2luL2dtb24uaAo9PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09ClJDUyBmaWxlOiAvY3ZzL3NyYy9zcmMvd2lu
c3VwL2N5Z3dpbi9nbW9uLmgsdgpyZXRyaWV2aW5nIHJldmlzaW9uIDEuMgpk
aWZmIC11IC1wIC1yMS4yIGdtb24uaAotLS0gd2luc3VwL2N5Z3dpbi9nbW9u
LmgJMjQgSnVuIDIwMDEgMjI6MjY6NTEgLTAwMDAJMS4yCisrKyB3aW5zdXAv
Y3lnd2luL2dtb24uaAkyOSBBdWcgMjAxMSAyMTowMTo1OCAtMDAwMApAQCAt
MTM0LDYgKzEzNCw5IEBAIHN0cnVjdCByYXdhcmMgewogc3RydWN0IGdtb25w
YXJhbSB7CiAJaW50CQlzdGF0ZTsKIAl1X3Nob3J0CQkqa2NvdW50OworI2lm
ZGVmIFBST0ZJTEUKKwl1X2ludDY0X3QgKmNvbW1fa2NvdW50OworI2VuZGlm
CiAJdV9sb25nCQlrY291bnRzaXplOwogCXVfc2hvcnQJCSpmcm9tczsKIAl1
X2xvbmcJCWZyb21zc2l6ZTsKSW5kZXg6IHdpbnN1cC9jeWd3aW4vaW5pdC5j
Ywo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09ClJDUyBmaWxlOiAvY3ZzL3NyYy9z
cmMvd2luc3VwL2N5Z3dpbi9pbml0LmNjLHYKcmV0cmlldmluZyByZXZpc2lv
biAxLjg0CmRpZmYgLXUgLXAgLXIxLjg0IGluaXQuY2MKLS0tIHdpbnN1cC9j
eWd3aW4vaW5pdC5jYwkxOCBBdWcgMjAxMSAxNTo1OToxNiAtMDAwMAkxLjg0
CisrKyB3aW5zdXAvY3lnd2luL2luaXQuY2MJMjkgQXVnIDIwMTEgMjE6MDE6
NTggLTAwMDAKQEAgLTEzLDYgKzEzLDEwIEBAIGRldGFpbHMuICovCiAjaW5j
bHVkZSAiY3lndGxzLmgiCiAjaW5jbHVkZSAibnRkbGwuaCIKICNpbmNsdWRl
ICJzaGFyZWRfaW5mby5oIgorI2lmZGVmIFBST0ZJTEUKKyNpbmNsdWRlICJw
cm9maWwuaCIKKyNpbmNsdWRlICJpbnN0cnVtZW50LmgiCisjZW5kaWYKIAog
c3RhdGljIERXT1JEIF9teV9vbGRmdW5jOwogCkBAIC0xMDYsNiArMTEwLDkg
QEAgcmVzcGF3bl93b3c2NF9wcm9jZXNzICgpCiAJYXBpX2ZhdGFsICgiV2Fp
dGluZyBmb3IgcHJvY2VzcyAlZCBmYWlsZWQsICVFIiwgcGkuZHdQcm9jZXNz
SWQpOwogICAgICAgR2V0RXhpdENvZGVQcm9jZXNzIChwaS5oUHJvY2Vzcywg
JnJldCk7CiAgICAgICBDbG9zZUhhbmRsZSAocGkuaFByb2Nlc3MpOworI2lm
ZGVmIFBST0ZJTEUKKyAgICAgIHByb2ZpbGVfdGhyZWFkX29mZigpOworI2Vu
ZGlmCiAgICAgICBFeGl0UHJvY2VzcyAocmV0KTsKICAgICB9CiB9CkBAIC0x
MjAsNiArMTI3LDEwIEBAIGRsbF9lbnRyeSAoSEFORExFIGgsIERXT1JEIHJl
YXNvbiwgdm9pZCAKICAgc3dpdGNoIChyZWFzb24pCiAgICAgewogICAgIGNh
c2UgRExMX1BST0NFU1NfQVRUQUNIOgorI2lmZGVmIFBST0ZJTEUKKyAgICAg
IF9fY3lnX3Byb2ZpbGVfZnVuY19jdG9yKCk7CisgICAgICBfX2N5Z19wcm9m
aWxlX3Rsc19jdG9yKCk7CisjZW5kaWYKICAgICAgIHdpbmNhcC5pbml0ICgp
OwogICAgICAgaW5pdF9jb25zb2xlX2hhbmRsZXIgKGZhbHNlKTsKIApAQCAt
MTQzLDggKzE1NCwxNSBAQCBkbGxfZW50cnkgKEhBTkRMRSBoLCBEV09SRCBy
ZWFzb24sIHZvaWQgCiAgICAgY2FzZSBETExfUFJPQ0VTU19ERVRBQ0g6CiAg
ICAgICBpZiAoZHluYW1pY2FsbHlfbG9hZGVkKQogCXNoYXJlZF9kZXN0cm95
ICgpOworI2lmZGVmIFBST0ZJTEUKKyAgICAgIF9fY3lnX3Byb2ZpbGVfdGxz
X2R0b3IoKTsKKyAgICAgIF9fY3lnX3Byb2ZpbGVfZnVuY19kdG9yKCk7Cisj
ZW5kaWYKICAgICAgIGJyZWFrOwogICAgIGNhc2UgRExMX1RIUkVBRF9BVFRB
Q0g6CisjaWZkZWYgUFJPRklMRQorICAgICAgX19jeWdfcHJvZmlsZV90bHNf
Y3RvcigpOworI2VuZGlmCiAgICAgICBpZiAoZGxsX2ZpbmlzaGVkX2xvYWRp
bmcpCiAJbXVuZ2VfdGhyZWFkZnVuYyAoKTsKICAgICAgIGJyZWFrOwpAQCAt
MTUzLDYgKzE3MSw5IEBAIGRsbF9lbnRyeSAoSEFORExFIGgsIERXT1JEIHJl
YXNvbiwgdm9pZCAKIAkgICYmIChQVk9JRCkgJl9teV90bHMgPiAoUFZPSUQp
ICZ3b3c2NF90ZXN0X3N0YWNrX21hcmtlcgogCSAgJiYgX215X3Rscy5pc2lu
aXRpYWxpemVkICgpKQogCV9teV90bHMucmVtb3ZlICgwKTsKKyNpZmRlZiBQ
Uk9GSUxFCisJX19jeWdfcHJvZmlsZV90bHNfZHRvcigpOworI2VuZGlmCiAg
ICAgICAvKiBXaW5kb3dzIDIwMDAgaGFzIGEgYnVnIGluIE50VGVybWluYXRl
VGhyZWFkLiAgSW5zdGVhZCBvZiByZWxlYXNpbmcKIAkgdGhlIHN0YWNrIGF0
IHRlYi0+RGVhbGxvY2F0aW9uU3RhY2sgaXQgdXNlcyB0aGUgdmFsdWUgb2YK
IAkgdGViLT5UaWIuU3RhY2tMaW1pdCB0byBldmFsdWF0ZSB0aGUgc3RhY2sg
YWRkcmVzcy4gIFNvIHdlIGp1c3QgY2xhaW0KSW5kZXg6IHdpbnN1cC9jeWd3
aW4vcGluZm8uY2MKPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQpSQ1MgZmlsZTog
L2N2cy9zcmMvc3JjL3dpbnN1cC9jeWd3aW4vcGluZm8uY2MsdgpyZXRyaWV2
aW5nIHJldmlzaW9uIDEuMjc5CmRpZmYgLXUgLXAgLXIxLjI3OSBwaW5mby5j
YwotLS0gd2luc3VwL2N5Z3dpbi9waW5mby5jYwkxMyBBdWcgMjAxMSAxMDoy
ODoxNSAtMDAwMAkxLjI3OQorKysgd2luc3VwL2N5Z3dpbi9waW5mby5jYwky
OSBBdWcgMjAxMSAyMTowMTo1OCAtMDAwMApAQCAtMjksNyArMjksOSBAQCBk
ZXRhaWxzLiAqLwogI2luY2x1ZGUgImN5Z3Rscy5oIgogI2luY2x1ZGUgInRs
c19wYnVmLmgiCiAjaW5jbHVkZSAiY2hpbGRfaW5mby5oIgotCisjaWZkZWYg
UFJPRklMRQorI2luY2x1ZGUgInByb2ZpbC5oIgorI2VuZGlmCiBjbGFzcyBw
aW5mb19iYXNpYzogcHVibGljIF9waW5mbwogewogcHVibGljOgpAQCAtMjA0
LDYgKzIwNiw5IEBAIHBpbmZvOjpleGl0IChEV09SRCBuKQogICBpZiAoIXNl
bGYtPmN5Z3N0YXJ0ZWQpCiAgICAgZXhpdGNvZGUgPSAoKGV4aXRjb2RlICYg
MHhmZikgPDwgOCkgfCAoKGV4aXRjb2RlID4+IDgpICYgMHhmZik7CiAgIHNp
Z3Byb2NfcHJpbnRmICgiQ2FsbGluZyBFeGl0UHJvY2VzcyBuICVwLCBleGl0
Y29kZSAlcCIsIG4sIGV4aXRjb2RlKTsKKyNpZmRlZiBQUk9GSUxFCisgIHBy
b2ZpbGVfdGhyZWFkX29mZigpOworI2VuZGlmCiAgIEV4aXRQcm9jZXNzIChl
eGl0Y29kZSk7CiB9CiAjIHVuZGVmIHNlbGYKSW5kZXg6IHdpbnN1cC9jeWd3
aW4vcHJvZmlsLmMKPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQpSQ1MgZmlsZTog
L2N2cy9zcmMvc3JjL3dpbnN1cC9jeWd3aW4vcHJvZmlsLmMsdgpyZXRyaWV2
aW5nIHJldmlzaW9uIDEuOApkaWZmIC11IC1wIC1yMS44IHByb2ZpbC5jCi0t
LSB3aW5zdXAvY3lnd2luL3Byb2ZpbC5jCTMwIEF1ZyAyMDEwIDAxOjU3OjM2
IC0wMDAwCTEuOAorKysgd2luc3VwL2N5Z3dpbi9wcm9maWwuYwkyOSBBdWcg
MjAxMSAyMTowMTo1OCAtMDAwMApAQCAtNywxOCArNywyNyBAQAogICAgVGhp
cyBzb2Z0d2FyZSBpcyBhIGNvcHlyaWdodGVkIHdvcmsgbGljZW5zZWQgdW5k
ZXIgdGhlIHRlcm1zIG9mIHRoZQogICAgQ3lnd2luIGxpY2Vuc2UuICBQbGVh
c2UgY29uc3VsdCB0aGUgZmlsZSAiQ1lHV0lOX0xJQ0VOU0UiIGZvcgogICAg
ZGV0YWlscy4gKi8KLQorI2lmZGVmIFBST0ZJTEUKKyNpbmNsdWRlICJ3aW5z
dXAuaCIKKyNlbmRpZgogI2luY2x1ZGUgIndpbmxlYW4uaCIKICNpbmNsdWRl
IDxzeXMvdHlwZXMuaD4KICNpbmNsdWRlIDxlcnJuby5oPgotCisjaWZkZWYg
UFJPRklMRQorI2luY2x1ZGUgImdtb24uaCIKKyNlbmRpZgogI2luY2x1ZGUg
PHByb2ZpbC5oPgogCiAjZGVmaW5lIFNMRUVQVElNRSAoMTAwMCAvIFBST0Zf
SFopCi0KKyNpZmRlZiBQUk9GSUxFCitleHRlcm4gU0VDVVJJVFlfQVRUUklC
VVRFUyBzZWNfbm9uZV9uaWg7CisjZW5kaWYKIC8qIGdsb2JhbCBwcm9maW5m
byBmb3IgcHJvZmlsKCkgY2FsbCAqLworI2lmZGVmIFBST0ZJTEUKK3N0cnVj
dCBwcm9maW5mbyBOT19DT1BZIHByb2Y7CisjZWxzZQogc3RhdGljIHN0cnVj
dCBwcm9maW5mbyBwcm9mOwotCisjZW5kaWYKIC8qIEdldCB0aGUgcGMgZm9y
IHRocmVhZCBUSFIgKi8KIAogc3RhdGljIHVfbG9uZwpAQCAtODUsMTkgKzk0
LDUwIEBAIHByb2ZpbGVfb2ZmIChzdHJ1Y3QgcHJvZmluZm8gKnApCiB7CiAg
IGlmIChwLT5wcm9mdGhyKQogICAgIHsKKyNpZmRlZiBQUk9GSUxFCisgICAg
ICBpZiAocHJvZi5xdWV1ZS53b3JrZXJfZW5hYmxlZCkKKwkJeworCQkgIHBy
b2ZpbGVfdGhyZWFkX29mZigpOworCQkgIGJvdW5kYnVmZmVyX2R0b3IoJnAt
PnF1ZXVlKTsKKwkJICB3aGlsZSAoYm91bmRidWZmZXJfZW1wdHkoJnAtPnF1
ZXVlKSkKKwkJCXsKKwkJCSAgbWVzc2FnZSBtc2c7CisJCQkgIGJvdW5kYnVm
ZmVyX2RlcXVldWVfbm9sb2NrKCZwLT5xdWV1ZSwgJm1zZyk7CisJCQkgIHVu
c2lnbmVkIGlkeCA9IFBST0ZJRFggKCh1bnNpZ25lZCltc2cucHYsIHAtPmxv
d3BjLCBwLT5zY2FsZSk7CisJCQkgIGlmICghbXNnLnVsbHZhbCkKKwkJCSAg
Y29udGludWU7CisJCQkgIF9nbW9ucGFyYW0uY29tbV9rY291bnRbaWR4XSAr
PSBtc2cudWxsdmFsOworCQkJfQorCQl9CisJICBDbG9zZUhhbmRsZShwLT5w
cm9mdGhyKTsKKwkgIENsb3NlSGFuZGxlKHByb2Yub3BlcmF0aW9uYWwpOwor
CSAgcC0+cHJvZnRociA9IDA7CisjZWxzZQogICAgICAgVGVybWluYXRlVGhy
ZWFkIChwLT5wcm9mdGhyLCAwKTsKICAgICAgIENsb3NlSGFuZGxlIChwLT5w
cm9mdGhyKTsKKyNlbmRpZgogICAgIH0KKyNpZiAhZGVmaW5lZChQUk9GSUxF
KQogICBpZiAocC0+dGFyZ3RocikKICAgICBDbG9zZUhhbmRsZSAocC0+dGFy
Z3Rocik7CisjZW5kaWYKICAgcmV0dXJuIDA7CiB9Ci0KKyNpZmRlZiBQUk9G
SUxFCitzdGF0aWMgdm9pZCBfX3N0ZGNhbGwKK2FwY19zcGF3bnRocmVhZCh1
bnNpZ25lZCBsb25nIGFyZykKK3sKKyAgc3RydWN0IHByb2ZpbmZvKiBwID0g
KHN0cnVjdCBwcm9maW5mbyopIGFyZzsKKyAgcC0+cHJvZnRociA9IENyZWF0
ZVRocmVhZCgmc2VjX25vbmVfbmloLCAwLCB3b3JrZXJfY29uc3VtZXIsICh2
b2lkICopIHAsIDAsCisJICAwKTsKK30KKyNlbmRpZgogLyogQ3JlYXRlIGEg
dGltZXIgdGhyZWFkIGFuZCBwYXNzIGl0IGEgcG9pbnRlciBQIHRvIHRoZSBw
cm9maWxpbmcgYnVmZmVyLiAqLwogCiBzdGF0aWMgaW50CiBwcm9maWxlX29u
IChzdHJ1Y3QgcHJvZmluZm8gKnApCiB7CisjaWYgIWRlZmluZWQoUFJPRklM
RSkKICAgRFdPUkQgdGhyaWQ7CiAKICAgLyogZ2V0IGhhbmRsZSBmb3IgdGhp
cyB0aHJlYWQgKi8KQEAgLTExNyw2ICsxNTcsMTMgQEAgcHJvZmlsZV9vbiAo
c3RydWN0IHByb2ZpbmZvICpwKQogICAgICAgZXJybm8gPSBFQUdBSU47CiAg
ICAgICByZXR1cm4gLTE7CiAgICAgfQorI2Vsc2UKKyAgZXh0ZXJuIHZvaWQg
aW5pdF9nbG9iYWxfc2VjdXJpdHkoKSBhc20oIl9aMjBpbml0X2dsb2JhbF9z
ZWN1cml0eXYiKTsKKyAgaW5pdF9nbG9iYWxfc2VjdXJpdHkoKTsKKyAgYm91
bmRidWZmZXJfaW5pdGlhbCgmcHJvZi5xdWV1ZSk7CisgIHByb2Yub3BlcmF0
aW9uYWwgPSBDcmVhdGVTZW1hcGhvcmVBKCZzZWNfbm9uZV9uaWgsIDAsIDEs
IDApOworICBRdWV1ZVVzZXJBUEMoYXBjX3NwYXdudGhyZWFkLCBHZXRDdXJy
ZW50VGhyZWFkKCksIChVTE9OR19QVFIpIHApOworI2VuZGlmCiAgIHJldHVy
biAwOwogfQogCkluZGV4OiB3aW5zdXAvY3lnd2luL3Byb2ZpbC5oCj09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT0KUkNTIGZpbGU6IC9jdnMvc3JjL3NyYy93aW5z
dXAvY3lnd2luL3Byb2ZpbC5oLHYKcmV0cmlldmluZyByZXZpc2lvbiAxLjQK
ZGlmZiAtdSAtcCAtcjEuNCBwcm9maWwuaAotLS0gd2luc3VwL2N5Z3dpbi9w
cm9maWwuaAkyOCBBcHIgMjAwMyAyMDoxMDo1MyAtMDAwMAkxLjQKKysrIHdp
bnN1cC9jeWd3aW4vcHJvZmlsLmgJMjkgQXVnIDIwMTEgMjE6MDE6NTggLTAw
MDAKQEAgLTcsMTAgKzcsMTYgQEAgVGhpcyBmaWxlIGlzIHBhcnQgb2YgQ3ln
d2luLgogVGhpcyBzb2Z0d2FyZSBpcyBhIGNvcHlyaWdodGVkIHdvcmsgbGlj
ZW5zZWQgdW5kZXIgdGhlIHRlcm1zIG9mIHRoZQogQ3lnd2luIGxpY2Vuc2Uu
ICBQbGVhc2UgY29uc3VsdCB0aGUgZmlsZSAiQ1lHV0lOX0xJQ0VOU0UiIGZv
cgogZGV0YWlscy4gKi8KLQorI2lmbmRlZiBQUk9GSUxfSAorI2RlZmluZSBQ
Uk9GSUxfSAorI2lmZGVmIF9fY3BsdXNwbHVzCitleHRlcm4gIkMieworI2Vu
ZGlmCiAvKiBwcm9maWxpbmcgZnJlcXVlbmN5LiAgKE5vIGxhcmdlciB0aGFu
IDEwMDApICovCiAjZGVmaW5lIFBST0ZfSFoJCQkxMDAKLQorI2lmIGRlZmlu
ZWQoUFJPRklMRSkKKyNpbmNsdWRlICJib3VuZGJ1ZmZlci5oIgorI2VuZGlm
CiAvKiBjb252ZXJ0IGFuIGFkZHIgdG8gYW4gaW5kZXggKi8KICNkZWZpbmUg
UFJPRklEWChwYywgYmFzZSwgc2NhbGUpCVwKICAgKHsJCQkJCQkJCQlcCkBA
IC0zNyw4ICs0MywxNyBAQCBzdHJ1Y3QgcHJvZmluZm8gewogICAgIHVfc2hv
cnQgKmNvdW50ZXI7CQkJLyogcHJvZmlsaW5nIGNvdW50ZXJzICovCiAgICAg
dV9sb25nIGxvd3BjLCBoaWdocGM7CQkvKiByYW5nZSB0byBiZSBwcm9maWxl
ZCAqLwogICAgIHVfaW50IHNjYWxlOwkJCS8qIHNjYWxlIHZhbHVlIG9mIGJp
bnMgKi8KKyNpZmRlZiBQUk9GSUxFCisgICAgc3RydWN0IGJvdW5kYnVmZmVy
IHF1ZXVlOworICAgIF9XSU5IQU5ETEUgb3BlcmF0aW9uYWw7CisjZW5kaWYK
IH07Ci0KKyNpZmRlZiBQUk9GSUxFCitleHRlcm4gc3RydWN0IHByb2ZpbmZv
IHByb2Y7CisjZW5kaWYKIGludCBwcm9maWxlX2N0bChzdHJ1Y3QgcHJvZmlu
Zm8gKiwgY2hhciAqLCBzaXplX3QsIHVfbG9uZywgdV9pbnQpOwogaW50IHBy
b2ZpbChjaGFyICosIHNpemVfdCwgdV9sb25nLCB1X2ludCk7Ci0KKyNpZmRl
ZiBfX2NwbHVzcGx1cworfQorI2VuZGlmCisjZW5kaWYKSW5kZXg6IHdpbnN1
cC9jeWd3aW4vc2VjX2hlbHBlci5jYwo9PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
ClJDUyBmaWxlOiAvY3ZzL3NyYy9zcmMvd2luc3VwL2N5Z3dpbi9zZWNfaGVs
cGVyLmNjLHYKcmV0cmlldmluZyByZXZpc2lvbiAxLjkzCmRpZmYgLXUgLXAg
LXIxLjkzIHNlY19oZWxwZXIuY2MKLS0tIHdpbnN1cC9jeWd3aW4vc2VjX2hl
bHBlci5jYwkyOSBBcHIgMjAxMSAxMDozODoxMiAtMDAwMAkxLjkzCisrKyB3
aW5zdXAvY3lnd2luL3NlY19oZWxwZXIuY2MJMjkgQXVnIDIwMTEgMjE6MDE6
NTggLTAwMDAKQEAgLTQ3Niw2ICs0NzYsMTEgQEAgZ2V0X251bGxfc2QgKCkK
IHZvaWQKIGluaXRfZ2xvYmFsX3NlY3VyaXR5ICgpCiB7CisjaWZkZWYgUFJP
RklMRQorICBzdGF0aWMgaW50IGNhbGxlZDsKKyAgaWYgKGNhbGxlZCsrKQor
CXJldHVybjsKKyNlbmRpZgogICBzZWNfbm9uZS5uTGVuZ3RoID0gc2VjX25v
bmVfbmloLm5MZW5ndGggPQogICBzZWNfYWxsLm5MZW5ndGggPSBzZWNfYWxs
X25paC5uTGVuZ3RoID0gc2l6ZW9mIChTRUNVUklUWV9BVFRSSUJVVEVTKTsK
ICAgc2VjX25vbmUuYkluaGVyaXRIYW5kbGUgPSBzZWNfYWxsLmJJbmhlcml0
SGFuZGxlID0gVFJVRTsKLS0tIC9kZXYvbnVsbAkyMDExLTA4LTI4IDIzOjI5
OjMxLjAwMDAwMDAwMCArMDkwMAorKysgd2luc3VwL2N5Z3dpbi9ib3VuZGJ1
ZmZlci5oCTIwMTEtMDgtMjUgMDE6MzM6MjEuOTQzMjU1MDAwICswOTAwCkBA
IC0wLDAgKzEsNjYgQEAKKy8qIGJvdW5kYnVmZmVyLmgKKworIFRISVMgU09G
VFdBUkUgSVMgTk9UIENPUFlSSUdIVEVECisKKyBUaGlzIHNvdXJjZSBjb2Rl
IGlzIG9mZmVyZWQgZm9yIHVzZSBpbiB0aGUgcHVibGljIGRvbWFpbi4gWW91
IG1heQorIHVzZSwgbW9kaWZ5IG9yIGRpc3RyaWJ1dGUgaXQgZnJlZWx5Lgor
CisgVGhpcyBjb2RlIGlzIGRpc3RyaWJ1dGVkIGluIHRoZSBob3BlIHRoYXQg
aXQgd2lsbCBiZSB1c2VmdWwgYnV0CisgV0lUSE9VVCBBTlkgV0FSUkFOVFku
IEFMTCBXQVJSRU5USUVTLCBFWFBSRVNTIE9SIElNUExJRUQgQVJFIEhFUkVC
WQorIERJU0NMQU1FRC4gVGhpcyBpbmNsdWRlcyBidXQgaXMgbm90IGxpbWl0
ZWQgdG8gd2FycmVudGllcyBvZgorIE1FUkNIQU5UQUJJTElUWSBvciBGSVRO
RVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRS4KKyAqLworI2lmbmRlZiBC
T1VOREJVRkZFUl9IXworI2RlZmluZSBCT1VOREJVRkZFUl9IXworI2luY2x1
ZGUgPHN0ZGlvLmg+CisjaWZkZWYgX19jcGx1c3BsdXMKK2V4dGVybiAiQyIK
K3sKKyNlbmRpZgorICBleHRlcm4gdm9pZAorICBwcm9maWxlX3RocmVhZF9v
ZmYoKTsKKyAgc3RydWN0IG1lc3NhZ2UKKyAgeworI2lmIDAKKwl1bnNpZ25l
ZCBsb25nIGxvbmcgbGRhdGE7CisJdW5zaWduZWQgbG9uZyBpZGF0YVsyXTsK
KyNlbmRpZgorCXZvaWQqIHB2OworCXVuc2lnbmVkIGxvbmcgbG9uZyB1bGx2
YWw7CisgIH07CisgIHR5cGVkZWYgc3RydWN0IG1lc3NhZ2UgbWVzc2FnZTsK
KyAgZXh0ZXJuIERXT1JEIF9fc3RkY2FsbAorICB3b3JrZXJfY29uc3VtZXIo
dm9pZCogYXJnKTsKKyAgdW5pb24gYXZvaWR0eXBlY2hlY2sKKyAgeworCUhB
TkRMRSBoOworCUNSSVRJQ0FMX1NFQ1RJT04gczsKKwlpbnQgaTsKKyAgfTsK
KyAgZW51bSBiY29uc3QKKyAgeworCU1VVEVYLCBGSUxMLCBFTVBUWSwgRlJP
TlQsIEJBQ0ssIFNaTUVNQkVSLCBTWkJVRiA9IDE2Mzg0CisgIH07CisgIHN0
cnVjdCBib3VuZGJ1ZmZlcgorICB7CisJdW5pb24gYXZvaWR0eXBlY2hlY2sg
bWVtYmVyW1NaTUVNQkVSXTsKKwltZXNzYWdlIGJ1ZmZlcltTWkJVRl07CisJ
aW50IHdvcmtlcl9lbmFibGVkOworCWludCBpbml0aWFsOworICB9OworI2Rl
ZmluZSByZWcoeCkgX19hdHRyaWJ1dGVfXygocmVncGFybSgoeCkpKSkKKyNk
ZWZpbmUgYnVmZmVybWV0aG9kKHgpIGJvdW5kYnVmZmVyXyMjeAorICBleHRl
cm4gdm9pZCBidWZmZXJtZXRob2QoY3Rvcikoc3RydWN0IGJvdW5kYnVmZmVy
Kik7CisgIGV4dGVybiB2b2lkIGJ1ZmZlcm1ldGhvZChpbml0aWFsKShzdHJ1
Y3QgYm91bmRidWZmZXIqKTsKKyAgZXh0ZXJuIHZvaWQgYnVmZmVybWV0aG9k
KGR0b3IpKHN0cnVjdCBib3VuZGJ1ZmZlciopOworICBleHRlcm4gcmVnKDIp
IGludCBidWZmZXJtZXRob2QoZW5xdWV1ZSkoc3RydWN0IGJvdW5kYnVmZmVy
KiwgbWVzc2FnZSk7CisgIGV4dGVybiByZWcoMikgaW50IGJ1ZmZlcm1ldGhv
ZChkZXF1ZXVlKShzdHJ1Y3QgYm91bmRidWZmZXIqLCBtZXNzYWdlKik7Cisg
IGV4dGVybiByZWcoMikgdm9pZCBidWZmZXJtZXRob2QoZGVxdWV1ZV9ub2xv
Y2spKHN0cnVjdCBib3VuZGJ1ZmZlciosIG1lc3NhZ2UqKTsKKyAgZXh0ZXJu
IGludCBidWZmZXJtZXRob2QoZW1wdHkpKHN0cnVjdCBib3VuZGJ1ZmZlciop
OworICBleHRlcm4gaW50IGJ1ZmZlcm1ldGhvZChmdWxsKShzdHJ1Y3QgYm91
bmRidWZmZXIqKTsKKyN1bmRlZiBidWZmZXJtZXRob2QKKyN1bmRlZiByZWcK
KyNpZmRlZiBfX2NwbHVzcGx1cworfQorI2VuZGlmCisjZW5kaWYgLyogQk9V
TkRCVUZGRVJfSF8gKi8KLS0tIC9kZXYvbnVsbAkyMDExLTA4LTI4IDIzOjI5
OjMxLjAwMDAwMDAwMCArMDkwMAorKysgd2luc3VwL2N5Z3dpbi9ib3VuZGJ1
ZmZlci5jCTIwMTEtMDgtMjggMTQ6MTU6MjIuMjgxMjUwMDAwICswOTAwCkBA
IC0wLDAgKzEsMTc5IEBACisvKiBib3VuZGJ1ZmZlci5jCisKKyBUSElTIFNP
RlRXQVJFIElTIE5PVCBDT1BZUklHSFRFRAorCisgVGhpcyBzb3VyY2UgY29k
ZSBpcyBvZmZlcmVkIGZvciB1c2UgaW4gdGhlIHB1YmxpYyBkb21haW4uIFlv
dSBtYXkKKyB1c2UsIG1vZGlmeSBvciBkaXN0cmlidXRlIGl0IGZyZWVseS4K
KworIFRoaXMgY29kZSBpcyBkaXN0cmlidXRlZCBpbiB0aGUgaG9wZSB0aGF0
IGl0IHdpbGwgYmUgdXNlZnVsIGJ1dAorIFdJVEhPVVQgQU5ZIFdBUlJBTlRZ
LiBBTEwgV0FSUkVOVElFUywgRVhQUkVTUyBPUiBJTVBMSUVEIEFSRSBIRVJF
QlkKKyBESVNDTEFNRUQuIFRoaXMgaW5jbHVkZXMgYnV0IGlzIG5vdCBsaW1p
dGVkIHRvIHdhcnJlbnRpZXMgb2YKKyBNRVJDSEFOVEFCSUxJVFkgb3IgRklU
TkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UuCisgKi8KKyNpbmNsdWRl
ICJ3aW5zdXAuaCIKKyNpbmNsdWRlICJ3aW5sZWFuLmgiCisjaW5jbHVkZSAi
cHJvZmlsLmgiCisjaW5jbHVkZSAiZ21vbi5oIgorI2luY2x1ZGUgPHN0ZGlu
dC5oPgorI2luY2x1ZGUgPHN0ZGxpYi5oPgorI2luY2x1ZGUgPHN0ZGJvb2wu
aD4KKyNpbmNsdWRlICJib3VuZGJ1ZmZlci5oIgorLyogVXNlCisgKiAwOiBz
ZW1hcGhvcmUKKyAqIDE6IGV2ZW50CisgKi8KKyNkZWZpbmUgVVNFX0VWRU5U
IDEKKy8qCisgKiBUaGVyZSBhcmUgY2FzZXMgd2hlcmUgdGhlIGJvdW5kZWQg
YnVmZmVyIGlzIGJsb2NrZWQgYW5kIG5vdCBvcGVyYXRpb25hbC4KKyAqIGFz
IGEgd29ya2Fyb3VuZCwgZ2l2ZSBtYXhpbXVtIHRpbWVvdXQgdG8gV0ZTTy4K
KyAqIGFzIGxvbmcgYXMgcHJvZmlsZV90aHJlYWRfb2ZmIGlzIGlzc3VlZCBi
ZWZvcmUgZXZlcnkgRXhpdFByb2Nlc3MsIGl0IGlzIG9rYXkgaWYgdGhlIHRp
bWVvdXQgaXMgSU5GSU5JVEUuCisgKi8KKyNkZWZpbmUgV0ZTT19USU1FT1VU
X01TIElORklOSVRFCisvKgorICogaHR0cDovL21zZG4ubWljcm9zb2Z0LmNv
bS9lbi11cy9saWJyYXJ5L21zNjg3MDMyLmFzcHgKKyAqICBDdXJyZW50IHRo
cmVhZCBhbmQgcHJvY2VzcyBoYW5kbGVzIGFyZSBzcGVjaWFsIGNhc2VkCisg
Ki8KKyNkZWZpbmUgSU5WQUxJRF9GT1JfU1VSRSAtMworZXh0ZXJuIFNFQ1VS
SVRZX0FUVFJJQlVURVMgc2VjX25vbmVfbmloOworRFdPUkQgX19zdGRjYWxs
Cit3b3JrZXJfY29uc3VtZXIodm9pZCogYXJnKQoreworICBpZiAocHJvZi5x
dWV1ZS5pbml0aWFsKQorCXsKKwkgIGJvdW5kYnVmZmVyX2N0b3IoJnByb2Yu
cXVldWUpOworCSAgcHJvZi5xdWV1ZS5pbml0aWFsID0gMDsKKwl9CisgIEVu
dGVyQ3JpdGljYWxTZWN0aW9uKCZwcm9mLnF1ZXVlLm1lbWJlcltNVVRFWF0u
cyk7CisgIHByb2YucXVldWUud29ya2VyX2VuYWJsZWQgPSAxOworICBSZWxl
YXNlU2VtYXBob3JlKHByb2Yub3BlcmF0aW9uYWwsIDEsIDApOworICBMZWF2
ZUNyaXRpY2FsU2VjdGlvbigmcHJvZi5xdWV1ZS5tZW1iZXJbTVVURVhdLnMp
OworICB3aGlsZSAocHJvZi5xdWV1ZS53b3JrZXJfZW5hYmxlZCkKKwl7CisJ
ICBtZXNzYWdlIG1zZzsKKwkgIGlmICghYm91bmRidWZmZXJfZGVxdWV1ZSgm
cHJvZi5xdWV1ZSwgJm1zZykpCisJCWNvbnRpbnVlOworCSAgdW5zaWduZWQg
aWR4ID0gUFJPRklEWCAoKHVuc2lnbmVkKW1zZy5wdiwgcHJvZi5sb3dwYywg
cHJvZi4KKwkJICBzY2FsZSk7CisJICBpZiAoIW1zZy51bGx2YWwpCisJCWNv
bnRpbnVlOworCSAgX2dtb25wYXJhbS5jb21tX2tjb3VudFtpZHhdICs9IG1z
Zy51bGx2YWw7CisJfQorICByZXR1cm4gMDsKK30KKyNpZmRlZiBQUk9GSUxF
Cit2b2lkCitwcm9maWxlX3RocmVhZF9vZmYoKQoreworICBpbnQgZW5hYmxl
ZCA9IF9fc3luY19mZXRjaF9hbmRfYW5kKCZwcm9mLnF1ZXVlLndvcmtlcl9l
bmFibGVkLCAwKTsKKyAgaWYgKGVuYWJsZWQpCisJeworCSAgUmVsZWFzZVNl
bWFwaG9yZShwcm9mLnF1ZXVlLm1lbWJlcltGSUxMXS5oLCAxLCAwKTsKKwkg
IFdhaXRGb3JTaW5nbGVPYmplY3QocHJvZi5wcm9mdGhyLCBJTkZJTklURSk7
CisJfQorfQorI2VuZGlmCisjZGVmaW5lIGJ1ZmZlcm1ldGhvZCh4KSBib3Vu
ZGJ1ZmZlcl8jI3gKK3ZvaWQgYnVmZmVybWV0aG9kKGN0b3IpKHN0cnVjdCBi
b3VuZGJ1ZmZlciogdGhpcykKK3sKKyAgdGhpcy0+bWVtYmVyW0ZST05UXS5p
ID0gdGhpcy0+bWVtYmVyW0JBQ0tdLmkgPSAwOworICBJbml0aWFsaXplQ3Jp
dGljYWxTZWN0aW9uQW5kU3BpbkNvdW50KCZ0aGlzLT5tZW1iZXJbTVVURVhd
LnMsIDB4MDgwMDAwMDApOworI2lmIFVTRV9FVkVOVAorICB0aGlzLT5tZW1i
ZXJbRU1QVFldLmggPSBDcmVhdGVFdmVudEEoJnNlY19ub25lX25paCwgMSwg
MSwgMCk7CisjZWxzZQorICB0aGlzLT5tZW1iZXJbRU1QVFldLmggPSBDcmVh
dGVTZW1hcGhvcmVBKCZzZWNfbm9uZV9uaWgsIFNaQlVGLCBTWkJVRiwgMCk7
CisjZW5kaWYKKyAgdGhpcy0+bWVtYmVyW0ZJTExdLmggPSBDcmVhdGVTZW1h
cGhvcmVBKCZzZWNfbm9uZV9uaWgsIDAsIFNaQlVGLCAwKTsKK30KK3ZvaWQg
YnVmZmVybWV0aG9kKGluaXRpYWwpKHN0cnVjdCBib3VuZGJ1ZmZlciogdGhp
cykKK3sKKyAgdGhpcy0+aW5pdGlhbCA9IDE7CisgIHRoaXMtPm1lbWJlcltN
VVRFWF0uaSA9IHRoaXMtPm1lbWJlcltFTVBUWV0uaSA9IHRoaXMtPm1lbWJl
cltGSUxMXS5pID0gSU5WQUxJRF9GT1JfU1VSRTsKK30KK3ZvaWQgYnVmZmVy
bWV0aG9kKGR0b3IpKHN0cnVjdCBib3VuZGJ1ZmZlciogdGhpcykKK3sKKyAg
Q2xvc2VIYW5kbGUodGhpcy0+bWVtYmVyW01VVEVYXS5oKTsKKyAgQ2xvc2VI
YW5kbGUodGhpcy0+bWVtYmVyW0VNUFRZXS5oKTsKKyAgQ2xvc2VIYW5kbGUo
dGhpcy0+bWVtYmVyW0ZJTExdLmgpOworICB0aGlzLT5tZW1iZXJbTVVURVhd
LmkgPSB0aGlzLT5tZW1iZXJbRU1QVFldLmkgPSB0aGlzLT5tZW1iZXJbRklM
TF0uaSA9IElOVkFMSURfRk9SX1NVUkU7Cit9CitzdGF0aWMgX19hdHRyaWJ1
dGVfXygodXNlZCkpIHZvaWQgYnVmZmVybWV0aG9kKGNoZWNrKShzdHJ1Y3Qg
Ym91bmRidWZmZXIqIHRoaXMpCit7CisgIGlmICghKCh0aGlzLT5tZW1iZXJb
RlJPTlRdLmkgPiAtMSkgJiYgKHRoaXMtPm1lbWJlcltGUk9OVF0uaSA8IFNa
QlVGKSkpCisJYXNtIHZvbGF0aWxlKCJpbnQgJDNcdFxuIik7CisgIGlmICgh
KCh0aGlzLT5tZW1iZXJbQkFDS10uaSA+IC0xKSAmJiAodGhpcy0+bWVtYmVy
W0JBQ0tdLmkgPCBTWkJVRikpKQorCWFzbSB2b2xhdGlsZSgiaW50ICQzXHRc
biIpOworfQorX19hdHRyaWJ1dGVfXygoYWx3YXlzX2lubGluZSxyZWdwYXJt
KDIpKSkgdm9pZCBidWZmZXJtZXRob2QoZW5xdWV1ZV9ub2xvY2spKHN0cnVj
dCBib3VuZGJ1ZmZlciosIG1lc3NhZ2UpOworaW50IF9fYXR0cmlidXRlX18o
KHJlZ3Bhcm0oMikpKSBidWZmZXJtZXRob2QoZW5xdWV1ZSkoc3RydWN0IGJv
dW5kYnVmZmVyKiB0aGlzLCBtZXNzYWdlIG9iaikKK3sKKyAgaWYgKHByb2Yu
cXVldWUuaW5pdGlhbCkKKwl7CisJICBidWZmZXJtZXRob2QoZW5xdWV1ZV9u
b2xvY2spKHRoaXMsIG9iaik7CisJICByZXR1cm4gMTsKKwl9CisgIGludCBy
ZXQgPSBXYWl0Rm9yU2luZ2xlT2JqZWN0KHRoaXMtPm1lbWJlcltFTVBUWV0u
aCwgV0ZTT19USU1FT1VUX01TKTsKKyAgaWYgKChyZXQgIT0gV0FJVF9PQkpF
Q1RfMCkgfHwgIXRoaXMtPndvcmtlcl9lbmFibGVkKQorCXJldHVybiAwOwor
ICBFbnRlckNyaXRpY2FsU2VjdGlvbigmcHJvZi5xdWV1ZS5tZW1iZXJbTVVU
RVhdLnMpOworICBidWZmZXJtZXRob2QoZW5xdWV1ZV9ub2xvY2spKHRoaXMs
IG9iaik7CisjaWYgVVNFX0VWRU5UCisgIGxvbmcgYXZhaWxfdG9fZGVxdWV1
ZTsKKyAgUmVsZWFzZVNlbWFwaG9yZSh0aGlzLT5tZW1iZXJbRklMTF0uaCwg
MCwgJmF2YWlsX3RvX2RlcXVldWUpOworICBhdmFpbF90b19kZXF1ZXVlID0g
YXZhaWxfdG9fZGVxdWV1ZSA9PSAoU1pCVUYgLSAxKTsKKyNlbmRpZgorICBM
ZWF2ZUNyaXRpY2FsU2VjdGlvbigmcHJvZi5xdWV1ZS5tZW1iZXJbTVVURVhd
LnMpOworI2lmIFVTRV9FVkVOVAorICBpZiAoYXZhaWxfdG9fZGVxdWV1ZSkK
KwlSZXNldEV2ZW50KHRoaXMtPm1lbWJlcltFTVBUWV0uaCk7CisjZW5kaWYK
KyAgUmVsZWFzZVNlbWFwaG9yZSh0aGlzLT5tZW1iZXJbRklMTF0uaCwgMSwg
MCk7CisgIHJldHVybiAxOworfQorCitpbnQgYnVmZmVybWV0aG9kKGVtcHR5
KShzdHJ1Y3QgYm91bmRidWZmZXIqIHRoaXMpCit7CisgIGludCByZXQgPSB0
aGlzLT5tZW1iZXJbRlJPTlRdLmkgPT0gdGhpcy0+bWVtYmVyW0JBQ0tdLmk7
CisgIHJldHVybiByZXQ7Cit9CitpbnQgYnVmZmVybWV0aG9kKGZ1bGwpKHN0
cnVjdCBib3VuZGJ1ZmZlciogdGhpcykKK3sKKyAgaW50IHJldCA9ICh0aGlz
LT5tZW1iZXJbRlJPTlRdLmkgKyB0aGlzLT5tZW1iZXJbQkFDS10uaSkgPT0g
KFNaQlVGIC0gMSk7CisgIHJldHVybiByZXQ7Cit9CitpbnQgX19hdHRyaWJ1
dGVfXygocmVncGFybSgyKSkpIGJ1ZmZlcm1ldGhvZChkZXF1ZXVlKShzdHJ1
Y3QgYm91bmRidWZmZXIqIHRoaXMsIG1lc3NhZ2UqIHJlc3VsdCkKK3sKKyAg
aWYgKHByb2YucXVldWUuaW5pdGlhbCkKKwl7CisJICBidWZmZXJtZXRob2Qo
ZGVxdWV1ZV9ub2xvY2spKHRoaXMsIHJlc3VsdCk7CisJICByZXR1cm4gMTsK
Kwl9CisgIGludCByZXQgPSBXYWl0Rm9yU2luZ2xlT2JqZWN0KHRoaXMtPm1l
bWJlcltGSUxMXS5oLCBXRlNPX1RJTUVPVVRfTVMpOworICBpZiAoKHJldCAh
PSBXQUlUX09CSkVDVF8wKSB8fCAhdGhpcy0+d29ya2VyX2VuYWJsZWQpCisJ
cmV0dXJuIDA7CisgIEVudGVyQ3JpdGljYWxTZWN0aW9uKCZwcm9mLnF1ZXVl
Lm1lbWJlcltNVVRFWF0ucyk7CisgIGJ1ZmZlcm1ldGhvZChkZXF1ZXVlX25v
bG9jaykodGhpcywgcmVzdWx0KTsKKyNpZiBVU0VfRVZFTlQKKyAgbG9uZyBh
dmFpbF90b19lbnF1ZXVlOworICBSZWxlYXNlU2VtYXBob3JlKHRoaXMtPm1l
bWJlcltGSUxMXS5oLCAwLCAmYXZhaWxfdG9fZW5xdWV1ZSk7CisgIGF2YWls
X3RvX2VucXVldWUgPSBhdmFpbF90b19lbnF1ZXVlIDw9IDA7CisjZW5kaWYK
KyAgTGVhdmVDcml0aWNhbFNlY3Rpb24oJnByb2YucXVldWUubWVtYmVyW01V
VEVYXS5zKTsKKyNpZiBVU0VfRVZFTlQKKyAgaWYgKGF2YWlsX3RvX2VucXVl
dWUpCisJU2V0RXZlbnQodGhpcy0+bWVtYmVyW0VNUFRZXS5oKTsKKyNlbHNl
CisgIFJlbGVhc2VTZW1hcGhvcmUodGhpcy0+bWVtYmVyW0VNUFRZXS5oLCAx
LCAwKTsKKyNlbmRpZgorICByZXR1cm4gMTsKK30KK19fYXR0cmlidXRlX18o
KGFsd2F5c19pbmxpbmUscmVncGFybSgyKSkpIHZvaWQgYnVmZmVybWV0aG9k
KGVucXVldWVfbm9sb2NrKShzdHJ1Y3QgYm91bmRidWZmZXIqIHRoaXMsIG1l
c3NhZ2Ugb2JqKQoreworICB0aGlzLT5idWZmZXJbdGhpcy0+bWVtYmVyW0JB
Q0tdLmldID0gb2JqOworICB0aGlzLT5tZW1iZXJbQkFDS10uaSA9ICh0aGlz
LT5tZW1iZXJbQkFDS10uaSArIDEpICUgU1pCVUY7Cit9CitfX2F0dHJpYnV0
ZV9fKChhbHdheXNfaW5saW5lLHJlZ3Bhcm0oMikpKSB2b2lkIGJ1ZmZlcm1l
dGhvZChkZXF1ZXVlX25vbG9jaykoc3RydWN0IGJvdW5kYnVmZmVyKiB0aGlz
LCBtZXNzYWdlKiByZXN1bHQpCit7CisgICgqcmVzdWx0KSA9IHRoaXMtPmJ1
ZmZlclt0aGlzLT5tZW1iZXJbRlJPTlRdLmldOworICB0aGlzLT5tZW1iZXJb
RlJPTlRdLmkgPSAodGhpcy0+bWVtYmVyW0ZST05UXS5pICsgMSkgJSBTWkJV
RjsKK30KKyN1bmRlZiBidWZmZXJtZXRob2QKLS0tIC9kZXYvbnVsbAkyMDEx
LTA4LTI4IDIzOjI5OjMxLjAwMDAwMDAwMCArMDkwMAorKysgd2luc3VwL2N5
Z3dpbi9pbnN0cnVtZW50LmMJMjAxMS0wOC0yNiAwNTo0NToxNS4yMzQzNzUw
MDAgKzA5MDAKQEAgLTAsMCArMSwxMTkgQEAKKy8qIGluc3RydW1lbnQuYwor
CisgVEhJUyBTT0ZUV0FSRSBJUyBOT1QgQ09QWVJJR0hURUQKKworIFRoaXMg
c291cmNlIGNvZGUgaXMgb2ZmZXJlZCBmb3IgdXNlIGluIHRoZSBwdWJsaWMg
ZG9tYWluLiBZb3UgbWF5CisgdXNlLCBtb2RpZnkgb3IgZGlzdHJpYnV0ZSBp
dCBmcmVlbHkuCisKKyBUaGlzIGNvZGUgaXMgZGlzdHJpYnV0ZWQgaW4gdGhl
IGhvcGUgdGhhdCBpdCB3aWxsIGJlIHVzZWZ1bCBidXQKKyBXSVRIT1VUIEFO
WSBXQVJSQU5UWS4gQUxMIFdBUlJFTlRJRVMsIEVYUFJFU1MgT1IgSU1QTElF
RCBBUkUgSEVSRUJZCisgRElTQ0xBTUVELiBUaGlzIGluY2x1ZGVzIGJ1dCBp
cyBub3QgbGltaXRlZCB0byB3YXJyZW50aWVzIG9mCisgTUVSQ0hBTlRBQklM
SVRZIG9yIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFLgorCisg
Q3JlYXRlZCBvbjogMjAxMS4gMy4gMi4KKyAqLworI2luY2x1ZGUgPHN0ZGlu
dC5oPgorI2luY2x1ZGUgIndpbnN1cC5oIgorI2luY2x1ZGUgIndpbmxlYW4u
aCIKKyNpbmNsdWRlICJwcm9maWwuaCIKKyNpbmNsdWRlICJpbnN0cnVtZW50
LmgiCisjaW5jbHVkZSAiYm91bmRidWZmZXIuaCIKKyNpbmNsdWRlICJnbW9u
LmgiCitEV09SRCBOT19DT1BZIHRsc2tleTsKK2V4dGVybiBEV09SRCBXSU5B
UEkKK0dldExhc3RFcnJvcih2b2lkKTsKK3ZvaWQgV0lOQVBJCitTZXRMYXN0
RXJyb3IoRFdPUkQpOwordm9pZAorX19hdHRyaWJ1dGVfXygobm9faW5zdHJ1
bWVudF9mdW5jdGlvbikpCitfX2N5Z19wcm9maWxlX2Z1bmNfY3RvcigpCit7
CisgIHRsc2tleSA9IFRsc0FsbG9jKCk7Cit9Cit2b2lkIF9fYXR0cmlidXRl
X18gKChub19pbnN0cnVtZW50X2Z1bmN0aW9uKSkKK19fY3lnX3Byb2ZpbGVf
dGxzX2N0b3IoKQoreworICB2b2lkICogbWFwID0gKHZvaWQqKSBMb2NhbEFs
bG9jKExNRU1fWkVST0lOSVQsIHNpemVvZihzdHJ1Y3QgY2xrKSk7CisgIFRs
c1NldFZhbHVlKHRsc2tleSwgbWFwKTsKKyAgc3RydWN0IGNsayogY2xraW5m
byA9IChzdHJ1Y3QgY2xrKikgbWFwOworICBjbGtpbmZvLT5pZHggPSAwOwor
fQordm9pZCBfX2F0dHJpYnV0ZV9fICgobm9faW5zdHJ1bWVudF9mdW5jdGlv
bikpCitfX2N5Z19wcm9maWxlX3Rsc19kdG9yKCkKK3sKKyAgdm9pZCAqIG1h
cCA9IFRsc0dldFZhbHVlKHRsc2tleSk7CisgIGlmIChtYXApCisJTG9jYWxG
cmVlKG1hcCk7CisgIFRsc1NldFZhbHVlKHRsc2tleSwgMCk7CisKK30KK3Zv
aWQgX19hdHRyaWJ1dGVfXyAoKG5vX2luc3RydW1lbnRfZnVuY3Rpb24pKQor
X19jeWdfcHJvZmlsZV9mdW5jX2R0b3IoKQoreworICBUbHNGcmVlKHRsc2tl
eSk7CisgIHRsc2tleSA9IC0xOworfQorLyoKKyAqIEl0IHdvdWxkIGJlIGJl
dHRlciBpZiBpdCBkb2VzIGVpdGhlciBib3VuZCBjaGVja3MgYW5kIHNvbWUg
YXNzZXJ0aW9uIGFib3V0IGNhbGxlci4KKyAqIEZvciB0aGUgaXNzdWUgb2Yg
Ym91bmQgY2hlY2ssIGl0IGlzIGFzc3VtZWQgdGhhdCBjeWd3aW4ncyBjYWxs
IHN0YWNrIGdyb3dzIGxlc3MgdGhhbiBDQUxMU1RBQ0tCT1VORC4KKyAqIEZv
ciB0aGUgaXNzdWUgb2YgY2FsbGVyLCBpdCBpcyBiZWxpdmVkIHRoYXQgZ2Nj
IGRvZXMgcmlnaHQgdGhpbmcgc28gdGhhdCB3ZSBoYXZlIG1hdGNoaW5nIGVu
dGVyL2V4aXQgcGFpci4KKyAqLworc3RhdGljIHZvaWQgX19hdHRyaWJ1dGVf
XyAoKGFsd2F5c19pbmxpbmUsbm9faW5zdHJ1bWVudF9mdW5jdGlvbixyZWdw
YXJtKDMpKSkKK19fY3lnX3NldF9jbGsoc3RydWN0IGNsayogY2xraW5mbywg
dm9pZCAqY2FsbGVyLCBpbnQgc3RhdGUpCit7CisgIHJlZ2lzdGVyIGludCBp
ZHg7CisgIHJlZ2lzdGVyIG1lc3NhZ2UgbXNnOworICBzd2l0Y2ggKHN0YXRl
KQorCXsKKyAgY2FzZSAwOgorCWlmICghY2xraW5mby0+aWR4KQorCSAgZ290
byBza2lwOworCWlkeCA9IC0tY2xraW5mby0+aWR4OworCWNsa2luZm8tPnRz
Y1tpZHhdID0gX19idWlsdGluX2lhMzJfcmR0c2MoKSAtIGNsa2luZm8tPnRz
Y1tpZHhdOworCW1zZy5wdiA9IGNsa2luZm8tPnBjW2lkeF07CisJbXNnLnVs
bHZhbCA9IGNsa2luZm8tPnRzY1tpZHhdOworCWlmICgmcHJvZi5xdWV1ZS53
b3JrZXJfZW5hYmxlZCkKKwkgIGJvdW5kYnVmZmVyX2VucXVldWUoJnByb2Yu
cXVldWUsIG1zZyk7CisJYnJlYWs7CisgIGNhc2UgMToKKwlpZHggPSBjbGtp
bmZvLT5pZHg7CisJY2xraW5mby0+cGNbaWR4XSA9IGNhbGxlcjsKKwljbGtp
bmZvLT50c2NbaWR4XSA9IF9fYnVpbHRpbl9pYTMyX3JkdHNjKCk7CisJY2xr
aW5mby0+aWR4Kys7CisJYnJlYWs7CisgIGRlZmF1bHQ6CisJZ290byBza2lw
OworCWJyZWFrOworCX07CisgIHNraXA6IGRvCisJeworCX0KKyAgd2hpbGUg
KDApOworfQorLyoKKyAqIEdldExhc3RFcnJvciAvIFNldExhc3RFcnJvciBp
cyBuZWVkZWQgYmVjYXVzZSBUbHMqIGFsdGVyIGxhc3QgZXJyb3IgY29kZQor
ICovCit2b2lkIF9fYXR0cmlidXRlX18gKChub19pbnN0cnVtZW50X2Z1bmN0
aW9uKSkKK19fY3lnX3Byb2ZpbGVfZnVuY19lbnRlcih2b2lkKiBjYWxsZXIs
IHZvaWQqIHNpdGUpCit7CisgIERXT1JEIGVyciA9IEdldExhc3RFcnJvcigp
OworICBzdHJ1Y3QgY2xrKiBjbGtpbmZvID0gKHN0cnVjdCBjbGsqKSBUbHNH
ZXRWYWx1ZSh0bHNrZXkpOworICBpZiAoIWNsa2luZm8pCisJeworCSAgZ290
byB0cmFwOworCX0KKyAgX19jeWdfc2V0X2NsayhjbGtpbmZvLCBjYWxsZXIs
IDEpOworICB0cmFwOiBTZXRMYXN0RXJyb3IoZXJyKTsKK30KK3ZvaWQgX19h
dHRyaWJ1dGVfXyAoKG5vX2luc3RydW1lbnRfZnVuY3Rpb24pKQorX19jeWdf
cHJvZmlsZV9mdW5jX2V4aXQodm9pZCogY2FsbGVyLCB2b2lkKiBzaXRlKQor
eworICBEV09SRCBlcnIgPSBHZXRMYXN0RXJyb3IoKTsKKyAgc3RydWN0IGNs
ayogY2xraW5mbyA9IChzdHJ1Y3QgY2xrKikgVGxzR2V0VmFsdWUodGxza2V5
KTsKKyAgaWYgKCFjbGtpbmZvKQorCXsKKwkgIGdvdG8gdHJhcDsKKwl9Cisg
IF9fY3lnX3NldF9jbGsoY2xraW5mbywgY2FsbGVyLCAwKTsKKyAgdHJhcDog
U2V0TGFzdEVycm9yKGVycik7Cit9Ci0tLSAvZGV2L251bGwJMjAxMS0wOC0y
OCAyMzoyOTozMi4wMDAwMDAwMDAgKzA5MDAKKysrIHdpbnN1cC9jeWd3aW4v
aW5zdHJ1bWVudC5oCTIwMTEtMDgtMjYgMDU6MzI6MTQuNzE4Mzc1MDAwICsw
OTAwCkBAIC0wLDAgKzEsNDIgQEAKKy8qIGluc3RydW1lbnQuYworCisgVEhJ
UyBTT0ZUV0FSRSBJUyBOT1QgQ09QWVJJR0hURUQKKworIFRoaXMgc291cmNl
IGNvZGUgaXMgb2ZmZXJlZCBmb3IgdXNlIGluIHRoZSBwdWJsaWMgZG9tYWlu
LiBZb3UgbWF5CisgdXNlLCBtb2RpZnkgb3IgZGlzdHJpYnV0ZSBpdCBmcmVl
bHkuCisKKyBUaGlzIGNvZGUgaXMgZGlzdHJpYnV0ZWQgaW4gdGhlIGhvcGUg
dGhhdCBpdCB3aWxsIGJlIHVzZWZ1bCBidXQKKyBXSVRIT1VUIEFOWSBXQVJS
QU5UWS4gQUxMIFdBUlJFTlRJRVMsIEVYUFJFU1MgT1IgSU1QTElFRCBBUkUg
SEVSRUJZCisgRElTQ0xBTUVELiBUaGlzIGluY2x1ZGVzIGJ1dCBpcyBub3Qg
bGltaXRlZCB0byB3YXJyZW50aWVzIG9mCisgTUVSQ0hBTlRBQklMSVRZIG9y
IEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFLgorCisgQ3JlYXRl
ZCBvbjogMjAxMS4gMy4gMTguCisgKi8KKyNpZm5kZWYgSU5TVFJVTUVOVF9I
XworI2RlZmluZSBJTlNUUlVNRU5UX0hfCisjaWZkZWYgX19jcGx1c3BsdXMK
K2V4dGVybiAiQyIKK3sKKyNlbmRpZgorICBzdHJ1Y3QgY2xrCisgIHsKKwkv
KgorCSAqIEZJWE1FOiBDQUxMU1RBQ0tCT1VORCBzaG91bGQgYmUgbGVzcyB0
aGFuIG1heGltdW0gY2FsbCBzdGFjayBzaXplLgorCSAqLworI2RlZmluZSBD
QUxMU1RBQ0tCT1VORCAweDEwMDAwCisJdW5zaWduZWQgaWR4OworCXZvaWQq
IHBjW0NBTExTVEFDS0JPVU5EXTsKKwl1bnNpZ25lZCBsb25nIGxvbmcgdHNj
W0NBTExTVEFDS0JPVU5EXTsKKyAgfTsKKyAgdm9pZCBfX2F0dHJpYnV0ZV9f
ICgobm9faW5zdHJ1bWVudF9mdW5jdGlvbikpCisgIF9fY3lnX3Byb2ZpbGVf
ZnVuY19jdG9yKCk7CisgIHZvaWQgX19hdHRyaWJ1dGVfXyAoKG5vX2luc3Ry
dW1lbnRfZnVuY3Rpb24pKQorICBfX2N5Z19wcm9maWxlX2Z1bmNfZHRvcigp
OworICB2b2lkIF9fYXR0cmlidXRlX18gKChub19pbnN0cnVtZW50X2Z1bmN0
aW9uKSkKKyAgX19jeWdfcHJvZmlsZV90bHNfY3RvcigpOworICB2b2lkIF9f
YXR0cmlidXRlX18gKChub19pbnN0cnVtZW50X2Z1bmN0aW9uKSkKKyAgX19j
eWdfcHJvZmlsZV90bHNfZHRvcigpOworI2lmZGVmIF9fY3BsdXNwbHVzCit9
CisjZW5kaWYKKyNlbmRpZiAvKiBJTlNUUlVNRU5UX0hfICovCg==

--------------010204030104010209060203--
