Return-Path: <cygwin-patches-return-9097-listarch-cygwin-patches=sources.redhat.com@cygwin.com>
Received: (qmail 13690 invoked by alias); 21 Jun 2018 15:05:23 -0000
Mailing-List: contact cygwin-patches-help@cygwin.com; run by ezmlm
Precedence: bulk
List-Id: <cygwin-patches.cygwin.com>
List-Subscribe: <mailto:cygwin-patches-subscribe@cygwin.com>
List-Post: <mailto:cygwin-patches@cygwin.com>
List-Archive: <http://sourceware.org/ml/cygwin-patches/>
List-Help: <mailto:cygwin-patches-help@cygwin.com>, <http://sourceware.org/ml/#faqs>
Sender: cygwin-patches-owner@cygwin.com
Mail-Followup-To: cygwin-patches@cygwin.com
Received: (qmail 13679 invoked by uid 89); 21 Jun 2018 15:05:23 -0000
Authentication-Results: sourceware.org; auth=none
X-Virus-Found: No
X-Spam-SWARE-Status: No, score=-1.8 required=5.0 tests=AWL,BAYES_00,RCVD_IN_DNSWL_NONE autolearn=ham version=3.3.2 spammy=Hx-languages-length:174, H*c:HHHH
X-HELO: conssluserg-01.nifty.com
Received: from conssluserg-01.nifty.com (HELO conssluserg-01.nifty.com) (210.131.2.80) by sourceware.org (qpsmtpd/0.93/v0.84-503-g423c35a) with ESMTP; Thu, 21 Jun 2018 15:05:21 +0000
Received: from Express5800-S70 (ntsitm315127.sitm.nt.ngn.ppp.infoweb.ne.jp [125.3.30.127]) (authenticated)	by conssluserg-01.nifty.com with ESMTP id w5LF58nn013472	for <cygwin-patches@cygwin.com>; Fri, 22 Jun 2018 00:05:08 +0900
DKIM-Filter: OpenDKIM Filter v2.10.3 conssluserg-01.nifty.com w5LF58nn013472
X-Nifty-SrcIP: [125.3.30.127]
Date: Thu, 21 Jun 2018 15:05:00 -0000
From: Takashi Yano <takashi.yano@nifty.ne.jp>
To: cygwin-patches@cygwin.com
Subject: Re: [PATCH cygwin] Re: Problems of AF_INET domain socket regarding out-of-band data.
Message-Id: <20180622000518.2034f98a440dccfacf4aab14@nifty.ne.jp>
In-Reply-To: <20180621235728.928a7b97ec8e7bfea5960a47@nifty.ne.jp>
References: <20180613224858.7822b08abb75d76b72920095@nifty.ne.jp>	<20180620221812.2e10f95ef5501758493560a2@nifty.ne.jp>	<20180621071954.GA28504@calimero.vinschen.de>	<20180621235728.928a7b97ec8e7bfea5960a47@nifty.ne.jp>
Mime-Version: 1.0
Content-Type: multipart/mixed; boundary="Multipart=_Fri__22_Jun_2018_00_05_18_+0900_77EiNrKWwwL71aOX"
X-IsSubscribed: yes
X-SW-Source: 2018-q2/txt/msg00054.txt.bz2

This is a multi-part message in MIME format.

--Multipart=_Fri__22_Jun_2018_00_05_18_+0900_77EiNrKWwwL71aOX
Content-Type: text/plain; charset=US-ASCII
Content-Transfer-Encoding: 7bit
Content-length: 89

Sorry, again. Fix a typo in commit message.

-- 
Takashi Yano <takashi.yano@nifty.ne.jp>

--Multipart=_Fri__22_Jun_2018_00_05_18_+0900_77EiNrKWwwL71aOX
Content-Type: application/octet-stream;
 name="0001-Fix-the-handling-of-out-of-band-OOB-data-in-a-socket.patch"
Content-Disposition: attachment;
 filename="0001-Fix-the-handling-of-out-of-band-OOB-data-in-a-socket.patch"
Content-Transfer-Encoding: base64
Content-length: 15047

RnJvbSBkYzg4ZWI1ODQ1ZmRhOTFmYzNiNjQ4ZmE4MTkyNzVhMGNmOTI1ZjRm
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBUYWthc2hpIFlhbm8g
PHRha2FzaGkueWFub0BuaWZ0eS5uZS5qcD4KRGF0ZTogVGh1LCAyMSBKdW4g
MjAxOCAyMzoxMTo0OSArMDkwMApTdWJqZWN0OiBbUEFUQ0hdIEZpeCB0aGUg
aGFuZGxpbmcgb2Ygb3V0LW9mLWJhbmQgKE9PQikgZGF0YSBpbiBhIHNvY2tl
dC4KCiogZmhhbmRsZXIuaCAoY2xhc3MgZmhhbmRsZXJfc29ja2V0X3dzb2Nr
KTogQWRkIHZhcmlhYmxlIGJvb2wgb29iaW5saW5lLgoqIGZoYW5kbGVyX3Nv
Y2tldF9pbmV0LmNjIChmaGFuZGxlcl9zb2NrZXRfaW5ldDo6ZmhhbmRsZXJf
c29ja2V0X2luZXQpOgogIEluaXRpYWxpemUgdmFyaWFibGUgb29iaW5saW5l
LgooZmhhbmRsZXJfc29ja2V0X2luZXQ6OnJlY3ZfaW50ZXJuYWwpOiBNYWtl
IHRoZSBoYW5kbGluZyBvZiBPT0IgZGF0YQogIGFzIGNvbnNpc3RlbnQgd2l0
aCBQT1NJWCBhcyBwb3NzaWJsZS4gQWRkIHNpbXVsYXRpb24gb2YgaW5saW5l
IG1vZGUKICBmb3IgT09CIGRhdGEgYXMgYSB3b3JrYXJvdW5kIGZvciBicm9r
ZW4gd2luc29jayBiZWhhdmlvci4KKGZoYW5kbGVyX3NvY2tldF9pbmV0Ojpz
ZXRzb2Nrb3B0KTogRGl0dG8uCihmaGFuZGxlcl9zb2NrZXRfaW5ldDo6Z2V0
c29ja29wdCk6IERpdHRvLgooZmhhbmRsZXJfc29ja2V0X3dzb2NrOjppb2N0
bCk6IEZpeCByZXR1cm4gdmFsdWUgb2YgU0lPQ0FUTUFSSyBjb21tYW5kLgog
IFRoZSByZXR1cm4gdmFsdWUgb2YgU0lPQ0FUTUFSSyBvZiB3aW5zb2NrIGlz
IGFsbW9zdCBvcHBvc2l0ZSB0bwogIGV4cGVjdGF0aW9uLgoqIGZoYW5kbGVy
X3NvY2tldF9sb2NhbC5jYyAoZmhhbmRsZXJfc29ja2V0X2xvY2FsOjpyZWN2
X2ludGVybmFsKToKICBSZW1vdmUgdGhlIGhhbmRsaW5nIG9mIE9PQiBkYXRh
IGZyb20gQUZfTE9DQUwgZG9tYWluIHNvY2tldC4gT3BlcmF0aW9uCiAgcmVs
YXRlZCB0byBPT0IgZGF0YSB3aWxsIHJlc3VsdCBpbiBhbiBlcnJvciBsaWtl
IExpbnV4IGRvZXMuCihmaGFuZGxlcl9zb2NrZXRfbG9jYWw6OnNlbmR0byk6
IERpdHRvLgooZmhhbmRsZXJfc29ja2V0X2xvY2FsOjpzZW5kbXNnKTogRGl0
dG8uCgpUaGlzIGZpeGVzIHRoZSBpc3N1ZSByZXBvcnRlZCBpbiBmb2xsb3dp
bmcgcG9zdC4KaHR0cHM6Ly9jeWd3aW4uY29tL21sL2N5Z3dpbi8yMDE4LTA2
L21zZzAwMTQzLmh0bWwKLS0tCiB3aW5zdXAvY3lnd2luL2ZoYW5kbGVyLmgg
ICAgICAgICAgICAgICB8ICAyICsKIHdpbnN1cC9jeWd3aW4vZmhhbmRsZXJf
c29ja2V0X2luZXQuY2MgIHwgOTQgKysrKysrKysrKysrKysrKysrKysrKysr
LS0KIHdpbnN1cC9jeWd3aW4vZmhhbmRsZXJfc29ja2V0X2xvY2FsLmNjIHwg
MzMgKysrKysrKy0tCiAzIGZpbGVzIGNoYW5nZWQsIDEyMCBpbnNlcnRpb25z
KCspLCA5IGRlbGV0aW9ucygtKQoKZGlmZiAtLWdpdCBhL3dpbnN1cC9jeWd3
aW4vZmhhbmRsZXIuaCBiL3dpbnN1cC9jeWd3aW4vZmhhbmRsZXIuaAppbmRl
eCAyZWM0NjBhMzcuLjM5YTY3NGM3NiAxMDA2NDQKLS0tIGEvd2luc3VwL2N5
Z3dpbi9maGFuZGxlci5oCisrKyBiL3dpbnN1cC9jeWd3aW4vZmhhbmRsZXIu
aApAQCAtNjg0LDYgKzY4NCw4IEBAIGNsYXNzIGZoYW5kbGVyX3NvY2tldF93
c29jazogcHVibGljIGZoYW5kbGVyX3NvY2tldAogCiBjbGFzcyBmaGFuZGxl
cl9zb2NrZXRfaW5ldDogcHVibGljIGZoYW5kbGVyX3NvY2tldF93c29jawog
eworIHByaXZhdGU6CisgIGJvb2wgb29iaW5saW5lOyAvKiBUcnVlIGlmIG9w
dGlvbiBTT19PT0JJTkxJTkUgaXMgc2V0ICovCiAgcHJvdGVjdGVkOgogICBp
bnQgYWZfbG9jYWxfY29ubmVjdCAoKSB7IHJldHVybiAwOyB9CiAKZGlmZiAt
LWdpdCBhL3dpbnN1cC9jeWd3aW4vZmhhbmRsZXJfc29ja2V0X2luZXQuY2Mg
Yi93aW5zdXAvY3lnd2luL2ZoYW5kbGVyX3NvY2tldF9pbmV0LmNjCmluZGV4
IGRiMzAxZjM1NC4uNTU1YzNhOTRhIDEwMDY0NAotLS0gYS93aW5zdXAvY3ln
d2luL2ZoYW5kbGVyX3NvY2tldF9pbmV0LmNjCisrKyBiL3dpbnN1cC9jeWd3
aW4vZmhhbmRsZXJfc29ja2V0X2luZXQuY2MKQEAgLTY4NSw3ICs2ODUsOCBA
QCBmaGFuZGxlcl9zb2NrZXRfd3NvY2s6OnNldF9zb2NrZXRfaGFuZGxlIChT
T0NLRVQgc29jaywgaW50IGFmLCBpbnQgdHlwZSwKIH0KIAogZmhhbmRsZXJf
c29ja2V0X2luZXQ6OmZoYW5kbGVyX3NvY2tldF9pbmV0ICgpIDoKLSAgZmhh
bmRsZXJfc29ja2V0X3dzb2NrICgpCisgIGZoYW5kbGVyX3NvY2tldF93c29j
ayAoKSwKKyAgb29iaW5saW5lIChmYWxzZSkKIHsKIH0KIApAQCAtMTA0NCwx
MCArMTA0NSwxMSBAQCBmaGFuZGxlcl9zb2NrZXRfaW5ldDo6cmVjdl9pbnRl
cm5hbCAoTFBXU0FNU0cgd3NhbXNnLCBib29sIHVzZV9yZWN2bXNnKQogewog
ICBzc2l6ZV90IHJlcyA9IDA7CiAgIERXT1JEIHJldCA9IDAsIHdyZXQ7Ci0g
IGludCBldnRfbWFzayA9IEZEX1JFQUQgfCAoKHdzYW1zZy0+ZHdGbGFncyAm
IE1TR19PT0IpID8gRkRfT09CIDogMCk7CisgIGludCBldnRfbWFzayA9ICh3
c2Ftc2ctPmR3RmxhZ3MgJiBNU0dfT09CKSA/IEZEX09PQiA6IEZEX1JFQUQ7
CiAgIExQV1NBQlVGICZ3c2FidWYgPSB3c2Ftc2ctPmxwQnVmZmVyczsKICAg
VUxPTkcgJndzYWNudCA9IHdzYW1zZy0+ZHdCdWZmZXJDb3VudDsKICAgc3Rh
dGljIE5PX0NPUFkgTFBGTl9XU0FSRUNWTVNHIFdTQVJlY3ZNc2c7CisgIGJv
b2wgcmVhZF9vb2IgPSBmYWxzZTsKIAogICAvKiBDViAyMDE0LTEwLTI2OiBE
byBub3QgY2hlY2sgZm9yIHRoZSBjb25uZWN0X3N0YXRlIGF0IHRoaXMgcG9p
bnQuICBJbgogICAgICBjZXJ0YWluIHNjZW5hcmlvcyB0aGVyZSdzIG5vIHdh
eSB0byBjaGVjayB0aGUgY29ubmVjdCBzdGF0ZSByZWxpYWJseS4KQEAgLTEw
ODYsMTIgKzEwODgsNjQgQEAgZmhhbmRsZXJfc29ja2V0X2luZXQ6OnJlY3Zf
aW50ZXJuYWwgKExQV1NBTVNHIHdzYW1zZywgYm9vbCB1c2VfcmVjdm1zZykK
IAl3YWl0YWxsID0gZmFsc2U7CiAgICAgfQogCisgIC8qIHJlY3YoKSByZXR1
cm5zIEVJTlZBTCBpZiBNU0dfT09CIGZsYWcgaXMgc2V0IGluIGlubGluZSBt
b2RlLiAqLworICBpZiAob29iaW5saW5lICYmICh3c2Ftc2ctPmR3RmxhZ3Mg
JiBNU0dfT09CKSkKKyAgICB7CisgICAgICBzZXRfZXJybm8gKEVJTlZBTCk7
CisgICAgICByZXR1cm4gU09DS0VUX0VSUk9SOworICAgIH0KKworICAvKiBD
aGVjayB3aGV0aGVyIE9PQiBkYXRhIGlzIHJlYWR5IG9yIG5vdCAqLworICBp
ZiAoZ2V0X3NvY2tldF90eXBlICgpID09IFNPQ0tfU1RSRUFNKQorICAgIGlm
ICgod3NhbXNnLT5kd0ZsYWdzICYgTVNHX09PQikgfHwgb29iaW5saW5lKQor
ICAgICAgeworCXVfbG9uZyBhdG1hcmsgPSAwOworI2lmZGVmIF9feDg2XzY0
X18KKwkvKiBTSU9DQVRNQVJLID0gX0lPUigncycsNyx1X2xvbmcpICovCisJ
aW50IGVyciA9IDo6aW9jdGxzb2NrZXQgKGdldF9zb2NrZXQgKCksIF9JT1Io
J3MnLDcsdV9sb25nKSwgJmF0bWFyayk7CisjZWxzZQorCWludCBlcnIgPSA6
OmlvY3Rsc29ja2V0IChnZXRfc29ja2V0ICgpLCBTSU9DQVRNQVJLLCAmYXRt
YXJrKTsKKyNlbmRpZgorCWlmIChlcnIpCisJICB7CisJICAgIHNldF93aW5z
b2NrX2Vycm5vICgpOworCSAgICByZXR1cm4gU09DS0VUX0VSUk9SOworCSAg
fQorCS8qIElmIHRoZXJlIGlzIG5vIE9PQiBkYXRhLCByZWN2KCkgd2l0aCBN
U0dfT09CIHJldHVybnMgRUlOVkFMLgorCSAgIE5vdGU6IFRoZSByZXR1cm4g
dmFsdWUgb2YgU0lPQ0FUTUFSSyBpbiBub24taW5saW5lIG1vZGUgb2YKKwkg
ICB3aW5zb2NrIGlzIEZBTFNFIGlmIE9PQiBkYXRhIGV4aXN0cywgVFJVRSBv
dGhlcndpc2UuICovCisJaWYgKGF0bWFyayAmJiAod3NhbXNnLT5kd0ZsYWdz
ICYgTVNHX09PQikpCisJICB7CisJICAgIC8qIE5vIE9PQiBkYXRhICovCisJ
ICAgIHNldF9lcnJubyAoRUlOVkFMKTsKKwkgICAgcmV0dXJuIFNPQ0tFVF9F
UlJPUjsKKwkgIH0KKwkvKiBJbmxpbmUgbW9kZSBmb3Igb3V0LW9mLWJhbmQg
KE9PQikgZGF0YSBvZiB3aW5zb2NrIGlzCisJICAgY29tcGxldGVseSBicm9r
ZW4uIFRoYXQgaXMsIFNJT0NBVE1BUksgYWx3YXlzIHJldHVybnMKKwkgICBU
UlVFIGluIGlubGluZSBtb2RlLiBEdWUgdG8gdGhpcyBwcm9ibGVtLCBhcHBs
aWNhdGlvbgorCSAgIGNhbm5vdCBkZXRlcm1pbmUgT09CIGRhdGEgYXQgYWxs
LiBUaGVyZWZvcmUgdGhlIGJlaGF2aW9yCisJICAgb2YgYSBzb2NrZXQgd2l0
aCBTT19PT0JJTkxJTkUgc2V0IGlzIHNpbXVsYXRlZCB1c2luZworCSAgIGEg
c29ja2V0IHdpdGggU09fT09CSU5MSU5FIG5vdCBzZXQuIEluIHRoaXMgZmFr
ZSBpbmxpbmUKKwkgICBtb2RlLCB0aGUgb3JkZXIgb2YgdGhlIE9PQiBhbmQg
bm9uLU9PQiBkYXRhIGlzIG5vdAorCSAgIHByZXNlcnZlZC4gT09CIGRhdGEg
aXMgcmVhZCBiZWZvcmUgbm9uLU9PQiBkYXRhIHNlbnQKKwkgICBwcmlvciB0
byB0aGUgT09CIGRhdGEuICBIb3dldmVyLCB0aGlzIG1vc3QgbGlrZWx5IGlz
CisJICAgbm90IGEgcHJvYmxlbSBpbiBtb3N0IGNhc2VzLiAqLworCS8qIElm
IHRoZXJlIGlzIE9PQiBkYXRhLCByZWFkIE9PQiBkYXRhIHVzaW5nIE1TR19P
T0IgaW4KKwkgICBmYWtlIGlubGluZSBtb2RlLiAqLworCWlmICghYXRtYXJr
ICYmIG9vYmlubGluZSkKKwkgIHsKKwkgICAgcmVhZF9vb2IgPSB0cnVlOwor
CSAgICBldnRfbWFzayA9IEZEX09PQjsKKwkgIH0KKyAgICAgIH0KKwogICAv
KiBOb3RlOiBEb24ndCBjYWxsIFdTQVJlY3ZGcm9tKE1TR19QRUVLKSB3aXRo
b3V0IGFjdHVhbGx5IGhhdmluZyBkYXRhCiAgICAgIHdhaXRpbmcgaW4gdGhl
IGJ1ZmZlcnMsIG90aGVyd2lzZSB0aGUgZXZlbnQgaGFuZGxpbmcgZ2V0cyBt
ZXNzZWQgdXAKICAgICAgZm9yIHNvbWUgcmVhc29uLiAqLwogICB3aGlsZSAo
IShyZXMgPSB3YWl0X2Zvcl9ldmVudHMgKGV2dF9tYXNrIHwgRkRfQ0xPU0Us
IHdhaXRfZmxhZ3MpKQogCSB8fCBzYXdfc2h1dGRvd25fcmVhZCAoKSkKICAg
ICB7CisgICAgICBEV09SRCBkd0ZsYWdzID0gd3NhbXNnLT5kd0ZsYWdzIHwg
KHJlYWRfb29iID8gTVNHX09PQiA6IDApOwogICAgICAgaWYgKHVzZV9yZWN2
bXNnKQogCXJlcyA9IFdTQVJlY3ZNc2cgKGdldF9zb2NrZXQgKCksIHdzYW1z
ZywgJndyZXQsIE5VTEwsIE5VTEwpOwogICAgICAgLyogVGhpcyBpcyB3b3Jr
aW5nIGFyb3VuZCBhIHJlYWxseSB3ZWlyZCBwcm9ibGVtIGluIFdpblNvY2su
CkBAIC0xMTEzLDExICsxMTY3LDExIEBAIGZoYW5kbGVyX3NvY2tldF9pbmV0
OjpyZWN2X2ludGVybmFsIChMUFdTQU1TRyB3c2Ftc2csIGJvb2wgdXNlX3Jl
Y3Ztc2cpCiAJIG5hbWVsZW4gaXMgYSB2YWxpZCBwb2ludGVyIHdoaWxlIG5h
bWUgaXMgTlVMTC4gIEJvdGggcGFyYW1ldGVycyBhcmUKIAkgaWdub3JlZCBm
b3IgVENQIHNvY2tldHMsIHNvIHRoaXMgb25seSBvY2N1cnMgd2hlbiB1c2lu
ZyBVRFAgc29ja2V0LiAqLwogICAgICAgZWxzZSBpZiAoIXdzYW1zZy0+bmFt
ZSB8fCBnZXRfc29ja2V0X3R5cGUgKCkgPT0gU09DS19TVFJFQU0pCi0JcmVz
ID0gV1NBUmVjdiAoZ2V0X3NvY2tldCAoKSwgd3NhYnVmLCB3c2FjbnQsICZ3
cmV0LCAmd3NhbXNnLT5kd0ZsYWdzLAorCXJlcyA9IFdTQVJlY3YgKGdldF9z
b2NrZXQgKCksIHdzYWJ1Ziwgd3NhY250LCAmd3JldCwgJmR3RmxhZ3MsCiAJ
CSAgICAgICBOVUxMLCBOVUxMKTsKICAgICAgIGVsc2UKIAlyZXMgPSBXU0FS
ZWN2RnJvbSAoZ2V0X3NvY2tldCAoKSwgd3NhYnVmLCB3c2FjbnQsICZ3cmV0
LAotCQkJICAgJndzYW1zZy0+ZHdGbGFncywgd3NhbXNnLT5uYW1lLCAmd3Nh
bXNnLT5uYW1lbGVuLAorCQkJICAgJmR3RmxhZ3MsIHdzYW1zZy0+bmFtZSwg
JndzYW1zZy0+bmFtZWxlbiwKIAkJCSAgIE5VTEwsIE5VTEwpOwogICAgICAg
aWYgKCFyZXMpCiAJewpAQCAtMTU2MSw2ICsxNjE1LDIzIEBAIGZoYW5kbGVy
X3NvY2tldF9pbmV0OjpzZXRzb2Nrb3B0IChpbnQgbGV2ZWwsIGludCBvcHRu
YW1lLCBjb25zdCB2b2lkICpvcHR2YWwsCiAJICAgIHNldF9lcnJubyAoRURP
TSk7CiAJICByZXR1cm4gcmV0OwogCisJY2FzZSBTT19PT0JJTkxJTkU6CisJ
ICAvKiBJbmxpbmUgbW9kZSBmb3Igb3V0LW9mLWJhbmQgKE9PQikgZGF0YSBv
ZiB3aW5zb2NrIGlzCisJICAgICBjb21wbGV0ZWx5IGJyb2tlbi4gVGhhdCBp
cywgU0lPQ0FUTUFSSyBhbHdheXMgcmV0dXJucworCSAgICAgVFJVRSBpbiBp
bmxpbmUgbW9kZS4gRHVlIHRvIHRoaXMgcHJvYmxlbSwgYXBwbGljYXRpb24K
KwkgICAgIGNhbm5vdCBkZXRlcm1pbmUgT09CIGRhdGEgYXQgYWxsLiBUaGVy
ZWZvcmUgdGhlIGJlaGF2aW9yCisJICAgICBvZiBhIHNvY2tldCB3aXRoIFNP
X09PQklOTElORSBzZXQgaXMgc2ltdWxhdGVkIHVzaW5nCisJICAgICBhIHNv
Y2tldCB3aXRoIFNPX09PQklOTElORSBub3Qgc2V0LiBJbiB0aGlzIGZha2Ug
aW5saW5lCisJICAgICBtb2RlLCB0aGUgb3JkZXIgb2YgdGhlIE9PQiBhbmQg
bm9uLU9PQiBkYXRhIGlzIG5vdAorCSAgICAgcHJlc2VydmVkLiBPT0IgZGF0
YSBpcyByZWFkIGJlZm9yZSBub24tT09CIGRhdGEgc2VudAorCSAgICAgcHJp
b3IgdG8gdGhlIE9PQiBkYXRhLiAgSG93ZXZlciwgdGhpcyBtb3N0IGxpa2Vs
eSBpcworCSAgICAgbm90IGEgcHJvYmxlbSBpbiBtb3N0IGNhc2VzLiAqLwor
CSAgLyogSGVyZSwgaW5zdGVhZCBvZiBhY3R1YWxseSBzZXR0aW5nIGlubGlu
ZSBtb2RlLCBzaW1wbHkKKwkgICAgIHNldCB0aGUgdmFyaWFibGUgb29iaW5s
aW5lLiAqLworCSAgb29iaW5saW5lID0gKihpbnQgKikgb3B0dmFsID8gdHJ1
ZSA6IGZhbHNlOworCSAgaWdub3JlID0gdHJ1ZTsKKwkgIGJyZWFrOworCiAJ
ZGVmYXVsdDoKIAkgIGJyZWFrOwogCX0KQEAgLTE3MTMsNiArMTc4NCwxMCBA
QCBmaGFuZGxlcl9zb2NrZXRfaW5ldDo6Z2V0c29ja29wdCAoaW50IGxldmVs
LCBpbnQgb3B0bmFtZSwgY29uc3Qgdm9pZCAqb3B0dmFsLAogCSAgICByZXR1
cm4gMDsKIAkgIH0KIAorCWNhc2UgU09fT09CSU5MSU5FOgorCSAgKihpbnQg
Kikgb3B0dmFsID0gb29iaW5saW5lID8gMSA6IDA7CisJICByZXR1cm4gMDsK
KwogCWRlZmF1bHQ6CiAJICBicmVhazsKIAl9CkBAIC0xODUwLDYgKzE5MjUs
MTcgQEAgZmhhbmRsZXJfc29ja2V0X3dzb2NrOjppb2N0bCAodW5zaWduZWQg
aW50IGNtZCwgdm9pZCAqcCkKIAl9CiAgICAgICBlbHNlCiAJcmVzID0gOjpp
b2N0bHNvY2tldCAoZ2V0X3NvY2tldCAoKSwgY21kLCAodV9sb25nICopIHAp
OworICAgICAgLyogSW4gd2luc29jaywgdGhlIHJldHVybiB2YWx1ZSBvZiBT
SU9DQVRNQVJLIGlzIEZBTFNFIGlmCisJIE9PQiBkYXRhIGV4aXN0cywgVFJV
RSBvdGhlcndpc2UuIFRoaXMgaXMgYWxtb3N0IG9wcG9zaXRlCisJIHRvIGV4
cGVjdGF0aW9uLiAqLworI2lmZGVmIF9feDg2XzY0X18KKyAgICAgIC8qIFNJ
T0NBVE1BUksgPSBfSU9SKCdzJyw3LHVfbG9uZykgKi8KKyAgICAgIGlmIChj
bWQgPT0gX0lPUigncycsNyx1X2xvbmcpICYmICFyZXMpCisJKih1X2xvbmcg
KilwID0gISoodV9sb25nICopcDsKKyNlbHNlCisgICAgICBpZiAoY21kID09
IFNJT0NBVE1BUksgJiYgIXJlcykKKwkqKHVfbG9uZyAqKXAgPSAhKih1X2xv
bmcgKilwOworI2VuZGlmCiAgICAgICBicmVhazsKICAgICBkZWZhdWx0Ogog
ICAgICAgcmVzID0gZmhhbmRsZXJfc29ja2V0Ojppb2N0bCAoY21kLCBwKTsK
ZGlmZiAtLWdpdCBhL3dpbnN1cC9jeWd3aW4vZmhhbmRsZXJfc29ja2V0X2xv
Y2FsLmNjIGIvd2luc3VwL2N5Z3dpbi9maGFuZGxlcl9zb2NrZXRfbG9jYWwu
Y2MKaW5kZXggOTBkOGQ1YWE1Li4yZTAxZjMwYTIgMTAwNjQ0Ci0tLSBhL3dp
bnN1cC9jeWd3aW4vZmhhbmRsZXJfc29ja2V0X2xvY2FsLmNjCisrKyBiL3dp
bnN1cC9jeWd3aW4vZmhhbmRsZXJfc29ja2V0X2xvY2FsLmNjCkBAIC0xMDY1
LDcgKzEwNjUsNyBAQCBmaGFuZGxlcl9zb2NrZXRfbG9jYWw6OnJlY3ZfaW50
ZXJuYWwgKExQV1NBTVNHIHdzYW1zZywgYm9vbCB1c2VfcmVjdm1zZykKIHsK
ICAgc3NpemVfdCByZXMgPSAwOwogICBEV09SRCByZXQgPSAwLCB3cmV0Owot
ICBpbnQgZXZ0X21hc2sgPSBGRF9SRUFEIHwgKCh3c2Ftc2ctPmR3RmxhZ3Mg
JiBNU0dfT09CKSA/IEZEX09PQiA6IDApOworICBpbnQgZXZ0X21hc2sgPSBG
RF9SRUFEOwogICBMUFdTQUJVRiAmd3NhYnVmID0gd3NhbXNnLT5scEJ1ZmZl
cnM7CiAgIFVMT05HICZ3c2FjbnQgPSB3c2Ftc2ctPmR3QnVmZmVyQ291bnQ7
CiAgIHN0YXRpYyBOT19DT1BZIExQRk5fV1NBUkVDVk1TRyBXU0FSZWN2TXNn
OwpAQCAtMTA4MCw3ICsxMDgwLDE1IEBAIGZoYW5kbGVyX3NvY2tldF9sb2Nh
bDo6cmVjdl9pbnRlcm5hbCAoTFBXU0FNU0cgd3NhbXNnLCBib29sIHVzZV9y
ZWN2bXNnKQogCiAgIERXT1JEIHdhaXRfZmxhZ3MgPSB3c2Ftc2ctPmR3Rmxh
Z3M7CiAgIGJvb2wgd2FpdGFsbCA9ICEhKHdhaXRfZmxhZ3MgJiBNU0dfV0FJ
VEFMTCk7Ci0gIHdzYW1zZy0+ZHdGbGFncyAmPSAoTVNHX09PQiB8IE1TR19Q
RUVLIHwgTVNHX0RPTlRST1VURSk7CisKKyAgLyogT3V0LW9mLWJhbmQgZGF0
YSBub3Qgc3VwcG9ydGVkIGJ5IEFGX0xPQ0FMICovCisgIGlmICh3c2Ftc2ct
PmR3RmxhZ3MgJiBNU0dfT09CKQorICAgIHsKKyAgICAgIHNldF9lcnJubyAo
RU9QTk9UU1VQUCk7CisgICAgICByZXR1cm4gU09DS0VUX0VSUk9SOworICAg
IH0KKworICB3c2Ftc2ctPmR3RmxhZ3MgJj0gKE1TR19QRUVLIHwgTVNHX0RP
TlRST1VURSk7CiAgIGlmICh1c2VfcmVjdm1zZykKICAgICB7CiAgICAgICBp
ZiAoIVdTQVJlY3ZNc2cKQEAgLTExMDQsNyArMTExMiw3IEBAIGZoYW5kbGVy
X3NvY2tldF9sb2NhbDo6cmVjdl9pbnRlcm5hbCAoTFBXU0FNU0cgd3NhbXNn
LCBib29sIHVzZV9yZWN2bXNnKQogCSAgc2V0X3dpbnNvY2tfZXJybm8gKCk7
CiAJICByZXR1cm4gU09DS0VUX0VSUk9SOwogCX0KLSAgICAgIGlmIChpc19u
b25ibG9ja2luZyAoKSB8fCAod3NhbXNnLT5kd0ZsYWdzICYgKE1TR19PT0Ig
fCBNU0dfUEVFSykpKQorICAgICAgaWYgKGlzX25vbmJsb2NraW5nICgpIHx8
ICh3c2Ftc2ctPmR3RmxhZ3MgJiBNU0dfUEVFSykpCiAJd2FpdGFsbCA9IGZh
bHNlOwogICAgIH0KIApAQCAtMTExNCw2ICsxMTIyLDcgQEAgZmhhbmRsZXJf
c29ja2V0X2xvY2FsOjpyZWN2X2ludGVybmFsIChMUFdTQU1TRyB3c2Ftc2cs
IGJvb2wgdXNlX3JlY3Ztc2cpCiAgIHdoaWxlICghKHJlcyA9IHdhaXRfZm9y
X2V2ZW50cyAoZXZ0X21hc2sgfCBGRF9DTE9TRSwgd2FpdF9mbGFncykpCiAJ
IHx8IHNhd19zaHV0ZG93bl9yZWFkICgpKQogICAgIHsKKyAgICAgIERXT1JE
IGR3RmxhZ3MgPSB3c2Ftc2ctPmR3RmxhZ3M7CiAgICAgICBpZiAodXNlX3Jl
Y3Ztc2cpCiAJcmVzID0gV1NBUmVjdk1zZyAoZ2V0X3NvY2tldCAoKSwgd3Nh
bXNnLCAmd3JldCwgTlVMTCwgTlVMTCk7CiAgICAgICAvKiBUaGlzIGlzIHdv
cmtpbmcgYXJvdW5kIGEgcmVhbGx5IHdlaXJkIHByb2JsZW0gaW4gV2luU29j
ay4KQEAgLTExMzUsMTEgKzExNDQsMTEgQEAgZmhhbmRsZXJfc29ja2V0X2xv
Y2FsOjpyZWN2X2ludGVybmFsIChMUFdTQU1TRyB3c2Ftc2csIGJvb2wgdXNl
X3JlY3Ztc2cpCiAJIG5hbWVsZW4gaXMgYSB2YWxpZCBwb2ludGVyIHdoaWxl
IG5hbWUgaXMgTlVMTC4gIEJvdGggcGFyYW1ldGVycyBhcmUKIAkgaWdub3Jl
ZCBmb3IgVENQIHNvY2tldHMsIHNvIHRoaXMgb25seSBvY2N1cnMgd2hlbiB1
c2luZyBVRFAgc29ja2V0LiAqLwogICAgICAgZWxzZSBpZiAoIXdzYW1zZy0+
bmFtZSB8fCBnZXRfc29ja2V0X3R5cGUgKCkgPT0gU09DS19TVFJFQU0pCi0J
cmVzID0gV1NBUmVjdiAoZ2V0X3NvY2tldCAoKSwgd3NhYnVmLCB3c2FjbnQs
ICZ3cmV0LCAmd3NhbXNnLT5kd0ZsYWdzLAorCXJlcyA9IFdTQVJlY3YgKGdl
dF9zb2NrZXQgKCksIHdzYWJ1Ziwgd3NhY250LCAmd3JldCwgJmR3RmxhZ3Ms
CiAJCSAgICAgICBOVUxMLCBOVUxMKTsKICAgICAgIGVsc2UKIAlyZXMgPSBX
U0FSZWN2RnJvbSAoZ2V0X3NvY2tldCAoKSwgd3NhYnVmLCB3c2FjbnQsICZ3
cmV0LAotCQkJICAgJndzYW1zZy0+ZHdGbGFncywgd3NhbXNnLT5uYW1lLCAm
d3NhbXNnLT5uYW1lbGVuLAorCQkJICAgJmR3RmxhZ3MsIHdzYW1zZy0+bmFt
ZSwgJndzYW1zZy0+bmFtZWxlbiwKIAkJCSAgIE5VTEwsIE5VTEwpOwogICAg
ICAgaWYgKCFyZXMpCiAJewpAQCAtMTIzNiw2ICsxMjQ1LDEzIEBAIGZoYW5k
bGVyX3NvY2tldF9sb2NhbDo6c2VuZHRvIChjb25zdCB2b2lkICppbl9wdHIs
IHNpemVfdCBsZW4sIGludCBmbGFncywKICAgY2hhciAqcHRyID0gKGNoYXIg
KikgaW5fcHRyOwogICBzdHJ1Y3Qgc29ja2FkZHJfc3RvcmFnZSBzc3Q7CiAK
KyAgLyogT3V0LW9mLWJhbmQgZGF0YSBub3Qgc3VwcG9ydGVkIGJ5IEFGX0xP
Q0FMICovCisgIGlmIChmbGFncyAmIE1TR19PT0IpCisgICAgeworICAgICAg
c2V0X2Vycm5vIChFT1BOT1RTVVBQKTsKKyAgICAgIHJldHVybiBTT0NLRVRf
RVJST1I7CisgICAgfQorCiAgIGlmICh0byAmJiBnZXRfaW5ldF9hZGRyX2xv
Y2FsICh0bywgdG9sZW4sICZzc3QsICZ0b2xlbikgPT0gU09DS0VUX0VSUk9S
KQogICAgIHJldHVybiBTT0NLRVRfRVJST1I7CiAKQEAgLTEyNzQsNiArMTI5
MCwxMyBAQCBmaGFuZGxlcl9zb2NrZXRfbG9jYWw6OnNlbmRtc2cgKGNvbnN0
IHN0cnVjdCBtc2doZHIgKm1zZywgaW50IGZsYWdzKQogICBzdHJ1Y3Qgc29j
a2FkZHJfc3RvcmFnZSBzc3Q7CiAgIGludCBsZW4gPSAwOwogCisgIC8qIE91
dC1vZi1iYW5kIGRhdGEgbm90IHN1cHBvcnRlZCBieSBBRl9MT0NBTCAqLwor
ICBpZiAoZmxhZ3MgJiBNU0dfT09CKQorICAgIHsKKyAgICAgIHNldF9lcnJu
byAoRU9QTk9UU1VQUCk7CisgICAgICByZXR1cm4gU09DS0VUX0VSUk9SOwor
ICAgIH0KKwogICBpZiAobXNnLT5tc2dfbmFtZQogICAgICAgJiYgZ2V0X2lu
ZXRfYWRkcl9sb2NhbCAoKHN0cnVjdCBzb2NrYWRkciAqKSBtc2ctPm1zZ19u
YW1lLAogCQkJICAgICAgbXNnLT5tc2dfbmFtZWxlbiwgJnNzdCwgJmxlbikg
PT0gU09DS0VUX0VSUk9SKQotLSAKMi4xNy4wCgo=

--Multipart=_Fri__22_Jun_2018_00_05_18_+0900_77EiNrKWwwL71aOX--
